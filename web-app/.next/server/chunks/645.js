exports.id=645,exports.ids=[645],exports.modules={6421:t=>{function e(t){return Promise.resolve().then(()=>{var e=Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e})}e.keys=()=>[],e.resolve=e,e.id=6421,t.exports=e},7092:t=>{function e(t){var e=Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e}e.keys=()=>[],e.resolve=e,e.id=7092,t.exports=e},5857:t=>{let e,a;var i=(()=>{for(var t=new Uint8Array(128),e=0;e<64;e++)t[e<26?e+65:e<52?e+71:e<62?e-4:4*e-205]=e;return e=>{for(var a=e.length,i=new Uint8Array((a-("="==e[a-1])-("="==e[a-2]))*3/4|0),o=0,n=0;o<a;){var l=t[e.charCodeAt(o++)],r=t[e.charCodeAt(o++)],s=t[e.charCodeAt(o++)],c=t[e.charCodeAt(o++)];i[n++]=l<<2|r>>4,i[n++]=r<<4|s>>2,i[n++]=s<<6|c}return i}})(),o=(e={"wasm-binary:./blake2b.wat"(t,e){e.exports=i("AGFzbQEAAAABEANgAn9/AGADf39/AGABfwADBQQAAQICBQUBAQroBwdNBQZtZW1vcnkCAAxibGFrZTJiX2luaXQAAA5ibGFrZTJiX3VwZGF0ZQABDWJsYWtlMmJfZmluYWwAAhBibGFrZTJiX2NvbXByZXNzAAMKvz8EwAIAIABCADcDACAAQgA3AwggAEIANwMQIABCADcDGCAAQgA3AyAgAEIANwMoIABCADcDMCAAQgA3AzggAEIANwNAIABCADcDSCAAQgA3A1AgAEIANwNYIABCADcDYCAAQgA3A2ggAEIANwNwIABCADcDeCAAQoiS853/zPmE6gBBACkDAIU3A4ABIABCu86qptjQ67O7f0EIKQMAhTcDiAEgAEKr8NP0r+68tzxBECkDAIU3A5ABIABC8e30+KWn/aelf0EYKQMAhTcDmAEgAELRhZrv+s+Uh9EAQSApAwCFNwOgASAAQp/Y+dnCkdqCm39BKCkDAIU3A6gBIABC6/qG2r+19sEfQTApAwCFNwOwASAAQvnC+JuRo7Pw2wBBOCkDAIU3A7gBIABCADcDwAEgAEIANwPIASAAQgA3A9ABC20BA38gAEHAAWohAyAAQcgBaiEEIAQpAwCnIQUCQANAIAEgAkYNASAFQYABRgRAIAMgAykDACAFrXw3AwBBACEFIAAQAwsgACAFaiABLQAAOgAAIAVBAWohBSABQQFqIQEMAAsLIAQgBa03AwALYQEDfyAAQcABaiEBIABByAFqIQIgASABKQMAIAIpAwB8NwMAIABCfzcD0AEgAikDAKchAwJAA0AgA0GAAUYNASAAIANqQQA6AAAgA0EBaiEDDAALCyACIAOtNwMAIAAQAwuqOwIgfgl/IABBgAFqISEgAEGIAWohIiAAQZABaiEjIABBmAFqISQgAEGgAWohJSAAQagBaiEmIABBsAFqIScgAEG4AWohKCAhKQMAIQEgIikDACECICMpAwAhAyAkKQMAIQQgJSkDACEFICYpAwAhBiAnKQMAIQcgKCkDACEIQoiS853/zPmE6gAhCUK7zqqm2NDrs7t/IQpCq/DT9K/uvLc8IQtC8e30+KWn/aelfyEMQtGFmu/6z5SH0QAhDUKf2PnZwpHagpt/IQ5C6/qG2r+19sEfIQ9C+cL4m5Gjs/DbACEQIAApAwAhESAAKQMIIRIgACkDECETIAApAxghFCAAKQMgIRUgACkDKCEWIAApAzAhFyAAKQM4IRggACkDQCEZIAApA0ghGiAAKQNQIRsgACkDWCEcIAApA2AhHSAAKQNoIR4gACkDcCEfIAApA3ghICANIAApA8ABhSENIA8gACkD0AGFIQ8gASAFIBF8fCEBIA0gAYVCIIohDSAJIA18IQkgBSAJhUIYiiEFIAEgBSASfHwhASANIAGFQhCKIQ0gCSANfCEJIAUgCYVCP4ohBSACIAYgE3x8IQIgDiAChUIgiiEOIAogDnwhCiAGIAqFQhiKIQYgAiAGIBR8fCECIA4gAoVCEIohDiAKIA58IQogBiAKhUI/iiEGIAMgByAVfHwhAyAPIAOFQiCKIQ8gCyAPfCELIAcgC4VCGIohByADIAcgFnx8IQMgDyADhUIQiiEPIAsgD3whCyAHIAuFQj+KIQcgBCAIIBd8fCEEIBAgBIVCIIohECAMIBB8IQwgCCAMhUIYiiEIIAQgCCAYfHwhBCAQIASFQhCKIRAgDCAQfCEMIAggDIVCP4ohCCABIAYgGXx8IQEgECABhUIgiiEQIAsgEHwhCyAGIAuFQhiKIQYgASAGIBp8fCEBIBAgAYVCEIohECALIBB8IQsgBiALhUI/iiEGIAIgByAbfHwhAiANIAKFQiCKIQ0gDCANfCEMIAcgDIVCGIohByACIAcgHHx8IQIgDSAChUIQiiENIAwgDXwhDCAHIAyFQj+KIQcgAyAIIB18fCEDIA4gA4VCIIohDiAJIA58IQkgCCAJhUIYiiEIIAMgCCAefHwhAyAOIAOFQhCKIQ4gCSAOfCEJIAggCYVCP4ohCCAEIAUgH3x8IQQgDyAEhUIgiiEPIAogD3whCiAFIAqFQhiKIQUgBCAFICB8fCEEIA8gBIVCEIohDyAKIA98IQogBSAKhUI/iiEFIAEgBSAffHwhASANIAGFQiCKIQ0gCSANfCEJIAUgCYVCGIohBSABIAUgG3x8IQEgDSABhUIQiiENIAkgDXwhCSAFIAmFQj+KIQUgAiAGIBV8fCECIA4gAoVCIIohDiAKIA58IQogBiAKhUIYiiEGIAIgBiAZfHwhAiAOIAKFQhCKIQ4gCiAOfCEKIAYgCoVCP4ohBiADIAcgGnx8IQMgDyADhUIgiiEPIAsgD3whCyAHIAuFQhiKIQcgAyAHICB8fCEDIA8gA4VCEIohDyALIA98IQsgByALhUI/iiEHIAQgCCAefHwhBCAQIASFQiCKIRAgDCAQfCEMIAggDIVCGIohCCAEIAggF3x8IQQgECAEhUIQiiEQIAwgEHwhDCAIIAyFQj+KIQggASAGIBJ8fCEBIBAgAYVCIIohECALIBB8IQsgBiALhUIYiiEGIAEgBiAdfHwhASAQIAGFQhCKIRAgCyAQfCELIAYgC4VCP4ohBiACIAcgEXx8IQIgDSAChUIgiiENIAwgDXwhDCAHIAyFQhiKIQcgAiAHIBN8fCECIA0gAoVCEIohDSAMIA18IQwgByAMhUI/iiEHIAMgCCAcfHwhAyAOIAOFQiCKIQ4gCSAOfCEJIAggCYVCGIohCCADIAggGHx8IQMgDiADhUIQiiEOIAkgDnwhCSAIIAmFQj+KIQggBCAFIBZ8fCEEIA8gBIVCIIohDyAKIA98IQogBSAKhUIYiiEFIAQgBSAUfHwhBCAPIASFQhCKIQ8gCiAPfCEKIAUgCoVCP4ohBSABIAUgHHx8IQEgDSABhUIgiiENIAkgDXwhCSAFIAmFQhiKIQUgASAFIBl8fCEBIA0gAYVCEIohDSAJIA18IQkgBSAJhUI/iiEFIAIgBiAdfHwhAiAOIAKFQiCKIQ4gCiAOfCEKIAYgCoVCGIohBiACIAYgEXx8IQIgDiAChUIQiiEOIAogDnwhCiAGIAqFQj+KIQYgAyAHIBZ8fCEDIA8gA4VCIIohDyALIA98IQsgByALhUIYiiEHIAMgByATfHwhAyAPIAOFQhCKIQ8gCyAPfCELIAcgC4VCP4ohByAEIAggIHx8IQQgECAEhUIgiiEQIAwgEHwhDCAIIAyFQhiKIQggBCAIIB58fCEEIBAgBIVCEIohECAMIBB8IQwgCCAMhUI/iiEIIAEgBiAbfHwhASAQIAGFQiCKIRAgCyAQfCELIAYgC4VCGIohBiABIAYgH3x8IQEgECABhUIQiiEQIAsgEHwhCyAGIAuFQj+KIQYgAiAHIBR8fCECIA0gAoVCIIohDSAMIA18IQwgByAMhUIYiiEHIAIgByAXfHwhAiANIAKFQhCKIQ0gDCANfCEMIAcgDIVCP4ohByADIAggGHx8IQMgDiADhUIgiiEOIAkgDnwhCSAIIAmFQhiKIQggAyAIIBJ8fCEDIA4gA4VCEIohDiAJIA58IQkgCCAJhUI/iiEIIAQgBSAafHwhBCAPIASFQiCKIQ8gCiAPfCEKIAUgCoVCGIohBSAEIAUgFXx8IQQgDyAEhUIQiiEPIAogD3whCiAFIAqFQj+KIQUgASAFIBh8fCEBIA0gAYVCIIohDSAJIA18IQkgBSAJhUIYiiEFIAEgBSAafHwhASANIAGFQhCKIQ0gCSANfCEJIAUgCYVCP4ohBSACIAYgFHx8IQIgDiAChUIgiiEOIAogDnwhCiAGIAqFQhiKIQYgAiAGIBJ8fCECIA4gAoVCEIohDiAKIA58IQogBiAKhUI/iiEGIAMgByAefHwhAyAPIAOFQiCKIQ8gCyAPfCELIAcgC4VCGIohByADIAcgHXx8IQMgDyADhUIQiiEPIAsgD3whCyAHIAuFQj+KIQcgBCAIIBx8fCEEIBAgBIVCIIohECAMIBB8IQwgCCAMhUIYiiEIIAQgCCAffHwhBCAQIASFQhCKIRAgDCAQfCEMIAggDIVCP4ohCCABIAYgE3x8IQEgECABhUIgiiEQIAsgEHwhCyAGIAuFQhiKIQYgASAGIBd8fCEBIBAgAYVCEIohECALIBB8IQsgBiALhUI/iiEGIAIgByAWfHwhAiANIAKFQiCKIQ0gDCANfCEMIAcgDIVCGIohByACIAcgG3x8IQIgDSAChUIQiiENIAwgDXwhDCAHIAyFQj+KIQcgAyAIIBV8fCEDIA4gA4VCIIohDiAJIA58IQkgCCAJhUIYiiEIIAMgCCARfHwhAyAOIAOFQhCKIQ4gCSAOfCEJIAggCYVCP4ohCCAEIAUgIHx8IQQgDyAEhUIgiiEPIAogD3whCiAFIAqFQhiKIQUgBCAFIBl8fCEEIA8gBIVCEIohDyAKIA98IQogBSAKhUI/iiEFIAEgBSAafHwhASANIAGFQiCKIQ0gCSANfCEJIAUgCYVCGIohBSABIAUgEXx8IQEgDSABhUIQiiENIAkgDXwhCSAFIAmFQj+KIQUgAiAGIBZ8fCECIA4gAoVCIIohDiAKIA58IQogBiAKhUIYiiEGIAIgBiAYfHwhAiAOIAKFQhCKIQ4gCiAOfCEKIAYgCoVCP4ohBiADIAcgE3x8IQMgDyADhUIgiiEPIAsgD3whCyAHIAuFQhiKIQcgAyAHIBV8fCEDIA8gA4VCEIohDyALIA98IQsgByALhUI/iiEHIAQgCCAbfHwhBCAQIASFQiCKIRAgDCAQfCEMIAggDIVCGIohCCAEIAggIHx8IQQgECAEhUIQiiEQIAwgEHwhDCAIIAyFQj+KIQggASAGIB98fCEBIBAgAYVCIIohECALIBB8IQsgBiALhUIYiiEGIAEgBiASfHwhASAQIAGFQhCKIRAgCyAQfCELIAYgC4VCP4ohBiACIAcgHHx8IQIgDSAChUIgiiENIAwgDXwhDCAHIAyFQhiKIQcgAiAHIB18fCECIA0gAoVCEIohDSAMIA18IQwgByAMhUI/iiEHIAMgCCAXfHwhAyAOIAOFQiCKIQ4gCSAOfCEJIAggCYVCGIohCCADIAggGXx8IQMgDiADhUIQiiEOIAkgDnwhCSAIIAmFQj+KIQggBCAFIBR8fCEEIA8gBIVCIIohDyAKIA98IQogBSAKhUIYiiEFIAQgBSAefHwhBCAPIASFQhCKIQ8gCiAPfCEKIAUgCoVCP4ohBSABIAUgE3x8IQEgDSABhUIgiiENIAkgDXwhCSAFIAmFQhiKIQUgASAFIB18fCEBIA0gAYVCEIohDSAJIA18IQkgBSAJhUI/iiEFIAIgBiAXfHwhAiAOIAKFQiCKIQ4gCiAOfCEKIAYgCoVCGIohBiACIAYgG3x8IQIgDiAChUIQiiEOIAogDnwhCiAGIAqFQj+KIQYgAyAHIBF8fCEDIA8gA4VCIIohDyALIA98IQsgByALhUIYiiEHIAMgByAcfHwhAyAPIAOFQhCKIQ8gCyAPfCELIAcgC4VCP4ohByAEIAggGXx8IQQgECAEhUIgiiEQIAwgEHwhDCAIIAyFQhiKIQggBCAIIBR8fCEEIBAgBIVCEIohECAMIBB8IQwgCCAMhUI/iiEIIAEgBiAVfHwhASAQIAGFQiCKIRAgCyAQfCELIAYgC4VCGIohBiABIAYgHnx8IQEgECABhUIQiiEQIAsgEHwhCyAGIAuFQj+KIQYgAiAHIBh8fCECIA0gAoVCIIohDSAMIA18IQwgByAMhUIYiiEHIAIgByAWfHwhAiANIAKFQhCKIQ0gDCANfCEMIAcgDIVCP4ohByADIAggIHx8IQMgDiADhUIgiiEOIAkgDnwhCSAIIAmFQhiKIQggAyAIIB98fCEDIA4gA4VCEIohDiAJIA58IQkgCCAJhUI/iiEIIAQgBSASfHwhBCAPIASFQiCKIQ8gCiAPfCEKIAUgCoVCGIohBSAEIAUgGnx8IQQgDyAEhUIQiiEPIAogD3whCiAFIAqFQj+KIQUgASAFIB18fCEBIA0gAYVCIIohDSAJIA18IQkgBSAJhUIYiiEFIAEgBSAWfHwhASANIAGFQhCKIQ0gCSANfCEJIAUgCYVCP4ohBSACIAYgEnx8IQIgDiAChUIgiiEOIAogDnwhCiAGIAqFQhiKIQYgAiAGICB8fCECIA4gAoVCEIohDiAKIA58IQogBiAKhUI/iiEGIAMgByAffHwhAyAPIAOFQiCKIQ8gCyAPfCELIAcgC4VCGIohByADIAcgHnx8IQMgDyADhUIQiiEPIAsgD3whCyAHIAuFQj+KIQcgBCAIIBV8fCEEIBAgBIVCIIohECAMIBB8IQwgCCAMhUIYiiEIIAQgCCAbfHwhBCAQIASFQhCKIRAgDCAQfCEMIAggDIVCP4ohCCABIAYgEXx8IQEgECABhUIgiiEQIAsgEHwhCyAGIAuFQhiKIQYgASAGIBh8fCEBIBAgAYVCEIohECALIBB8IQsgBiALhUI/iiEGIAIgByAXfHwhAiANIAKFQiCKIQ0gDCANfCEMIAcgDIVCGIohByACIAcgFHx8IQIgDSAChUIQiiENIAwgDXwhDCAHIAyFQj+KIQcgAyAIIBp8fCEDIA4gA4VCIIohDiAJIA58IQkgCCAJhUIYiiEIIAMgCCATfHwhAyAOIAOFQhCKIQ4gCSAOfCEJIAggCYVCP4ohCCAEIAUgGXx8IQQgDyAEhUIgiiEPIAogD3whCiAFIAqFQhiKIQUgBCAFIBx8fCEEIA8gBIVCEIohDyAKIA98IQogBSAKhUI/iiEFIAEgBSAefHwhASANIAGFQiCKIQ0gCSANfCEJIAUgCYVCGIohBSABIAUgHHx8IQEgDSABhUIQiiENIAkgDXwhCSAFIAmFQj+KIQUgAiAGIBh8fCECIA4gAoVCIIohDiAKIA58IQogBiAKhUIYiiEGIAIgBiAffHwhAiAOIAKFQhCKIQ4gCiAOfCEKIAYgCoVCP4ohBiADIAcgHXx8IQMgDyADhUIgiiEPIAsgD3whCyAHIAuFQhiKIQcgAyAHIBJ8fCEDIA8gA4VCEIohDyALIA98IQsgByALhUI/iiEHIAQgCCAUfHwhBCAQIASFQiCKIRAgDCAQfCEMIAggDIVCGIohCCAEIAggGnx8IQQgECAEhUIQiiEQIAwgEHwhDCAIIAyFQj+KIQggASAGIBZ8fCEBIBAgAYVCIIohECALIBB8IQsgBiALhUIYiiEGIAEgBiARfHwhASAQIAGFQhCKIRAgCyAQfCELIAYgC4VCP4ohBiACIAcgIHx8IQIgDSAChUIgiiENIAwgDXwhDCAHIAyFQhiKIQcgAiAHIBV8fCECIA0gAoVCEIohDSAMIA18IQwgByAMhUI/iiEHIAMgCCAZfHwhAyAOIAOFQiCKIQ4gCSAOfCEJIAggCYVCGIohCCADIAggF3x8IQMgDiADhUIQiiEOIAkgDnwhCSAIIAmFQj+KIQggBCAFIBN8fCEEIA8gBIVCIIohDyAKIA98IQogBSAKhUIYiiEFIAQgBSAbfHwhBCAPIASFQhCKIQ8gCiAPfCEKIAUgCoVCP4ohBSABIAUgF3x8IQEgDSABhUIgiiENIAkgDXwhCSAFIAmFQhiKIQUgASAFICB8fCEBIA0gAYVCEIohDSAJIA18IQkgBSAJhUI/iiEFIAIgBiAffHwhAiAOIAKFQiCKIQ4gCiAOfCEKIAYgCoVCGIohBiACIAYgGnx8IQIgDiAChUIQiiEOIAogDnwhCiAGIAqFQj+KIQYgAyAHIBx8fCEDIA8gA4VCIIohDyALIA98IQsgByALhUIYiiEHIAMgByAUfHwhAyAPIAOFQhCKIQ8gCyAPfCELIAcgC4VCP4ohByAEIAggEXx8IQQgECAEhUIgiiEQIAwgEHwhDCAIIAyFQhiKIQggBCAIIBl8fCEEIBAgBIVCEIohECAMIBB8IQwgCCAMhUI/iiEIIAEgBiAdfHwhASAQIAGFQiCKIRAgCyAQfCELIAYgC4VCGIohBiABIAYgE3x8IQEgECABhUIQiiEQIAsgEHwhCyAGIAuFQj+KIQYgAiAHIB58fCECIA0gAoVCIIohDSAMIA18IQwgByAMhUIYiiEHIAIgByAYfHwhAiANIAKFQhCKIQ0gDCANfCEMIAcgDIVCP4ohByADIAggEnx8IQMgDiADhUIgiiEOIAkgDnwhCSAIIAmFQhiKIQggAyAIIBV8fCEDIA4gA4VCEIohDiAJIA58IQkgCCAJhUI/iiEIIAQgBSAbfHwhBCAPIASFQiCKIQ8gCiAPfCEKIAUgCoVCGIohBSAEIAUgFnx8IQQgDyAEhUIQiiEPIAogD3whCiAFIAqFQj+KIQUgASAFIBt8fCEBIA0gAYVCIIohDSAJIA18IQkgBSAJhUIYiiEFIAEgBSATfHwhASANIAGFQhCKIQ0gCSANfCEJIAUgCYVCP4ohBSACIAYgGXx8IQIgDiAChUIgiiEOIAogDnwhCiAGIAqFQhiKIQYgAiAGIBV8fCECIA4gAoVCEIohDiAKIA58IQogBiAKhUI/iiEGIAMgByAYfHwhAyAPIAOFQiCKIQ8gCyAPfCELIAcgC4VCGIohByADIAcgF3x8IQMgDyADhUIQiiEPIAsgD3whCyAHIAuFQj+KIQcgBCAIIBJ8fCEEIBAgBIVCIIohECAMIBB8IQwgCCAMhUIYiiEIIAQgCCAWfHwhBCAQIASFQhCKIRAgDCAQfCEMIAggDIVCP4ohCCABIAYgIHx8IQEgECABhUIgiiEQIAsgEHwhCyAGIAuFQhiKIQYgASAGIBx8fCEBIBAgAYVCEIohECALIBB8IQsgBiALhUI/iiEGIAIgByAafHwhAiANIAKFQiCKIQ0gDCANfCEMIAcgDIVCGIohByACIAcgH3x8IQIgDSAChUIQiiENIAwgDXwhDCAHIAyFQj+KIQcgAyAIIBR8fCEDIA4gA4VCIIohDiAJIA58IQkgCCAJhUIYiiEIIAMgCCAdfHwhAyAOIAOFQhCKIQ4gCSAOfCEJIAggCYVCP4ohCCAEIAUgHnx8IQQgDyAEhUIgiiEPIAogD3whCiAFIAqFQhiKIQUgBCAFIBF8fCEEIA8gBIVCEIohDyAKIA98IQogBSAKhUI/iiEFIAEgBSARfHwhASANIAGFQiCKIQ0gCSANfCEJIAUgCYVCGIohBSABIAUgEnx8IQEgDSABhUIQiiENIAkgDXwhCSAFIAmFQj+KIQUgAiAGIBN8fCECIA4gAoVCIIohDiAKIA58IQogBiAKhUIYiiEGIAIgBiAUfHwhAiAOIAKFQhCKIQ4gCiAOfCEKIAYgCoVCP4ohBiADIAcgFXx8IQMgDyADhUIgiiEPIAsgD3whCyAHIAuFQhiKIQcgAyAHIBZ8fCEDIA8gA4VCEIohDyALIA98IQsgByALhUI/iiEHIAQgCCAXfHwhBCAQIASFQiCKIRAgDCAQfCEMIAggDIVCGIohCCAEIAggGHx8IQQgECAEhUIQiiEQIAwgEHwhDCAIIAyFQj+KIQggASAGIBl8fCEBIBAgAYVCIIohECALIBB8IQsgBiALhUIYiiEGIAEgBiAafHwhASAQIAGFQhCKIRAgCyAQfCELIAYgC4VCP4ohBiACIAcgG3x8IQIgDSAChUIgiiENIAwgDXwhDCAHIAyFQhiKIQcgAiAHIBx8fCECIA0gAoVCEIohDSAMIA18IQwgByAMhUI/iiEHIAMgCCAdfHwhAyAOIAOFQiCKIQ4gCSAOfCEJIAggCYVCGIohCCADIAggHnx8IQMgDiADhUIQiiEOIAkgDnwhCSAIIAmFQj+KIQggBCAFIB98fCEEIA8gBIVCIIohDyAKIA98IQogBSAKhUIYiiEFIAQgBSAgfHwhBCAPIASFQhCKIQ8gCiAPfCEKIAUgCoVCP4ohBSABIAUgH3x8IQEgDSABhUIgiiENIAkgDXwhCSAFIAmFQhiKIQUgASAFIBt8fCEBIA0gAYVCEIohDSAJIA18IQkgBSAJhUI/iiEFIAIgBiAVfHwhAiAOIAKFQiCKIQ4gCiAOfCEKIAYgCoVCGIohBiACIAYgGXx8IQIgDiAChUIQiiEOIAogDnwhCiAGIAqFQj+KIQYgAyAHIBp8fCEDIA8gA4VCIIohDyALIA98IQsgByALhUIYiiEHIAMgByAgfHwhAyAPIAOFQhCKIQ8gCyAPfCELIAcgC4VCP4ohByAEIAggHnx8IQQgECAEhUIgiiEQIAwgEHwhDCAIIAyFQhiKIQggBCAIIBd8fCEEIBAgBIVCEIohECAMIBB8IQwgCCAMhUI/iiEIIAEgBiASfHwhASAQIAGFQiCKIRAgCyAQfCELIAYgC4VCGIohBiABIAYgHXx8IQEgECABhUIQiiEQIAsgEHwhCyAGIAuFQj+KIQYgAiAHIBF8fCECIA0gAoVCIIohDSAMIA18IQwgByAMhUIYiiEHIAIgByATfHwhAiANIAKFQhCKIQ0gDCANfCEMIAcgDIVCP4ohByADIAggHHx8IQMgDiADhUIgiiEOIAkgDnwhCSAIIAmFQhiKIQggAyAIIBh8fCEDIA4gA4VCEIohDiAJIA58IQkgCCAJhUI/iiEIIAQgBSAWfHwhBCAPIASFQiCKIQ8gCiAPfCEKIAUgCoVCGIohBSAEIAUgFHx8IQQgDyAEhUIQiiEPIAogD3whCiAFIAqFQj+KIQUgISAhKQMAIAEgCYWFNwMAICIgIikDACACIAqFhTcDACAjICMpAwAgAyALhYU3AwAgJCAkKQMAIAQgDIWFNwMAICUgJSkDACAFIA2FhTcDACAmICYpAwAgBiAOhYU3AwAgJyAnKQMAIAcgD4WFNwMAICggKCkDACAIIBCFhTcDAAs=")}},function(){return a||(0,e[Object.keys(e)[0]])((a={exports:{}}).exports,a),a.exports})(),n=WebAssembly.compile(o);t.exports=async t=>(await WebAssembly.instantiate(await n,t)).exports},8694:(t,e,a)=>{var i=a(410),o=a(8662),n=null,l="undefined"!=typeof WebAssembly&&a(5857)().then(t=>{n=t}),r=64,s=[];t.exports=p;var c=t.exports.BYTES_MIN=16,d=t.exports.BYTES_MAX=64;t.exports.BYTES=32;var u=t.exports.KEYBYTES_MIN=16,f=t.exports.KEYBYTES_MAX=64;t.exports.KEYBYTES=32;var h=t.exports.SALTBYTES=16,g=t.exports.PERSONALBYTES=16;function p(t,e,a,o,l){if(!(this instanceof p))return new p(t,e,a,o,l);if(!n)throw Error("WASM not loaded. Wait for Blake2b.ready(cb)");t||(t=32),!0!==l&&(i(t>=c,"digestLength must be at least "+c+", was given "+t),i(t<=d,"digestLength must be at most "+d+", was given "+t),null!=e&&(i(e instanceof Uint8Array,"key must be Uint8Array or Buffer"),i(e.length>=u,"key must be at least "+u+", was given "+e.length),i(e.length<=f,"key must be at least "+f+", was given "+e.length)),null!=a&&(i(a instanceof Uint8Array,"salt must be Uint8Array or Buffer"),i(a.length===h,"salt must be exactly "+h+", was given "+a.length)),null!=o&&(i(o instanceof Uint8Array,"personal must be Uint8Array or Buffer"),i(o.length===g,"personal must be exactly "+g+", was given "+o.length))),s.length||(s.push(r),r+=216),this.digestLength=t,this.finalized=!1,this.pointer=s.pop(),this._memory=new Uint8Array(n.memory.buffer),this._memory.fill(0,0,64),this._memory[0]=this.digestLength,this._memory[1]=e?e.length:0,this._memory[2]=1,this._memory[3]=1,a&&this._memory.set(a,32),o&&this._memory.set(o,48),this.pointer+216>this._memory.length&&this._realloc(this.pointer+216),n.blake2b_init(this.pointer,this.digestLength),e&&(this.update(e),this._memory.fill(0,r,r+e.length),this._memory[this.pointer+200]=128)}function _(){}p.prototype._realloc=function(t){n.memory.grow(Math.max(0,Math.ceil(Math.abs(t-this._memory.length)/65536))),this._memory=new Uint8Array(n.memory.buffer)},p.prototype.update=function(t){return i(!1===this.finalized,"Hash instance finalized"),i(t instanceof Uint8Array,"input must be Uint8Array or Buffer"),r+t.length>this._memory.length&&this._realloc(r+t.length),this._memory.set(t,r),n.blake2b_update(this.pointer,r,r+t.length),this},p.prototype.digest=function(t){if(i(!1===this.finalized,"Hash instance finalized"),this.finalized=!0,s.push(this.pointer),n.blake2b_final(this.pointer),!t||"binary"===t)return this._memory.slice(this.pointer+128,this.pointer+128+this.digestLength);if("string"==typeof t)return o.toString(this._memory,t,this.pointer+128,this.pointer+128+this.digestLength);i(t instanceof Uint8Array&&t.length>=this.digestLength,"input must be Uint8Array or Buffer");for(var e=0;e<this.digestLength;e++)t[e]=this._memory[this.pointer+128+e];return t},p.prototype.final=p.prototype.digest,p.WASM=n,p.SUPPORTED="undefined"!=typeof WebAssembly,p.ready=function(t){return(t||(t=_),l)?l.then(()=>t(),t):t(Error("WebAssembly not supported"))},p.prototype.ready=p.ready,p.prototype.getPartialHash=function(){return this._memory.slice(this.pointer,this.pointer+216)},p.prototype.setPartialHash=function(t){this._memory.set(t,this.pointer)}},8662:t=>{function e(t){return Buffer.isBuffer(t)?t:Buffer.from(t.buffer,t.byteOffset,t.byteLength)}t.exports={isBuffer:function(t){return Buffer.isBuffer(t)||t instanceof Uint8Array},isEncoding:function(t){return Buffer.isEncoding(t)},alloc:function(t,e,a){return Buffer.alloc(t,e,a)},allocUnsafe:function(t){return Buffer.allocUnsafe(t)},allocUnsafeSlow:function(t){return Buffer.allocUnsafeSlow(t)},byteLength:function(t,e){return Buffer.byteLength(t,e)},compare:function(t,e){return Buffer.compare(t,e)},concat:function(t,e){return Buffer.concat(t,e)},copy:function(t,a,i,o,n){return e(t).copy(a,i,o,n)},equals:function(t,a){return e(t).equals(a)},fill:function(t,a,i,o,n){return e(t).fill(a,i,o,n)},from:function(t,e,a){return Buffer.from(t,e,a)},includes:function(t,a,i,o){return e(t).includes(a,i,o)},indexOf:function(t,a,i,o){return e(t).indexOf(a,i,o)},lastIndexOf:function(t,a,i,o){return e(t).lastIndexOf(a,i,o)},swap16:function(t){return e(t).swap16()},swap32:function(t){return e(t).swap32()},swap64:function(t){return e(t).swap64()},toBuffer:e,toString:function(t,a,i,o){return e(t).toString(a,i,o)},write:function(t,a,i,o,n){return e(t).write(a,i,o,n)},readDoubleBE:function(t,a){return e(t).readDoubleBE(a)},readDoubleLE:function(t,a){return e(t).readDoubleLE(a)},readFloatBE:function(t,a){return e(t).readFloatBE(a)},readFloatLE:function(t,a){return e(t).readFloatLE(a)},readInt32BE:function(t,a){return e(t).readInt32BE(a)},readInt32LE:function(t,a){return e(t).readInt32LE(a)},readUInt32BE:function(t,a){return e(t).readUInt32BE(a)},readUInt32LE:function(t,a){return e(t).readUInt32LE(a)},writeDoubleBE:function(t,a,i){return e(t).writeDoubleBE(a,i)},writeDoubleLE:function(t,a,i){return e(t).writeDoubleLE(a,i)},writeFloatBE:function(t,a,i){return e(t).writeFloatBE(a,i)},writeFloatLE:function(t,a,i){return e(t).writeFloatLE(a,i)},writeInt32BE:function(t,a,i){return e(t).writeInt32BE(a,i)},writeInt32LE:function(t,a,i){return e(t).writeInt32LE(a,i)},writeUInt32BE:function(t,a,i){return e(t).writeUInt32BE(a,i)},writeUInt32LE:function(t,a,i){return e(t).writeUInt32LE(a,i)}}},4752:(t,e,a)=>{"use strict";var i=a(2048),o=a(5315),n=a(6545),l=!1,r=a(3316).i8,s="locals",c=["delimiter","scope","context","debug","compileDebug","client","_with","rmWhitespace","strict","filename","async"],d=c.concat("cache"),u=/^\uFEFF/,f=/^[a-zA-Z_$][0-9a-zA-Z_$]*$/;function h(t,a){var o;if(a.some(function(a){return o=e.resolveInclude(t,a,!0),i.existsSync(o)}))return o}function g(t,a){var i,o=t.filename,n=arguments.length>1;if(t.cache){if(!o)throw Error("cache option requires a filename");if(i=e.cache.get(o))return i;n||(a=p(o).toString().replace(u,""))}else if(!n){if(!o)throw Error("Internal EJS error: no file name or template provided");a=p(o).toString().replace(u,"")}return i=e.compile(a,t),t.cache&&e.cache.set(o,i),i}function p(t){return e.fileLoader(t)}function _(t,e,a,i,o){var n=e.split("\n"),l=Math.max(i-3,0),r=Math.min(n.length,i+3),s=o(a),c=n.slice(l,r).map(function(t,e){var a=e+l+1;return(a==i?" >> ":"    ")+a+"| "+t}).join("\n");throw t.path=s,t.message=(s||"ejs")+":"+i+"\n"+c+"\n\n"+t.message,t}function m(t){return t.replace(/;(\s*$)/,"$1")}function b(t,a){var i=n.hasOwnOnlyObject(a),o=n.createNullProtoObjWherePossible();this.templateText=t,this.mode=null,this.truncate=!1,this.currentLine=1,this.source="",o.client=i.client||!1,o.escapeFunction=i.escape||i.escapeFunction||n.escapeXML,o.compileDebug=!1!==i.compileDebug,o.debug=!!i.debug,o.filename=i.filename,o.openDelimiter=i.openDelimiter||e.openDelimiter||"<",o.closeDelimiter=i.closeDelimiter||e.closeDelimiter||">",o.delimiter=i.delimiter||e.delimiter||"%",o.strict=i.strict||!1,o.context=i.context,o.cache=i.cache||!1,o.rmWhitespace=i.rmWhitespace,o.root=i.root,o.includer=i.includer,o.outputFunctionName=i.outputFunctionName,o.localsName=i.localsName||e.localsName||s,o.views=i.views,o.async=i.async,o.destructuredLocals=i.destructuredLocals,o.legacyInclude=void 0===i.legacyInclude||!!i.legacyInclude,o.strict?o._with=!1:o._with=void 0===i._with||i._with,this.opts=o,this.regex=this.createRegex()}e.cache=n.cache,e.fileLoader=i.readFileSync,e.localsName=s,e.promiseImpl=Function("return this;")().Promise,e.resolveInclude=function(t,e,a){var i=o.dirname,n=o.extname,l=(0,o.resolve)(a?e:i(e),t);return n(t)||(l+=".ejs"),l},e.compile=function(t,e){return e&&e.scope&&(l||(console.warn("`scope` option is deprecated and will be removed in EJS 3"),l=!0),e.context||(e.context=e.scope),delete e.scope),new b(t,e).compile()},e.render=function(t,e,a){var i=e||n.createNullProtoObjWherePossible(),o=a||n.createNullProtoObjWherePossible();return 2==arguments.length&&n.shallowCopyFromList(o,i,c),g(o,t)(i)},e.renderFile=function(){var t,a,i,o=Array.prototype.slice.call(arguments),l=o.shift(),r={filename:l};return"function"==typeof arguments[arguments.length-1]&&(t=o.pop()),o.length?(a=o.shift(),o.length?n.shallowCopy(r,o.pop()):(a.settings&&(a.settings.views&&(r.views=a.settings.views),a.settings["view cache"]&&(r.cache=!0),(i=a.settings["view options"])&&n.shallowCopy(r,i)),n.shallowCopyFromList(r,a,d)),r.filename=l):a=n.createNullProtoObjWherePossible(),function(t,a,i){var o;if(i){try{o=g(t)(a)}catch(t){return i(t)}i(null,o)}else{if("function"==typeof e.promiseImpl)return new e.promiseImpl(function(e,i){try{o=g(t)(a),e(o)}catch(t){i(t)}});throw Error("Please provide a callback function")}}(r,a,t)},e.Template=b,e.clearCache=function(){e.cache.reset()},b.modes={EVAL:"eval",ESCAPED:"escaped",RAW:"raw",COMMENT:"comment",LITERAL:"literal"},b.prototype={createRegex:function(){var t="(<%%|%%>|<%=|<%-|<%_|<%#|<%|%>|-%>|_%>)",e=n.escapeRegExpChars(this.opts.delimiter),a=n.escapeRegExpChars(this.opts.openDelimiter),i=n.escapeRegExpChars(this.opts.closeDelimiter);return new RegExp(t=t.replace(/%/g,e).replace(/</g,a).replace(/>/g,i))},compile:function(){var t,a,l,r=this.opts,s="",c="",d=r.escapeFunction,u=r.filename?JSON.stringify(r.filename):"undefined";if(!this.source){if(this.generateSource(),s+='  var __output = "";\n  function __append(s) { if (s !== undefined && s !== null) __output += s }\n',r.outputFunctionName){if(!f.test(r.outputFunctionName))throw Error("outputFunctionName is not a valid JS identifier.");s+="  var "+r.outputFunctionName+" = __append;\n"}if(r.localsName&&!f.test(r.localsName))throw Error("localsName is not a valid JS identifier.");if(r.destructuredLocals&&r.destructuredLocals.length){for(var p="  var __locals = ("+r.localsName+" || {}),\n",m=0;m<r.destructuredLocals.length;m++){var b=r.destructuredLocals[m];if(!f.test(b))throw Error("destructuredLocals["+m+"] is not a valid JS identifier.");m>0&&(p+=",\n  "),p+=b+" = __locals."+b}s+=p+";\n"}!1!==r._with&&(s+="  with ("+r.localsName+" || {}) {\n",c+="  }\n"),c+="  return __output;\n",this.source=s+this.source+c}t=r.compileDebug?"var __line = 1\n  , __lines = "+JSON.stringify(this.templateText)+"\n  , __filename = "+u+";\ntry {\n"+this.source+"} catch (e) {\n  rethrow(e, __lines, __filename, __line, escapeFn);\n}\n":this.source,r.client&&(t="escapeFn = escapeFn || "+d.toString()+";\n"+t,r.compileDebug&&(t="rethrow = rethrow || "+_.toString()+";\n"+t)),r.strict&&(t='"use strict";\n'+t),r.debug&&console.log(t),r.compileDebug&&r.filename&&(t=t+"\n//# sourceURL="+u+"\n");try{if(r.async)try{l=Function("return (async function(){}).constructor;")()}catch(t){if(t instanceof SyntaxError)throw Error("This environment does not support async/await");throw t}else l=Function;a=new l(r.localsName+", escapeFn, include, rethrow",t)}catch(t){throw t instanceof SyntaxError&&(r.filename&&(t.message+=" in "+r.filename),t.message+=" while compiling ejs\n\n",t.message+="If the above error is not helpful, you may want to try EJS-Lint:\n",t.message+="https://github.com/RyanZim/EJS-Lint",r.async||(t.message+="\n",t.message+="Or, if you meant to create an async function, pass `async: true` as an option.")),t}var L=r.client?a:function(t){return a.apply(r.context,[t||n.createNullProtoObjWherePossible(),d,function(a,o){var l=n.shallowCopy(n.createNullProtoObjWherePossible(),t);return o&&(l=n.shallowCopy(l,o)),(function(t,a){var o=n.shallowCopy(n.createNullProtoObjWherePossible(),a);if(o.filename=function(t,a){var o,n,l=a.views,r=/^[A-Za-z]+:\\|^\//.exec(t);if(r&&r.length)t=t.replace(/^\/*/,""),o=Array.isArray(a.root)?h(t,a.root):e.resolveInclude(t,a.root||"/",!0);else if(a.filename&&(n=e.resolveInclude(t,a.filename),i.existsSync(n)&&(o=n)),!o&&Array.isArray(l)&&(o=h(t,l)),!o&&"function"!=typeof a.includer)throw Error('Could not find the include file "'+a.escapeFunction(t)+'"');return o}(t,o),"function"==typeof a.includer){var l=a.includer(t,o.filename);if(l&&(l.filename&&(o.filename=l.filename),l.template))return g(o,l.template)}return g(o)})(a,r)(l)},_])};if(r.filename&&"function"==typeof Object.defineProperty){var w=r.filename,y=o.basename(w,o.extname(w));try{Object.defineProperty(L,"name",{value:y,writable:!1,enumerable:!1,configurable:!0})}catch(t){}}return L},generateSource:function(){this.opts.rmWhitespace&&(this.templateText=this.templateText.replace(/[\r\n]+/g,"\n").replace(/^\s+|\s+$/gm,"")),this.templateText=this.templateText.replace(/[ \t]*<%_/gm,"<%_").replace(/_%>[ \t]*/gm,"_%>");var t=this,e=this.parseTemplateText(),a=this.opts.delimiter,i=this.opts.openDelimiter,o=this.opts.closeDelimiter;e&&e.length&&e.forEach(function(n,l){var r;if(0===n.indexOf(i+a)&&0!==n.indexOf(i+a+a)&&!((r=e[l+2])==a+o||r=="-"+a+o||r=="_"+a+o))throw Error('Could not find matching close tag for "'+n+'".');t.scanLine(n)})},parseTemplateText:function(){for(var t,e=this.templateText,a=this.regex,i=a.exec(e),o=[];i;)0!==(t=i.index)&&(o.push(e.substring(0,t)),e=e.slice(t)),o.push(i[0]),e=e.slice(i[0].length),i=a.exec(e);return e&&o.push(e),o},_addOutput:function(t){if(this.truncate&&(t=t.replace(/^(?:\r\n|\r|\n)/,""),this.truncate=!1),!t)return t;t=(t=(t=(t=t.replace(/\\/g,"\\\\")).replace(/\n/g,"\\n")).replace(/\r/g,"\\r")).replace(/"/g,'\\"'),this.source+='    ; __append("'+t+'")\n'},scanLine:function(t){var e=this.opts.delimiter,a=this.opts.openDelimiter,i=this.opts.closeDelimiter,o=0;switch(o=t.split("\n").length-1,t){case a+e:case a+e+"_":this.mode=b.modes.EVAL;break;case a+e+"=":this.mode=b.modes.ESCAPED;break;case a+e+"-":this.mode=b.modes.RAW;break;case a+e+"#":this.mode=b.modes.COMMENT;break;case a+e+e:this.mode=b.modes.LITERAL,this.source+='    ; __append("'+t.replace(a+e+e,a+e)+'")\n';break;case e+e+i:this.mode=b.modes.LITERAL,this.source+='    ; __append("'+t.replace(e+e+i,e+i)+'")\n';break;case e+i:case"-"+e+i:case"_"+e+i:this.mode==b.modes.LITERAL&&this._addOutput(t),this.mode=null,this.truncate=0===t.indexOf("-")||0===t.indexOf("_");break;default:if(this.mode){switch(this.mode){case b.modes.EVAL:case b.modes.ESCAPED:case b.modes.RAW:t.lastIndexOf("//")>t.lastIndexOf("\n")&&(t+="\n")}switch(this.mode){case b.modes.EVAL:this.source+="    ; "+t+"\n";break;case b.modes.ESCAPED:this.source+="    ; __append(escapeFn("+m(t)+"))\n";break;case b.modes.RAW:this.source+="    ; __append("+m(t)+")\n";break;case b.modes.COMMENT:break;case b.modes.LITERAL:this._addOutput(t)}}else this._addOutput(t)}this.opts.compileDebug&&o&&(this.currentLine+=o,this.source+="    ; __line = "+this.currentLine+"\n")}},e.escapeXML=n.escapeXML,e.__express=e.renderFile,e.VERSION=r,e.name="ejs","undefined"!=typeof window&&(window.ejs=e)},6545:(t,e)=>{"use strict";var a=/[|\\{}()[\]^$+*?.]/g,i=Object.prototype.hasOwnProperty,o=function(t,e){return i.apply(t,[e])};e.escapeRegExpChars=function(t){return t?String(t).replace(a,"\\$&"):""};var n={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&#34;","'":"&#39;"},l=/[&<>'"]/g;function r(t){return n[t]||t}function s(){return Function.prototype.toString.call(this)+';\nvar _ENCODE_HTML_RULES = {\n      "&": "&amp;"\n    , "<": "&lt;"\n    , ">": "&gt;"\n    , \'"\': "&#34;"\n    , "\'": "&#39;"\n    }\n  , _MATCH_HTML = /[&<>\'"]/g;\nfunction encode_char(c) {\n  return _ENCODE_HTML_RULES[c] || c;\n};\n'}e.escapeXML=function(t){return void 0==t?"":String(t).replace(l,r)};try{"function"==typeof Object.defineProperty?Object.defineProperty(e.escapeXML,"toString",{value:s}):e.escapeXML.toString=s}catch(t){console.warn("Unable to set escapeXML.toString (is the Function prototype frozen?)")}e.shallowCopy=function(t,e){if(e=e||{},null!=t)for(var a in e)o(e,a)&&"__proto__"!==a&&"constructor"!==a&&(t[a]=e[a]);return t},e.shallowCopyFromList=function(t,e,a){if(a=a||[],e=e||{},null!=t)for(var i=0;i<a.length;i++){var n=a[i];if(void 0!==e[n]){if(!o(e,n)||"__proto__"===n||"constructor"===n)continue;t[n]=e[n]}}return t},e.cache={_data:{},set:function(t,e){this._data[t]=e},get:function(t){return this._data[t]},remove:function(t){delete this._data[t]},reset:function(){this._data={}}},e.hyphenToCamel=function(t){return t.replace(/-[a-z]/g,function(t){return t[1].toUpperCase()})},e.createNullProtoObjWherePossible="function"==typeof Object.create?function(){return Object.create(null)}:function(){return{}},e.hasOwnOnlyObject=function(t){var a=e.createNullProtoObjWherePossible();for(var i in t)o(t,i)&&(a[i]=t[i]);return a}},2648:(t,e,a)=>{var i;!function(){"use strict";var o="input is invalid type",n="object"==typeof window,l=n?window:{};l.JS_SHA3_NO_WINDOW&&(n=!1);var r=!n&&"object"==typeof self;!l.JS_SHA3_NO_NODE_JS&&"object"==typeof process&&process.versions&&process.versions.node?l=global:r&&(l=self);var s=!l.JS_SHA3_NO_COMMON_JS&&t.exports,c=a.amdO,d=!l.JS_SHA3_NO_ARRAY_BUFFER&&"undefined"!=typeof ArrayBuffer,u="0123456789abcdef".split(""),f=[4,1024,262144,67108864],h=[0,8,16,24],g=[1,0,32898,0,32906,2147483648,2147516416,2147483648,32907,0,2147483649,0,2147516545,2147483648,32777,2147483648,138,0,136,0,2147516425,0,2147483658,0,2147516555,0,139,2147483648,32905,2147483648,32771,2147483648,32770,2147483648,128,2147483648,32778,0,2147483658,2147483648,2147516545,2147483648,32896,2147483648,2147483649,0,2147516424,2147483648],p=[224,256,384,512],_=[128,256],m=["hex","buffer","arrayBuffer","array","digest"],b={128:168,256:136};(l.JS_SHA3_NO_NODE_JS||!Array.isArray)&&(Array.isArray=function(t){return"[object Array]"===Object.prototype.toString.call(t)}),d&&(l.JS_SHA3_NO_ARRAY_BUFFER_IS_VIEW||!ArrayBuffer.isView)&&(ArrayBuffer.isView=function(t){return"object"==typeof t&&t.buffer&&t.buffer.constructor===ArrayBuffer});for(var L=function(t,e,a){return function(i){return new T(t,e,t).update(i)[a]()}},w=function(t,e,a){return function(i,o){return new T(t,e,o).update(i)[a]()}},y=function(t,e,a){return function(e,i,o,n){return x["cshake"+t].update(e,i,o,n)[a]()}},A=function(t,e,a){return function(e,i,o,n){return x["kmac"+t].update(e,i,o,n)[a]()}},C=function(t,e,a,i){for(var o=0;o<m.length;++o){var n=m[o];t[n]=e(a,i,n)}return t},I=function(t,e){var a=L(t,e,"hex");return a.create=function(){return new T(t,e,t)},a.update=function(t){return a.create().update(t)},C(a,L,t,e)},F=[{name:"keccak",padding:[1,256,65536,16777216],bits:p,createMethod:I},{name:"sha3",padding:[6,1536,393216,100663296],bits:p,createMethod:I},{name:"shake",padding:[31,7936,2031616,520093696],bits:_,createMethod:function(t,e){var a=w(t,e,"hex");return a.create=function(a){return new T(t,e,a)},a.update=function(t,e){return a.create(e).update(t)},C(a,w,t,e)}},{name:"cshake",padding:f,bits:_,createMethod:function(t,e){var a=b[t],i=y(t,e,"hex");return i.create=function(i,o,n){return o||n?new T(t,e,i).bytepad([o,n],a):x["shake"+t].create(i)},i.update=function(t,e,a,o){return i.create(e,a,o).update(t)},C(i,y,t,e)}},{name:"kmac",padding:f,bits:_,createMethod:function(t,e){var a=b[t],i=A(t,e,"hex");return i.create=function(i,o,n){return new q(t,e,o).bytepad(["KMAC",n],a).bytepad([i],a)},i.update=function(t,e,a,o){return i.create(t,a,o).update(e)},C(i,A,t,e)}}],x={},E=[],v=0;v<F.length;++v)for(var B=F[v],S=B.bits,O=0;O<S.length;++O){var P=B.name+"_"+S[O];if(E.push(P),x[P]=B.createMethod(S[O],B.padding),"sha3"!==B.name){var G=B.name+S[O];E.push(G),x[G]=x[P]}}function T(t,e,a){this.blocks=[],this.s=[],this.padding=e,this.outputBits=a,this.reset=!0,this.finalized=!1,this.block=0,this.start=0,this.blockCount=1600-(t<<1)>>5,this.byteCount=this.blockCount<<2,this.outputBlocks=a>>5,this.extraBytes=(31&a)>>3;for(var i=0;i<50;++i)this.s[i]=0}function q(t,e,a){T.call(this,t,e,a)}T.prototype.update=function(t){if(this.finalized)throw Error("finalize already called");var e,a=typeof t;if("string"!==a){if("object"===a){if(null===t)throw Error(o);if(d&&t.constructor===ArrayBuffer)t=new Uint8Array(t);else if(!Array.isArray(t)&&(!d||!ArrayBuffer.isView(t)))throw Error(o)}else throw Error(o);e=!0}for(var i,n,l=this.blocks,r=this.byteCount,s=t.length,c=this.blockCount,u=0,f=this.s;u<s;){if(this.reset)for(i=1,this.reset=!1,l[0]=this.block;i<c+1;++i)l[i]=0;if(e)for(i=this.start;u<s&&i<r;++u)l[i>>2]|=t[u]<<h[3&i++];else for(i=this.start;u<s&&i<r;++u)(n=t.charCodeAt(u))<128?l[i>>2]|=n<<h[3&i++]:(n<2048?l[i>>2]|=(192|n>>6)<<h[3&i++]:(n<55296||n>=57344?l[i>>2]|=(224|n>>12)<<h[3&i++]:(n=65536+((1023&n)<<10|1023&t.charCodeAt(++u)),l[i>>2]|=(240|n>>18)<<h[3&i++],l[i>>2]|=(128|n>>12&63)<<h[3&i++]),l[i>>2]|=(128|n>>6&63)<<h[3&i++]),l[i>>2]|=(128|63&n)<<h[3&i++]);if(this.lastByteIndex=i,i>=r){for(this.start=i-r,this.block=l[c],i=0;i<c;++i)f[i]^=l[i];z(f),this.reset=!0}else this.start=i}return this},T.prototype.encode=function(t,e){var a=255&t,i=1,o=[a];for(t>>=8,a=255&t;a>0;)o.unshift(a),t>>=8,a=255&t,++i;return e?o.push(i):o.unshift(i),this.update(o),o.length},T.prototype.encodeString=function(t){var e,a=typeof t;if("string"!==a){if("object"===a){if(null===t)throw Error(o);if(d&&t.constructor===ArrayBuffer)t=new Uint8Array(t);else if(!Array.isArray(t)&&(!d||!ArrayBuffer.isView(t)))throw Error(o)}else throw Error(o);e=!0}var i=0,n=t.length;if(e)i=n;else for(var l=0;l<t.length;++l){var r=t.charCodeAt(l);r<128?i+=1:r<2048?i+=2:r<55296||r>=57344?i+=3:(r=65536+((1023&r)<<10|1023&t.charCodeAt(++l)),i+=4)}return i+=this.encode(8*i),this.update(t),i},T.prototype.bytepad=function(t,e){for(var a=this.encode(e),i=0;i<t.length;++i)a+=this.encodeString(t[i]);var o=e-a%e,n=[];return n.length=o,this.update(n),this},T.prototype.finalize=function(){if(!this.finalized){this.finalized=!0;var t=this.blocks,e=this.lastByteIndex,a=this.blockCount,i=this.s;if(t[e>>2]|=this.padding[3&e],this.lastByteIndex===this.byteCount)for(e=1,t[0]=t[a];e<a+1;++e)t[e]=0;for(t[a-1]|=2147483648,e=0;e<a;++e)i[e]^=t[e];z(i)}},T.prototype.toString=T.prototype.hex=function(){this.finalize();for(var t,e=this.blockCount,a=this.s,i=this.outputBlocks,o=this.extraBytes,n=0,l=0,r="";l<i;){for(n=0;n<e&&l<i;++n,++l)r+=u[(t=a[n])>>4&15]+u[15&t]+u[t>>12&15]+u[t>>8&15]+u[t>>20&15]+u[t>>16&15]+u[t>>28&15]+u[t>>24&15];l%e==0&&(z(a),n=0)}return o&&(r+=u[(t=a[n])>>4&15]+u[15&t],o>1&&(r+=u[t>>12&15]+u[t>>8&15]),o>2&&(r+=u[t>>20&15]+u[t>>16&15])),r},T.prototype.arrayBuffer=function(){this.finalize();for(var t,e=this.blockCount,a=this.s,i=this.outputBlocks,o=this.extraBytes,n=0,l=0,r=this.outputBits>>3,s=new Uint32Array(t=new ArrayBuffer(o?i+1<<2:r));l<i;){for(n=0;n<e&&l<i;++n,++l)s[l]=a[n];l%e==0&&z(a)}return o&&(s[n]=a[n],t=t.slice(0,r)),t},T.prototype.buffer=T.prototype.arrayBuffer,T.prototype.digest=T.prototype.array=function(){this.finalize();for(var t,e,a=this.blockCount,i=this.s,o=this.outputBlocks,n=this.extraBytes,l=0,r=0,s=[];r<o;){for(l=0;l<a&&r<o;++l,++r)t=r<<2,e=i[l],s[t]=255&e,s[t+1]=e>>8&255,s[t+2]=e>>16&255,s[t+3]=e>>24&255;r%a==0&&z(i)}return n&&(t=r<<2,e=i[l],s[t]=255&e,n>1&&(s[t+1]=e>>8&255),n>2&&(s[t+2]=e>>16&255)),s},q.prototype=new T,q.prototype.finalize=function(){return this.encode(this.outputBits,!0),T.prototype.finalize.call(this)};var z=function(t){var e,a,i,o,n,l,r,s,c,d,u,f,h,p,_,m,b,L,w,y,A,C,I,F,x,E,v,B,S,O,P,G,T,q,z,U,M,Q,k,R,N,D,$,j,V,K,H,Z,W,Y,J,X,tt,te,ta,ti,to,tn,tl,tr,ts,tc,td;for(i=0;i<48;i+=2)o=t[0]^t[10]^t[20]^t[30]^t[40],n=t[1]^t[11]^t[21]^t[31]^t[41],l=t[2]^t[12]^t[22]^t[32]^t[42],r=t[3]^t[13]^t[23]^t[33]^t[43],s=t[4]^t[14]^t[24]^t[34]^t[44],c=t[5]^t[15]^t[25]^t[35]^t[45],d=t[6]^t[16]^t[26]^t[36]^t[46],u=t[7]^t[17]^t[27]^t[37]^t[47],f=t[8]^t[18]^t[28]^t[38]^t[48],h=t[9]^t[19]^t[29]^t[39]^t[49],e=f^(l<<1|r>>>31),a=h^(r<<1|l>>>31),t[0]^=e,t[1]^=a,t[10]^=e,t[11]^=a,t[20]^=e,t[21]^=a,t[30]^=e,t[31]^=a,t[40]^=e,t[41]^=a,e=o^(s<<1|c>>>31),a=n^(c<<1|s>>>31),t[2]^=e,t[3]^=a,t[12]^=e,t[13]^=a,t[22]^=e,t[23]^=a,t[32]^=e,t[33]^=a,t[42]^=e,t[43]^=a,e=l^(d<<1|u>>>31),a=r^(u<<1|d>>>31),t[4]^=e,t[5]^=a,t[14]^=e,t[15]^=a,t[24]^=e,t[25]^=a,t[34]^=e,t[35]^=a,t[44]^=e,t[45]^=a,e=s^(f<<1|h>>>31),a=c^(h<<1|f>>>31),t[6]^=e,t[7]^=a,t[16]^=e,t[17]^=a,t[26]^=e,t[27]^=a,t[36]^=e,t[37]^=a,t[46]^=e,t[47]^=a,e=d^(o<<1|n>>>31),a=u^(n<<1|o>>>31),t[8]^=e,t[9]^=a,t[18]^=e,t[19]^=a,t[28]^=e,t[29]^=a,t[38]^=e,t[39]^=a,t[48]^=e,t[49]^=a,p=t[0],_=t[1],K=t[11]<<4|t[10]>>>28,H=t[10]<<4|t[11]>>>28,B=t[20]<<3|t[21]>>>29,S=t[21]<<3|t[20]>>>29,tr=t[31]<<9|t[30]>>>23,ts=t[30]<<9|t[31]>>>23,D=t[40]<<18|t[41]>>>14,$=t[41]<<18|t[40]>>>14,q=t[2]<<1|t[3]>>>31,z=t[3]<<1|t[2]>>>31,m=t[13]<<12|t[12]>>>20,b=t[12]<<12|t[13]>>>20,Z=t[22]<<10|t[23]>>>22,W=t[23]<<10|t[22]>>>22,O=t[33]<<13|t[32]>>>19,P=t[32]<<13|t[33]>>>19,tc=t[42]<<2|t[43]>>>30,td=t[43]<<2|t[42]>>>30,te=t[5]<<30|t[4]>>>2,ta=t[4]<<30|t[5]>>>2,U=t[14]<<6|t[15]>>>26,M=t[15]<<6|t[14]>>>26,L=t[25]<<11|t[24]>>>21,w=t[24]<<11|t[25]>>>21,Y=t[34]<<15|t[35]>>>17,J=t[35]<<15|t[34]>>>17,G=t[45]<<29|t[44]>>>3,T=t[44]<<29|t[45]>>>3,F=t[6]<<28|t[7]>>>4,x=t[7]<<28|t[6]>>>4,ti=t[17]<<23|t[16]>>>9,to=t[16]<<23|t[17]>>>9,Q=t[26]<<25|t[27]>>>7,k=t[27]<<25|t[26]>>>7,y=t[36]<<21|t[37]>>>11,A=t[37]<<21|t[36]>>>11,X=t[47]<<24|t[46]>>>8,tt=t[46]<<24|t[47]>>>8,j=t[8]<<27|t[9]>>>5,V=t[9]<<27|t[8]>>>5,E=t[18]<<20|t[19]>>>12,v=t[19]<<20|t[18]>>>12,tn=t[29]<<7|t[28]>>>25,tl=t[28]<<7|t[29]>>>25,R=t[38]<<8|t[39]>>>24,N=t[39]<<8|t[38]>>>24,C=t[48]<<14|t[49]>>>18,I=t[49]<<14|t[48]>>>18,t[0]=p^~m&L,t[1]=_^~b&w,t[10]=F^~E&B,t[11]=x^~v&S,t[20]=q^~U&Q,t[21]=z^~M&k,t[30]=j^~K&Z,t[31]=V^~H&W,t[40]=te^~ti&tn,t[41]=ta^~to&tl,t[2]=m^~L&y,t[3]=b^~w&A,t[12]=E^~B&O,t[13]=v^~S&P,t[22]=U^~Q&R,t[23]=M^~k&N,t[32]=K^~Z&Y,t[33]=H^~W&J,t[42]=ti^~tn&tr,t[43]=to^~tl&ts,t[4]=L^~y&C,t[5]=w^~A&I,t[14]=B^~O&G,t[15]=S^~P&T,t[24]=Q^~R&D,t[25]=k^~N&$,t[34]=Z^~Y&X,t[35]=W^~J&tt,t[44]=tn^~tr&tc,t[45]=tl^~ts&td,t[6]=y^~C&p,t[7]=A^~I&_,t[16]=O^~G&F,t[17]=P^~T&x,t[26]=R^~D&q,t[27]=N^~$&z,t[36]=Y^~X&j,t[37]=J^~tt&V,t[46]=tr^~tc&te,t[47]=ts^~td&ta,t[8]=C^~p&m,t[9]=I^~_&b,t[18]=G^~F&E,t[19]=T^~x&v,t[28]=D^~q&U,t[29]=$^~z&M,t[38]=X^~j&K,t[39]=tt^~V&H,t[48]=tc^~te&ti,t[49]=td^~ta&to,t[0]^=g[i],t[1]^=g[i+1]};if(s)t.exports=x;else{for(v=0;v<E.length;++v)l[E[v]]=x[E[v]];c&&void 0!==(i=(function(){return x}).call(e,a,e,t))&&(t.exports=i)}}()},410:t=>{t.exports=function t(a,i){if(!a){var o=new e(i);throw Error.captureStackTrace&&Error.captureStackTrace(o,t),o}};class e extends Error{}e.prototype.name="AssertionError"},2434:(t,e,a)=>{t.exports.buildBn128=a(540),t.exports.buildBls12381=a(7337),a(6246)},3667:t=>{function e(t,e){return t===e?0:t>e?1:-1}function a(t){return t%2n!==0n}function i(t){return t%2n===0n}function o(t){return t<0n?t.toString(2).length-1:t.toString(2).length}function n(t){return t<0n?-t:t}function l(t){return 1n===n(t)}function r(t,a){for(var i,o,r,s=0n,c=1n,d=a,u=n(t);0n!==u;)i=d/u,o=s,r=d,s=c,d=u,c=o-i*c,u=r-i*u;if(!l(d))throw Error(t.toString()+" and "+a.toString()+" are not co-prime");return(-1===e(s,0n)&&(s+=a),t<0n)?-s:s}function s(t,e,i){if(0n===i)throw Error("Cannot take modPow with modulus 0");var o,n=1n,l=t%i;for(e<0n&&(e=-(1n*e),l=r(l,i));e>0n;){if(0n===l)return 0n;a(e)&&(n=n*l%i),e/=2n,l=(o=l)*o%i}return n}function c(t,e){var a,o;return 0n!==e&&(!!l(e)||(0==(o=2n,(a=(a=e)>=0n?a:-a)===(o=o>=0n?o:-o)?0:a>o?1:-1)?i(t):t%e===0n))}function d(t,e){for(var a,o,n,r,c=t-1n,d=c,u=0;i(d);)d/=2n,u++;t:for(n=0;n<e.length;n++)if(!(t<e[n])&&!l(r=s(BigInt(e[n]),d,t))&&r!==c){for(o=u-1;0!=o&&!l(r=(a=r)*a%t);o--)if(r===c)continue t;return!1}return!0}t.exports.bitLength=o,t.exports.isOdd=a,t.exports.isNegative=function(t){return t<0n},t.exports.abs=n,t.exports.isUnit=l,t.exports.compare=e,t.exports.modInv=r,t.exports.modPow=s,t.exports.isPrime=function(t){var e,a=!l(e=n(t))&&(2n===e||3n===e||5n===e||!(i(e)||c(e,3n)||c(e,5n))&&(e<49n||void 0));if(void 0!==a)return a;var r=n(t),s=o(r);if(s<=64)return d(r,[2,3,5,7,11,13,17,19,23,29,31,37]);for(var u=Math.ceil(Math.log(2)*Number(s)),f=[],h=0;h<u;h++)f.push(BigInt(h+2));return d(r,f)},t.exports.square=function(t){return t*t}},7337:(t,e,a)=>{let i=a(1209),o=a(6246),n=a(6466),l=a(1599),r=a(4033),s=a(7644),c=a(3920),d=a(6989),u=a(7119),f=a(2929),{bitLength:h,isOdd:g,isNegative:p}=a(3667);t.exports=function(t,e){let a=e||"bls12381";if(t.modules[a])return a;let _=Math.floor((h(0x1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffaaabn-1n)-1)/64)+1,m=8*_,b=2*m,L=12*m,w=Math.floor((h(0x73eda753299d7d483339d80809a1d80553bda402fffe5bfeffffffff00000001n-1n)-1)/64)+1,y=8*w,A=t.alloc(i.bigInt2BytesLE(0x73eda753299d7d483339d80809a1d80553bda402fffe5bfeffffffff00000001n,y)),C=o(t,0x1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffaaabn,"f1m","intq");n(t,0x73eda753299d7d483339d80809a1d80553bda402fffe5bfeffffffff00000001n,"fr","frm","intr");let I=t.alloc(i.bigInt2BytesLE(S(4n),m)),F=s(t,"g1m","f1m",I);c(t,"frm","frm","frm","frm_mul"),d(t,"pol","frm"),u(t,"qap","frm");let x=l(t,"f1m_neg","f2m","f1m"),E=t.alloc([...i.bigInt2BytesLE(S(4n),m),...i.bigInt2BytesLE(S(4n),m)]),v=s(t,"g2m","f2m",E);function B(e,a){let i=t.addFunction(e);i.addParam("pG","i32"),i.addParam("pFr","i32"),i.addParam("pr","i32");let o=i.getCodeBuilder(),n=o.i32_const(t.alloc(y));i.addCode(o.call("frm_fromMontgomery",o.getLocal("pFr"),n),o.call(a,o.getLocal("pG"),n,o.i32_const(y),o.getLocal("pr"))),t.exportFunction(e)}function S(t){return BigInt(t)*(1n<<BigInt(8*m))%0x1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffaaabn}B("g1m_timesFr","g1m_timesScalar"),c(t,"g1m","g1m","frm","g1m_timesFr"),B("g2m_timesFr","g2m_timesScalar"),c(t,"g2m","g2m","frm","g2m_timesFr"),B("g1m_timesFrAffine","g1m_timesScalarAffine"),B("g2m_timesFrAffine","g2m_timesScalarAffine"),f(t,"frm_batchApplyKey","fmr","frm",y,y,y,"frm_mul"),f(t,"g1m_batchApplyKey","g1m","frm",3*m,3*m,y,"g1m_timesFr"),f(t,"g1m_batchApplyKeyMixed","g1m","frm",2*m,3*m,y,"g1m_timesFrAffine"),f(t,"g2m_batchApplyKey","g2m","frm",6*m,6*m,y,"g2m_timesFr"),f(t,"g2m_batchApplyKeyMixed","g2m","frm",4*m,6*m,y,"g2m_timesFrAffine");let O=t.alloc([...i.bigInt2BytesLE(S(0x17f1d3a73197d7942695638c4fa9ac0fc3688c4f9774b905a14e3a3f171bac586c55e83ff97a1aeffb3af00adb22c6bbn),m),...i.bigInt2BytesLE(S(0x8b3f481e3aaa0f1a09e30ed741d8ae4fcf5e095d5d00af600db18cb2c04b3edd03cc744a2888ae40caa232946c5e7e1n),m),...i.bigInt2BytesLE(S(1n),m)]),P=t.alloc([...i.bigInt2BytesLE(S(0n),m),...i.bigInt2BytesLE(S(1n),m),...i.bigInt2BytesLE(S(0n),m)]),G=[[0x24aa2b2f08f0a91260805272dc51051c6e47ad4fa403b02b4510b647ae3d1770bac0326a805bbefd48056c8c121bdb8n,0x13e02b6052719f607dacd3a088274f65596bd0d09920b61ab5da61bbdc7f5049334cf11213945d57e5ac7d055d042b7en],[0xce5d527727d6e118cc9cdc6da2e351aadfd9baa8cbdd3a76d429a695160d12c923ac9cc3baca289e193548608b82801n,0x606c4a02ea734cc32acd2b02bc28b99cb3e287e85a763af267492ab572e99ab3f370d275cec1da1aaa9075ff05f79ben],[1n,0n]],T=t.alloc([...i.bigInt2BytesLE(S(G[0][0]),m),...i.bigInt2BytesLE(S(G[0][1]),m),...i.bigInt2BytesLE(S(G[1][0]),m),...i.bigInt2BytesLE(S(G[1][1]),m),...i.bigInt2BytesLE(S(G[2][0]),m),...i.bigInt2BytesLE(S(G[2][1]),m)]),q=[[0n,0n],[1n,0n],[0n,0n]],z=t.alloc([...i.bigInt2BytesLE(S(q[0][0]),m),...i.bigInt2BytesLE(S(q[0][1]),m),...i.bigInt2BytesLE(S(q[1][0]),m),...i.bigInt2BytesLE(S(q[1][1]),m),...i.bigInt2BytesLE(S(q[2][0]),m),...i.bigInt2BytesLE(S(q[2][1]),m)]),U=t.alloc([...i.bigInt2BytesLE(S(1n),m),...i.bigInt2BytesLE(S(0n),m),...i.bigInt2BytesLE(S(0n),m),...i.bigInt2BytesLE(S(0n),m),...i.bigInt2BytesLE(S(0n),m),...i.bigInt2BytesLE(S(0n),m),...i.bigInt2BytesLE(S(0n),m),...i.bigInt2BytesLE(S(0n),m),...i.bigInt2BytesLE(S(0n),m),...i.bigInt2BytesLE(S(0n),m),...i.bigInt2BytesLE(S(0n),m),...i.bigInt2BytesLE(S(0n),m)]),M=t.alloc([...i.bigInt2BytesLE(S(1n),m),...i.bigInt2BytesLE(S(1n),m)]);!function(){let e=t.addFunction(x+"_mulNR");e.addParam("x","i32"),e.addParam("pr","i32");let a=e.getCodeBuilder(),i=a.i32_const(t.alloc(m)),o=a.getLocal("x"),n=a.i32_add(a.getLocal("x"),a.i32_const(m)),l=a.getLocal("pr"),r=a.i32_add(a.getLocal("pr"),a.i32_const(m));e.addCode(a.call(C+"_copy",o,i),a.call(C+"_sub",o,n,l),a.call(C+"_add",i,n,r))}();let Q=r(t,x+"_mulNR","f6m","f2m");!function(){let e=t.addFunction(Q+"_mulNR");e.addParam("x","i32"),e.addParam("pr","i32");let a=e.getCodeBuilder(),i=a.i32_const(t.alloc(2*m));e.addCode(a.call(x+"_copy",a.getLocal("x"),i),a.call(x+"_mulNR",a.i32_add(a.getLocal("x"),a.i32_const(4*m)),a.getLocal("pr")),a.call(x+"_copy",a.i32_add(a.getLocal("x"),a.i32_const(2*m)),a.i32_add(a.getLocal("pr"),a.i32_const(4*m))),a.call(x+"_copy",i,a.i32_add(a.getLocal("pr"),a.i32_const(2*m))))}();let k=l(t,Q+"_mulNR","ftm",Q),R=function(t){let e=0xd201000000010000n,a=[];for(;e>0n;)g(e)?a.push(1):a.push(0),e>>=1n;return a}(0),N=t.alloc(R),D=3*b,$=R.length-1,j=R.reduce((t,e)=>t+(0!=e?1:0),0),V=6*m,K=3*m*2+(j+$+1)*D;t.modules[a]={n64q:_,n64r:w,n8q:m,n8r:y,pG1gen:O,pG1zero:P,pG1b:I,pG2gen:T,pG2zero:z,pG2b:E,pq:t.modules.f1m.pq,pr:A,pOneT:U,r:0x73eda753299d7d483339d80809a1d80553bda402fffe5bfeffffffff00000001n,q:0x1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffaaabn,prePSize:V,preQSize:K},function(){let e=t.addFunction(Q+"_mul1");e.addParam("pA","i32"),e.addParam("pC1","i32"),e.addParam("pR","i32");let a=e.getCodeBuilder(),i=a.getLocal("pA"),o=a.i32_add(a.getLocal("pA"),a.i32_const(2*m)),n=a.i32_add(a.getLocal("pA"),a.i32_const(4*m)),l=a.getLocal("pC1"),r=a.getLocal("pR"),s=a.i32_add(a.getLocal("pR"),a.i32_const(2*m)),c=a.i32_add(a.getLocal("pR"),a.i32_const(4*m)),d=a.i32_const(t.alloc(2*m)),u=a.i32_const(t.alloc(2*m));e.addCode(a.call(x+"_add",i,o,d),a.call(x+"_add",o,n,u),a.call(x+"_mul",o,l,c),a.call(x+"_mul",u,l,r),a.call(x+"_sub",r,c,r),a.call(x+"_mulNR",r,r),a.call(x+"_mul",d,l,s),a.call(x+"_sub",s,c,s))}(),function(){let e=t.addFunction(Q+"_mul01");e.addParam("pA","i32"),e.addParam("pC0","i32"),e.addParam("pC1","i32"),e.addParam("pR","i32");let a=e.getCodeBuilder(),i=a.getLocal("pA"),o=a.i32_add(a.getLocal("pA"),a.i32_const(2*m)),n=a.i32_add(a.getLocal("pA"),a.i32_const(4*m)),l=a.getLocal("pC0"),r=a.getLocal("pC1"),s=a.getLocal("pR"),c=a.i32_add(a.getLocal("pR"),a.i32_const(2*m)),d=a.i32_add(a.getLocal("pR"),a.i32_const(4*m)),u=a.i32_const(t.alloc(2*m)),f=a.i32_const(t.alloc(2*m)),h=a.i32_const(t.alloc(2*m)),g=a.i32_const(t.alloc(2*m));e.addCode(a.call(x+"_mul",i,l,u),a.call(x+"_mul",o,r,f),a.call(x+"_add",i,o,h),a.call(x+"_add",i,n,g),a.call(x+"_add",o,n,s),a.call(x+"_mul",s,r,s),a.call(x+"_sub",s,f,s),a.call(x+"_mulNR",s,s),a.call(x+"_add",s,u,s),a.call(x+"_add",l,r,c),a.call(x+"_mul",c,h,c),a.call(x+"_sub",c,u,c),a.call(x+"_sub",c,f,c),a.call(x+"_mul",g,l,d),a.call(x+"_sub",d,u,d),a.call(x+"_add",d,f,d))}(),function(){let e=t.addFunction(k+"_mul014");e.addParam("pA","i32"),e.addParam("pC0","i32"),e.addParam("pC1","i32"),e.addParam("pC4","i32"),e.addParam("pR","i32");let a=e.getCodeBuilder(),i=a.getLocal("pA"),o=a.i32_add(a.getLocal("pA"),a.i32_const(6*m)),n=a.getLocal("pC0"),l=a.getLocal("pC1"),r=a.getLocal("pC4"),s=a.i32_const(t.alloc(6*m)),c=a.i32_const(t.alloc(6*m)),d=a.i32_const(t.alloc(2*m)),u=a.getLocal("pR"),f=a.i32_add(a.getLocal("pR"),a.i32_const(6*m));e.addCode(a.call(Q+"_mul01",i,n,l,s),a.call(Q+"_mul1",o,r,c),a.call(x+"_add",l,r,d),a.call(Q+"_add",o,i,f),a.call(Q+"_mul01",f,n,d,f),a.call(Q+"_sub",f,s,f),a.call(Q+"_sub",f,c,f),a.call(Q+"_copy",c,u),a.call(Q+"_mulNR",u,u),a.call(Q+"_add",u,s,u))}(),function(){let e=t.addFunction(a+"_ell");e.addParam("pP","i32"),e.addParam("pCoefs","i32"),e.addParam("pF","i32");let i=e.getCodeBuilder(),o=i.getLocal("pP"),n=i.i32_add(i.getLocal("pP"),i.i32_const(m)),l=i.getLocal("pF"),r=i.getLocal("pCoefs"),s=i.i32_add(i.getLocal("pCoefs"),i.i32_const(m)),c=i.i32_add(i.getLocal("pCoefs"),i.i32_const(2*m)),d=i.i32_add(i.getLocal("pCoefs"),i.i32_const(3*m)),u=i.i32_add(i.getLocal("pCoefs"),i.i32_const(4*m)),f=t.alloc(2*m),h=i.i32_const(f),g=i.i32_const(f),p=i.i32_const(f+m),_=t.alloc(2*m),b=i.i32_const(_),L=i.i32_const(_),w=i.i32_const(_+m);e.addCode(i.call(C+"_mul",r,n,g),i.call(C+"_mul",s,n,p),i.call(C+"_mul",c,o,L),i.call(C+"_mul",d,o,w),i.call(k+"_mul014",l,u,b,h,l))}();let H=t.alloc(V),Z=t.alloc(K);for(let e=0;e<10;e++)(function(e){let a=[[[1n,0n],[1n,0n],[1n,0n],[1n,0n],[1n,0n],[1n,0n],[1n,0n],[1n,0n],[1n,0n],[1n,0n],[1n,0n],[1n,0n]],[[1n,0n],[0x1904d3bf02bb0667c231beb4202c0d1f0fd603fd3cbd5f4f7b2443d784bab9c4f67ea53d63e7813d8d0775ed92235fb8n,0xfc3e2b36c4e03288e9e902231f9fb854a14787b6c7b36fec0c8ec971f63c5f282d5ac14d6c7ec22cf78a126ddc4af3n],[0x5f19672fdf76ce51ba69c6076a0f77eaddb3a93be6f89688de17d813620a00022e01fffffffeffffn,0n],[0x135203e60180a68ee2e9c448d77a2cd91c3dedd930b1cf60ef396489f61eb45e304466cf3e67fa0af1ee7b04121bdea2n,0x6af0e0437ff400b6831e36d6bd17ffe48395dabc2d3435e77f76e17009241c5ee67992f72ec05f4c81084fbede3cc09n],[0x5f19672fdf76ce51ba69c6076a0f77eaddb3a93be6f89688de17d813620a00022e01fffffffefffen,0n],[0x144e4211384586c16bd3ad4afa99cc9170df3560e77982d0db45f3536814f0bd5871c1908bd478cd1ee605167ff82995n,0x5b2cfd9013a5fd8df47fa6b48b1e045f39816240c0b8fee8beadf4d8e9c0566c63a3e6e257f87329b18fae980078116n],[0x1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffaaaan,0n],[0xfc3e2b36c4e03288e9e902231f9fb854a14787b6c7b36fec0c8ec971f63c5f282d5ac14d6c7ec22cf78a126ddc4af3n,0x1904d3bf02bb0667c231beb4202c0d1f0fd603fd3cbd5f4f7b2443d784bab9c4f67ea53d63e7813d8d0775ed92235fb8n],[0x1a0111ea397fe699ec02408663d4de85aa0d857d89759ad4897d29650fb85f9b409427eb4f49fffd8bfd00000000aaacn,0n],[0x6af0e0437ff400b6831e36d6bd17ffe48395dabc2d3435e77f76e17009241c5ee67992f72ec05f4c81084fbede3cc09n,0x135203e60180a68ee2e9c448d77a2cd91c3dedd930b1cf60ef396489f61eb45e304466cf3e67fa0af1ee7b04121bdea2n],[0x1a0111ea397fe699ec02408663d4de85aa0d857d89759ad4897d29650fb85f9b409427eb4f49fffd8bfd00000000aaadn,0n],[0x5b2cfd9013a5fd8df47fa6b48b1e045f39816240c0b8fee8beadf4d8e9c0566c63a3e6e257f87329b18fae980078116n,0x144e4211384586c16bd3ad4afa99cc9170df3560e77982d0db45f3536814f0bd5871c1908bd478cd1ee605167ff82995n]]],o=[[[1n,0n],[1n,0n],[1n,0n],[1n,0n],[1n,0n],[1n,0n]],[[1n,0n],[0n,0x1a0111ea397fe699ec02408663d4de85aa0d857d89759ad4897d29650fb85f9b409427eb4f49fffd8bfd00000000aaacn],[0x5f19672fdf76ce51ba69c6076a0f77eaddb3a93be6f89688de17d813620a00022e01fffffffefffen,0n],[0n,1n],[0x1a0111ea397fe699ec02408663d4de85aa0d857d89759ad4897d29650fb85f9b409427eb4f49fffd8bfd00000000aaacn,0n],[0n,0x5f19672fdf76ce51ba69c6076a0f77eaddb3a93be6f89688de17d813620a00022e01fffffffefffen]],[[1n,0n],[0x1a0111ea397fe699ec02408663d4de85aa0d857d89759ad4897d29650fb85f9b409427eb4f49fffd8bfd00000000aaadn,0n],[0x1a0111ea397fe699ec02408663d4de85aa0d857d89759ad4897d29650fb85f9b409427eb4f49fffd8bfd00000000aaacn,0n],[0x1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffaaaan,0n],[0x5f19672fdf76ce51ba69c6076a0f77eaddb3a93be6f89688de17d813620a00022e01fffffffefffen,0n],[0x5f19672fdf76ce51ba69c6076a0f77eaddb3a93be6f89688de17d813620a00022e01fffffffeffffn,0n]]],n=t.addFunction(k+"_frobeniusMap"+e);n.addParam("x","i32"),n.addParam("r","i32");let l=n.getCodeBuilder();for(let r=0;r<6;r++){let s=0==r?l.getLocal("x"):l.i32_add(l.getLocal("x"),l.i32_const(r*b)),c=l.i32_add(l.getLocal("x"),l.i32_const(r*b+m)),d=0==r?l.getLocal("r"):l.i32_add(l.getLocal("r"),l.i32_const(r*b)),u=l.i32_add(l.getLocal("r"),l.i32_const(r*b+m)),f=function(t,e){let a=t[0],i=t[1],o=e[0],n=e[1],l=[(a*o-i*n)%0x1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffaaabn,(a*n+i*o)%0x1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffaaabn];return p(l[0])&&(l[0]=l[0]+0x1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffaaabn),l}(a[Math.floor(r/3)][e%12],o[r%3][e%6]),h=t.alloc([...i.bigInt2BytesLE(S(f[0]),m),...i.bigInt2BytesLE(S(f[1]),m)]);e%2==1?n.addCode(l.call(C+"_copy",s,d),l.call(C+"_neg",c,u),l.call(x+"_mul",d,l.i32_const(h),d)):n.addCode(l.call(x+"_mul",s,l.i32_const(h),d))}})(e),t.exportFunction(k+"_frobeniusMap"+e);(function(){let e=t.addFunction(F+"_inGroupAffine");e.addParam("p","i32"),e.setReturnType("i32");let a=e.getCodeBuilder(),o=a.i32_const(t.alloc(i.bigInt2BytesLE(S(0x1a0111ea397fe699ec02408663d4de85aa0d857d89759ad4897d29650fb85f9b409427eb4f49fffd8bfd00000000aaacn),m))),n=a.i32_const(t.alloc(i.bigInt2BytesLE(S(0x5f19672fdf76ce51ba69c6076a0f77eaddb3a93be6f89688de17d813620a00022e01fffffffefffen),m))),l=a.i32_const(t.alloc(i.bigInt2BytesLE((0xd201000000010000n*0xd201000000010000n-1n)/3n,16))),r=a.getLocal("p"),s=a.i32_add(a.getLocal("p"),a.i32_const(m)),c=t.alloc(3*m),d=a.i32_const(c),u=a.i32_const(c),f=a.i32_const(c+m),h=t.alloc(2*m),g=a.i32_const(h),p=a.i32_const(h),_=a.i32_const(h+m);e.addCode(a.if(a.call(F+"_isZeroAffine",a.getLocal("p")),a.ret(a.i32_const(1))),a.if(a.i32_eqz(a.call(F+"_inCurveAffine",a.getLocal("p"))),a.ret(a.i32_const(0))),a.call(C+"_mul",r,o,u),a.call(C+"_copy",s,f),a.call(C+"_mul",r,n,p),a.call(C+"_copy",s,_),a.call(F+"_doubleAffine",d,d),a.call(F+"_subMixed",d,a.getLocal("p"),d),a.call(F+"_subMixed",d,g,d),a.call(F+"_timesScalar",d,l,a.i32_const(16),d),a.ret(a.call(F+"_eqMixed",d,g)));let b=t.addFunction(F+"_inGroup");b.addParam("pIn","i32"),b.setReturnType("i32");let L=b.getCodeBuilder(),w=L.i32_const(t.alloc(2*m));b.addCode(L.call(F+"_toAffine",L.getLocal("pIn"),w),L.ret(L.call(F+"_inGroupAffine",w)))})(),function(){let e=t.addFunction(v+"_inGroupAffine");e.addParam("p","i32"),e.setReturnType("i32");let a=e.getCodeBuilder(),o=a.i32_const(t.alloc([...i.bigInt2BytesLE(S(0xd0088f51cbff34d258dd3db21a5d66bb23ba5c279c2895fb39869507b587b120f55ffff58a9ffffdcff7fffffffd556n),m),...i.bigInt2BytesLE(S(0xd0088f51cbff34d258dd3db21a5d66bb23ba5c279c2895fb39869507b587b120f55ffff58a9ffffdcff7fffffffd555n),m)])),n=a.i32_const(t.alloc(i.bigInt2BytesLE(S(0x1a0111ea397fe699ec02408663d4de85aa0d857d89759ad4897d29650fb85f9b409427eb4f49fffd8bfd00000000aaacn),m))),l=a.i32_const(t.alloc([...i.bigInt2BytesLE(S(0x135203e60180a68ee2e9c448d77a2cd91c3dedd930b1cf60ef396489f61eb45e304466cf3e67fa0af1ee7b04121bdea2n),m),...i.bigInt2BytesLE(S(0x135203e60180a68ee2e9c448d77a2cd91c3dedd930b1cf60ef396489f61eb45e304466cf3e67fa0af1ee7b04121bdea2n),m)])),r=a.i32_const(t.alloc(i.bigInt2BytesLE(0xd201000000010000n,8))),s=a.getLocal("p"),c=a.i32_add(a.getLocal("p"),a.i32_const(b)),d=a.i32_const(t.alloc(m)),u=a.i32_const(t.alloc(b)),f=a.i32_const(t.alloc(b)),h=t.alloc(2*b),g=a.i32_const(h),p=a.i32_const(h),_=a.i32_const(h),L=a.i32_const(h+m),w=a.i32_const(h+b),y=a.i32_const(h+b),A=a.i32_const(h+b+m),I=t.alloc(3*b),F=a.i32_const(I),E=a.i32_const(I),B=a.i32_const(I),O=a.i32_const(I+m),P=a.i32_const(I+b),G=a.i32_const(I+b),T=a.i32_const(I+b+m),q=a.i32_const(I+2*b);e.addCode(a.if(a.call(v+"_isZeroAffine",a.getLocal("p")),a.ret(a.i32_const(1))),a.if(a.i32_eqz(a.call(v+"_inCurveAffine",a.getLocal("p"))),a.ret(a.i32_const(0))),a.call(x+"_mul",s,o,u),a.call(x+"_mul",c,o,f),a.call(x+"_mul1",u,n,p),a.call(x+"_neg",f,w),a.call(x+"_neg",u,E),a.call(x+"_mul",f,l,P),a.call(C+"_sub",_,L,d),a.call(C+"_add",_,L,L),a.call(C+"_copy",d,_),a.call(C+"_sub",y,A,d),a.call(C+"_add",y,A,A),a.call(C+"_copy",d,y),a.call(C+"_add",B,O,d),a.call(C+"_sub",B,O,O),a.call(C+"_copy",d,B),a.call(C+"_sub",T,G,d),a.call(C+"_add",G,T,T),a.call(C+"_copy",d,G),a.call(x+"_one",q),a.call(v+"_timesScalar",F,r,a.i32_const(8),F),a.call(v+"_addMixed",F,g,F),a.ret(a.call(v+"_eqMixed",F,a.getLocal("p"))));let z=t.addFunction(v+"_inGroup");z.addParam("pIn","i32"),z.setReturnType("i32");let U=z.getCodeBuilder(),M=U.i32_const(t.alloc(2*b));z.addCode(U.call(v+"_toAffine",U.getLocal("pIn"),M),U.ret(U.call(v+"_inGroupAffine",M)))}(),function(){let e=t.addFunction(a+"_prepAddStep");e.addParam("R","i32"),e.addParam("Q","i32"),e.addParam("r","i32");let i=e.getCodeBuilder(),o=i.getLocal("R"),n=i.i32_add(i.getLocal("R"),i.i32_const(2*m)),l=i.i32_add(i.getLocal("R"),i.i32_const(4*m)),r=i.getLocal("Q"),s=i.i32_add(i.getLocal("Q"),i.i32_const(2*m)),c=i.getLocal("r"),d=i.i32_add(i.getLocal("r"),i.i32_const(2*m)),u=i.i32_add(i.getLocal("r"),i.i32_const(4*m)),f=i.i32_const(t.alloc(b)),h=i.i32_const(t.alloc(b)),g=i.i32_const(t.alloc(b)),p=i.i32_const(t.alloc(b)),_=i.i32_const(t.alloc(b)),L=i.i32_const(t.alloc(b)),w=i.i32_const(t.alloc(b)),y=i.i32_const(t.alloc(b)),A=i.i32_const(t.alloc(b)),C=i.i32_const(t.alloc(b)),I=i.i32_const(t.alloc(b));e.addCode(i.call(x+"_square",l,f),i.call(x+"_square",s,h),i.call(x+"_mul",f,r,p),i.call(x+"_add",s,l,d),i.call(x+"_square",d,d),i.call(x+"_sub",d,h,d),i.call(x+"_sub",d,f,d),i.call(x+"_mul",d,f,d),i.call(x+"_sub",p,o,_),i.call(x+"_square",_,L),i.call(x+"_add",L,L,w),i.call(x+"_add",w,w,w),i.call(x+"_mul",w,_,y),i.call(x+"_sub",d,n,A),i.call(x+"_sub",A,n,A),i.call(x+"_mul",A,r,u),i.call(x+"_mul",w,o,C),i.call(x+"_square",A,o),i.call(x+"_sub",o,y,o),i.call(x+"_sub",o,C,o),i.call(x+"_sub",o,C,o),i.call(x+"_add",l,_,l),i.call(x+"_square",l,l),i.call(x+"_sub",l,f,l),i.call(x+"_sub",l,L,l),i.call(x+"_add",s,l,c),i.call(x+"_sub",C,o,I),i.call(x+"_mul",I,A,I),i.call(x+"_mul",n,y,p),i.call(x+"_add",p,p,p),i.call(x+"_sub",I,p,n),i.call(x+"_square",c,c),i.call(x+"_sub",c,h,c),i.call(x+"_square",l,g),i.call(x+"_sub",c,g,c),i.call(x+"_add",u,u,u),i.call(x+"_sub",u,c,u),i.call(x+"_add",l,l,c),i.call(x+"_neg",A,A),i.call(x+"_add",A,A,d))}(),function(){let e=t.addFunction(a+"_prepDblStep");e.addParam("R","i32"),e.addParam("r","i32");let i=e.getCodeBuilder(),o=i.getLocal("R"),n=i.i32_add(i.getLocal("R"),i.i32_const(2*m)),l=i.i32_add(i.getLocal("R"),i.i32_const(4*m)),r=i.getLocal("r"),s=i.i32_add(i.getLocal("r"),i.i32_const(2*m)),c=i.i32_add(i.getLocal("r"),i.i32_const(4*m)),d=i.i32_const(t.alloc(b)),u=i.i32_const(t.alloc(b)),f=i.i32_const(t.alloc(b)),h=i.i32_const(t.alloc(b)),g=i.i32_const(t.alloc(b));e.addCode(i.call(x+"_square",o,r),i.call(x+"_square",n,u),i.call(x+"_square",u,f),i.call(x+"_add",u,o,s),i.call(x+"_square",s,s),i.call(x+"_sub",s,r,s),i.call(x+"_sub",s,f,s),i.call(x+"_add",s,s,s),i.call(x+"_add",r,r,h),i.call(x+"_add",h,r,h),i.call(x+"_add",o,h,c),i.call(x+"_square",h,g),i.call(x+"_square",l,d),i.call(x+"_sub",g,s,o),i.call(x+"_sub",o,s,o),i.call(x+"_add",l,n,l),i.call(x+"_square",l,l),i.call(x+"_sub",l,u,l),i.call(x+"_sub",l,d,l),i.call(x+"_sub",s,o,n),i.call(x+"_mul",n,h,n),i.call(x+"_add",f,f,f),i.call(x+"_add",f,f,f),i.call(x+"_add",f,f,f),i.call(x+"_sub",n,f,n),i.call(x+"_mul",h,d,s),i.call(x+"_add",s,s,s),i.call(x+"_neg",s,s),i.call(x+"_square",c,c),i.call(x+"_sub",c,r,c),i.call(x+"_sub",c,g,c),i.call(x+"_add",u,u,u),i.call(x+"_add",u,u,u),i.call(x+"_sub",c,u,c),i.call(x+"_mul",l,d,r),i.call(x+"_add",r,r,r))}(),function(){let e=t.addFunction(a+"_prepareG1");e.addParam("pP","i32"),e.addParam("ppreP","i32");let i=e.getCodeBuilder();e.addCode(i.call(F+"_normalize",i.getLocal("pP"),i.getLocal("ppreP")))}(),function(){let e=t.addFunction(a+"_prepareG2");e.addParam("pQ","i32"),e.addParam("ppreQ","i32"),e.addLocal("pCoef","i32"),e.addLocal("i","i32");let i=e.getCodeBuilder(),o=i.getLocal("pQ"),n=t.alloc(3*b),l=i.i32_const(n),r=i.getLocal("ppreQ");e.addCode(i.call(v+"_normalize",o,r),i.if(i.call(v+"_isZero",r),i.ret([])),i.call(v+"_copy",r,l),i.setLocal("pCoef",i.i32_add(i.getLocal("ppreQ"),i.i32_const(3*b)))),e.addCode(i.setLocal("i",i.i32_const(R.length-2)),i.block(i.loop(i.call(a+"_prepDblStep",l,i.getLocal("pCoef")),i.setLocal("pCoef",i.i32_add(i.getLocal("pCoef"),i.i32_const(D))),i.if(i.i32_load8_s(i.getLocal("i"),N),[...i.call(a+"_prepAddStep",l,r,i.getLocal("pCoef")),...i.setLocal("pCoef",i.i32_add(i.getLocal("pCoef"),i.i32_const(D)))]),i.br_if(1,i.i32_eqz(i.getLocal("i"))),i.setLocal("i",i.i32_sub(i.getLocal("i"),i.i32_const(1))),i.br(0))))}(),function(){let e=t.addFunction(a+"_millerLoop");e.addParam("ppreP","i32"),e.addParam("ppreQ","i32"),e.addParam("r","i32"),e.addLocal("pCoef","i32"),e.addLocal("i","i32");let i=e.getCodeBuilder(),o=i.getLocal("ppreP"),n=i.getLocal("pCoef"),l=i.getLocal("r");e.addCode(i.call(k+"_one",l),i.if(i.call(F+"_isZero",o),i.ret([])),i.if(i.call(F+"_isZero",i.getLocal("ppreQ")),i.ret([])),i.setLocal("pCoef",i.i32_add(i.getLocal("ppreQ"),i.i32_const(3*b))),i.setLocal("i",i.i32_const(R.length-2)),i.block(i.loop(i.call(a+"_ell",o,n,l),i.setLocal("pCoef",i.i32_add(i.getLocal("pCoef"),i.i32_const(D))),i.if(i.i32_load8_s(i.getLocal("i"),N),[...i.call(a+"_ell",o,n,l),...i.setLocal("pCoef",i.i32_add(i.getLocal("pCoef"),i.i32_const(D)))]),i.call(k+"_square",l,l),i.br_if(1,i.i32_eq(i.getLocal("i"),i.i32_const(1))),i.setLocal("i",i.i32_sub(i.getLocal("i"),i.i32_const(1))),i.br(0))),i.call(a+"_ell",o,n,l)),e.addCode(i.call(k+"_conjugate",l,l))}(),function(){let e=t.addFunction(a+"_finalExponentiationOld");e.addParam("x","i32"),e.addParam("r","i32");let o=t.alloc(i.bigInt2BytesLE(0x2ee1db5dcc825b7e1bda9c0496a1c0a89ee0193d4977b3f7d4507d07363baa13f8d14a917848517badc3a43d1073776ab353f2c30698e8cc7deada9c0aadff5e9cfee9a074e43b9a660835cc872ee83ff3a0f0f1c0ad0d6106feaf4e347aa68ad49466fa927e7bb9375331807a0dce2630d9aa4b113f414386b0e8819328148978e2b0dd39099b86e1ab656d2670d93e4d7acdd350da5359bc73ab61a0c5bf24c374693c49f570bcd2b01f3077ffb10bf24dde41064837f27611212596bc293c8d4c01f25118790f4684d0b9c40a68eb74bb22a40ee7169cdc1041296532fef459f12438dfc8e2886ef965e61a474c5c85b0129127a1b5ad0463434724538411d1676a53b5a62eb34c05739334f46c02c3f0bd0c55d3109cd15948d0a1fad20044ce6ad4c6bec3ec03ef19592004cedd556952c6d8823b19dadd7c2498345c6e5308f1c511291097db60b1749bf9b71a9f9e0100418a3ef0bc627751bbd81367066bca6a4c1b6dcfc5cceb73fc56947a403577dfa9e13c24ea820b09c1d9f7c31759c3635de3f7a3639991708e88adce88177456c49637fd7961be1a4c7e79fb02faa732e2f3ec2bea83d196283313492caa9d4aff1c910e9622d2a73f62537f2701aaef6539314043f7bbce5b78c7869aeb2181a67e49eeed2161daf3f881bd88592d767f67c4717489119226c2f011d4cab803e9d71650a6f80698e2f8491d12191a04406fbc8fbd5f48925f98630e68bfb24c0bcb9b55df57510n,544)),n=e.getCodeBuilder();e.addCode(n.call(k+"_exp",n.getLocal("x"),n.i32_const(o),n.i32_const(544),n.getLocal("r")))}(),function(){(function(){let e=t.addFunction(a+"__cyclotomicSquare");e.addParam("x","i32"),e.addParam("r","i32");let i=e.getCodeBuilder(),o=i.getLocal("x"),n=i.i32_add(i.getLocal("x"),i.i32_const(b)),l=i.i32_add(i.getLocal("x"),i.i32_const(2*b)),r=i.i32_add(i.getLocal("x"),i.i32_const(3*b)),s=i.i32_add(i.getLocal("x"),i.i32_const(4*b)),c=i.i32_add(i.getLocal("x"),i.i32_const(5*b)),d=i.getLocal("r"),u=i.i32_add(i.getLocal("r"),i.i32_const(b)),f=i.i32_add(i.getLocal("r"),i.i32_const(2*b)),h=i.i32_add(i.getLocal("r"),i.i32_const(3*b)),g=i.i32_add(i.getLocal("r"),i.i32_const(4*b)),p=i.i32_add(i.getLocal("r"),i.i32_const(5*b)),_=i.i32_const(t.alloc(b)),m=i.i32_const(t.alloc(b)),L=i.i32_const(t.alloc(b)),w=i.i32_const(t.alloc(b)),y=i.i32_const(t.alloc(b)),A=i.i32_const(t.alloc(b)),C=i.i32_const(t.alloc(b)),I=i.i32_const(t.alloc(b));e.addCode(i.call(x+"_mul",o,s,C),i.call(x+"_mulNR",s,_),i.call(x+"_add",o,_,_),i.call(x+"_add",o,s,I),i.call(x+"_mul",I,_,_),i.call(x+"_mulNR",C,I),i.call(x+"_add",C,I,I),i.call(x+"_sub",_,I,_),i.call(x+"_add",C,C,m),i.call(x+"_mul",r,l,C),i.call(x+"_mulNR",l,L),i.call(x+"_add",r,L,L),i.call(x+"_add",r,l,I),i.call(x+"_mul",I,L,L),i.call(x+"_mulNR",C,I),i.call(x+"_add",C,I,I),i.call(x+"_sub",L,I,L),i.call(x+"_add",C,C,w),i.call(x+"_mul",n,c,C),i.call(x+"_mulNR",c,y),i.call(x+"_add",n,y,y),i.call(x+"_add",n,c,I),i.call(x+"_mul",I,y,y),i.call(x+"_mulNR",C,I),i.call(x+"_add",C,I,I),i.call(x+"_sub",y,I,y),i.call(x+"_add",C,C,A),i.call(x+"_sub",_,o,d),i.call(x+"_add",d,d,d),i.call(x+"_add",_,d,d),i.call(x+"_add",m,s,g),i.call(x+"_add",g,g,g),i.call(x+"_add",m,g,g),i.call(x+"_mul",A,i.i32_const(M),I),i.call(x+"_add",I,r,h),i.call(x+"_add",h,h,h),i.call(x+"_add",I,h,h),i.call(x+"_sub",y,l,f),i.call(x+"_add",f,f,f),i.call(x+"_add",y,f,f),i.call(x+"_sub",L,n,u),i.call(x+"_add",u,u,u),i.call(x+"_add",L,u,u),i.call(x+"_add",w,c,p),i.call(x+"_add",p,p,p),i.call(x+"_add",w,p,p))})(),function(e,i,o){let n=(function(t){let e=0xd201000000010000n,a=[];for(;e>0n;){if(g(e)){let t=2-Number(e%4n);a.push(t),e-=BigInt(t)}else a.push(0);e>>=1n}return a})(0).map(t=>-1==t?255:t),l=t.alloc(n),r=t.addFunction(a+"__cyclotomicExp_w0");r.addParam("x","i32"),r.addParam("r","i32"),r.addLocal("bit","i32"),r.addLocal("i","i32");let s=r.getCodeBuilder(),c=s.getLocal("x"),d=s.getLocal("r"),u=s.i32_const(t.alloc(L));r.addCode(s.call(k+"_conjugate",c,u),s.call(k+"_one",d),s.if(s.teeLocal("bit",s.i32_load8_s(s.i32_const(n.length-1),l)),s.if(s.i32_eq(s.getLocal("bit"),s.i32_const(1)),s.call(k+"_mul",d,c,d),s.call(k+"_mul",d,u,d))),s.setLocal("i",s.i32_const(n.length-2)),s.block(s.loop(s.call(a+"__cyclotomicSquare",d,d),s.if(s.teeLocal("bit",s.i32_load8_s(s.getLocal("i"),l)),s.if(s.i32_eq(s.getLocal("bit"),s.i32_const(1)),s.call(k+"_mul",d,c,d),s.call(k+"_mul",d,u,d))),s.br_if(1,s.i32_eqz(s.getLocal("i"))),s.setLocal("i",s.i32_sub(s.getLocal("i"),s.i32_const(1))),s.br(0)))),i&&r.addCode(s.call(k+"_conjugate",d,d))}(0,!0,0);let e=t.addFunction(a+"_finalExponentiation");e.addParam("x","i32"),e.addParam("r","i32");let i=e.getCodeBuilder(),o=i.getLocal("x"),n=i.getLocal("r"),l=i.i32_const(t.alloc(L)),r=i.i32_const(t.alloc(L)),s=i.i32_const(t.alloc(L)),c=i.i32_const(t.alloc(L)),d=i.i32_const(t.alloc(L)),u=i.i32_const(t.alloc(L)),f=i.i32_const(t.alloc(L));e.addCode(i.call(k+"_frobeniusMap6",o,l),i.call(k+"_inverse",o,r),i.call(k+"_mul",l,r,s),i.call(k+"_copy",s,r),i.call(k+"_frobeniusMap2",s,s),i.call(k+"_mul",s,r,s),i.call(a+"__cyclotomicSquare",s,r),i.call(k+"_conjugate",r,r),i.call(a+"__cyclotomicExp_w0",s,c),i.call(a+"__cyclotomicSquare",c,d),i.call(k+"_mul",r,c,u),i.call(a+"__cyclotomicExp_w0",u,r),i.call(a+"__cyclotomicExp_w0",r,l),i.call(a+"__cyclotomicExp_w0",l,f),i.call(k+"_mul",f,d,f),i.call(a+"__cyclotomicExp_w0",f,d),i.call(k+"_conjugate",u,u),i.call(k+"_mul",d,u,d),i.call(k+"_mul",d,s,d),i.call(k+"_conjugate",s,u),i.call(k+"_mul",r,s,r),i.call(k+"_frobeniusMap3",r,r),i.call(k+"_mul",f,u,f),i.call(k+"_frobeniusMap1",f,f),i.call(k+"_mul",c,l,c),i.call(k+"_frobeniusMap2",c,c),i.call(k+"_mul",c,r,c),i.call(k+"_mul",c,f,c),i.call(k+"_mul",c,d,n))}();for(let e=1;e<=5;e++)(function(e){let i=t.addFunction(a+"_pairingEq"+e);for(let t=0;t<e;t++)i.addParam("p_"+t,"i32"),i.addParam("q_"+t,"i32");i.addParam("c","i32"),i.setReturnType("i32");let o=i.getCodeBuilder(),n=o.i32_const(t.alloc(L)),l=o.i32_const(t.alloc(L));i.addCode(o.call(k+"_one",n));for(let t=0;t<e;t++)i.addCode(o.call(a+"_prepareG1",o.getLocal("p_"+t),o.i32_const(H))),i.addCode(o.call(a+"_prepareG2",o.getLocal("q_"+t),o.i32_const(Z))),i.addCode(o.if(o.i32_eqz(o.call(F+"_inGroupAffine",o.i32_const(H))),o.ret(o.i32_const(0))),o.if(o.i32_eqz(o.call(v+"_inGroupAffine",o.i32_const(Z))),o.ret(o.i32_const(0)))),i.addCode(o.call(a+"_millerLoop",o.i32_const(H),o.i32_const(Z),l)),i.addCode(o.call(k+"_mul",n,l,n));i.addCode(o.call(a+"_finalExponentiation",n,n)),i.addCode(o.call(k+"_eq",n,o.getLocal("c")))})(e),t.exportFunction(a+"_pairingEq"+e);(function(){let e=t.addFunction(a+"_pairing");e.addParam("p","i32"),e.addParam("q","i32"),e.addParam("r","i32");let i=e.getCodeBuilder(),o=i.i32_const(t.alloc(L));e.addCode(i.call(a+"_prepareG1",i.getLocal("p"),i.i32_const(H))),e.addCode(i.call(a+"_prepareG2",i.getLocal("q"),i.i32_const(Z))),e.addCode(i.call(a+"_millerLoop",i.i32_const(H),i.i32_const(Z),o)),e.addCode(i.call(a+"_finalExponentiation",o,i.getLocal("r")))})(),t.exportFunction(a+"_pairing"),t.exportFunction(a+"_prepareG1"),t.exportFunction(a+"_prepareG2"),t.exportFunction(a+"_millerLoop"),t.exportFunction(a+"_finalExponentiation"),t.exportFunction(a+"_finalExponentiationOld"),t.exportFunction(a+"__cyclotomicSquare"),t.exportFunction(a+"__cyclotomicExp_w0"),t.exportFunction(Q+"_mul1"),t.exportFunction(Q+"_mul01"),t.exportFunction(k+"_mul014"),t.exportFunction(F+"_inGroupAffine"),t.exportFunction(F+"_inGroup"),t.exportFunction(v+"_inGroupAffine"),t.exportFunction(v+"_inGroup")}},540:(t,e,a)=>{let i=a(1209),o=a(6246),n=a(6466),l=a(1599),r=a(4033),s=a(7644),c=a(3920),d=a(6989),u=a(7119),f=a(2929),{bitLength:h,modInv:g,isOdd:p,isNegative:_}=a(3667);t.exports=function(t,e){let a=e||"bn128";if(t.modules[a])return a;let m=Math.floor((h(0x30644e72e131a029b85045b68181585d97816a916871ca8d3c208c16d87cfd47n-1n)-1)/64)+1,b=8*m,L=2*b,w=12*b,y=t.alloc(i.bigInt2BytesLE(0x30644e72e131a029b85045b68181585d2833e84879b9709143e1f593f0000001n,b)),A=o(t,0x30644e72e131a029b85045b68181585d97816a916871ca8d3c208c16d87cfd47n,"f1m");n(t,0x30644e72e131a029b85045b68181585d2833e84879b9709143e1f593f0000001n,"fr","frm");let C=t.alloc(i.bigInt2BytesLE(B(3n),b)),I=s(t,"g1m","f1m",C);c(t,"frm","frm","frm","frm_mul"),d(t,"pol","frm"),u(t,"qap","frm");let F=l(t,"f1m_neg","f2m","f1m"),x=t.alloc([...i.bigInt2BytesLE(B(0x2b149d40ceb8aaae81be18991be06ac3b5b4c5e559dbefa33267e6dc24a138e5n),b),...i.bigInt2BytesLE(B(0x9713b03af0fed4cd2cafadeed8fdf4a74fa084e52d1852e4a2bd0685c315d2n),b)]),E=s(t,"g2m","f2m",x);function v(e,a){let i=t.addFunction(e);i.addParam("pG","i32"),i.addParam("pFr","i32"),i.addParam("pr","i32");let o=i.getCodeBuilder(),n=o.i32_const(t.alloc(b));i.addCode(o.call("frm_fromMontgomery",o.getLocal("pFr"),n),o.call(a,o.getLocal("pG"),n,o.i32_const(b),o.getLocal("pr"))),t.exportFunction(e)}function B(t){return BigInt(t)*(1n<<BigInt(8*b))%0x30644e72e131a029b85045b68181585d97816a916871ca8d3c208c16d87cfd47n}v("g1m_timesFr","g1m_timesScalar"),c(t,"g1m","g1m","frm","g1m_timesFr"),v("g2m_timesFr","g2m_timesScalar"),c(t,"g2m","g2m","frm","g2m_timesFr"),v("g1m_timesFrAffine","g1m_timesScalarAffine"),v("g2m_timesFrAffine","g2m_timesScalarAffine"),f(t,"frm_batchApplyKey","fmr","frm",b,b,b,"frm_mul"),f(t,"g1m_batchApplyKey","g1m","frm",3*b,3*b,b,"g1m_timesFr"),f(t,"g1m_batchApplyKeyMixed","g1m","frm",2*b,3*b,b,"g1m_timesFrAffine"),f(t,"g2m_batchApplyKey","g2m","frm",6*b,6*b,b,"g2m_timesFr"),f(t,"g2m_batchApplyKeyMixed","g2m","frm",4*b,6*b,b,"g2m_timesFrAffine");let S=t.alloc([...i.bigInt2BytesLE(B(1n),b),...i.bigInt2BytesLE(B(2n),b),...i.bigInt2BytesLE(B(1n),b)]),O=t.alloc([...i.bigInt2BytesLE(B(0n),b),...i.bigInt2BytesLE(B(1n),b),...i.bigInt2BytesLE(B(0n),b)]),P=[[0x1800deef121f1e76426a00665e5c4479674322d4f75edadd46debd5cd992f6edn,0x198e9393920d483a7260bfb731fb5d25f1aa493335a9e71297e485b7aef312c2n],[0x12c85ea5db8c6deb4aab71808dcb408fe3d1e7690c43d37b4ce6cc0166fa7daan,0x90689d0585ff075ec9e99ad690c3395bc4b313370b38ef355acdadcd122975bn],[1n,0n]],G=t.alloc([...i.bigInt2BytesLE(B(P[0][0]),b),...i.bigInt2BytesLE(B(P[0][1]),b),...i.bigInt2BytesLE(B(P[1][0]),b),...i.bigInt2BytesLE(B(P[1][1]),b),...i.bigInt2BytesLE(B(P[2][0]),b),...i.bigInt2BytesLE(B(P[2][1]),b)]),T=[[0n,0n],[1n,0n],[0n,0n]],q=t.alloc([...i.bigInt2BytesLE(B(T[0][0]),b),...i.bigInt2BytesLE(B(T[0][1]),b),...i.bigInt2BytesLE(B(T[1][0]),b),...i.bigInt2BytesLE(B(T[1][1]),b),...i.bigInt2BytesLE(B(T[2][0]),b),...i.bigInt2BytesLE(B(T[2][1]),b)]),z=t.alloc([...i.bigInt2BytesLE(B(1),b),...i.bigInt2BytesLE(B(0),b),...i.bigInt2BytesLE(B(0),b),...i.bigInt2BytesLE(B(0),b),...i.bigInt2BytesLE(B(0),b),...i.bigInt2BytesLE(B(0),b),...i.bigInt2BytesLE(B(0),b),...i.bigInt2BytesLE(B(0),b),...i.bigInt2BytesLE(B(0),b),...i.bigInt2BytesLE(B(0),b),...i.bigInt2BytesLE(B(0),b),...i.bigInt2BytesLE(B(0),b)]),U=t.alloc([...i.bigInt2BytesLE(B(9),b),...i.bigInt2BytesLE(B(1),b)]),M=t.alloc([...i.bigInt2BytesLE(B(g(2n,0x30644e72e131a029b85045b68181585d97816a916871ca8d3c208c16d87cfd47n)),b),...i.bigInt2BytesLE(0n,b)]),Q=t.alloc([...i.bigInt2BytesLE(B(0x2b149d40ceb8aaae81be18991be06ac3b5b4c5e559dbefa33267e6dc24a138e5n),b),...i.bigInt2BytesLE(B(0x9713b03af0fed4cd2cafadeed8fdf4a74fa084e52d1852e4a2bd0685c315d2n),b)]);!function(){let e=t.addFunction(a+"_mulNR6");e.addParam("x","i32"),e.addParam("pr","i32");let i=e.getCodeBuilder();e.addCode(i.call(F+"_mul",i.i32_const(U),i.getLocal("x"),i.getLocal("pr")))}();let k=r(t,a+"_mulNR6","f6m","f2m");!function(){let e=t.addFunction(a+"_mulNR12");e.addParam("x","i32"),e.addParam("pr","i32");let i=e.getCodeBuilder();e.addCode(i.call(F+"_mul",i.i32_const(U),i.i32_add(i.getLocal("x"),i.i32_const(4*b)),i.getLocal("pr")),i.call(F+"_copy",i.getLocal("x"),i.i32_add(i.getLocal("pr"),i.i32_const(2*b))),i.call(F+"_copy",i.i32_add(i.getLocal("x"),i.i32_const(2*b)),i.i32_add(i.getLocal("pr"),i.i32_const(4*b))))}();let R=l(t,a+"_mulNR12","ftm",k),N=function(t){let e=0x19d797039be763ba8n,a=[];for(;e>0n;)p(e)?a.push(1):a.push(0),e>>=1n;return a}(0),D=t.alloc(N),$=3*L,j=N.length-1,V=N.reduce((t,e)=>t+(0!=e?1:0),0),K=6*b,H=3*b*2+(V+j+1)*$;t.modules[a]={n64:m,pG1gen:S,pG1zero:O,pG1b:C,pG2gen:G,pG2zero:q,pG2b:x,pq:t.modules.f1m.pq,pr:y,pOneT:z,prePSize:K,preQSize:H,r:0x30644e72e131a029b85045b68181585d2833e84879b9709143e1f593f0000001n.toString(),q:0x30644e72e131a029b85045b68181585d97816a916871ca8d3c208c16d87cfd47n.toString()};let Z=t.alloc(K),W=t.alloc(H);(function(){let e=t.addFunction(a+"_prepAddStep");e.addParam("pQ","i32"),e.addParam("pR","i32"),e.addParam("pCoef","i32");let i=e.getCodeBuilder(),o=i.getLocal("pQ"),n=i.i32_add(i.getLocal("pQ"),i.i32_const(L)),l=i.getLocal("pR"),r=i.i32_add(i.getLocal("pR"),i.i32_const(L)),s=i.i32_add(i.getLocal("pR"),i.i32_const(2*L)),c=i.getLocal("pCoef"),d=i.i32_add(i.getLocal("pCoef"),i.i32_const(L)),u=i.i32_add(i.getLocal("pCoef"),i.i32_const(2*L)),f=i.i32_const(t.alloc(L)),h=i.i32_const(t.alloc(L)),g=i.i32_const(t.alloc(L)),p=i.i32_const(t.alloc(L)),_=i.i32_const(t.alloc(L)),m=i.i32_const(t.alloc(L)),b=i.i32_const(t.alloc(L));e.addCode(i.call(F+"_mul",o,s,d),i.call(F+"_sub",l,d,d),i.call(F+"_mul",n,s,f),i.call(F+"_sub",r,f,f),i.call(F+"_square",d,h),i.call(F+"_square",f,g),i.call(F+"_mul",d,h,p),i.call(F+"_mul",l,h,_),i.call(F+"_add",_,_,b),i.call(F+"_mul",s,g,m),i.call(F+"_add",p,m,m),i.call(F+"_sub",m,b,m),i.call(F+"_mul",d,m,l),i.call(F+"_mul",p,r,r),i.call(F+"_sub",_,m,b),i.call(F+"_mul",f,b,b),i.call(F+"_sub",b,r,r),i.call(F+"_mul",s,p,s),i.call(F+"_mul",d,n,b),i.call(F+"_mul",f,o,c),i.call(F+"_sub",c,b,c),i.call(F+"_mul",c,i.i32_const(U),c),i.call(F+"_neg",f,u))})(),function(){let e=t.addFunction(a+"_prepDblStep");e.addParam("pR","i32"),e.addParam("pCoef","i32");let i=e.getCodeBuilder(),o=i.getLocal("pR"),n=i.i32_add(i.getLocal("pR"),i.i32_const(L)),l=i.i32_add(i.getLocal("pR"),i.i32_const(2*L)),r=i.getLocal("pCoef"),s=i.i32_add(i.getLocal("pCoef"),i.i32_const(L)),c=i.i32_add(i.getLocal("pCoef"),i.i32_const(2*L)),d=i.i32_const(t.alloc(L)),u=i.i32_const(t.alloc(L)),f=i.i32_const(t.alloc(L)),h=i.i32_const(t.alloc(L)),g=i.i32_const(t.alloc(L)),p=i.i32_const(t.alloc(L)),_=i.i32_const(t.alloc(L)),m=i.i32_const(t.alloc(L)),b=i.i32_const(t.alloc(L)),w=i.i32_const(t.alloc(L)),y=i.i32_const(t.alloc(L)),A=i.i32_const(t.alloc(L));e.addCode(i.call(F+"_mul",n,i.i32_const(M),d),i.call(F+"_mul",o,d,d),i.call(F+"_square",n,u),i.call(F+"_square",l,f),i.call(F+"_add",f,f,h),i.call(F+"_add",h,f,h),i.call(F+"_mul",i.i32_const(Q),h,g),i.call(F+"_add",g,g,p),i.call(F+"_add",g,p,p),i.call(F+"_add",u,p,_),i.call(F+"_mul",_,i.i32_const(M),_),i.call(F+"_add",u,f,A),i.call(F+"_add",n,l,m),i.call(F+"_square",m,m),i.call(F+"_sub",m,A,m),i.call(F+"_sub",g,u,b),i.call(F+"_square",o,w),i.call(F+"_square",g,y),i.call(F+"_sub",u,p,A),i.call(F+"_mul",d,A,o),i.call(F+"_add",y,y,A),i.call(F+"_add",y,A,A),i.call(F+"_square",_,n),i.call(F+"_sub",n,A,n),i.call(F+"_mul",u,m,l),i.call(F+"_mul",i.i32_const(U),b,r),i.call(F+"_neg",m,s),i.call(F+"_add",w,w,c),i.call(F+"_add",w,c,c))}(),function(){let e=t.addFunction(a+"_prepareG1");e.addParam("pP","i32"),e.addParam("ppreP","i32");let i=e.getCodeBuilder();e.addCode(i.call(I+"_normalize",i.getLocal("pP"),i.getLocal("ppreP")))}(),function(){!function(){let e=t.addFunction(a+"_mulByQ");e.addParam("p1","i32"),e.addParam("pr","i32");let o=e.getCodeBuilder(),n=o.getLocal("p1"),l=o.i32_add(o.getLocal("p1"),o.i32_const(L)),r=o.i32_add(o.getLocal("p1"),o.i32_const(2*L)),s=o.getLocal("pr"),c=o.i32_add(o.getLocal("pr"),o.i32_const(L)),d=o.i32_add(o.getLocal("pr"),o.i32_const(2*L)),u=o.i32_const(t.alloc([...i.bigInt2BytesLE(B("21575463638280843010398324269430826099269044274347216827212613867836435027261"),b),...i.bigInt2BytesLE(B("10307601595873709700152284273816112264069230130616436755625194854815875713954"),b)])),f=o.i32_const(t.alloc([...i.bigInt2BytesLE(B("2821565182194536844548159561693502659359617185244120367078079554186484126554"),b),...i.bigInt2BytesLE(B("3505843767911556378687030309984248845540243509899259641013678093033130930403"),b)]));e.addCode(o.call(F+"_conjugate",n,s),o.call(F+"_mul",u,s,s),o.call(F+"_conjugate",l,c),o.call(F+"_mul",f,c,c),o.call(F+"_conjugate",r,d))}();let e=t.addFunction(a+"_prepareG2");e.addParam("pQ","i32"),e.addParam("ppreQ","i32"),e.addLocal("pCoef","i32"),e.addLocal("i","i32");let o=e.getCodeBuilder(),n=o.getLocal("pQ"),l=t.alloc(3*L),r=o.i32_const(l),s=o.i32_const(l),c=o.i32_const(l+L),d=o.i32_const(l+2*L),u=o.i32_add(o.getLocal("ppreQ"),o.i32_const(0)),f=o.i32_add(o.getLocal("ppreQ"),o.i32_const(L)),h=t.alloc(3*L),g=o.i32_const(h),p=t.alloc(3*L),_=o.i32_const(p),m=o.i32_const(p+L);e.addCode(o.call(E+"_normalize",n,u),o.call(F+"_copy",u,s),o.call(F+"_copy",f,c),o.call(F+"_one",d)),e.addCode(o.setLocal("pCoef",o.i32_add(o.getLocal("ppreQ"),o.i32_const(3*L))),o.setLocal("i",o.i32_const(N.length-2)),o.block(o.loop(o.call(a+"_prepDblStep",r,o.getLocal("pCoef")),o.setLocal("pCoef",o.i32_add(o.getLocal("pCoef"),o.i32_const($))),o.if(o.i32_load8_s(o.getLocal("i"),D),[...o.call(a+"_prepAddStep",u,r,o.getLocal("pCoef")),...o.setLocal("pCoef",o.i32_add(o.getLocal("pCoef"),o.i32_const($)))]),o.br_if(1,o.i32_eqz(o.getLocal("i"))),o.setLocal("i",o.i32_sub(o.getLocal("i"),o.i32_const(1))),o.br(0)))),e.addCode(o.call(a+"_mulByQ",u,g),o.call(a+"_mulByQ",g,_)),e.addCode(o.call(F+"_neg",m,m),o.call(a+"_prepAddStep",g,r,o.getLocal("pCoef")),o.setLocal("pCoef",o.i32_add(o.getLocal("pCoef"),o.i32_const($))),o.call(a+"_prepAddStep",_,r,o.getLocal("pCoef")),o.setLocal("pCoef",o.i32_add(o.getLocal("pCoef"),o.i32_const($))))}(),function(){let e=t.addFunction(a+"__mulBy024");e.addParam("pEll0","i32"),e.addParam("pEllVW","i32"),e.addParam("pEllVV","i32"),e.addParam("pR","i32");let i=e.getCodeBuilder(),o=i.getLocal("pEll0"),n=i.getLocal("pEllVV"),l=i.getLocal("pEllVW"),r=i.getLocal("pR"),s=i.i32_add(i.getLocal("pR"),i.i32_const(2*b)),c=i.i32_add(i.getLocal("pR"),i.i32_const(4*b)),d=i.i32_add(i.getLocal("pR"),i.i32_const(6*b)),u=i.i32_add(i.getLocal("pR"),i.i32_const(8*b)),f=i.i32_add(i.getLocal("pR"),i.i32_const(10*b)),h=i.i32_const(t.alloc(L)),g=i.i32_const(t.alloc(L)),p=i.i32_const(t.alloc(L)),_=i.i32_const(t.alloc(L)),m=i.i32_const(t.alloc(L)),w=i.i32_const(t.alloc(L)),y=i.i32_const(t.alloc(L)),A=i.i32_const(t.alloc(L)),C=i.i32_const(t.alloc(L)),I=i.i32_const(t.alloc(L)),x=i.i32_const(t.alloc(L));e.addCode(i.call(F+"_mul",r,o,y),i.call(F+"_mul",c,n,A),i.call(F+"_mul",u,l,C),i.call(F+"_add",r,u,p),i.call(F+"_add",r,c,g),i.call(F+"_add",s,d,_),i.call(F+"_add",_,f,_),i.call(F+"_mul",s,n,I),i.call(F+"_add",I,C,m),i.call(F+"_mul",i.i32_const(U),m,w),i.call(F+"_add",w,y,r),i.call(F+"_mul",f,l,m),i.call(F+"_add",I,m,I),i.call(F+"_add",m,A,m),i.call(F+"_mul",i.i32_const(U),m,w),i.call(F+"_mul",s,o,m),i.call(F+"_add",I,m,I),i.call(F+"_add",w,m,s),i.call(F+"_add",o,n,h),i.call(F+"_mul",g,h,m),i.call(F+"_add",y,A,x),i.call(F+"_sub",m,x,m),i.call(F+"_mul",d,l,w),i.call(F+"_add",I,w,I),i.call(F+"_add",c,u,h),i.call(F+"_add",m,w,c),i.call(F+"_add",n,l,g),i.call(F+"_mul",g,h,m),i.call(F+"_add",A,C,x),i.call(F+"_sub",m,x,m),i.call(F+"_mul",i.i32_const(U),m,w),i.call(F+"_mul",d,o,m),i.call(F+"_add",I,m,I),i.call(F+"_add",w,m,d),i.call(F+"_mul",f,n,m),i.call(F+"_add",I,m,I),i.call(F+"_mul",i.i32_const(U),m,w),i.call(F+"_add",o,l,h),i.call(F+"_mul",p,h,m),i.call(F+"_add",y,C,x),i.call(F+"_sub",m,x,m),i.call(F+"_add",w,m,u),i.call(F+"_add",o,n,h),i.call(F+"_add",h,l,h),i.call(F+"_mul",_,h,m),i.call(F+"_sub",m,I,f))}(),function(){let e=t.addFunction(a+"__mulBy024Old");e.addParam("pEll0","i32"),e.addParam("pEllVW","i32"),e.addParam("pEllVV","i32"),e.addParam("pR","i32");let i=e.getCodeBuilder(),o=i.getLocal("pEll0"),n=i.getLocal("pEllVV"),l=i.getLocal("pEllVW"),r=i.getLocal("pR"),s=t.alloc(w),c=i.i32_const(s),d=i.i32_const(s),u=i.i32_const(s+L),f=i.i32_const(s+2*L),h=i.i32_const(s+3*L),g=i.i32_const(s+4*L),p=i.i32_const(s+5*L);e.addCode(i.call(F+"_copy",o,d),i.call(F+"_zero",u),i.call(F+"_copy",n,f),i.call(F+"_zero",h),i.call(F+"_copy",l,g),i.call(F+"_zero",p),i.call(R+"_mul",c,r,r))}(),function(){let e=t.addFunction(a+"_millerLoop");e.addParam("ppreP","i32"),e.addParam("ppreQ","i32"),e.addParam("r","i32"),e.addLocal("pCoef","i32"),e.addLocal("i","i32");let i=e.getCodeBuilder(),o=i.getLocal("ppreP"),n=i.i32_add(i.getLocal("ppreP"),i.i32_const(b)),l=i.getLocal("pCoef"),r=i.i32_add(i.getLocal("pCoef"),i.i32_const(L)),s=i.i32_add(i.getLocal("pCoef"),i.i32_const(2*L)),c=t.alloc(L),d=i.i32_const(c),u=t.alloc(L),f=i.i32_const(u),h=i.getLocal("r");e.addCode(i.call(R+"_one",h),i.setLocal("pCoef",i.i32_add(i.getLocal("ppreQ"),i.i32_const(3*L))),i.setLocal("i",i.i32_const(N.length-2)),i.block(i.loop(i.call(R+"_square",h,h),i.call(F+"_mul1",r,n,d),i.call(F+"_mul1",s,o,f),i.call(a+"__mulBy024",l,d,f,h),i.setLocal("pCoef",i.i32_add(i.getLocal("pCoef"),i.i32_const($))),i.if(i.i32_load8_s(i.getLocal("i"),D),[...i.call(F+"_mul1",r,n,d),...i.call(F+"_mul1",s,o,f),...i.call(a+"__mulBy024",l,d,f,h),...i.setLocal("pCoef",i.i32_add(i.getLocal("pCoef"),i.i32_const($)))]),i.br_if(1,i.i32_eqz(i.getLocal("i"))),i.setLocal("i",i.i32_sub(i.getLocal("i"),i.i32_const(1))),i.br(0)))),e.addCode(i.call(F+"_mul1",r,n,d),i.call(F+"_mul1",s,o,f),i.call(a+"__mulBy024",l,d,f,h),i.setLocal("pCoef",i.i32_add(i.getLocal("pCoef"),i.i32_const($))),i.call(F+"_mul1",r,n,d),i.call(F+"_mul1",s,o,f),i.call(a+"__mulBy024",l,d,f,h),i.setLocal("pCoef",i.i32_add(i.getLocal("pCoef"),i.i32_const($))))}();for(let e=0;e<10;e++)(function(e){let o=[[[1n,0n],[1n,0n],[1n,0n],[1n,0n],[1n,0n],[1n,0n],[1n,0n],[1n,0n],[1n,0n],[1n,0n],[1n,0n],[1n,0n]],[[1n,0n],[0x1284b71c2865a7dfe8b99fdd76e68b605c521e08292f2176d60b35dadcc9e470n,0x246996f3b4fae7e6a6327cfe12150b8e747992778eeec7e5ca5cf05f80f362acn],[0x30644e72e131a0295e6dd9e7e0acccb0c28f069fbb966e3de4bd44e5607cfd49n,0n],[0x19dc81cfcc82e4bbefe9608cd0acaa90894cb38dbe55d24ae86f7d391ed4a67fn,0xabf8b60be77d7306cbeee33576139d7f03a5e397d439ec7694aa2bf4c0c101n],[0x30644e72e131a0295e6dd9e7e0acccb0c28f069fbb966e3de4bd44e5607cfd48n,0n],[0x757cab3a41d3cdc072fc0af59c61f302cfa95859526b0d41264475e420ac20fn,0xca6b035381e35b618e9b79ba4e2606ca20b7dfd71573c93e85845e34c4a5b9cn],[0x30644e72e131a029b85045b68181585d97816a916871ca8d3c208c16d87cfd46n,0n],[0x1ddf9756b8cbf849cf96a5d90a9accfd3b2f4c893f42a9166615563bfbb318d7n,0xbfab77f2c36b843121dc8b86f6c4ccf2307d819d98302a771c39bb757899a9bn],[0x59e26bcea0d48bacd4f263f1acdb5c4f5763473177fffffen,0n],[0x1687cca314aebb6dc866e529b0d4adcd0e34b703aa1bf84253b10eddb9a856c8n,0x2fb855bcd54a22b6b18456d34c0b44c0187dc4add09d90a0c58be1eae3bc3c46n],[0x59e26bcea0d48bacd4f263f1acdb5c4f5763473177ffffffn,0n],[0x290c83bf3d14634db120850727bb392d6a86d50bd34b19b929bc44b896723b38n,0x23bd9e3da9136a739f668e1adc9ef7f0f575ec93f71a8df953c846338c32a1abn]]],n=[[[1n,0n],[1n,0n],[1n,0n],[1n,0n],[1n,0n],[1n,0n]],[[1n,0n],[0x2fb347984f7911f74c0bec3cf559b143b78cc310c2c3330c99e39557176f553dn,0x16c9e55061ebae204ba4cc8bd75a079432ae2a1d0b7c9dce1665d51c640fcba2n],[0x30644e72e131a0295e6dd9e7e0acccb0c28f069fbb966e3de4bd44e5607cfd48n,0n],[0x856e078b755ef0abaff1c77959f25ac805ffd3d5d6942d37b746ee87bdcfb6dn,0x4f1de41b3d1766fa9f30e6dec26094f0fdf31bf98ff2631380cab2baaa586den],[0x59e26bcea0d48bacd4f263f1acdb5c4f5763473177fffffen,0n],[0x28be74d4bb943f51699582b87809d9caf71614d4b0b71f3a62e913ee1dada9e4n,0x14a88ae0cb747b99c2b86abcbe01477a54f40eb4c3f6068dedae0bcec9c7aac7n]],[[1n,0n],[0x5b54f5e64eea80180f3c0b75a181e84d33365f7be94ec72848a1f55921ea762n,0x2c145edbe7fd8aee9f3a80b03b0b1c923685d2ea1bdec763c13b4711cd2b8126n],[0x59e26bcea0d48bacd4f263f1acdb5c4f5763473177fffffen,0n],[0xbc58c6611c08dab19bee0f7b5b2444ee633094575b06bcb0e1a92bc3ccbf066n,0x23d5e999e1910a12feb0f6ef0cd21d04a44a9e08737f96e55fe3ed9d730c239fn],[0x30644e72e131a0295e6dd9e7e0acccb0c28f069fbb966e3de4bd44e5607cfd48n,0n],[0x1ee972ae6a826a7d1d9da40771b6f589de1afb54342c724fa97bda050992657fn,0x10de546ff8d4ab51d2b513cdbb25772454326430418536d15721e37e70c255c9n]]],l=t.addFunction(a+"__frobeniusMap"+e);l.addParam("x","i32"),l.addParam("r","i32");let r=l.getCodeBuilder();for(let a=0;a<6;a++){let s=0==a?r.getLocal("x"):r.i32_add(r.getLocal("x"),r.i32_const(a*L)),c=r.i32_add(r.getLocal("x"),r.i32_const(a*L+b)),d=0==a?r.getLocal("r"):r.i32_add(r.getLocal("r"),r.i32_const(a*L)),u=r.i32_add(r.getLocal("r"),r.i32_const(a*L+b)),f=function(t,e){let a=BigInt(t[0]),i=BigInt(t[1]),o=BigInt(e[0]),n=BigInt(e[1]),l=[(a*o-i*n)%0x30644e72e131a029b85045b68181585d97816a916871ca8d3c208c16d87cfd47n,(a*n+i*o)%0x30644e72e131a029b85045b68181585d97816a916871ca8d3c208c16d87cfd47n];return _(l[0])&&(l[0]=l[0]+0x30644e72e131a029b85045b68181585d97816a916871ca8d3c208c16d87cfd47n),l}(o[Math.floor(a/3)][e%12],n[a%3][e%6]),h=t.alloc([...i.bigInt2BytesLE(B(f[0]),32),...i.bigInt2BytesLE(B(f[1]),32)]);e%2==1?l.addCode(r.call(A+"_copy",s,d),r.call(A+"_neg",c,u),r.call(F+"_mul",d,r.i32_const(h),d)):l.addCode(r.call(F+"_mul",s,r.i32_const(h),d))}})(e),t.exportFunction(a+"__frobeniusMap"+e);(function(){let e=t.addFunction(a+"_finalExponentiationOld");e.addParam("x","i32"),e.addParam("r","i32");let o=t.alloc(i.bigInt2BytesLE(0x2f4b6dc97020fddadf107d20bc842d43bf6369b1ff6a1c71015f3f7be2e1e30a73bb94fec0daf15466b2383a5d3ec3d15ad524d8f70c54efee1bd8c3b21377e563a09a1b705887e72eceaddea3790364a61f676baaf977870e88d5c6c8fef0781361e443ae77f5b63a2a2264487f2940a8b1ddb3d15062cd0fb2015dfc6668449aed3cc48a82d0d602d268c7daab6a41294c0cc4ebe5664568dfc50e1648a45a4a1e3a5195846a3ed011a337a02088ec80e0ebae8755cfe107acf3aafb40494e406f804216bb10cf430b0f37856b42db8dc5514724ee93dfb10826f0dd4a0364b9580291d2cd65664814fde37ca80bb4ea44eacc5e641bbadf423f9a2cbf813b8d145da90029baee7ddadda71c7f3811c4105262945bba1668c3be69a3c230974d83561841d766f9c9d570bb7fbe04c7e8a6c3c760c0de81def35692da361102b6b9b2b918837fa97896e84abb40a4efb7e54523a486964b64ca86f120n,352)),n=e.getCodeBuilder();e.addCode(n.call(R+"_exp",n.getLocal("x"),n.i32_const(o),n.i32_const(352),n.getLocal("r")))})(),function(){(function(){let e=t.addFunction(a+"__finalExponentiationFirstChunk");e.addParam("x","i32"),e.addParam("r","i32");let i=e.getCodeBuilder(),o=i.getLocal("x"),n=i.i32_add(o,i.i32_const(6*b)),l=i.getLocal("r"),r=t.alloc(w),s=i.i32_const(r),c=i.i32_const(r+6*b),d=i.i32_const(t.alloc(w)),u=i.i32_const(t.alloc(w)),f=i.i32_const(t.alloc(w));e.addCode(i.call(k+"_copy",o,s),i.call(k+"_neg",n,c),i.call(R+"_inverse",o,d),i.call(R+"_mul",s,d,u),i.call(a+"__frobeniusMap2",u,f),i.call(R+"_mul",u,f,l))})(),function(){(function(){let e=t.addFunction(a+"__cyclotomicSquare");e.addParam("x","i32"),e.addParam("r","i32");let i=e.getCodeBuilder(),o=i.getLocal("x"),n=i.i32_add(i.getLocal("x"),i.i32_const(L)),l=i.i32_add(i.getLocal("x"),i.i32_const(2*L)),r=i.i32_add(i.getLocal("x"),i.i32_const(3*L)),s=i.i32_add(i.getLocal("x"),i.i32_const(4*L)),c=i.i32_add(i.getLocal("x"),i.i32_const(5*L)),d=i.getLocal("r"),u=i.i32_add(i.getLocal("r"),i.i32_const(L)),f=i.i32_add(i.getLocal("r"),i.i32_const(2*L)),h=i.i32_add(i.getLocal("r"),i.i32_const(3*L)),g=i.i32_add(i.getLocal("r"),i.i32_const(4*L)),p=i.i32_add(i.getLocal("r"),i.i32_const(5*L)),_=i.i32_const(t.alloc(L)),m=i.i32_const(t.alloc(L)),b=i.i32_const(t.alloc(L)),w=i.i32_const(t.alloc(L)),y=i.i32_const(t.alloc(L)),A=i.i32_const(t.alloc(L)),C=i.i32_const(t.alloc(L)),I=i.i32_const(t.alloc(L));e.addCode(i.call(F+"_mul",o,s,C),i.call(F+"_mul",s,i.i32_const(U),_),i.call(F+"_add",o,_,_),i.call(F+"_add",o,s,I),i.call(F+"_mul",I,_,_),i.call(F+"_mul",i.i32_const(U),C,I),i.call(F+"_add",C,I,I),i.call(F+"_sub",_,I,_),i.call(F+"_add",C,C,m),i.call(F+"_mul",r,l,C),i.call(F+"_mul",l,i.i32_const(U),b),i.call(F+"_add",r,b,b),i.call(F+"_add",r,l,I),i.call(F+"_mul",I,b,b),i.call(F+"_mul",i.i32_const(U),C,I),i.call(F+"_add",C,I,I),i.call(F+"_sub",b,I,b),i.call(F+"_add",C,C,w),i.call(F+"_mul",n,c,C),i.call(F+"_mul",c,i.i32_const(U),y),i.call(F+"_add",n,y,y),i.call(F+"_add",n,c,I),i.call(F+"_mul",I,y,y),i.call(F+"_mul",i.i32_const(U),C,I),i.call(F+"_add",C,I,I),i.call(F+"_sub",y,I,y),i.call(F+"_add",C,C,A),i.call(F+"_sub",_,o,d),i.call(F+"_add",d,d,d),i.call(F+"_add",_,d,d),i.call(F+"_add",m,s,g),i.call(F+"_add",g,g,g),i.call(F+"_add",m,g,g),i.call(F+"_mul",A,i.i32_const(U),I),i.call(F+"_add",I,r,h),i.call(F+"_add",h,h,h),i.call(F+"_add",I,h,h),i.call(F+"_sub",y,l,f),i.call(F+"_add",f,f,f),i.call(F+"_add",y,f,f),i.call(F+"_sub",b,n,u),i.call(F+"_add",u,u,u),i.call(F+"_add",b,u,u),i.call(F+"_add",w,c,p),i.call(F+"_add",p,p,p),i.call(F+"_add",w,p,p))})(),function(e,i){let o=(function(t){let e=0x44e992b44a6909f1n,a=[];for(;e>0n;){if(p(e)){let t=2-Number(e%4n);a.push(t),e-=BigInt(t)}else a.push(0);e>>=1n}return a})(0).map(t=>-1==t?255:t),n=t.alloc(o),l=t.addFunction(a+"__cyclotomicExp_w0");l.addParam("x","i32"),l.addParam("r","i32"),l.addLocal("bit","i32"),l.addLocal("i","i32");let r=l.getCodeBuilder(),s=r.getLocal("x"),c=r.getLocal("r"),d=r.i32_const(t.alloc(w));l.addCode(r.call(R+"_conjugate",s,d),r.call(R+"_one",c),r.if(r.teeLocal("bit",r.i32_load8_s(r.i32_const(o.length-1),n)),r.if(r.i32_eq(r.getLocal("bit"),r.i32_const(1)),r.call(R+"_mul",c,s,c),r.call(R+"_mul",c,d,c))),r.setLocal("i",r.i32_const(o.length-2)),r.block(r.loop(r.call(a+"__cyclotomicSquare",c,c),r.if(r.teeLocal("bit",r.i32_load8_s(r.getLocal("i"),n)),r.if(r.i32_eq(r.getLocal("bit"),r.i32_const(1)),r.call(R+"_mul",c,s,c),r.call(R+"_mul",c,d,c))),r.br_if(1,r.i32_eqz(r.getLocal("i"))),r.setLocal("i",r.i32_sub(r.getLocal("i"),r.i32_const(1))),r.br(0))))}(0,0);let e=t.addFunction(a+"__finalExponentiationLastChunk");e.addParam("x","i32"),e.addParam("r","i32");let i=e.getCodeBuilder(),o=i.getLocal("x"),n=i.getLocal("r"),l=i.i32_const(t.alloc(w)),r=i.i32_const(t.alloc(w)),s=i.i32_const(t.alloc(w)),c=i.i32_const(t.alloc(w)),d=i.i32_const(t.alloc(w)),u=i.i32_const(t.alloc(w)),f=i.i32_const(t.alloc(w)),h=i.i32_const(t.alloc(w)),g=i.i32_const(t.alloc(w)),_=i.i32_const(t.alloc(w)),m=i.i32_const(t.alloc(w)),b=i.i32_const(t.alloc(w)),y=i.i32_const(t.alloc(w)),A=i.i32_const(t.alloc(w)),C=i.i32_const(t.alloc(w)),I=i.i32_const(t.alloc(w)),x=i.i32_const(t.alloc(w)),E=i.i32_const(t.alloc(w)),v=i.i32_const(t.alloc(w)),B=i.i32_const(t.alloc(w)),S=i.i32_const(t.alloc(w));e.addCode(i.call(a+"__cyclotomicExp_w0",o,l),i.call(R+"_conjugate",l,l),i.call(a+"__cyclotomicSquare",l,r),i.call(a+"__cyclotomicSquare",r,s),i.call(R+"_mul",s,r,c),i.call(a+"__cyclotomicExp_w0",c,d),i.call(R+"_conjugate",d,d),i.call(a+"__cyclotomicSquare",d,u),i.call(a+"__cyclotomicExp_w0",u,f),i.call(R+"_conjugate",f,f),i.call(R+"_conjugate",c,h),i.call(R+"_conjugate",f,g),i.call(R+"_mul",g,d,_),i.call(R+"_mul",_,h,m),i.call(R+"_mul",m,r,b),i.call(R+"_mul",m,d,y),i.call(R+"_mul",y,o,A),i.call(a+"__frobeniusMap1",b,C),i.call(R+"_mul",C,A,I),i.call(a+"__frobeniusMap2",m,x),i.call(R+"_mul",x,I,E),i.call(R+"_conjugate",o,v),i.call(R+"_mul",v,b,B),i.call(a+"__frobeniusMap3",B,S),i.call(R+"_mul",S,E,n))}();let e=t.addFunction(a+"_finalExponentiation");e.addParam("x","i32"),e.addParam("r","i32");let i=e.getCodeBuilder(),o=i.getLocal("x"),n=i.getLocal("r"),l=i.i32_const(t.alloc(w));e.addCode(i.call(a+"__finalExponentiationFirstChunk",o,l),i.call(a+"__finalExponentiationLastChunk",l,n))}();for(let e=1;e<=5;e++)(function(e){let i=t.addFunction(a+"_pairingEq"+e);for(let t=0;t<e;t++)i.addParam("p_"+t,"i32"),i.addParam("q_"+t,"i32");i.addParam("c","i32"),i.setReturnType("i32");let o=i.getCodeBuilder(),n=o.i32_const(t.alloc(w)),l=o.i32_const(t.alloc(w));i.addCode(o.call(R+"_one",n));for(let t=0;t<e;t++)i.addCode(o.call(a+"_prepareG1",o.getLocal("p_"+t),o.i32_const(Z))),i.addCode(o.call(a+"_prepareG2",o.getLocal("q_"+t),o.i32_const(W))),i.addCode(o.call(a+"_millerLoop",o.i32_const(Z),o.i32_const(W),l)),i.addCode(o.call(R+"_mul",n,l,n));i.addCode(o.call(a+"_finalExponentiation",n,n)),i.addCode(o.call(R+"_eq",n,o.getLocal("c")))})(e),t.exportFunction(a+"_pairingEq"+e);(function(){let e=t.addFunction(a+"_pairing");e.addParam("p","i32"),e.addParam("q","i32"),e.addParam("r","i32");let i=e.getCodeBuilder(),o=i.i32_const(t.alloc(w));e.addCode(i.call(a+"_prepareG1",i.getLocal("p"),i.i32_const(Z))),e.addCode(i.call(a+"_prepareG2",i.getLocal("q"),i.i32_const(W))),e.addCode(i.call(a+"_millerLoop",i.i32_const(Z),i.i32_const(W),o)),e.addCode(i.call(a+"_finalExponentiation",o,i.getLocal("r")))})(),t.exportFunction(a+"_pairing"),t.exportFunction(a+"_prepareG1"),t.exportFunction(a+"_prepareG2"),t.exportFunction(a+"_millerLoop"),t.exportFunction(a+"_finalExponentiation"),t.exportFunction(a+"_finalExponentiationOld"),t.exportFunction(a+"__mulBy024"),t.exportFunction(a+"__mulBy024Old"),t.exportFunction(a+"__cyclotomicSquare"),t.exportFunction(a+"__cyclotomicExp_w0")}},2929:t=>{t.exports=function(t,e,a,i,o,n,l,r){let s=t.addFunction(e);s.addParam("pIn","i32"),s.addParam("n","i32"),s.addParam("pFirst","i32"),s.addParam("pInc","i32"),s.addParam("pOut","i32"),s.addLocal("pOldFree","i32"),s.addLocal("i","i32"),s.addLocal("pFrom","i32"),s.addLocal("pTo","i32");let c=s.getCodeBuilder(),d=c.i32_const(t.alloc(l));s.addCode(c.setLocal("pFrom",c.getLocal("pIn")),c.setLocal("pTo",c.getLocal("pOut"))),s.addCode(c.call(i+"_copy",c.getLocal("pFirst"),d)),s.addCode(c.setLocal("i",c.i32_const(0)),c.block(c.loop(c.br_if(1,c.i32_eq(c.getLocal("i"),c.getLocal("n"))),c.call(r,c.getLocal("pFrom"),d,c.getLocal("pTo")),c.setLocal("pFrom",c.i32_add(c.getLocal("pFrom"),c.i32_const(o))),c.setLocal("pTo",c.i32_add(c.getLocal("pTo"),c.i32_const(n))),c.call(i+"_mul",d,c.getLocal("pInc"),d),c.setLocal("i",c.i32_add(c.getLocal("i"),c.i32_const(1))),c.br(0)))),t.exportFunction(e)}},8002:t=>{t.exports=function(t,e,a,i,o,n){void 0===n&&(n=i<o);let l=t.addFunction(e);l.addParam("pIn","i32"),l.addParam("n","i32"),l.addParam("pOut","i32"),l.addLocal("i","i32"),l.addLocal("itIn","i32"),l.addLocal("itOut","i32");let r=l.getCodeBuilder();n?l.addCode(r.setLocal("itIn",r.i32_add(r.getLocal("pIn"),r.i32_mul(r.i32_sub(r.getLocal("n"),r.i32_const(1)),r.i32_const(i)))),r.setLocal("itOut",r.i32_add(r.getLocal("pOut"),r.i32_mul(r.i32_sub(r.getLocal("n"),r.i32_const(1)),r.i32_const(o)))),r.setLocal("i",r.i32_const(0)),r.block(r.loop(r.br_if(1,r.i32_eq(r.getLocal("i"),r.getLocal("n"))),r.call(a,r.getLocal("itIn"),r.getLocal("itOut")),r.setLocal("itIn",r.i32_sub(r.getLocal("itIn"),r.i32_const(i))),r.setLocal("itOut",r.i32_sub(r.getLocal("itOut"),r.i32_const(o))),r.setLocal("i",r.i32_add(r.getLocal("i"),r.i32_const(1))),r.br(0)))):l.addCode(r.setLocal("itIn",r.getLocal("pIn")),r.setLocal("itOut",r.getLocal("pOut")),r.setLocal("i",r.i32_const(0)),r.block(r.loop(r.br_if(1,r.i32_eq(r.getLocal("i"),r.getLocal("n"))),r.call(a,r.getLocal("itIn"),r.getLocal("itOut")),r.setLocal("itIn",r.i32_add(r.getLocal("itIn"),r.i32_const(i))),r.setLocal("itOut",r.i32_add(r.getLocal("itOut"),r.i32_const(o))),r.setLocal("i",r.i32_add(r.getLocal("i"),r.i32_const(1))),r.br(0))))}},7078:t=>{t.exports=function(t,e){let a=8*t.modules[e].n64,i=t.addFunction(e+"_batchInverse");i.addParam("pIn","i32"),i.addParam("inStep","i32"),i.addParam("n","i32"),i.addParam("pOut","i32"),i.addParam("outStep","i32"),i.addLocal("itAux","i32"),i.addLocal("itIn","i32"),i.addLocal("itOut","i32"),i.addLocal("i","i32");let o=i.getCodeBuilder(),n=o.i32_const(t.alloc(a));i.addCode(o.setLocal("itAux",o.i32_load(o.i32_const(0))),o.i32_store(o.i32_const(0),o.i32_add(o.getLocal("itAux"),o.i32_mul(o.i32_add(o.getLocal("n"),o.i32_const(1)),o.i32_const(a))))),i.addCode(o.call(e+"_one",o.getLocal("itAux")),o.setLocal("itIn",o.getLocal("pIn")),o.setLocal("itAux",o.i32_add(o.getLocal("itAux"),o.i32_const(a))),o.setLocal("i",o.i32_const(0)),o.block(o.loop(o.br_if(1,o.i32_eq(o.getLocal("i"),o.getLocal("n"))),o.if(o.call(e+"_isZero",o.getLocal("itIn")),o.call(e+"_copy",o.i32_sub(o.getLocal("itAux"),o.i32_const(a)),o.getLocal("itAux")),o.call(e+"_mul",o.getLocal("itIn"),o.i32_sub(o.getLocal("itAux"),o.i32_const(a)),o.getLocal("itAux"))),o.setLocal("itIn",o.i32_add(o.getLocal("itIn"),o.getLocal("inStep"))),o.setLocal("itAux",o.i32_add(o.getLocal("itAux"),o.i32_const(a))),o.setLocal("i",o.i32_add(o.getLocal("i"),o.i32_const(1))),o.br(0))),o.setLocal("itIn",o.i32_sub(o.getLocal("itIn"),o.getLocal("inStep"))),o.setLocal("itAux",o.i32_sub(o.getLocal("itAux"),o.i32_const(a))),o.setLocal("itOut",o.i32_add(o.getLocal("pOut"),o.i32_mul(o.i32_sub(o.getLocal("n"),o.i32_const(1)),o.getLocal("outStep")))),o.call(e+"_inverse",o.getLocal("itAux"),o.getLocal("itAux")),o.block(o.loop(o.br_if(1,o.i32_eqz(o.getLocal("i"))),o.if(o.call(e+"_isZero",o.getLocal("itIn")),[...o.call(e+"_copy",o.getLocal("itAux"),o.i32_sub(o.getLocal("itAux"),o.i32_const(a))),...o.call(e+"_zero",o.getLocal("itOut"))],[...o.call(e+"_copy",o.i32_sub(o.getLocal("itAux"),o.i32_const(a)),n),...o.call(e+"_mul",o.getLocal("itAux"),o.getLocal("itIn"),o.i32_sub(o.getLocal("itAux"),o.i32_const(a))),...o.call(e+"_mul",o.getLocal("itAux"),n,o.getLocal("itOut"))]),o.setLocal("itIn",o.i32_sub(o.getLocal("itIn"),o.getLocal("inStep"))),o.setLocal("itOut",o.i32_sub(o.getLocal("itOut"),o.getLocal("outStep"))),o.setLocal("itAux",o.i32_sub(o.getLocal("itAux"),o.i32_const(a))),o.setLocal("i",o.i32_sub(o.getLocal("i"),o.i32_const(1))),o.br(0)))),i.addCode(o.i32_store(o.i32_const(0),o.getLocal("itAux")))}},6336:t=>{t.exports=function(t,e,a,i,o,n){void 0===n&&(n=i<o);let l=t.addFunction(e);l.addParam("pIn1","i32"),l.addParam("pIn2","i32"),l.addParam("n","i32"),l.addParam("pOut","i32"),l.addLocal("i","i32"),l.addLocal("itIn1","i32"),l.addLocal("itIn2","i32"),l.addLocal("itOut","i32");let r=l.getCodeBuilder();n?l.addCode(r.setLocal("itIn1",r.i32_add(r.getLocal("pIn1"),r.i32_mul(r.i32_sub(r.getLocal("n"),r.i32_const(1)),r.i32_const(i)))),r.setLocal("itIn2",r.i32_add(r.getLocal("pIn2"),r.i32_mul(r.i32_sub(r.getLocal("n"),r.i32_const(1)),r.i32_const(i)))),r.setLocal("itOut",r.i32_add(r.getLocal("pOut"),r.i32_mul(r.i32_sub(r.getLocal("n"),r.i32_const(1)),r.i32_const(o)))),r.setLocal("i",r.i32_const(0)),r.block(r.loop(r.br_if(1,r.i32_eq(r.getLocal("i"),r.getLocal("n"))),r.call(a,r.getLocal("itIn1"),r.getLocal("itIn2"),r.getLocal("itOut")),r.setLocal("itIn1",r.i32_sub(r.getLocal("itIn1"),r.i32_const(i))),r.setLocal("itIn2",r.i32_sub(r.getLocal("itIn2"),r.i32_const(i))),r.setLocal("itOut",r.i32_sub(r.getLocal("itOut"),r.i32_const(o))),r.setLocal("i",r.i32_add(r.getLocal("i"),r.i32_const(1))),r.br(0)))):l.addCode(r.setLocal("itIn1",r.getLocal("pIn1")),r.setLocal("itIn2",r.getLocal("pIn2")),r.setLocal("itOut",r.getLocal("pOut")),r.setLocal("i",r.i32_const(0)),r.block(r.loop(r.br_if(1,r.i32_eq(r.getLocal("i"),r.getLocal("n"))),r.call(a,r.getLocal("itIn1"),r.getLocal("itIn2"),r.getLocal("itOut")),r.setLocal("itIn1",r.i32_add(r.getLocal("itIn1"),r.i32_const(i))),r.setLocal("itIn2",r.i32_add(r.getLocal("itIn2"),r.i32_const(i))),r.setLocal("itOut",r.i32_add(r.getLocal("itOut"),r.i32_const(o))),r.setLocal("i",r.i32_add(r.getLocal("i"),r.i32_const(1))),r.br(0))))}},7644:(t,e,a)=>{let i=a(1738),o=a(8002),n=a(3549);t.exports=function(t,e,a,l){let r=t.modules[a].n64,s=8*r;return t.modules[e]||(t.modules[e]={n64:3*r},function(){let i=t.addFunction(e+"_isZeroAffine");i.addParam("p1","i32"),i.setReturnType("i32");let o=i.getCodeBuilder();i.addCode(o.i32_and(o.call(a+"_isZero",o.getLocal("p1")),o.call(a+"_isZero",o.i32_add(o.getLocal("p1"),o.i32_const(s)))))}(),function(){let i=t.addFunction(e+"_isZero");i.addParam("p1","i32"),i.setReturnType("i32");let o=i.getCodeBuilder();i.addCode(o.call(a+"_isZero",o.i32_add(o.getLocal("p1"),o.i32_const(2*s))))}(),function(){let i=t.addFunction(e+"_zeroAffine");i.addParam("pr","i32");let o=i.getCodeBuilder();i.addCode(o.call(a+"_zero",o.getLocal("pr"))),i.addCode(o.call(a+"_zero",o.i32_add(o.getLocal("pr"),o.i32_const(s))))}(),function(){let i=t.addFunction(e+"_zero");i.addParam("pr","i32");let o=i.getCodeBuilder();i.addCode(o.call(a+"_zero",o.getLocal("pr"))),i.addCode(o.call(a+"_one",o.i32_add(o.getLocal("pr"),o.i32_const(s)))),i.addCode(o.call(a+"_zero",o.i32_add(o.getLocal("pr"),o.i32_const(2*s))))}(),function(){let a=t.addFunction(e+"_copyAffine");a.addParam("ps","i32"),a.addParam("pd","i32");let i=a.getCodeBuilder();for(let t=0;t<2*r;t++)a.addCode(i.i64_store(i.getLocal("pd"),8*t,i.i64_load(i.getLocal("ps"),8*t)))}(),function(){let a=t.addFunction(e+"_copy");a.addParam("ps","i32"),a.addParam("pd","i32");let i=a.getCodeBuilder();for(let t=0;t<3*r;t++)a.addCode(i.i64_store(i.getLocal("pd"),8*t,i.i64_load(i.getLocal("ps"),8*t)))}(),function(){let i=t.addFunction(e+"_toJacobian");i.addParam("p1","i32"),i.addParam("pr","i32");let o=i.getCodeBuilder(),n=o.getLocal("p1"),l=o.i32_add(o.getLocal("p1"),o.i32_const(s)),r=o.getLocal("pr"),c=o.i32_add(o.getLocal("pr"),o.i32_const(s)),d=o.i32_add(o.getLocal("pr"),o.i32_const(2*s));i.addCode(o.if(o.call(e+"_isZeroAffine",o.getLocal("p1")),o.call(e+"_zero",o.getLocal("pr")),[...o.call(a+"_one",d),...o.call(a+"_copy",l,c),...o.call(a+"_copy",n,r)]))}(),function(){let i=t.addFunction(e+"_eqAffine");i.addParam("p1","i32"),i.addParam("p2","i32"),i.setReturnType("i32"),i.addLocal("z1","i32");let o=i.getCodeBuilder();i.addCode(o.ret(o.i32_and(o.call(a+"_eq",o.getLocal("p1"),o.getLocal("p2")),o.call(a+"_eq",o.i32_add(o.getLocal("p1"),o.i32_const(s)),o.i32_add(o.getLocal("p2"),o.i32_const(s))))))}(),function(){let i=t.addFunction(e+"_eqMixed");i.addParam("p1","i32"),i.addParam("p2","i32"),i.setReturnType("i32"),i.addLocal("z1","i32");let o=i.getCodeBuilder(),n=o.getLocal("p1"),l=o.i32_add(o.getLocal("p1"),o.i32_const(s));i.addCode(o.setLocal("z1",o.i32_add(o.getLocal("p1"),o.i32_const(2*s))));let r=o.getLocal("z1"),c=o.getLocal("p2"),d=o.i32_add(o.getLocal("p2"),o.i32_const(s)),u=o.i32_const(t.alloc(s)),f=o.i32_const(t.alloc(s)),h=o.i32_const(t.alloc(s)),g=o.i32_const(t.alloc(s));i.addCode(o.if(o.call(e+"_isZero",o.getLocal("p1")),o.ret(o.call(e+"_isZeroAffine",o.getLocal("p2")))),o.if(o.call(e+"_isZeroAffine",o.getLocal("p2")),o.ret(o.i32_const(0))),o.if(o.call(a+"_isOne",r),o.ret(o.call(e+"_eqAffine",o.getLocal("p1"),o.getLocal("p2")))),o.call(a+"_square",r,u),o.call(a+"_mul",c,u,f),o.call(a+"_mul",r,u,h),o.call(a+"_mul",d,h,g),o.if(o.call(a+"_eq",n,f),o.if(o.call(a+"_eq",l,g),o.ret(o.i32_const(1)))),o.ret(o.i32_const(0)))}(),function(){let i=t.addFunction(e+"_eq");i.addParam("p1","i32"),i.addParam("p2","i32"),i.setReturnType("i32"),i.addLocal("z1","i32"),i.addLocal("z2","i32");let o=i.getCodeBuilder(),n=o.getLocal("p1"),l=o.i32_add(o.getLocal("p1"),o.i32_const(s));i.addCode(o.setLocal("z1",o.i32_add(o.getLocal("p1"),o.i32_const(2*s))));let r=o.getLocal("z1"),c=o.getLocal("p2"),d=o.i32_add(o.getLocal("p2"),o.i32_const(s));i.addCode(o.setLocal("z2",o.i32_add(o.getLocal("p2"),o.i32_const(2*s))));let u=o.getLocal("z2"),f=o.i32_const(t.alloc(s)),h=o.i32_const(t.alloc(s)),g=o.i32_const(t.alloc(s)),p=o.i32_const(t.alloc(s)),_=o.i32_const(t.alloc(s)),m=o.i32_const(t.alloc(s)),b=o.i32_const(t.alloc(s)),L=o.i32_const(t.alloc(s));i.addCode(o.if(o.call(e+"_isZero",o.getLocal("p1")),o.ret(o.call(e+"_isZero",o.getLocal("p2")))),o.if(o.call(e+"_isZero",o.getLocal("p2")),o.ret(o.i32_const(0))),o.if(o.call(a+"_isOne",r),o.ret(o.call(e+"_eqMixed",o.getLocal("p2"),o.getLocal("p1")))),o.if(o.call(a+"_isOne",u),o.ret(o.call(e+"_eqMixed",o.getLocal("p1"),o.getLocal("p2")))),o.call(a+"_square",r,f),o.call(a+"_square",u,h),o.call(a+"_mul",n,h,g),o.call(a+"_mul",c,f,p),o.call(a+"_mul",r,f,_),o.call(a+"_mul",u,h,m),o.call(a+"_mul",l,m,b),o.call(a+"_mul",d,_,L),o.if(o.call(a+"_eq",g,p),o.if(o.call(a+"_eq",b,L),o.ret(o.i32_const(1)))),o.ret(o.i32_const(0)))}(),function(){let i=t.addFunction(e+"_doubleAffine");i.addParam("p1","i32"),i.addParam("pr","i32");let o=i.getCodeBuilder(),n=o.getLocal("p1"),l=o.i32_add(o.getLocal("p1"),o.i32_const(s)),r=o.getLocal("pr"),c=o.i32_add(o.getLocal("pr"),o.i32_const(s)),d=o.i32_add(o.getLocal("pr"),o.i32_const(2*s)),u=o.i32_const(t.alloc(s)),f=o.i32_const(t.alloc(s)),h=o.i32_const(t.alloc(s)),g=o.i32_const(t.alloc(s)),p=o.i32_const(t.alloc(s)),_=o.i32_const(t.alloc(s));i.addCode(o.if(o.call(e+"_isZeroAffine",o.getLocal("p1")),[...o.call(e+"_toJacobian",o.getLocal("p1"),o.getLocal("pr")),...o.ret([])]),o.call(a+"_square",n,u),o.call(a+"_square",l,f),o.call(a+"_square",f,h),o.call(a+"_add",n,f,g),o.call(a+"_square",g,g),o.call(a+"_sub",g,u,g),o.call(a+"_sub",g,h,g),o.call(a+"_add",g,g,g),o.call(a+"_add",u,u,p),o.call(a+"_add",p,u,p),o.call(a+"_add",l,l,d),o.call(a+"_square",p,r),o.call(a+"_sub",r,g,r),o.call(a+"_sub",r,g,r),o.call(a+"_add",h,h,_),o.call(a+"_add",_,_,_),o.call(a+"_add",_,_,_),o.call(a+"_sub",g,r,c),o.call(a+"_mul",c,p,c),o.call(a+"_sub",c,_,c))}(),function(){let i=t.addFunction(e+"_double");i.addParam("p1","i32"),i.addParam("pr","i32");let o=i.getCodeBuilder(),n=o.getLocal("p1"),l=o.i32_add(o.getLocal("p1"),o.i32_const(s)),r=o.i32_add(o.getLocal("p1"),o.i32_const(2*s)),c=o.getLocal("pr"),d=o.i32_add(o.getLocal("pr"),o.i32_const(s)),u=o.i32_add(o.getLocal("pr"),o.i32_const(2*s)),f=o.i32_const(t.alloc(s)),h=o.i32_const(t.alloc(s)),g=o.i32_const(t.alloc(s)),p=o.i32_const(t.alloc(s)),_=o.i32_const(t.alloc(s)),m=o.i32_const(t.alloc(s)),b=o.i32_const(t.alloc(s)),L=o.i32_const(t.alloc(s));i.addCode(o.if(o.call(e+"_isZero",o.getLocal("p1")),[...o.call(e+"_copy",o.getLocal("p1"),o.getLocal("pr")),...o.ret([])]),o.if(o.call(a+"_isOne",r),[...o.ret(o.call(e+"_doubleAffine",o.getLocal("p1"),o.getLocal("pr"))),...o.ret([])]),o.call(a+"_square",n,f),o.call(a+"_square",l,h),o.call(a+"_square",h,g),o.call(a+"_add",n,h,p),o.call(a+"_square",p,p),o.call(a+"_sub",p,f,p),o.call(a+"_sub",p,g,p),o.call(a+"_add",p,p,p),o.call(a+"_add",f,f,_),o.call(a+"_add",_,f,_),o.call(a+"_square",_,m),o.call(a+"_mul",l,r,b),o.call(a+"_add",p,p,c),o.call(a+"_sub",m,c,c),o.call(a+"_add",g,g,L),o.call(a+"_add",L,L,L),o.call(a+"_add",L,L,L),o.call(a+"_sub",p,c,d),o.call(a+"_mul",d,_,d),o.call(a+"_sub",d,L,d),o.call(a+"_add",b,b,u))}(),function(){let i=t.addFunction(e+"_addAffine");i.addParam("p1","i32"),i.addParam("p2","i32"),i.addParam("pr","i32"),i.addLocal("z1","i32");let o=i.getCodeBuilder(),n=o.getLocal("p1"),l=o.i32_add(o.getLocal("p1"),o.i32_const(s));i.addCode(o.setLocal("z1",o.i32_add(o.getLocal("p1"),o.i32_const(2*s))));let r=o.getLocal("p2"),c=o.i32_add(o.getLocal("p2"),o.i32_const(s)),d=o.getLocal("pr"),u=o.i32_add(o.getLocal("pr"),o.i32_const(s)),f=o.i32_add(o.getLocal("pr"),o.i32_const(2*s)),h=o.i32_const(t.alloc(s)),g=o.i32_const(t.alloc(s)),p=o.i32_const(t.alloc(s)),_=o.i32_const(t.alloc(s)),m=o.i32_const(t.alloc(s)),b=o.i32_const(t.alloc(s)),L=o.i32_const(t.alloc(s)),w=o.i32_const(t.alloc(s)),y=o.i32_const(t.alloc(s)),A=o.i32_const(t.alloc(s));i.addCode(o.if(o.call(e+"_isZeroAffine",o.getLocal("p1")),[...o.call(e+"_copyAffine",o.getLocal("p2"),o.getLocal("pr")),...o.call(a+"_one",o.i32_add(o.getLocal("pr"),o.i32_const(2*s))),...o.ret([])]),o.if(o.call(e+"_isZeroAffine",o.getLocal("p2")),[...o.call(e+"_copyAffine",o.getLocal("p1"),o.getLocal("pr")),...o.call(a+"_one",o.i32_add(o.getLocal("pr"),o.i32_const(2*s))),...o.ret([])]),o.if(o.call(a+"_eq",n,r),o.if(o.call(a+"_eq",l,c),[...o.call(e+"_doubleAffine",o.getLocal("p2"),o.getLocal("pr")),...o.ret([])])),o.call(a+"_sub",r,n,h),o.call(a+"_sub",c,l,p),o.call(a+"_square",h,g),o.call(a+"_add",g,g,_),o.call(a+"_add",_,_,_),o.call(a+"_mul",h,_,m),o.call(a+"_add",p,p,b),o.call(a+"_mul",n,_,w),o.call(a+"_square",b,L),o.call(a+"_add",w,w,y),o.call(a+"_sub",L,m,d),o.call(a+"_sub",d,y,d),o.call(a+"_mul",l,m,A),o.call(a+"_add",A,A,A),o.call(a+"_sub",w,d,u),o.call(a+"_mul",u,b,u),o.call(a+"_sub",u,A,u),o.call(a+"_add",h,h,f))}(),function(){let i=t.addFunction(e+"_addMixed");i.addParam("p1","i32"),i.addParam("p2","i32"),i.addParam("pr","i32"),i.addLocal("z1","i32");let o=i.getCodeBuilder(),n=o.getLocal("p1"),l=o.i32_add(o.getLocal("p1"),o.i32_const(s));i.addCode(o.setLocal("z1",o.i32_add(o.getLocal("p1"),o.i32_const(2*s))));let r=o.getLocal("z1"),c=o.getLocal("p2"),d=o.i32_add(o.getLocal("p2"),o.i32_const(s)),u=o.getLocal("pr"),f=o.i32_add(o.getLocal("pr"),o.i32_const(s)),h=o.i32_add(o.getLocal("pr"),o.i32_const(2*s)),g=o.i32_const(t.alloc(s)),p=o.i32_const(t.alloc(s)),_=o.i32_const(t.alloc(s)),m=o.i32_const(t.alloc(s)),b=o.i32_const(t.alloc(s)),L=o.i32_const(t.alloc(s)),w=o.i32_const(t.alloc(s)),y=o.i32_const(t.alloc(s)),A=o.i32_const(t.alloc(s)),C=o.i32_const(t.alloc(s)),I=o.i32_const(t.alloc(s)),F=o.i32_const(t.alloc(s)),x=o.i32_const(t.alloc(s)),E=o.i32_const(t.alloc(s));i.addCode(o.if(o.call(e+"_isZero",o.getLocal("p1")),[...o.call(e+"_copyAffine",o.getLocal("p2"),o.getLocal("pr")),...o.call(a+"_one",o.i32_add(o.getLocal("pr"),o.i32_const(2*s))),...o.ret([])]),o.if(o.call(e+"_isZeroAffine",o.getLocal("p2")),[...o.call(e+"_copy",o.getLocal("p1"),o.getLocal("pr")),...o.ret([])]),o.if(o.call(a+"_isOne",r),[...o.call(e+"_addAffine",n,c,u),...o.ret([])]),o.call(a+"_square",r,g),o.call(a+"_mul",c,g,p),o.call(a+"_mul",r,g,_),o.call(a+"_mul",d,_,m),o.if(o.call(a+"_eq",n,p),o.if(o.call(a+"_eq",l,m),[...o.call(e+"_doubleAffine",o.getLocal("p2"),o.getLocal("pr")),...o.ret([])])),o.call(a+"_sub",p,n,b),o.call(a+"_sub",m,l,w),o.call(a+"_square",b,L),o.call(a+"_add",L,L,y),o.call(a+"_add",y,y,y),o.call(a+"_mul",b,y,A),o.call(a+"_add",w,w,C),o.call(a+"_mul",n,y,F),o.call(a+"_square",C,I),o.call(a+"_add",F,F,x),o.call(a+"_sub",I,A,u),o.call(a+"_sub",u,x,u),o.call(a+"_mul",l,A,E),o.call(a+"_add",E,E,E),o.call(a+"_sub",F,u,f),o.call(a+"_mul",f,C,f),o.call(a+"_sub",f,E,f),o.call(a+"_add",r,b,h),o.call(a+"_square",h,h),o.call(a+"_sub",h,g,h),o.call(a+"_sub",h,L,h))}(),function(){let i=t.addFunction(e+"_add");i.addParam("p1","i32"),i.addParam("p2","i32"),i.addParam("pr","i32"),i.addLocal("z1","i32"),i.addLocal("z2","i32");let o=i.getCodeBuilder(),n=o.getLocal("p1"),l=o.i32_add(o.getLocal("p1"),o.i32_const(s));i.addCode(o.setLocal("z1",o.i32_add(o.getLocal("p1"),o.i32_const(2*s))));let r=o.getLocal("z1"),c=o.getLocal("p2"),d=o.i32_add(o.getLocal("p2"),o.i32_const(s));i.addCode(o.setLocal("z2",o.i32_add(o.getLocal("p2"),o.i32_const(2*s))));let u=o.getLocal("z2"),f=o.getLocal("pr"),h=o.i32_add(o.getLocal("pr"),o.i32_const(s)),g=o.i32_add(o.getLocal("pr"),o.i32_const(2*s)),p=o.i32_const(t.alloc(s)),_=o.i32_const(t.alloc(s)),m=o.i32_const(t.alloc(s)),b=o.i32_const(t.alloc(s)),L=o.i32_const(t.alloc(s)),w=o.i32_const(t.alloc(s)),y=o.i32_const(t.alloc(s)),A=o.i32_const(t.alloc(s)),C=o.i32_const(t.alloc(s)),I=o.i32_const(t.alloc(s)),F=o.i32_const(t.alloc(s)),x=o.i32_const(t.alloc(s)),E=o.i32_const(t.alloc(s)),v=o.i32_const(t.alloc(s)),B=o.i32_const(t.alloc(s)),S=o.i32_const(t.alloc(s)),O=o.i32_const(t.alloc(s));i.addCode(o.if(o.call(e+"_isZero",o.getLocal("p1")),[...o.call(e+"_copy",o.getLocal("p2"),o.getLocal("pr")),...o.ret([])]),o.if(o.call(e+"_isZero",o.getLocal("p2")),[...o.call(e+"_copy",o.getLocal("p1"),o.getLocal("pr")),...o.ret([])]),o.if(o.call(a+"_isOne",r),[...o.call(e+"_addMixed",c,n,f),...o.ret([])]),o.if(o.call(a+"_isOne",u),[...o.call(e+"_addMixed",n,c,f),...o.ret([])]),o.call(a+"_square",r,p),o.call(a+"_square",u,_),o.call(a+"_mul",n,_,m),o.call(a+"_mul",c,p,b),o.call(a+"_mul",r,p,L),o.call(a+"_mul",u,_,w),o.call(a+"_mul",l,w,y),o.call(a+"_mul",d,L,A),o.if(o.call(a+"_eq",m,b),o.if(o.call(a+"_eq",y,A),[...o.call(e+"_double",o.getLocal("p1"),o.getLocal("pr")),...o.ret([])])),o.call(a+"_sub",b,m,C),o.call(a+"_sub",A,y,I),o.call(a+"_add",C,C,F),o.call(a+"_square",F,F),o.call(a+"_mul",C,F,x),o.call(a+"_add",I,I,E),o.call(a+"_mul",m,F,B),o.call(a+"_square",E,v),o.call(a+"_add",B,B,S),o.call(a+"_sub",v,x,f),o.call(a+"_sub",f,S,f),o.call(a+"_mul",y,x,O),o.call(a+"_add",O,O,O),o.call(a+"_sub",B,f,h),o.call(a+"_mul",h,E,h),o.call(a+"_sub",h,O,h),o.call(a+"_add",r,u,g),o.call(a+"_square",g,g),o.call(a+"_sub",g,p,g),o.call(a+"_sub",g,_,g),o.call(a+"_mul",g,C,g))}(),function(){let i=t.addFunction(e+"_negAffine");i.addParam("p1","i32"),i.addParam("pr","i32");let o=i.getCodeBuilder(),n=o.getLocal("p1"),l=o.i32_add(o.getLocal("p1"),o.i32_const(s)),r=o.getLocal("pr"),c=o.i32_add(o.getLocal("pr"),o.i32_const(s));i.addCode(o.call(a+"_copy",n,r),o.call(a+"_neg",l,c))}(),function(){let i=t.addFunction(e+"_neg");i.addParam("p1","i32"),i.addParam("pr","i32");let o=i.getCodeBuilder(),n=o.getLocal("p1"),l=o.i32_add(o.getLocal("p1"),o.i32_const(s)),r=o.i32_add(o.getLocal("p1"),o.i32_const(2*s)),c=o.getLocal("pr"),d=o.i32_add(o.getLocal("pr"),o.i32_const(s)),u=o.i32_add(o.getLocal("pr"),o.i32_const(2*s));i.addCode(o.call(a+"_copy",n,c),o.call(a+"_neg",l,d),o.call(a+"_copy",r,u))}(),function(){let a=t.addFunction(e+"_subAffine");a.addParam("p1","i32"),a.addParam("p2","i32"),a.addParam("pr","i32");let i=a.getCodeBuilder(),o=i.i32_const(t.alloc(3*s));a.addCode(i.call(e+"_negAffine",i.getLocal("p2"),o),i.call(e+"_addAffine",i.getLocal("p1"),o,i.getLocal("pr")))}(),function(){let a=t.addFunction(e+"_subMixed");a.addParam("p1","i32"),a.addParam("p2","i32"),a.addParam("pr","i32");let i=a.getCodeBuilder(),o=i.i32_const(t.alloc(3*s));a.addCode(i.call(e+"_negAffine",i.getLocal("p2"),o),i.call(e+"_addMixed",i.getLocal("p1"),o,i.getLocal("pr")))}(),function(){let a=t.addFunction(e+"_sub");a.addParam("p1","i32"),a.addParam("p2","i32"),a.addParam("pr","i32");let i=a.getCodeBuilder(),o=i.i32_const(t.alloc(3*s));a.addCode(i.call(e+"_neg",i.getLocal("p2"),o),i.call(e+"_add",i.getLocal("p1"),o,i.getLocal("pr")))}(),function(){let i=t.addFunction(e+"_fromMontgomeryAffine");i.addParam("p1","i32"),i.addParam("pr","i32");let o=i.getCodeBuilder();i.addCode(o.call(a+"_fromMontgomery",o.getLocal("p1"),o.getLocal("pr")));for(let t=1;t<2;t++)i.addCode(o.call(a+"_fromMontgomery",o.i32_add(o.getLocal("p1"),o.i32_const(t*s)),o.i32_add(o.getLocal("pr"),o.i32_const(t*s))))}(),function(){let i=t.addFunction(e+"_fromMontgomery");i.addParam("p1","i32"),i.addParam("pr","i32");let o=i.getCodeBuilder();i.addCode(o.call(a+"_fromMontgomery",o.getLocal("p1"),o.getLocal("pr")));for(let t=1;t<3;t++)i.addCode(o.call(a+"_fromMontgomery",o.i32_add(o.getLocal("p1"),o.i32_const(t*s)),o.i32_add(o.getLocal("pr"),o.i32_const(t*s))))}(),function(){let i=t.addFunction(e+"_toMontgomeryAffine");i.addParam("p1","i32"),i.addParam("pr","i32");let o=i.getCodeBuilder();i.addCode(o.call(a+"_toMontgomery",o.getLocal("p1"),o.getLocal("pr")));for(let t=1;t<2;t++)i.addCode(o.call(a+"_toMontgomery",o.i32_add(o.getLocal("p1"),o.i32_const(t*s)),o.i32_add(o.getLocal("pr"),o.i32_const(t*s))))}(),function(){let i=t.addFunction(e+"_toMontgomery");i.addParam("p1","i32"),i.addParam("pr","i32");let o=i.getCodeBuilder();i.addCode(o.call(a+"_toMontgomery",o.getLocal("p1"),o.getLocal("pr")));for(let t=1;t<3;t++)i.addCode(o.call(a+"_toMontgomery",o.i32_add(o.getLocal("p1"),o.i32_const(t*s)),o.i32_add(o.getLocal("pr"),o.i32_const(t*s))))}(),function(){let i=t.addFunction(e+"_toAffine");i.addParam("p1","i32"),i.addParam("pr","i32");let o=i.getCodeBuilder(),n=o.getLocal("p1"),l=o.i32_add(o.getLocal("p1"),o.i32_const(s)),r=o.i32_add(o.getLocal("p1"),o.i32_const(2*s)),c=o.getLocal("pr"),d=o.i32_add(o.getLocal("pr"),o.i32_const(s)),u=o.i32_const(t.alloc(s)),f=o.i32_const(t.alloc(s)),h=o.i32_const(t.alloc(s));i.addCode(o.if(o.call(e+"_isZero",o.getLocal("p1")),[...o.call(a+"_zero",c),...o.call(a+"_zero",d)],[...o.call(a+"_inverse",r,u),...o.call(a+"_square",u,f),...o.call(a+"_mul",u,f,h),...o.call(a+"_mul",n,f,c),...o.call(a+"_mul",l,h,d)]))}(),function(){let i=t.addFunction(e+"_inCurveAffine");i.addParam("pIn","i32"),i.setReturnType("i32");let o=i.getCodeBuilder(),n=o.getLocal("pIn"),r=o.i32_add(o.getLocal("pIn"),o.i32_const(s)),c=o.i32_const(t.alloc(s)),d=o.i32_const(t.alloc(s));i.addCode(o.call(a+"_square",r,c),o.call(a+"_square",n,d),o.call(a+"_mul",n,d,d),o.call(a+"_add",d,o.i32_const(l),d),o.ret(o.call(a+"_eq",c,d)))}(),function(){let a=t.addFunction(e+"_inCurve");a.addParam("pIn","i32"),a.setReturnType("i32");let i=a.getCodeBuilder(),o=i.i32_const(t.alloc(2*s));a.addCode(i.call(e+"_toAffine",i.getLocal("pIn"),o),i.ret(i.call(e+"_inCurveAffine",o)))}(),function(){let i=t.addFunction(e+"_batchToAffine");i.addParam("pIn","i32"),i.addParam("n","i32"),i.addParam("pOut","i32"),i.addLocal("pAux","i32"),i.addLocal("itIn","i32"),i.addLocal("itAux","i32"),i.addLocal("itOut","i32"),i.addLocal("i","i32");let o=i.getCodeBuilder(),n=o.i32_const(t.alloc(s));i.addCode(o.setLocal("pAux",o.i32_load(o.i32_const(0))),o.i32_store(o.i32_const(0),o.i32_add(o.getLocal("pAux"),o.i32_mul(o.getLocal("n"),o.i32_const(s)))),o.call(a+"_batchInverse",o.i32_add(o.getLocal("pIn"),o.i32_const(2*s)),o.i32_const(3*s),o.getLocal("n"),o.getLocal("pAux"),o.i32_const(s)),o.setLocal("itIn",o.getLocal("pIn")),o.setLocal("itAux",o.getLocal("pAux")),o.setLocal("itOut",o.getLocal("pOut")),o.setLocal("i",o.i32_const(0)),o.block(o.loop(o.br_if(1,o.i32_eq(o.getLocal("i"),o.getLocal("n"))),o.if(o.call(a+"_isZero",o.getLocal("itAux")),[...o.call(a+"_zero",o.getLocal("itOut")),...o.call(a+"_zero",o.i32_add(o.getLocal("itOut"),o.i32_const(s)))],[...o.call(a+"_mul",o.getLocal("itAux"),o.i32_add(o.getLocal("itIn"),o.i32_const(s)),n),...o.call(a+"_square",o.getLocal("itAux"),o.getLocal("itAux")),...o.call(a+"_mul",o.getLocal("itAux"),o.getLocal("itIn"),o.getLocal("itOut")),...o.call(a+"_mul",o.getLocal("itAux"),n,o.i32_add(o.getLocal("itOut"),o.i32_const(s)))]),o.setLocal("itIn",o.i32_add(o.getLocal("itIn"),o.i32_const(3*s))),o.setLocal("itOut",o.i32_add(o.getLocal("itOut"),o.i32_const(2*s))),o.setLocal("itAux",o.i32_add(o.getLocal("itAux"),o.i32_const(s))),o.setLocal("i",o.i32_add(o.getLocal("i"),o.i32_const(1))),o.br(0))),o.i32_store(o.i32_const(0),o.getLocal("pAux")))}(),function(){let i=t.addFunction(e+"_normalize");i.addParam("p1","i32"),i.addParam("pr","i32");let o=i.getCodeBuilder(),n=o.getLocal("p1"),l=o.i32_add(o.getLocal("p1"),o.i32_const(s)),r=o.i32_add(o.getLocal("p1"),o.i32_const(2*s)),c=o.getLocal("pr"),d=o.i32_add(o.getLocal("pr"),o.i32_const(s)),u=o.i32_add(o.getLocal("pr"),o.i32_const(2*s)),f=o.i32_const(t.alloc(s)),h=o.i32_const(t.alloc(s)),g=o.i32_const(t.alloc(s));i.addCode(o.if(o.call(e+"_isZero",o.getLocal("p1")),o.call(e+"_zero",o.getLocal("pr")),[...o.call(a+"_inverse",r,f),...o.call(a+"_square",f,h),...o.call(a+"_mul",f,h,g),...o.call(a+"_mul",n,h,c),...o.call(a+"_mul",l,g,d),...o.call(a+"_one",u)]))}(),function(){let a=t.addFunction(e+"__reverseBytes");a.addParam("pIn","i32"),a.addParam("n","i32"),a.addParam("pOut","i32"),a.addLocal("itOut","i32"),a.addLocal("itIn","i32");let i=a.getCodeBuilder();a.addCode(i.setLocal("itOut",i.i32_sub(i.i32_add(i.getLocal("pOut"),i.getLocal("n")),i.i32_const(1))),i.setLocal("itIn",i.getLocal("pIn")),i.block(i.loop(i.br_if(1,i.i32_lt_s(i.getLocal("itOut"),i.getLocal("pOut"))),i.i32_store8(i.getLocal("itOut"),i.i32_load8_u(i.getLocal("itIn"))),i.setLocal("itOut",i.i32_sub(i.getLocal("itOut"),i.i32_const(1))),i.setLocal("itIn",i.i32_add(i.getLocal("itIn"),i.i32_const(1))),i.br(0))))}(),function(){let a=t.addFunction(e+"_LEMtoU");a.addParam("pIn","i32"),a.addParam("pOut","i32");let i=a.getCodeBuilder(),o=t.alloc(2*s),n=i.i32_const(o),l=i.i32_const(o),r=i.i32_const(o+s);a.addCode(i.if(i.call(e+"_isZeroAffine",i.getLocal("pIn")),[...i.call(e+"_zeroAffine",i.getLocal("pOut")),...i.ret([])]),i.call(e+"_fromMontgomeryAffine",i.getLocal("pIn"),n),i.call(e+"__reverseBytes",l,i.i32_const(s),i.getLocal("pOut")),i.call(e+"__reverseBytes",r,i.i32_const(s),i.i32_add(i.getLocal("pOut"),i.i32_const(s))))}(),function(){let i=t.addFunction(e+"_LEMtoC");i.addParam("pIn","i32"),i.addParam("pOut","i32");let o=i.getCodeBuilder(),n=o.i32_const(t.alloc(s));i.addCode(o.if(o.call(e+"_isZeroAffine",o.getLocal("pIn")),[...o.call(a+"_zero",o.getLocal("pOut")),...o.i32_store8(o.getLocal("pOut"),o.i32_const(64)),...o.ret([])]),o.call(a+"_fromMontgomery",o.getLocal("pIn"),n),o.call(e+"__reverseBytes",n,o.i32_const(s),o.getLocal("pOut")),o.if(o.i32_eq(o.call(a+"_sign",o.i32_add(o.getLocal("pIn"),o.i32_const(s))),o.i32_const(-1)),o.i32_store8(o.getLocal("pOut"),o.i32_or(o.i32_load8_u(o.getLocal("pOut")),o.i32_const(128)))))}(),function(){let a=t.addFunction(e+"_UtoLEM");a.addParam("pIn","i32"),a.addParam("pOut","i32");let i=a.getCodeBuilder(),o=t.alloc(2*s),n=i.i32_const(o),l=i.i32_const(o),r=i.i32_const(o+s);a.addCode(i.if(i.i32_and(i.i32_load8_u(i.getLocal("pIn")),i.i32_const(64)),[...i.call(e+"_zeroAffine",i.getLocal("pOut")),...i.ret([])]),i.call(e+"__reverseBytes",i.getLocal("pIn"),i.i32_const(s),l),i.call(e+"__reverseBytes",i.i32_add(i.getLocal("pIn"),i.i32_const(s)),i.i32_const(s),r),i.call(e+"_toMontgomeryAffine",n,i.getLocal("pOut")))}(),function(){let i=t.addFunction(e+"_CtoLEM");i.addParam("pIn","i32"),i.addParam("pOut","i32"),i.addLocal("firstByte","i32"),i.addLocal("greatest","i32");let o=i.getCodeBuilder(),n=t.alloc(2*s),r=o.i32_const(n),c=o.i32_const(n+s);i.addCode(o.setLocal("firstByte",o.i32_load8_u(o.getLocal("pIn"))),o.if(o.i32_and(o.getLocal("firstByte"),o.i32_const(64)),[...o.call(e+"_zeroAffine",o.getLocal("pOut")),...o.ret([])]),o.setLocal("greatest",o.i32_and(o.getLocal("firstByte"),o.i32_const(128))),o.call(a+"_copy",o.getLocal("pIn"),c),o.i32_store8(c,o.i32_and(o.getLocal("firstByte"),o.i32_const(63))),o.call(e+"__reverseBytes",c,o.i32_const(s),r),o.call(a+"_toMontgomery",r,o.getLocal("pOut")),o.call(a+"_square",o.getLocal("pOut"),c),o.call(a+"_mul",o.getLocal("pOut"),c,c),o.call(a+"_add",c,o.i32_const(l),c),o.call(a+"_sqrt",c,c),o.call(a+"_neg",c,r),o.if(o.i32_eq(o.call(a+"_sign",c),o.i32_const(-1)),o.if(o.getLocal("greatest"),o.call(a+"_copy",c,o.i32_add(o.getLocal("pOut"),o.i32_const(s))),o.call(a+"_neg",c,o.i32_add(o.getLocal("pOut"),o.i32_const(s)))),o.if(o.getLocal("greatest"),o.call(a+"_neg",c,o.i32_add(o.getLocal("pOut"),o.i32_const(s))),o.call(a+"_copy",c,o.i32_add(o.getLocal("pOut"),o.i32_const(s))))))}(),o(t,e+"_batchLEMtoU",e+"_LEMtoU",2*s,2*s),o(t,e+"_batchLEMtoC",e+"_LEMtoC",2*s,s),o(t,e+"_batchUtoLEM",e+"_UtoLEM",2*s,2*s),o(t,e+"_batchCtoLEM",e+"_CtoLEM",s,2*s,!0),o(t,e+"_batchToJacobian",e+"_toJacobian",2*s,3*s,!0),n(t,e,e+"_multiexp",e+"_add",3*s),n(t,e,e+"_multiexpAffine",e+"_addMixed",2*s),i(t,e+"_timesScalar",3*s,e+"_add",e+"_double",e+"_sub",e+"_copy",e+"_zero"),i(t,e+"_timesScalarAffine",2*s,e+"_addMixed",e+"_double",e+"_subMixed",e+"_copyAffine",e+"_zero"),t.exportFunction(e+"_isZero"),t.exportFunction(e+"_isZeroAffine"),t.exportFunction(e+"_eq"),t.exportFunction(e+"_eqMixed"),t.exportFunction(e+"_eqAffine"),t.exportFunction(e+"_copy"),t.exportFunction(e+"_copyAffine"),t.exportFunction(e+"_zero"),t.exportFunction(e+"_zeroAffine"),t.exportFunction(e+"_double"),t.exportFunction(e+"_doubleAffine"),t.exportFunction(e+"_add"),t.exportFunction(e+"_addMixed"),t.exportFunction(e+"_addAffine"),t.exportFunction(e+"_neg"),t.exportFunction(e+"_negAffine"),t.exportFunction(e+"_sub"),t.exportFunction(e+"_subMixed"),t.exportFunction(e+"_subAffine"),t.exportFunction(e+"_fromMontgomery"),t.exportFunction(e+"_fromMontgomeryAffine"),t.exportFunction(e+"_toMontgomery"),t.exportFunction(e+"_toMontgomeryAffine"),t.exportFunction(e+"_timesScalar"),t.exportFunction(e+"_timesScalarAffine"),t.exportFunction(e+"_normalize"),t.exportFunction(e+"_LEMtoU"),t.exportFunction(e+"_LEMtoC"),t.exportFunction(e+"_UtoLEM"),t.exportFunction(e+"_CtoLEM"),t.exportFunction(e+"_batchLEMtoU"),t.exportFunction(e+"_batchLEMtoC"),t.exportFunction(e+"_batchUtoLEM"),t.exportFunction(e+"_batchCtoLEM"),t.exportFunction(e+"_toAffine"),t.exportFunction(e+"_toJacobian"),t.exportFunction(e+"_batchToAffine"),t.exportFunction(e+"_batchToJacobian"),t.exportFunction(e+"_inCurve"),t.exportFunction(e+"_inCurveAffine")),e}},6466:(t,e,a)=>{let i=a(6246),{bitLength:o}=a(3667);t.exports=function(t,e,a,n,l){let r=BigInt(e),s=Math.floor((o(r-1n)-1)/64)+1,c=8*s,d=a||"f1";if(t.modules[d])return d;t.modules[d]={n64:s};let u=l||"int",f=i(t,r,n,u),h=t.modules[f].pR2,g=t.modules[f].pq,p=t.modules[f].pePlusOne;return function(){let e=t.alloc(c),a=t.addFunction(d+"_mul");a.addParam("x","i32"),a.addParam("y","i32"),a.addParam("r","i32");let i=a.getCodeBuilder();a.addCode(i.call(f+"_mul",i.getLocal("x"),i.getLocal("y"),i.i32_const(e))),a.addCode(i.call(f+"_mul",i.i32_const(e),i.i32_const(h),i.getLocal("r")))}(),function(){let e=t.addFunction(d+"_square");e.addParam("x","i32"),e.addParam("r","i32");let a=e.getCodeBuilder();e.addCode(a.call(d+"_mul",a.getLocal("x"),a.getLocal("x"),a.getLocal("r")))}(),function(){let e=t.addFunction(d+"_inverse");e.addParam("x","i32"),e.addParam("r","i32");let a=e.getCodeBuilder();e.addCode(a.call(u+"_inverseMod",a.getLocal("x"),a.i32_const(g),a.getLocal("r")))}(),function(){let e=t.addFunction(d+"_isNegative");e.addParam("x","i32"),e.setReturnType("i32");let a=e.getCodeBuilder();e.addCode(a.call(u+"_gte",a.getLocal("x"),a.i32_const(p)))}(),t.exportFunction(f+"_add",d+"_add"),t.exportFunction(f+"_sub",d+"_sub"),t.exportFunction(f+"_neg",d+"_neg"),t.exportFunction(d+"_mul"),t.exportFunction(d+"_square"),t.exportFunction(d+"_inverse"),t.exportFunction(d+"_isNegative"),t.exportFunction(f+"_copy",d+"_copy"),t.exportFunction(f+"_zero",d+"_zero"),t.exportFunction(f+"_one",d+"_one"),t.exportFunction(f+"_isZero",d+"_isZero"),t.exportFunction(f+"_eq",d+"_eq"),d}},6246:(t,e,a)=>{let i=a(1453),o=a(1209),n=a(9492),l=a(7078),r=a(8002),s=a(6336),{bitLength:c,modInv:d,modPow:u,isPrime:f,isOdd:h,square:g}=a(3667);t.exports=function(t,e,a,p){let _=BigInt(e),m=Math.floor((c(_-1n)-1)/64)+1,b=2*m,L=8*m,w=a||"f1m";if(t.modules[w])return w;let y=i(t,m,p),A=t.alloc(L,o.bigInt2BytesLE(_,L)),C=t.alloc(o.bigInt2BytesLE(g(1n<<BigInt(64*m))%_,L)),I=t.alloc(o.bigInt2BytesLE((1n<<BigInt(64*m))%_,L)),F=t.alloc(o.bigInt2BytesLE(0n,L)),x=_-1n,E=x>>1n,v=t.alloc(L,o.bigInt2BytesLE(E,L)),B=t.alloc(L,o.bigInt2BytesLE(E+1n,L));t.modules[w]={pq:A,pR2:C,n64:m,q:_,pOne:I,pZero:F,pePlusOne:B};let S=2n;if(f(_))for(;u(S,E,_)!==x;)S+=1n;let O=0,P=x;for(;!h(P)&&0n!==P;)O++,P>>=1n;let G=t.alloc(L,o.bigInt2BytesLE(P,L)),T=u(S,P,_),q=t.alloc(o.bigInt2BytesLE((T<<BigInt(64*m))%_,L)),z=P+1n>>1n,U=t.alloc(L,o.bigInt2BytesLE(z,L));return t.exportFunction(y+"_copy",w+"_copy"),t.exportFunction(y+"_zero",w+"_zero"),t.exportFunction(y+"_isZero",w+"_isZero"),t.exportFunction(y+"_eq",w+"_eq"),function(){let e=t.addFunction(w+"_isOne");e.addParam("x","i32"),e.setReturnType("i32");let a=e.getCodeBuilder();e.addCode(a.ret(a.call(y+"_eq",a.getLocal("x"),a.i32_const(I))))}(),function(){let e=t.addFunction(w+"_add");e.addParam("x","i32"),e.addParam("y","i32"),e.addParam("r","i32");let a=e.getCodeBuilder();e.addCode(a.if(a.call(y+"_add",a.getLocal("x"),a.getLocal("y"),a.getLocal("r")),a.drop(a.call(y+"_sub",a.getLocal("r"),a.i32_const(A),a.getLocal("r"))),a.if(a.call(y+"_gte",a.getLocal("r"),a.i32_const(A)),a.drop(a.call(y+"_sub",a.getLocal("r"),a.i32_const(A),a.getLocal("r"))))))}(),function(){let e=t.addFunction(w+"_sub");e.addParam("x","i32"),e.addParam("y","i32"),e.addParam("r","i32");let a=e.getCodeBuilder();e.addCode(a.if(a.call(y+"_sub",a.getLocal("x"),a.getLocal("y"),a.getLocal("r")),a.drop(a.call(y+"_add",a.getLocal("r"),a.i32_const(A),a.getLocal("r")))))}(),function(){let e=t.addFunction(w+"_neg");e.addParam("x","i32"),e.addParam("r","i32");let a=e.getCodeBuilder();e.addCode(a.call(w+"_sub",a.i32_const(F),a.getLocal("x"),a.getLocal("r")))}(),function(){let e=t.alloc(b*b*8),a=t.addFunction(w+"_mReduct");a.addParam("t","i32"),a.addParam("r","i32"),a.addLocal("np32","i64"),a.addLocal("c","i64"),a.addLocal("m","i64");let i=a.getCodeBuilder(),o=Number(4294967296n-d(_,4294967296n));a.addCode(i.setLocal("np32",i.i64_const(o)));for(let t=0;t<b;t++){a.addCode(i.setLocal("c",i.i64_const(0))),a.addCode(i.setLocal("m",i.i64_and(i.i64_mul(i.i64_load32_u(i.getLocal("t"),4*t),i.getLocal("np32")),i.i64_const("0xFFFFFFFF"))));for(let e=0;e<b;e++)a.addCode(i.setLocal("c",i.i64_add(i.i64_add(i.i64_load32_u(i.getLocal("t"),(t+e)*4),i.i64_shr_u(i.getLocal("c"),i.i64_const(32))),i.i64_mul(i.i64_load32_u(i.i32_const(A),4*e),i.getLocal("m"))))),a.addCode(i.i64_store32(i.getLocal("t"),(t+e)*4,i.getLocal("c")));a.addCode(i.i64_store32(i.i32_const(e),4*t,i.i64_shr_u(i.getLocal("c"),i.i64_const(32))))}a.addCode(i.call(w+"_add",i.i32_const(e),i.i32_add(i.getLocal("t"),i.i32_const(4*b)),i.getLocal("r")))}(),function(){let e=t.addFunction(w+"_mul");e.addParam("x","i32"),e.addParam("y","i32"),e.addParam("r","i32"),e.addLocal("c0","i64"),e.addLocal("c1","i64"),e.addLocal("np32","i64");for(let t=0;t<b;t++)e.addLocal("x"+t,"i64"),e.addLocal("y"+t,"i64"),e.addLocal("m"+t,"i64"),e.addLocal("q"+t,"i64");let a=e.getCodeBuilder(),i=Number(4294967296n-d(_,4294967296n));e.addCode(a.setLocal("np32",a.i64_const(i)));let o=[],n=[],l=[];function r(t,e){let i,o;return l[t]?i=a.getLocal("q"+t):(i=a.teeLocal("q"+t,a.i64_load32_u(a.i32_const(0),A+4*t)),l[t]=!0),o=a.getLocal("m"+e),a.i64_mul(i,o)}let s="c0",c="c1";for(let t=0;t<2*b-1;t++){for(let i=Math.max(0,t-b+1);i<=t&&i<b;i++){let l=t-i;e.addCode(a.setLocal(s,a.i64_add(a.i64_and(a.getLocal(s),a.i64_const(4294967295)),function(t,e){let i,l;return o[t]?i=a.getLocal("x"+t):(i=a.teeLocal("x"+t,a.i64_load32_u(a.getLocal("x"),4*t)),o[t]=!0),n[e]?l=a.getLocal("y"+e):(l=a.teeLocal("y"+e,a.i64_load32_u(a.getLocal("y"),4*e)),n[e]=!0),a.i64_mul(i,l)}(i,l)))),e.addCode(a.setLocal(c,a.i64_add(a.getLocal(c),a.i64_shr_u(a.getLocal(s),a.i64_const(32)))))}for(let i=Math.max(1,t-b+1);i<=t&&i<b;i++){let o=t-i;e.addCode(a.setLocal(s,a.i64_add(a.i64_and(a.getLocal(s),a.i64_const(4294967295)),r(i,o)))),e.addCode(a.setLocal(c,a.i64_add(a.getLocal(c),a.i64_shr_u(a.getLocal(s),a.i64_const(32)))))}t<b&&(e.addCode(a.setLocal("m"+t,a.i64_and(a.i64_mul(a.i64_and(a.getLocal(s),a.i64_const(4294967295)),a.getLocal("np32")),a.i64_const("0xFFFFFFFF")))),e.addCode(a.setLocal(s,a.i64_add(a.i64_and(a.getLocal(s),a.i64_const(4294967295)),r(0,t)))),e.addCode(a.setLocal(c,a.i64_add(a.getLocal(c),a.i64_shr_u(a.getLocal(s),a.i64_const(32)))))),t>=b&&e.addCode(a.i64_store32(a.getLocal("r"),(t-b)*4,a.getLocal(s))),[s,c]=[c,s],e.addCode(a.setLocal(c,a.i64_shr_u(a.getLocal(s),a.i64_const(32))))}e.addCode(a.i64_store32(a.getLocal("r"),4*b-4,a.getLocal(s))),e.addCode(a.if(a.i32_wrap_i64(a.getLocal(c)),a.drop(a.call(y+"_sub",a.getLocal("r"),a.i32_const(A),a.getLocal("r"))),a.if(a.call(y+"_gte",a.getLocal("r"),a.i32_const(A)),a.drop(a.call(y+"_sub",a.getLocal("r"),a.i32_const(A),a.getLocal("r"))))))}(),function(){let e=t.addFunction(w+"_square");e.addParam("x","i32"),e.addParam("r","i32"),e.addLocal("c0","i64"),e.addLocal("c1","i64"),e.addLocal("c0_old","i64"),e.addLocal("c1_old","i64"),e.addLocal("np32","i64");for(let t=0;t<b;t++)e.addLocal("x"+t,"i64"),e.addLocal("m"+t,"i64"),e.addLocal("q"+t,"i64");let a=e.getCodeBuilder(),i=Number(4294967296n-d(_,4294967296n));e.addCode(a.setLocal("np32",a.i64_const(i)));let o=[],n=[];function l(t,e){let i,n;return o[t]?i=a.getLocal("x"+t):(i=a.teeLocal("x"+t,a.i64_load32_u(a.getLocal("x"),4*t)),o[t]=!0),o[e]?n=a.getLocal("x"+e):(n=a.teeLocal("x"+e,a.i64_load32_u(a.getLocal("x"),4*e)),o[e]=!0),a.i64_mul(i,n)}function r(t,e){let i,o;return n[t]?i=a.getLocal("q"+t):(i=a.teeLocal("q"+t,a.i64_load32_u(a.i32_const(0),A+4*t)),n[t]=!0),o=a.getLocal("m"+e),a.i64_mul(i,o)}let s="c0_old",c="c1_old";for(let t=0;t<2*b-1;t++){e.addCode(a.setLocal("c0",a.i64_const(0)),a.setLocal("c1",a.i64_const(0)));for(let i=Math.max(0,t-b+1);i<t+1>>1&&i<b;i++){let o=t-i;e.addCode(a.setLocal("c0",a.i64_add(a.i64_and(a.getLocal("c0"),a.i64_const(4294967295)),l(i,o)))),e.addCode(a.setLocal("c1",a.i64_add(a.getLocal("c1"),a.i64_shr_u(a.getLocal("c0"),a.i64_const(32)))))}e.addCode(a.setLocal("c0",a.i64_shl(a.i64_and(a.getLocal("c0"),a.i64_const(4294967295)),a.i64_const(1)))),e.addCode(a.setLocal("c1",a.i64_add(a.i64_shl(a.getLocal("c1"),a.i64_const(1)),a.i64_shr_u(a.getLocal("c0"),a.i64_const(32))))),t%2==0&&(e.addCode(a.setLocal("c0",a.i64_add(a.i64_and(a.getLocal("c0"),a.i64_const(4294967295)),l(t>>1,t>>1)))),e.addCode(a.setLocal("c1",a.i64_add(a.getLocal("c1"),a.i64_shr_u(a.getLocal("c0"),a.i64_const(32)))))),t>0&&(e.addCode(a.setLocal("c0",a.i64_add(a.i64_and(a.getLocal("c0"),a.i64_const(4294967295)),a.i64_and(a.getLocal(s),a.i64_const(4294967295))))),e.addCode(a.setLocal("c1",a.i64_add(a.i64_add(a.getLocal("c1"),a.i64_shr_u(a.getLocal("c0"),a.i64_const(32))),a.getLocal(c)))));for(let i=Math.max(1,t-b+1);i<=t&&i<b;i++){let o=t-i;e.addCode(a.setLocal("c0",a.i64_add(a.i64_and(a.getLocal("c0"),a.i64_const(4294967295)),r(i,o)))),e.addCode(a.setLocal("c1",a.i64_add(a.getLocal("c1"),a.i64_shr_u(a.getLocal("c0"),a.i64_const(32)))))}t<b&&(e.addCode(a.setLocal("m"+t,a.i64_and(a.i64_mul(a.i64_and(a.getLocal("c0"),a.i64_const(4294967295)),a.getLocal("np32")),a.i64_const("0xFFFFFFFF")))),e.addCode(a.setLocal("c0",a.i64_add(a.i64_and(a.getLocal("c0"),a.i64_const(4294967295)),r(0,t)))),e.addCode(a.setLocal("c1",a.i64_add(a.getLocal("c1"),a.i64_shr_u(a.getLocal("c0"),a.i64_const(32)))))),t>=b&&e.addCode(a.i64_store32(a.getLocal("r"),(t-b)*4,a.getLocal("c0"))),e.addCode(a.setLocal(s,a.getLocal("c1")),a.setLocal(c,a.i64_shr_u(a.getLocal(s),a.i64_const(32))))}e.addCode(a.i64_store32(a.getLocal("r"),4*b-4,a.getLocal(s))),e.addCode(a.if(a.i32_wrap_i64(a.getLocal(c)),a.drop(a.call(y+"_sub",a.getLocal("r"),a.i32_const(A),a.getLocal("r"))),a.if(a.call(y+"_gte",a.getLocal("r"),a.i32_const(A)),a.drop(a.call(y+"_sub",a.getLocal("r"),a.i32_const(A),a.getLocal("r"))))))}(),function(){let e=t.addFunction(w+"_squareOld");e.addParam("x","i32"),e.addParam("r","i32");let a=e.getCodeBuilder();e.addCode(a.call(w+"_mul",a.getLocal("x"),a.getLocal("x"),a.getLocal("r")))}(),function(){let e=t.addFunction(w+"_toMontgomery");e.addParam("x","i32"),e.addParam("r","i32");let a=e.getCodeBuilder();e.addCode(a.call(w+"_mul",a.getLocal("x"),a.i32_const(C),a.getLocal("r")))}(),function(){let e=t.alloc(2*L),a=t.addFunction(w+"_fromMontgomery");a.addParam("x","i32"),a.addParam("r","i32");let i=a.getCodeBuilder();a.addCode(i.call(y+"_copy",i.getLocal("x"),i.i32_const(e))),a.addCode(i.call(y+"_zero",i.i32_const(e+L))),a.addCode(i.call(w+"_mReduct",i.i32_const(e),i.getLocal("r")))}(),function(){let e=t.addFunction(w+"_isNegative");e.addParam("x","i32"),e.setReturnType("i32");let a=e.getCodeBuilder(),i=a.i32_const(t.alloc(L));e.addCode(a.call(w+"_fromMontgomery",a.getLocal("x"),i),a.call(y+"_gte",i,a.i32_const(B)))}(),function(){let e=t.addFunction(w+"_sign");e.addParam("x","i32"),e.setReturnType("i32");let a=e.getCodeBuilder(),i=a.i32_const(t.alloc(L));e.addCode(a.if(a.call(y+"_isZero",a.getLocal("x")),a.ret(a.i32_const(0))),a.call(w+"_fromMontgomery",a.getLocal("x"),i),a.if(a.call(y+"_gte",i,a.i32_const(B)),a.ret(a.i32_const(-1))),a.ret(a.i32_const(1)))}(),function(){let e=t.addFunction(w+"_inverse");e.addParam("x","i32"),e.addParam("r","i32");let a=e.getCodeBuilder();e.addCode(a.call(w+"_fromMontgomery",a.getLocal("x"),a.getLocal("r"))),e.addCode(a.call(y+"_inverseMod",a.getLocal("r"),a.i32_const(A),a.getLocal("r"))),e.addCode(a.call(w+"_toMontgomery",a.getLocal("r"),a.getLocal("r")))}(),function(){let e=t.addFunction(w+"_one");e.addParam("pr","i32");let a=e.getCodeBuilder();e.addCode(a.call(y+"_copy",a.i32_const(I),a.getLocal("pr")))}(),function(){let e=t.addFunction(w+"_load");e.addParam("scalar","i32"),e.addParam("scalarLen","i32"),e.addParam("r","i32"),e.addLocal("p","i32"),e.addLocal("l","i32"),e.addLocal("i","i32"),e.addLocal("j","i32");let a=e.getCodeBuilder(),i=a.i32_const(t.alloc(L)),o=t.alloc(L),n=a.i32_const(o);e.addCode(a.call(y+"_zero",a.getLocal("r")),a.setLocal("i",a.i32_const(L)),a.setLocal("p",a.getLocal("scalar")),a.block(a.loop(a.br_if(1,a.i32_gt_u(a.getLocal("i"),a.getLocal("scalarLen"))),a.if(a.i32_eq(a.getLocal("i"),a.i32_const(L)),a.call(w+"_one",i),a.call(w+"_mul",i,a.i32_const(C),i)),a.call(w+"_mul",a.getLocal("p"),i,n),a.call(w+"_add",a.getLocal("r"),n,a.getLocal("r")),a.setLocal("p",a.i32_add(a.getLocal("p"),a.i32_const(L))),a.setLocal("i",a.i32_add(a.getLocal("i"),a.i32_const(L))),a.br(0))),a.setLocal("l",a.i32_rem_u(a.getLocal("scalarLen"),a.i32_const(L))),a.if(a.i32_eqz(a.getLocal("l")),a.ret([])),a.call(y+"_zero",n),a.setLocal("j",a.i32_const(0)),a.block(a.loop(a.br_if(1,a.i32_eq(a.getLocal("j"),a.getLocal("l"))),a.i32_store8(a.getLocal("j"),o,a.i32_load8_u(a.getLocal("p"))),a.setLocal("p",a.i32_add(a.getLocal("p"),a.i32_const(1))),a.setLocal("j",a.i32_add(a.getLocal("j"),a.i32_const(1))),a.br(0))),a.if(a.i32_eq(a.getLocal("i"),a.i32_const(L)),a.call(w+"_one",i),a.call(w+"_mul",i,a.i32_const(C),i)),a.call(w+"_mul",n,i,n),a.call(w+"_add",a.getLocal("r"),n,a.getLocal("r")))}(),function(){let e=t.addFunction(w+"_timesScalar");e.addParam("x","i32"),e.addParam("scalar","i32"),e.addParam("scalarLen","i32"),e.addParam("r","i32");let a=e.getCodeBuilder(),i=a.i32_const(t.alloc(L));e.addCode(a.call(w+"_load",a.getLocal("scalar"),a.getLocal("scalarLen"),i),a.call(w+"_toMontgomery",i,i),a.call(w+"_mul",a.getLocal("x"),i,a.getLocal("r")))}(),l(t,w),r(t,w+"_batchToMontgomery",w+"_toMontgomery",L,L),r(t,w+"_batchFromMontgomery",w+"_fromMontgomery",L,L),r(t,w+"_batchNeg",w+"_neg",L,L),s(t,w+"_batchAdd",w+"_add",L,L),s(t,w+"_batchSub",w+"_sub",L,L),s(t,w+"_batchMul",w+"_mul",L,L),t.exportFunction(w+"_add"),t.exportFunction(w+"_sub"),t.exportFunction(w+"_neg"),t.exportFunction(w+"_isNegative"),t.exportFunction(w+"_isOne"),t.exportFunction(w+"_sign"),t.exportFunction(w+"_mReduct"),t.exportFunction(w+"_mul"),t.exportFunction(w+"_square"),t.exportFunction(w+"_squareOld"),t.exportFunction(w+"_fromMontgomery"),t.exportFunction(w+"_toMontgomery"),t.exportFunction(w+"_inverse"),t.exportFunction(w+"_one"),t.exportFunction(w+"_load"),t.exportFunction(w+"_timesScalar"),n(t,w+"_exp",L,w+"_mul",w+"_square",y+"_copy",w+"_one"),t.exportFunction(w+"_exp"),t.exportFunction(w+"_batchInverse"),f(_)&&(function(){let e=t.addFunction(w+"_sqrt");e.addParam("n","i32"),e.addParam("r","i32"),e.addLocal("m","i32"),e.addLocal("i","i32"),e.addLocal("j","i32");let a=e.getCodeBuilder(),i=a.i32_const(I),o=a.i32_const(t.alloc(L)),n=a.i32_const(t.alloc(L)),l=a.i32_const(t.alloc(L)),r=a.i32_const(t.alloc(L)),s=a.i32_const(t.alloc(L));e.addCode(a.if(a.call(w+"_isZero",a.getLocal("n")),a.ret(a.call(w+"_zero",a.getLocal("r")))),a.setLocal("m",a.i32_const(O)),a.call(w+"_copy",a.i32_const(q),o),a.call(w+"_exp",a.getLocal("n"),a.i32_const(G),a.i32_const(L),n),a.call(w+"_exp",a.getLocal("n"),a.i32_const(U),a.i32_const(L),l),a.block(a.loop(a.br_if(1,a.call(w+"_eq",n,i)),a.call(w+"_square",n,r),a.setLocal("i",a.i32_const(1)),a.block(a.loop(a.br_if(1,a.call(w+"_eq",r,i)),a.call(w+"_square",r,r),a.setLocal("i",a.i32_add(a.getLocal("i"),a.i32_const(1))),a.br(0))),a.call(w+"_copy",o,s),a.setLocal("j",a.i32_sub(a.i32_sub(a.getLocal("m"),a.getLocal("i")),a.i32_const(1))),a.block(a.loop(a.br_if(1,a.i32_eqz(a.getLocal("j"))),a.call(w+"_square",s,s),a.setLocal("j",a.i32_sub(a.getLocal("j"),a.i32_const(1))),a.br(0))),a.setLocal("m",a.getLocal("i")),a.call(w+"_square",s,o),a.call(w+"_mul",n,o,n),a.call(w+"_mul",l,s,l),a.br(0))),a.if(a.call(w+"_isNegative",l),a.call(w+"_neg",l,a.getLocal("r")),a.call(w+"_copy",l,a.getLocal("r"))))}(),function(){let e=t.addFunction(w+"_isSquare");e.addParam("n","i32"),e.setReturnType("i32");let a=e.getCodeBuilder(),i=a.i32_const(I),o=a.i32_const(t.alloc(L));e.addCode(a.if(a.call(w+"_isZero",a.getLocal("n")),a.ret(a.i32_const(1))),a.call(w+"_exp",a.getLocal("n"),a.i32_const(v),a.i32_const(L),o),a.call(w+"_eq",o,i))}(),t.exportFunction(w+"_sqrt"),t.exportFunction(w+"_isSquare")),t.exportFunction(w+"_batchToMontgomery"),t.exportFunction(w+"_batchFromMontgomery"),w}},1599:(t,e,a)=>{let i=a(9492),o=a(7078),n=a(1209);t.exports=function(t,e,a,l){if(t.modules[a])return a;let r=8*t.modules[l].n64,s=t.modules[l].q;return t.modules[a]={n64:2*t.modules[l].n64},function(){let e=t.addFunction(a+"_isZero");e.addParam("x","i32"),e.setReturnType("i32");let i=e.getCodeBuilder(),o=i.getLocal("x"),n=i.i32_add(i.getLocal("x"),i.i32_const(r));e.addCode(i.i32_and(i.call(l+"_isZero",o),i.call(l+"_isZero",n)))}(),function(){let e=t.addFunction(a+"_isOne");e.addParam("x","i32"),e.setReturnType("i32");let i=e.getCodeBuilder(),o=i.getLocal("x"),n=i.i32_add(i.getLocal("x"),i.i32_const(r));e.addCode(i.ret(i.i32_and(i.call(l+"_isOne",o),i.call(l+"_isZero",n))))}(),function(){let e=t.addFunction(a+"_zero");e.addParam("x","i32");let i=e.getCodeBuilder(),o=i.getLocal("x"),n=i.i32_add(i.getLocal("x"),i.i32_const(r));e.addCode(i.call(l+"_zero",o),i.call(l+"_zero",n))}(),function(){let e=t.addFunction(a+"_one");e.addParam("x","i32");let i=e.getCodeBuilder(),o=i.getLocal("x"),n=i.i32_add(i.getLocal("x"),i.i32_const(r));e.addCode(i.call(l+"_one",o),i.call(l+"_zero",n))}(),function(){let e=t.addFunction(a+"_copy");e.addParam("x","i32"),e.addParam("r","i32");let i=e.getCodeBuilder(),o=i.getLocal("x"),n=i.i32_add(i.getLocal("x"),i.i32_const(r)),s=i.getLocal("r"),c=i.i32_add(i.getLocal("r"),i.i32_const(r));e.addCode(i.call(l+"_copy",o,s),i.call(l+"_copy",n,c))}(),function(){let i=t.addFunction(a+"_mul");i.addParam("x","i32"),i.addParam("y","i32"),i.addParam("r","i32");let o=i.getCodeBuilder(),n=o.getLocal("x"),s=o.i32_add(o.getLocal("x"),o.i32_const(r)),c=o.getLocal("y"),d=o.i32_add(o.getLocal("y"),o.i32_const(r)),u=o.getLocal("r"),f=o.i32_add(o.getLocal("r"),o.i32_const(r)),h=o.i32_const(t.alloc(r)),g=o.i32_const(t.alloc(r)),p=o.i32_const(t.alloc(r)),_=o.i32_const(t.alloc(r));i.addCode(o.call(l+"_mul",n,c,h),o.call(l+"_mul",s,d,g),o.call(l+"_add",n,s,p),o.call(l+"_add",c,d,_),o.call(l+"_mul",p,_,p),o.call(e,g,u),o.call(l+"_add",h,u,u),o.call(l+"_add",h,g,f),o.call(l+"_sub",p,f,f))}(),function(){let e=t.addFunction(a+"_mul1");e.addParam("x","i32"),e.addParam("y","i32"),e.addParam("r","i32");let i=e.getCodeBuilder(),o=i.getLocal("x"),n=i.i32_add(i.getLocal("x"),i.i32_const(r)),s=i.getLocal("y"),c=i.getLocal("r"),d=i.i32_add(i.getLocal("r"),i.i32_const(r));e.addCode(i.call(l+"_mul",o,s,c),i.call(l+"_mul",n,s,d))}(),function(){let i=t.addFunction(a+"_square");i.addParam("x","i32"),i.addParam("r","i32");let o=i.getCodeBuilder(),n=o.getLocal("x"),s=o.i32_add(o.getLocal("x"),o.i32_const(r)),c=o.getLocal("r"),d=o.i32_add(o.getLocal("r"),o.i32_const(r)),u=o.i32_const(t.alloc(r)),f=o.i32_const(t.alloc(r)),h=o.i32_const(t.alloc(r)),g=o.i32_const(t.alloc(r));i.addCode(o.call(l+"_mul",n,s,u),o.call(l+"_add",n,s,f),o.call(e,s,h),o.call(l+"_add",n,h,h),o.call(e,u,g),o.call(l+"_add",g,u,g),o.call(l+"_mul",f,h,c),o.call(l+"_sub",c,g,c),o.call(l+"_add",u,u,d))}(),function(){let e=t.addFunction(a+"_add");e.addParam("x","i32"),e.addParam("y","i32"),e.addParam("r","i32");let i=e.getCodeBuilder(),o=i.getLocal("x"),n=i.i32_add(i.getLocal("x"),i.i32_const(r)),s=i.getLocal("y"),c=i.i32_add(i.getLocal("y"),i.i32_const(r)),d=i.getLocal("r"),u=i.i32_add(i.getLocal("r"),i.i32_const(r));e.addCode(i.call(l+"_add",o,s,d),i.call(l+"_add",n,c,u))}(),function(){let e=t.addFunction(a+"_sub");e.addParam("x","i32"),e.addParam("y","i32"),e.addParam("r","i32");let i=e.getCodeBuilder(),o=i.getLocal("x"),n=i.i32_add(i.getLocal("x"),i.i32_const(r)),s=i.getLocal("y"),c=i.i32_add(i.getLocal("y"),i.i32_const(r)),d=i.getLocal("r"),u=i.i32_add(i.getLocal("r"),i.i32_const(r));e.addCode(i.call(l+"_sub",o,s,d),i.call(l+"_sub",n,c,u))}(),function(){let e=t.addFunction(a+"_neg");e.addParam("x","i32"),e.addParam("r","i32");let i=e.getCodeBuilder(),o=i.getLocal("x"),n=i.i32_add(i.getLocal("x"),i.i32_const(r)),s=i.getLocal("r"),c=i.i32_add(i.getLocal("r"),i.i32_const(r));e.addCode(i.call(l+"_neg",o,s),i.call(l+"_neg",n,c))}(),function(){let e=t.addFunction(a+"_conjugate");e.addParam("x","i32"),e.addParam("r","i32");let i=e.getCodeBuilder(),o=i.getLocal("x"),n=i.i32_add(i.getLocal("x"),i.i32_const(r)),s=i.getLocal("r"),c=i.i32_add(i.getLocal("r"),i.i32_const(r));e.addCode(i.call(l+"_copy",o,s),i.call(l+"_neg",n,c))}(),function(){let e=t.addFunction(a+"_toMontgomery");e.addParam("x","i32"),e.addParam("r","i32");let i=e.getCodeBuilder(),o=i.getLocal("x"),n=i.i32_add(i.getLocal("x"),i.i32_const(r)),s=i.getLocal("r"),c=i.i32_add(i.getLocal("r"),i.i32_const(r));e.addCode(i.call(l+"_toMontgomery",o,s),i.call(l+"_toMontgomery",n,c))}(),function(){let e=t.addFunction(a+"_fromMontgomery");e.addParam("x","i32"),e.addParam("r","i32");let i=e.getCodeBuilder(),o=i.getLocal("x"),n=i.i32_add(i.getLocal("x"),i.i32_const(r)),s=i.getLocal("r"),c=i.i32_add(i.getLocal("r"),i.i32_const(r));e.addCode(i.call(l+"_fromMontgomery",o,s),i.call(l+"_fromMontgomery",n,c))}(),function(){let e=t.addFunction(a+"_eq");e.addParam("x","i32"),e.addParam("y","i32"),e.setReturnType("i32");let i=e.getCodeBuilder(),o=i.getLocal("x"),n=i.i32_add(i.getLocal("x"),i.i32_const(r)),s=i.getLocal("y"),c=i.i32_add(i.getLocal("y"),i.i32_const(r));e.addCode(i.i32_and(i.call(l+"_eq",o,s),i.call(l+"_eq",n,c)))}(),function(){let i=t.addFunction(a+"_inverse");i.addParam("x","i32"),i.addParam("r","i32");let o=i.getCodeBuilder(),n=o.getLocal("x"),s=o.i32_add(o.getLocal("x"),o.i32_const(r)),c=o.getLocal("r"),d=o.i32_add(o.getLocal("r"),o.i32_const(r)),u=o.i32_const(t.alloc(r)),f=o.i32_const(t.alloc(r)),h=o.i32_const(t.alloc(r)),g=o.i32_const(t.alloc(r));i.addCode(o.call(l+"_square",n,u),o.call(l+"_square",s,f),o.call(e,f,h),o.call(l+"_sub",u,h,h),o.call(l+"_inverse",h,g),o.call(l+"_mul",n,g,c),o.call(l+"_mul",s,g,d),o.call(l+"_neg",d,d))}(),function(){let e=t.addFunction(a+"_timesScalar");e.addParam("x","i32"),e.addParam("scalar","i32"),e.addParam("scalarLen","i32"),e.addParam("r","i32");let i=e.getCodeBuilder(),o=i.getLocal("x"),n=i.i32_add(i.getLocal("x"),i.i32_const(r)),s=i.getLocal("r"),c=i.i32_add(i.getLocal("r"),i.i32_const(r));e.addCode(i.call(l+"_timesScalar",o,i.getLocal("scalar"),i.getLocal("scalarLen"),s),i.call(l+"_timesScalar",n,i.getLocal("scalar"),i.getLocal("scalarLen"),c))}(),function(){let e=t.addFunction(a+"_sign");e.addParam("x","i32"),e.addLocal("s","i32"),e.setReturnType("i32");let i=e.getCodeBuilder(),o=i.getLocal("x"),n=i.i32_add(i.getLocal("x"),i.i32_const(r));e.addCode(i.setLocal("s",i.call(l+"_sign",n)),i.if(i.getLocal("s"),i.ret(i.getLocal("s"))),i.ret(i.call(l+"_sign",o)))}(),function(){let e=t.addFunction(a+"_isNegative");e.addParam("x","i32"),e.setReturnType("i32");let i=e.getCodeBuilder(),o=i.getLocal("x"),n=i.i32_add(i.getLocal("x"),i.i32_const(r));e.addCode(i.if(i.call(l+"_isZero",n),i.ret(i.call(l+"_isNegative",o))),i.ret(i.call(l+"_isNegative",n)))}(),t.exportFunction(a+"_isZero"),t.exportFunction(a+"_isOne"),t.exportFunction(a+"_zero"),t.exportFunction(a+"_one"),t.exportFunction(a+"_copy"),t.exportFunction(a+"_mul"),t.exportFunction(a+"_mul1"),t.exportFunction(a+"_square"),t.exportFunction(a+"_add"),t.exportFunction(a+"_sub"),t.exportFunction(a+"_neg"),t.exportFunction(a+"_sign"),t.exportFunction(a+"_conjugate"),t.exportFunction(a+"_fromMontgomery"),t.exportFunction(a+"_toMontgomery"),t.exportFunction(a+"_eq"),t.exportFunction(a+"_inverse"),o(t,a),i(t,a+"_exp",2*r,a+"_mul",a+"_square",a+"_copy",a+"_one"),function(){let e=t.addFunction(a+"_sqrt");e.addParam("a","i32"),e.addParam("pr","i32");let i=e.getCodeBuilder(),o=i.i32_const(t.alloc(n.bigInt2BytesLE((BigInt(s||0)-3n)/4n,r))),c=i.i32_const(t.alloc(n.bigInt2BytesLE((BigInt(s||0)-1n)/2n,r))),d=i.getLocal("a"),u=i.i32_const(t.alloc(2*r)),f=i.i32_const(t.alloc(2*r)),h=i.i32_const(t.alloc(2*r)),g=t.alloc(2*r),p=i.i32_const(g),_=i.i32_const(g),m=i.i32_const(g+r),b=i.i32_const(t.alloc(2*r)),L=i.i32_const(t.alloc(2*r));e.addCode(i.call(a+"_one",p),i.call(a+"_neg",p,p),i.call(a+"_exp",d,o,i.i32_const(r),u),i.call(a+"_square",u,f),i.call(a+"_mul",d,f,f),i.call(a+"_conjugate",f,h),i.call(a+"_mul",h,f,h),i.if(i.call(a+"_eq",h,p),i.unreachable()),i.call(a+"_mul",u,d,b),i.if(i.call(a+"_eq",f,p),[...i.call(l+"_zero",_),...i.call(l+"_one",m),...i.call(a+"_mul",p,b,i.getLocal("pr"))],[...i.call(a+"_one",L),...i.call(a+"_add",L,f,L),...i.call(a+"_exp",L,c,i.i32_const(r),L),...i.call(a+"_mul",L,b,i.getLocal("pr"))]))}(),function(){let e=t.addFunction(a+"_isSquare");e.addParam("a","i32"),e.setReturnType("i32");let i=e.getCodeBuilder(),o=i.i32_const(t.alloc(n.bigInt2BytesLE((BigInt(s||0)-3n)/4n,r))),l=i.getLocal("a"),c=i.i32_const(t.alloc(2*r)),d=i.i32_const(t.alloc(2*r)),u=i.i32_const(t.alloc(2*r)),f=t.alloc(2*r),h=i.i32_const(f);e.addCode(i.call(a+"_one",h),i.call(a+"_neg",h,h),i.call(a+"_exp",l,o,i.i32_const(r),c),i.call(a+"_square",c,d),i.call(a+"_mul",l,d,d),i.call(a+"_conjugate",d,u),i.call(a+"_mul",u,d,u),i.if(i.call(a+"_eq",u,h),i.ret(i.i32_const(0))),i.ret(i.i32_const(1)))}(),t.exportFunction(a+"_exp"),t.exportFunction(a+"_timesScalar"),t.exportFunction(a+"_batchInverse"),t.exportFunction(a+"_sqrt"),t.exportFunction(a+"_isSquare"),t.exportFunction(a+"_isNegative"),a}},4033:(t,e,a)=>{let i=a(9492),o=a(7078);t.exports=function(t,e,a,n){if(t.modules[a])return a;let l=8*t.modules[n].n64;return t.modules[a]={n64:3*t.modules[n].n64},function(){let e=t.addFunction(a+"_isZero");e.addParam("x","i32"),e.setReturnType("i32");let i=e.getCodeBuilder(),o=i.getLocal("x"),r=i.i32_add(i.getLocal("x"),i.i32_const(l)),s=i.i32_add(i.getLocal("x"),i.i32_const(2*l));e.addCode(i.i32_and(i.i32_and(i.call(n+"_isZero",o),i.call(n+"_isZero",r)),i.call(n+"_isZero",s)))}(),function(){let e=t.addFunction(a+"_isOne");e.addParam("x","i32"),e.setReturnType("i32");let i=e.getCodeBuilder(),o=i.getLocal("x"),r=i.i32_add(i.getLocal("x"),i.i32_const(l)),s=i.i32_add(i.getLocal("x"),i.i32_const(2*l));e.addCode(i.ret(i.i32_and(i.i32_and(i.call(n+"_isOne",o),i.call(n+"_isZero",r)),i.call(n+"_isZero",s))))}(),function(){let e=t.addFunction(a+"_zero");e.addParam("x","i32");let i=e.getCodeBuilder(),o=i.getLocal("x"),r=i.i32_add(i.getLocal("x"),i.i32_const(l)),s=i.i32_add(i.getLocal("x"),i.i32_const(2*l));e.addCode(i.call(n+"_zero",o),i.call(n+"_zero",r),i.call(n+"_zero",s))}(),function(){let e=t.addFunction(a+"_one");e.addParam("x","i32");let i=e.getCodeBuilder(),o=i.getLocal("x"),r=i.i32_add(i.getLocal("x"),i.i32_const(l)),s=i.i32_add(i.getLocal("x"),i.i32_const(2*l));e.addCode(i.call(n+"_one",o),i.call(n+"_zero",r),i.call(n+"_zero",s))}(),function(){let e=t.addFunction(a+"_copy");e.addParam("x","i32"),e.addParam("r","i32");let i=e.getCodeBuilder(),o=i.getLocal("x"),r=i.i32_add(i.getLocal("x"),i.i32_const(l)),s=i.i32_add(i.getLocal("x"),i.i32_const(2*l)),c=i.getLocal("r"),d=i.i32_add(i.getLocal("r"),i.i32_const(l)),u=i.i32_add(i.getLocal("r"),i.i32_const(2*l));e.addCode(i.call(n+"_copy",o,c),i.call(n+"_copy",r,d),i.call(n+"_copy",s,u))}(),function(){let i=t.addFunction(a+"_mul");i.addParam("x","i32"),i.addParam("y","i32"),i.addParam("r","i32");let o=i.getCodeBuilder(),r=o.getLocal("x"),s=o.i32_add(o.getLocal("x"),o.i32_const(l)),c=o.i32_add(o.getLocal("x"),o.i32_const(2*l)),d=o.getLocal("y"),u=o.i32_add(o.getLocal("y"),o.i32_const(l)),f=o.i32_add(o.getLocal("y"),o.i32_const(2*l)),h=o.getLocal("r"),g=o.i32_add(o.getLocal("r"),o.i32_const(l)),p=o.i32_add(o.getLocal("r"),o.i32_const(2*l)),_=o.i32_const(t.alloc(l)),m=o.i32_const(t.alloc(l)),b=o.i32_const(t.alloc(l)),L=o.i32_const(t.alloc(l)),w=o.i32_const(t.alloc(l)),y=o.i32_const(t.alloc(l)),A=o.i32_const(t.alloc(l)),C=o.i32_const(t.alloc(l)),I=o.i32_const(t.alloc(l)),F=o.i32_const(t.alloc(l)),x=o.i32_const(t.alloc(l)),E=o.i32_const(t.alloc(l)),v=o.i32_const(t.alloc(l));i.addCode(o.call(n+"_mul",r,d,_),o.call(n+"_mul",s,u,m),o.call(n+"_mul",c,f,b),o.call(n+"_add",r,s,L),o.call(n+"_add",d,u,w),o.call(n+"_add",r,c,y),o.call(n+"_add",d,f,A),o.call(n+"_add",s,c,C),o.call(n+"_add",u,f,I),o.call(n+"_add",_,m,F),o.call(n+"_add",_,b,x),o.call(n+"_add",m,b,E),o.call(n+"_mul",C,I,h),o.call(n+"_sub",h,E,h),o.call(e,h,h),o.call(n+"_add",_,h,h),o.call(n+"_mul",L,w,g),o.call(n+"_sub",g,F,g),o.call(e,b,v),o.call(n+"_add",g,v,g),o.call(n+"_mul",y,A,p),o.call(n+"_sub",p,x,p),o.call(n+"_add",p,m,p))}(),function(){let i=t.addFunction(a+"_square");i.addParam("x","i32"),i.addParam("r","i32");let o=i.getCodeBuilder(),r=o.getLocal("x"),s=o.i32_add(o.getLocal("x"),o.i32_const(l)),c=o.i32_add(o.getLocal("x"),o.i32_const(2*l)),d=o.getLocal("r"),u=o.i32_add(o.getLocal("r"),o.i32_const(l)),f=o.i32_add(o.getLocal("r"),o.i32_const(2*l)),h=o.i32_const(t.alloc(l)),g=o.i32_const(t.alloc(l)),p=o.i32_const(t.alloc(l)),_=o.i32_const(t.alloc(l)),m=o.i32_const(t.alloc(l)),b=o.i32_const(t.alloc(l)),L=o.i32_const(t.alloc(l));i.addCode(o.call(n+"_square",r,h),o.call(n+"_mul",r,s,g),o.call(n+"_add",g,g,p),o.call(n+"_sub",r,s,_),o.call(n+"_add",_,c,_),o.call(n+"_square",_,_),o.call(n+"_mul",s,c,m),o.call(n+"_add",m,m,b),o.call(n+"_square",c,L),o.call(e,b,d),o.call(n+"_add",h,d,d),o.call(e,L,u),o.call(n+"_add",p,u,u),o.call(n+"_add",h,L,f),o.call(n+"_sub",b,f,f),o.call(n+"_add",_,f,f),o.call(n+"_add",p,f,f))}(),function(){let e=t.addFunction(a+"_add");e.addParam("x","i32"),e.addParam("y","i32"),e.addParam("r","i32");let i=e.getCodeBuilder(),o=i.getLocal("x"),r=i.i32_add(i.getLocal("x"),i.i32_const(l)),s=i.i32_add(i.getLocal("x"),i.i32_const(2*l)),c=i.getLocal("y"),d=i.i32_add(i.getLocal("y"),i.i32_const(l)),u=i.i32_add(i.getLocal("y"),i.i32_const(2*l)),f=i.getLocal("r"),h=i.i32_add(i.getLocal("r"),i.i32_const(l)),g=i.i32_add(i.getLocal("r"),i.i32_const(2*l));e.addCode(i.call(n+"_add",o,c,f),i.call(n+"_add",r,d,h),i.call(n+"_add",s,u,g))}(),function(){let e=t.addFunction(a+"_sub");e.addParam("x","i32"),e.addParam("y","i32"),e.addParam("r","i32");let i=e.getCodeBuilder(),o=i.getLocal("x"),r=i.i32_add(i.getLocal("x"),i.i32_const(l)),s=i.i32_add(i.getLocal("x"),i.i32_const(2*l)),c=i.getLocal("y"),d=i.i32_add(i.getLocal("y"),i.i32_const(l)),u=i.i32_add(i.getLocal("y"),i.i32_const(2*l)),f=i.getLocal("r"),h=i.i32_add(i.getLocal("r"),i.i32_const(l)),g=i.i32_add(i.getLocal("r"),i.i32_const(2*l));e.addCode(i.call(n+"_sub",o,c,f),i.call(n+"_sub",r,d,h),i.call(n+"_sub",s,u,g))}(),function(){let e=t.addFunction(a+"_neg");e.addParam("x","i32"),e.addParam("r","i32");let i=e.getCodeBuilder(),o=i.getLocal("x"),r=i.i32_add(i.getLocal("x"),i.i32_const(l)),s=i.i32_add(i.getLocal("x"),i.i32_const(2*l)),c=i.getLocal("r"),d=i.i32_add(i.getLocal("r"),i.i32_const(l)),u=i.i32_add(i.getLocal("r"),i.i32_const(2*l));e.addCode(i.call(n+"_neg",o,c),i.call(n+"_neg",r,d),i.call(n+"_neg",s,u))}(),function(){let e=t.addFunction(a+"_sign");e.addParam("x","i32"),e.addLocal("s","i32"),e.setReturnType("i32");let i=e.getCodeBuilder(),o=i.getLocal("x"),r=i.i32_add(i.getLocal("x"),i.i32_const(l)),s=i.i32_add(i.getLocal("x"),i.i32_const(2*l));e.addCode(i.setLocal("s",i.call(n+"_sign",s)),i.if(i.getLocal("s"),i.ret(i.getLocal("s"))),i.setLocal("s",i.call(n+"_sign",r)),i.if(i.getLocal("s"),i.ret(i.getLocal("s"))),i.ret(i.call(n+"_sign",o)))}(),function(){let e=t.addFunction(a+"_toMontgomery");e.addParam("x","i32"),e.addParam("r","i32");let i=e.getCodeBuilder(),o=i.getLocal("x"),r=i.i32_add(i.getLocal("x"),i.i32_const(l)),s=i.i32_add(i.getLocal("x"),i.i32_const(2*l)),c=i.getLocal("r"),d=i.i32_add(i.getLocal("r"),i.i32_const(l)),u=i.i32_add(i.getLocal("r"),i.i32_const(2*l));e.addCode(i.call(n+"_toMontgomery",o,c),i.call(n+"_toMontgomery",r,d),i.call(n+"_toMontgomery",s,u))}(),function(){let e=t.addFunction(a+"_fromMontgomery");e.addParam("x","i32"),e.addParam("r","i32");let i=e.getCodeBuilder(),o=i.getLocal("x"),r=i.i32_add(i.getLocal("x"),i.i32_const(l)),s=i.i32_add(i.getLocal("x"),i.i32_const(2*l)),c=i.getLocal("r"),d=i.i32_add(i.getLocal("r"),i.i32_const(l)),u=i.i32_add(i.getLocal("r"),i.i32_const(2*l));e.addCode(i.call(n+"_fromMontgomery",o,c),i.call(n+"_fromMontgomery",r,d),i.call(n+"_fromMontgomery",s,u))}(),function(){let e=t.addFunction(a+"_eq");e.addParam("x","i32"),e.addParam("y","i32"),e.setReturnType("i32");let i=e.getCodeBuilder(),o=i.getLocal("x"),r=i.i32_add(i.getLocal("x"),i.i32_const(l)),s=i.i32_add(i.getLocal("x"),i.i32_const(2*l)),c=i.getLocal("y"),d=i.i32_add(i.getLocal("y"),i.i32_const(l)),u=i.i32_add(i.getLocal("y"),i.i32_const(2*l));e.addCode(i.i32_and(i.i32_and(i.call(n+"_eq",o,c),i.call(n+"_eq",r,d)),i.call(n+"_eq",s,u)))}(),function(){let i=t.addFunction(a+"_inverse");i.addParam("x","i32"),i.addParam("r","i32");let o=i.getCodeBuilder(),r=o.getLocal("x"),s=o.i32_add(o.getLocal("x"),o.i32_const(l)),c=o.i32_add(o.getLocal("x"),o.i32_const(2*l)),d=o.getLocal("r"),u=o.i32_add(o.getLocal("r"),o.i32_const(l)),f=o.i32_add(o.getLocal("r"),o.i32_const(2*l)),h=o.i32_const(t.alloc(l)),g=o.i32_const(t.alloc(l)),p=o.i32_const(t.alloc(l)),_=o.i32_const(t.alloc(l)),m=o.i32_const(t.alloc(l)),b=o.i32_const(t.alloc(l)),L=o.i32_const(t.alloc(l)),w=o.i32_const(t.alloc(l)),y=o.i32_const(t.alloc(l)),A=o.i32_const(t.alloc(l)),C=o.i32_const(t.alloc(l));i.addCode(o.call(n+"_square",r,h),o.call(n+"_square",s,g),o.call(n+"_square",c,p),o.call(n+"_mul",r,s,_),o.call(n+"_mul",r,c,m),o.call(n+"_mul",s,c,b),o.call(e,b,L),o.call(n+"_sub",h,L,L),o.call(e,p,w),o.call(n+"_sub",w,_,w),o.call(n+"_sub",g,m,y),o.call(n+"_mul",c,w,A),o.call(n+"_mul",s,y,C),o.call(n+"_add",A,C,A),o.call(e,A,A),o.call(n+"_mul",r,L,C),o.call(n+"_add",C,A,A),o.call(n+"_inverse",A,A),o.call(n+"_mul",A,L,d),o.call(n+"_mul",A,w,u),o.call(n+"_mul",A,y,f))}(),function(){let e=t.addFunction(a+"_timesScalar");e.addParam("x","i32"),e.addParam("scalar","i32"),e.addParam("scalarLen","i32"),e.addParam("r","i32");let i=e.getCodeBuilder(),o=i.getLocal("x"),r=i.i32_add(i.getLocal("x"),i.i32_const(l)),s=i.i32_add(i.getLocal("x"),i.i32_const(2*l)),c=i.getLocal("r"),d=i.i32_add(i.getLocal("r"),i.i32_const(l)),u=i.i32_add(i.getLocal("r"),i.i32_const(2*l));e.addCode(i.call(n+"_timesScalar",o,i.getLocal("scalar"),i.getLocal("scalarLen"),c),i.call(n+"_timesScalar",r,i.getLocal("scalar"),i.getLocal("scalarLen"),d),i.call(n+"_timesScalar",s,i.getLocal("scalar"),i.getLocal("scalarLen"),u))}(),function(){let e=t.addFunction(a+"_isNegative");e.addParam("x","i32"),e.setReturnType("i32");let i=e.getCodeBuilder(),o=i.getLocal("x"),r=i.i32_add(i.getLocal("x"),i.i32_const(l)),s=i.i32_add(i.getLocal("x"),i.i32_const(2*l));e.addCode(i.if(i.call(n+"_isZero",s),i.if(i.call(n+"_isZero",r),i.ret(i.call(n+"_isNegative",o)),i.ret(i.call(n+"_isNegative",r)))),i.ret(i.call(n+"_isNegative",s)))}(),t.exportFunction(a+"_isZero"),t.exportFunction(a+"_isOne"),t.exportFunction(a+"_zero"),t.exportFunction(a+"_one"),t.exportFunction(a+"_copy"),t.exportFunction(a+"_mul"),t.exportFunction(a+"_square"),t.exportFunction(a+"_add"),t.exportFunction(a+"_sub"),t.exportFunction(a+"_neg"),t.exportFunction(a+"_sign"),t.exportFunction(a+"_fromMontgomery"),t.exportFunction(a+"_toMontgomery"),t.exportFunction(a+"_eq"),t.exportFunction(a+"_inverse"),o(t,a),i(t,a+"_exp",3*l,a+"_mul",a+"_square",a+"_copy",a+"_one"),t.exportFunction(a+"_exp"),t.exportFunction(a+"_timesScalar"),t.exportFunction(a+"_batchInverse"),t.exportFunction(a+"_isNegative"),a}},3920:(t,e,a)=>{let{isOdd:i,modInv:o,modPow:n}=a(3667),l=a(1209);t.exports=function(t,e,a,r,s){let c=8*t.modules[r].n64,d=8*t.modules[a].n64,u=t.modules[r].q,f=u-1n,h=0;for(;!i(f);)h++,f>>=1n;let g=2n;for(;1n===n(g,u>>1n,u);)g+=1n;let p=Array(h+1);p[h]=n(g,f,u);let _=h-1;for(;_>=0;)p[_]=n(p[_+1],2n,u),_--;let m=[],b=(1n<<BigInt(8*c))%u;for(let t=0;t<p.length;t++){let e=p[t]*b%u;m.push(...l.bigInt2BytesLE(e,c))}let L=t.alloc(m),w=Array(h+1);w[0]=1n;for(let t=1;t<=h;t++)w[t]=2n*w[t-1];let y=[];for(let t=0;t<=h;t++){let e=o(w[t],u)*b%u;y.push(...l.bigInt2BytesLE(e,c))}let A=t.alloc(y),C=n(g,2n,u),I=[],F=[];for(let t=0;t<=h;t++){let e=n(C,2n**BigInt(t),u),a=o(u+1n-e,u);I.push(...l.bigInt2BytesLE(e*b%u,c)),F.push(...l.bigInt2BytesLE(a*b%u,c))}let x=t.alloc(I),E=t.alloc(F),v=Array(256);for(let t=0;t<256;t++)v[t]=function(t){let e=0;for(let a=0;a<8;a++)t&1<<a&&(e|=128>>a);return e}(t);let B=t.alloc(v);(function(){let a=t.addFunction(e+"__rev");a.addParam("x","i32"),a.addParam("bits","i32"),a.setReturnType("i32");let i=a.getCodeBuilder();a.addCode(i.i32_rotl(i.i32_add(i.i32_add(i.i32_shl(i.i32_load8_u(i.i32_and(i.getLocal("x"),i.i32_const(255)),B,0),i.i32_const(24)),i.i32_shl(i.i32_load8_u(i.i32_and(i.i32_shr_u(i.getLocal("x"),i.i32_const(8)),i.i32_const(255)),B,0),i.i32_const(16))),i.i32_add(i.i32_shl(i.i32_load8_u(i.i32_and(i.i32_shr_u(i.getLocal("x"),i.i32_const(16)),i.i32_const(255)),B,0),i.i32_const(8)),i.i32_load8_u(i.i32_and(i.i32_shr_u(i.getLocal("x"),i.i32_const(24)),i.i32_const(255)),B,0))),i.getLocal("bits")))})(),function(){let i=t.addFunction(e+"__reversePermutation");i.addParam("px","i32"),i.addParam("bits","i32"),i.addLocal("n","i32"),i.addLocal("i","i32"),i.addLocal("ri","i32"),i.addLocal("idx1","i32"),i.addLocal("idx2","i32");let o=i.getCodeBuilder(),n=o.i32_const(t.alloc(d));i.addCode(o.setLocal("n",o.i32_shl(o.i32_const(1),o.getLocal("bits"))),o.setLocal("i",o.i32_const(0)),o.block(o.loop(o.br_if(1,o.i32_eq(o.getLocal("i"),o.getLocal("n"))),o.setLocal("idx1",o.i32_add(o.getLocal("px"),o.i32_mul(o.getLocal("i"),o.i32_const(d)))),o.setLocal("ri",o.call(e+"__rev",o.getLocal("i"),o.getLocal("bits"))),o.setLocal("idx2",o.i32_add(o.getLocal("px"),o.i32_mul(o.getLocal("ri"),o.i32_const(d)))),o.if(o.i32_lt_u(o.getLocal("i"),o.getLocal("ri")),[...o.call(a+"_copy",o.getLocal("idx1"),n),...o.call(a+"_copy",o.getLocal("idx2"),o.getLocal("idx1")),...o.call(a+"_copy",n,o.getLocal("idx2"))]),o.setLocal("i",o.i32_add(o.getLocal("i"),o.i32_const(1))),o.br(0))))}(),function(){let i=t.addFunction(e+"__fftFinal");i.addParam("px","i32"),i.addParam("bits","i32"),i.addParam("reverse","i32"),i.addParam("mulFactor","i32"),i.addLocal("n","i32"),i.addLocal("ndiv2","i32"),i.addLocal("pInv2","i32"),i.addLocal("i","i32"),i.addLocal("mask","i32"),i.addLocal("idx1","i32"),i.addLocal("idx2","i32");let o=i.getCodeBuilder(),n=o.i32_const(t.alloc(d));i.addCode(o.if(o.i32_and(o.i32_eqz(o.getLocal("reverse")),o.call(r+"_isOne",o.getLocal("mulFactor"))),o.ret([])),o.setLocal("n",o.i32_shl(o.i32_const(1),o.getLocal("bits"))),o.setLocal("mask",o.i32_sub(o.getLocal("n"),o.i32_const(1))),o.setLocal("i",o.i32_const(1)),o.setLocal("ndiv2",o.i32_shr_u(o.getLocal("n"),o.i32_const(1))),o.block(o.loop(o.br_if(1,o.i32_ge_u(o.getLocal("i"),o.getLocal("ndiv2"))),o.setLocal("idx1",o.i32_add(o.getLocal("px"),o.i32_mul(o.getLocal("i"),o.i32_const(d)))),o.setLocal("idx2",o.i32_add(o.getLocal("px"),o.i32_mul(o.i32_sub(o.getLocal("n"),o.getLocal("i")),o.i32_const(d)))),o.if(o.getLocal("reverse"),o.if(o.call(r+"_isOne",o.getLocal("mulFactor")),[...o.call(a+"_copy",o.getLocal("idx1"),n),...o.call(a+"_copy",o.getLocal("idx2"),o.getLocal("idx1")),...o.call(a+"_copy",n,o.getLocal("idx2"))],[...o.call(a+"_copy",o.getLocal("idx1"),n),...o.call(s,o.getLocal("idx2"),o.getLocal("mulFactor"),o.getLocal("idx1")),...o.call(s,n,o.getLocal("mulFactor"),o.getLocal("idx2"))]),o.if(o.call(r+"_isOne",o.getLocal("mulFactor")),[],[...o.call(s,o.getLocal("idx1"),o.getLocal("mulFactor"),o.getLocal("idx1")),...o.call(s,o.getLocal("idx2"),o.getLocal("mulFactor"),o.getLocal("idx2"))])),o.setLocal("i",o.i32_add(o.getLocal("i"),o.i32_const(1))),o.br(0))),o.if(o.call(r+"_isOne",o.getLocal("mulFactor")),[],[...o.call(s,o.getLocal("px"),o.getLocal("mulFactor"),o.getLocal("px")),...o.setLocal("idx2",o.i32_add(o.getLocal("px"),o.i32_mul(o.getLocal("ndiv2"),o.i32_const(d)))),...o.call(s,o.getLocal("idx2"),o.getLocal("mulFactor"),o.getLocal("idx2"))]))}(),function(){let i=t.addFunction(e+"_rawfft");i.addParam("px","i32"),i.addParam("bits","i32"),i.addParam("reverse","i32"),i.addParam("mulFactor","i32"),i.addLocal("s","i32"),i.addLocal("k","i32"),i.addLocal("j","i32"),i.addLocal("m","i32"),i.addLocal("mdiv2","i32"),i.addLocal("n","i32"),i.addLocal("pwm","i32"),i.addLocal("idx1","i32"),i.addLocal("idx2","i32");let o=i.getCodeBuilder(),n=o.i32_const(t.alloc(c)),l=o.i32_const(t.alloc(d)),u=o.i32_const(t.alloc(d));i.addCode(o.call(e+"__reversePermutation",o.getLocal("px"),o.getLocal("bits")),o.setLocal("n",o.i32_shl(o.i32_const(1),o.getLocal("bits"))),o.setLocal("s",o.i32_const(1)),o.block(o.loop(o.br_if(1,o.i32_gt_u(o.getLocal("s"),o.getLocal("bits"))),o.setLocal("m",o.i32_shl(o.i32_const(1),o.getLocal("s"))),o.setLocal("pwm",o.i32_add(o.i32_const(L),o.i32_mul(o.getLocal("s"),o.i32_const(c)))),o.setLocal("k",o.i32_const(0)),o.block(o.loop(o.br_if(1,o.i32_ge_u(o.getLocal("k"),o.getLocal("n"))),o.call(r+"_one",n),o.setLocal("mdiv2",o.i32_shr_u(o.getLocal("m"),o.i32_const(1))),o.setLocal("j",o.i32_const(0)),o.block(o.loop(o.br_if(1,o.i32_ge_u(o.getLocal("j"),o.getLocal("mdiv2"))),o.setLocal("idx1",o.i32_add(o.getLocal("px"),o.i32_mul(o.i32_add(o.getLocal("k"),o.getLocal("j")),o.i32_const(d)))),o.setLocal("idx2",o.i32_add(o.getLocal("idx1"),o.i32_mul(o.getLocal("mdiv2"),o.i32_const(d)))),o.call(s,o.getLocal("idx2"),n,l),o.call(a+"_copy",o.getLocal("idx1"),u),o.call(a+"_add",u,l,o.getLocal("idx1")),o.call(a+"_sub",u,l,o.getLocal("idx2")),o.call(r+"_mul",n,o.getLocal("pwm"),n),o.setLocal("j",o.i32_add(o.getLocal("j"),o.i32_const(1))),o.br(0))),o.setLocal("k",o.i32_add(o.getLocal("k"),o.getLocal("m"))),o.br(0))),o.setLocal("s",o.i32_add(o.getLocal("s"),o.i32_const(1))),o.br(0))),o.call(e+"__fftFinal",o.getLocal("px"),o.getLocal("bits"),o.getLocal("reverse"),o.getLocal("mulFactor")))}(),function(){let a=t.addFunction(e+"__log2");a.addParam("n","i32"),a.setReturnType("i32"),a.addLocal("bits","i32"),a.addLocal("aux","i32");let i=a.getCodeBuilder();a.addCode(i.setLocal("aux",i.i32_shr_u(i.getLocal("n"),i.i32_const(1)))),a.addCode(i.setLocal("bits",i.i32_const(0))),a.addCode(i.block(i.loop(i.br_if(1,i.i32_eqz(i.getLocal("aux"))),i.setLocal("aux",i.i32_shr_u(i.getLocal("aux"),i.i32_const(1))),i.setLocal("bits",i.i32_add(i.getLocal("bits"),i.i32_const(1))),i.br(0)))),a.addCode(i.if(i.i32_ne(i.getLocal("n"),i.i32_shl(i.i32_const(1),i.getLocal("bits"))),i.unreachable())),a.addCode(i.if(i.i32_gt_u(i.getLocal("bits"),i.i32_const(h)),i.unreachable())),a.addCode(i.getLocal("bits"))}(),function(){let a=t.addFunction(e+"_fft");a.addParam("px","i32"),a.addParam("n","i32"),a.addLocal("bits","i32");let i=a.getCodeBuilder(),o=i.i32_const(t.alloc(c));a.addCode(i.setLocal("bits",i.call(e+"__log2",i.getLocal("n"))),i.call(r+"_one",o),i.call(e+"_rawfft",i.getLocal("px"),i.getLocal("bits"),i.i32_const(0),o))}(),function(){let a=t.addFunction(e+"_ifft");a.addParam("px","i32"),a.addParam("n","i32"),a.addLocal("bits","i32"),a.addLocal("pInv2","i32");let i=a.getCodeBuilder();a.addCode(i.setLocal("bits",i.call(e+"__log2",i.getLocal("n"))),i.setLocal("pInv2",i.i32_add(i.i32_const(A),i.i32_mul(i.getLocal("bits"),i.i32_const(c)))),i.call(e+"_rawfft",i.getLocal("px"),i.getLocal("bits"),i.i32_const(1),i.getLocal("pInv2")))}(),function(){let i=t.addFunction(e+"_fftJoin");i.addParam("pBuff1","i32"),i.addParam("pBuff2","i32"),i.addParam("n","i32"),i.addParam("first","i32"),i.addParam("inc","i32"),i.addLocal("idx1","i32"),i.addLocal("idx2","i32"),i.addLocal("i","i32");let o=i.getCodeBuilder(),n=o.i32_const(t.alloc(c)),l=o.i32_const(t.alloc(d)),u=o.i32_const(t.alloc(d));i.addCode(o.call(r+"_copy",o.getLocal("first"),n),o.setLocal("i",o.i32_const(0)),o.block(o.loop(o.br_if(1,o.i32_eq(o.getLocal("i"),o.getLocal("n"))),o.setLocal("idx1",o.i32_add(o.getLocal("pBuff1"),o.i32_mul(o.getLocal("i"),o.i32_const(d)))),o.setLocal("idx2",o.i32_add(o.getLocal("pBuff2"),o.i32_mul(o.getLocal("i"),o.i32_const(d)))),o.call(s,o.getLocal("idx2"),n,l),o.call(a+"_copy",o.getLocal("idx1"),u),o.call(a+"_add",u,l,o.getLocal("idx1")),o.call(a+"_sub",u,l,o.getLocal("idx2")),o.call(r+"_mul",n,o.getLocal("inc"),n),o.setLocal("i",o.i32_add(o.getLocal("i"),o.i32_const(1))),o.br(0))))}(),function(){let i=t.addFunction(e+"_fftJoinExt");i.addParam("pBuff1","i32"),i.addParam("pBuff2","i32"),i.addParam("n","i32"),i.addParam("first","i32"),i.addParam("inc","i32"),i.addParam("totalBits","i32"),i.addLocal("idx1","i32"),i.addLocal("idx2","i32"),i.addLocal("i","i32"),i.addLocal("pShiftToM","i32");let o=i.getCodeBuilder(),n=o.i32_const(t.alloc(c)),l=o.i32_const(t.alloc(d));i.addCode(o.setLocal("pShiftToM",o.i32_add(o.i32_const(x),o.i32_mul(o.getLocal("totalBits"),o.i32_const(c)))),o.call(r+"_copy",o.getLocal("first"),n),o.setLocal("i",o.i32_const(0)),o.block(o.loop(o.br_if(1,o.i32_eq(o.getLocal("i"),o.getLocal("n"))),o.setLocal("idx1",o.i32_add(o.getLocal("pBuff1"),o.i32_mul(o.getLocal("i"),o.i32_const(d)))),o.setLocal("idx2",o.i32_add(o.getLocal("pBuff2"),o.i32_mul(o.getLocal("i"),o.i32_const(d)))),o.call(a+"_add",o.getLocal("idx1"),o.getLocal("idx2"),l),o.call(s,o.getLocal("idx2"),o.getLocal("pShiftToM"),o.getLocal("idx2")),o.call(a+"_add",o.getLocal("idx1"),o.getLocal("idx2"),o.getLocal("idx2")),o.call(s,o.getLocal("idx2"),n,o.getLocal("idx2")),o.call(a+"_copy",l,o.getLocal("idx1")),o.call(r+"_mul",n,o.getLocal("inc"),n),o.setLocal("i",o.i32_add(o.getLocal("i"),o.i32_const(1))),o.br(0))))}(),function(){let i=t.addFunction(e+"_fftJoinExtInv");i.addParam("pBuff1","i32"),i.addParam("pBuff2","i32"),i.addParam("n","i32"),i.addParam("first","i32"),i.addParam("inc","i32"),i.addParam("totalBits","i32"),i.addLocal("idx1","i32"),i.addLocal("idx2","i32"),i.addLocal("i","i32"),i.addLocal("pShiftToM","i32"),i.addLocal("pSConst","i32");let o=i.getCodeBuilder(),n=o.i32_const(t.alloc(c)),l=o.i32_const(t.alloc(d));i.addCode(o.setLocal("pShiftToM",o.i32_add(o.i32_const(x),o.i32_mul(o.getLocal("totalBits"),o.i32_const(c)))),o.setLocal("pSConst",o.i32_add(o.i32_const(E),o.i32_mul(o.getLocal("totalBits"),o.i32_const(c)))),o.call(r+"_copy",o.getLocal("first"),n),o.setLocal("i",o.i32_const(0)),o.block(o.loop(o.br_if(1,o.i32_eq(o.getLocal("i"),o.getLocal("n"))),o.setLocal("idx1",o.i32_add(o.getLocal("pBuff1"),o.i32_mul(o.getLocal("i"),o.i32_const(d)))),o.setLocal("idx2",o.i32_add(o.getLocal("pBuff2"),o.i32_mul(o.getLocal("i"),o.i32_const(d)))),o.call(s,o.getLocal("idx2"),n,l),o.call(a+"_sub",o.getLocal("idx1"),l,o.getLocal("idx2")),o.call(s,o.getLocal("idx2"),o.getLocal("pSConst"),o.getLocal("idx2")),o.call(s,o.getLocal("idx1"),o.getLocal("pShiftToM"),o.getLocal("idx1")),o.call(a+"_sub",l,o.getLocal("idx1"),o.getLocal("idx1")),o.call(s,o.getLocal("idx1"),o.getLocal("pSConst"),o.getLocal("idx1")),o.call(r+"_mul",n,o.getLocal("inc"),n),o.setLocal("i",o.i32_add(o.getLocal("i"),o.i32_const(1))),o.br(0))))}(),function(){let i=t.addFunction(e+"_fftMix");i.addParam("pBuff","i32"),i.addParam("n","i32"),i.addParam("exp","i32"),i.addLocal("nGroups","i32"),i.addLocal("nPerGroup","i32"),i.addLocal("nPerGroupDiv2","i32"),i.addLocal("pairOffset","i32"),i.addLocal("idx1","i32"),i.addLocal("idx2","i32"),i.addLocal("i","i32"),i.addLocal("j","i32"),i.addLocal("pwm","i32");let o=i.getCodeBuilder(),n=o.i32_const(t.alloc(c)),l=o.i32_const(t.alloc(d)),u=o.i32_const(t.alloc(d));i.addCode(o.setLocal("nPerGroup",o.i32_shl(o.i32_const(1),o.getLocal("exp"))),o.setLocal("nPerGroupDiv2",o.i32_shr_u(o.getLocal("nPerGroup"),o.i32_const(1))),o.setLocal("nGroups",o.i32_shr_u(o.getLocal("n"),o.getLocal("exp"))),o.setLocal("pairOffset",o.i32_mul(o.getLocal("nPerGroupDiv2"),o.i32_const(d))),o.setLocal("pwm",o.i32_add(o.i32_const(L),o.i32_mul(o.getLocal("exp"),o.i32_const(c)))),o.setLocal("i",o.i32_const(0)),o.block(o.loop(o.br_if(1,o.i32_eq(o.getLocal("i"),o.getLocal("nGroups"))),o.call(r+"_one",n),o.setLocal("j",o.i32_const(0)),o.block(o.loop(o.br_if(1,o.i32_eq(o.getLocal("j"),o.getLocal("nPerGroupDiv2"))),o.setLocal("idx1",o.i32_add(o.getLocal("pBuff"),o.i32_mul(o.i32_add(o.i32_mul(o.getLocal("i"),o.getLocal("nPerGroup")),o.getLocal("j")),o.i32_const(d)))),o.setLocal("idx2",o.i32_add(o.getLocal("idx1"),o.getLocal("pairOffset"))),o.call(s,o.getLocal("idx2"),n,l),o.call(a+"_copy",o.getLocal("idx1"),u),o.call(a+"_add",u,l,o.getLocal("idx1")),o.call(a+"_sub",u,l,o.getLocal("idx2")),o.call(r+"_mul",n,o.getLocal("pwm"),n),o.setLocal("j",o.i32_add(o.getLocal("j"),o.i32_const(1))),o.br(0))),o.setLocal("i",o.i32_add(o.getLocal("i"),o.i32_const(1))),o.br(0))))}(),function(){let i=t.addFunction(e+"_fftFinal");i.addParam("pBuff","i32"),i.addParam("n","i32"),i.addParam("factor","i32"),i.addLocal("idx1","i32"),i.addLocal("idx2","i32"),i.addLocal("i","i32"),i.addLocal("ndiv2","i32");let o=i.getCodeBuilder(),n=o.i32_const(t.alloc(d));i.addCode(o.setLocal("ndiv2",o.i32_shr_u(o.getLocal("n"),o.i32_const(1))),o.if(o.i32_and(o.getLocal("n"),o.i32_const(1)),o.call(s,o.i32_add(o.getLocal("pBuff"),o.i32_mul(o.getLocal("ndiv2"),o.i32_const(d))),o.getLocal("factor"),o.i32_add(o.getLocal("pBuff"),o.i32_mul(o.getLocal("ndiv2"),o.i32_const(d))))),o.setLocal("i",o.i32_const(0)),o.block(o.loop(o.br_if(1,o.i32_ge_u(o.getLocal("i"),o.getLocal("ndiv2"))),o.setLocal("idx1",o.i32_add(o.getLocal("pBuff"),o.i32_mul(o.getLocal("i"),o.i32_const(d)))),o.setLocal("idx2",o.i32_add(o.getLocal("pBuff"),o.i32_mul(o.i32_sub(o.i32_sub(o.getLocal("n"),o.i32_const(1)),o.getLocal("i")),o.i32_const(d)))),o.call(s,o.getLocal("idx2"),o.getLocal("factor"),n),o.call(s,o.getLocal("idx1"),o.getLocal("factor"),o.getLocal("idx2")),o.call(a+"_copy",n,o.getLocal("idx1")),o.setLocal("i",o.i32_add(o.getLocal("i"),o.i32_const(1))),o.br(0))))}(),function(){let i=t.addFunction(e+"_prepareLagrangeEvaluation");i.addParam("pBuff1","i32"),i.addParam("pBuff2","i32"),i.addParam("n","i32"),i.addParam("first","i32"),i.addParam("inc","i32"),i.addParam("totalBits","i32"),i.addLocal("idx1","i32"),i.addLocal("idx2","i32"),i.addLocal("i","i32"),i.addLocal("pShiftToM","i32"),i.addLocal("pSConst","i32");let o=i.getCodeBuilder(),n=o.i32_const(t.alloc(c)),l=o.i32_const(t.alloc(d));i.addCode(o.setLocal("pShiftToM",o.i32_add(o.i32_const(x),o.i32_mul(o.getLocal("totalBits"),o.i32_const(c)))),o.setLocal("pSConst",o.i32_add(o.i32_const(E),o.i32_mul(o.getLocal("totalBits"),o.i32_const(c)))),o.call(r+"_copy",o.getLocal("first"),n),o.setLocal("i",o.i32_const(0)),o.block(o.loop(o.br_if(1,o.i32_eq(o.getLocal("i"),o.getLocal("n"))),o.setLocal("idx1",o.i32_add(o.getLocal("pBuff1"),o.i32_mul(o.getLocal("i"),o.i32_const(d)))),o.setLocal("idx2",o.i32_add(o.getLocal("pBuff2"),o.i32_mul(o.getLocal("i"),o.i32_const(d)))),o.call(s,o.getLocal("idx1"),o.getLocal("pShiftToM"),l),o.call(a+"_sub",o.getLocal("idx2"),l,l),o.call(a+"_sub",o.getLocal("idx1"),o.getLocal("idx2"),o.getLocal("idx2")),o.call(s,l,o.getLocal("pSConst"),o.getLocal("idx1")),o.call(s,o.getLocal("idx2"),n,o.getLocal("idx2")),o.call(r+"_mul",n,o.getLocal("inc"),n),o.setLocal("i",o.i32_add(o.getLocal("i"),o.i32_const(1))),o.br(0))))}(),t.exportFunction(e+"_fft"),t.exportFunction(e+"_ifft"),t.exportFunction(e+"_rawfft"),t.exportFunction(e+"_fftJoin"),t.exportFunction(e+"_fftJoinExt"),t.exportFunction(e+"_fftJoinExtInv"),t.exportFunction(e+"_fftMix"),t.exportFunction(e+"_fftFinal"),t.exportFunction(e+"_prepareLagrangeEvaluation")}},1453:t=>{t.exports=function(t,e,a){let i=a||"int";if(t.modules[i])return i;t.modules[i]={};let o=2*e,n=8*e;return function(){let a=t.addFunction(i+"_copy");a.addParam("px","i32"),a.addParam("pr","i32");let o=a.getCodeBuilder();for(let t=0;t<e;t++)a.addCode(o.i64_store(o.getLocal("pr"),8*t,o.i64_load(o.getLocal("px"),8*t)))}(),function(){let a=t.addFunction(i+"_zero");a.addParam("pr","i32");let o=a.getCodeBuilder();for(let t=0;t<e;t++)a.addCode(o.i64_store(o.getLocal("pr"),8*t,o.i64_const(0)))}(),function(){let a=t.addFunction(i+"_isZero");a.addParam("px","i32"),a.setReturnType("i32");let o=a.getCodeBuilder();a.addCode(function t(e){return 0==e?o.ret(o.i64_eqz(o.i64_load(o.getLocal("px")))):o.if(o.i64_eqz(o.i64_load(o.getLocal("px"),8*e)),t(e-1),o.ret(o.i32_const(0)))}(e-1)),a.addCode(o.ret(o.i32_const(0)))}(),function(){let a=t.addFunction(i+"_one");a.addParam("pr","i32");let o=a.getCodeBuilder();a.addCode(o.i64_store(o.getLocal("pr"),0,o.i64_const(1)));for(let t=1;t<e;t++)a.addCode(o.i64_store(o.getLocal("pr"),8*t,o.i64_const(0)))}(),function(){let a=t.addFunction(i+"_eq");a.addParam("px","i32"),a.addParam("py","i32"),a.setReturnType("i32");let o=a.getCodeBuilder();a.addCode(function t(e){return 0==e?o.ret(o.i64_eq(o.i64_load(o.getLocal("px")),o.i64_load(o.getLocal("py")))):o.if(o.i64_eq(o.i64_load(o.getLocal("px"),8*e),o.i64_load(o.getLocal("py"),8*e)),t(e-1),o.ret(o.i32_const(0)))}(e-1)),a.addCode(o.ret(o.i32_const(0)))}(),function(){let a=t.addFunction(i+"_gte");a.addParam("px","i32"),a.addParam("py","i32"),a.setReturnType("i32");let o=a.getCodeBuilder();a.addCode(function t(e){return 0==e?o.ret(o.i64_ge_u(o.i64_load(o.getLocal("px")),o.i64_load(o.getLocal("py")))):o.if(o.i64_lt_u(o.i64_load(o.getLocal("px"),8*e),o.i64_load(o.getLocal("py"),8*e)),o.ret(o.i32_const(0)),o.if(o.i64_gt_u(o.i64_load(o.getLocal("px"),8*e),o.i64_load(o.getLocal("py"),8*e)),o.ret(o.i32_const(1)),t(e-1)))}(e-1)),a.addCode(o.ret(o.i32_const(0)))}(),function(){let e=t.addFunction(i+"_add");e.addParam("x","i32"),e.addParam("y","i32"),e.addParam("r","i32"),e.setReturnType("i32"),e.addLocal("c","i64");let a=e.getCodeBuilder();e.addCode(a.setLocal("c",a.i64_add(a.i64_load32_u(a.getLocal("x")),a.i64_load32_u(a.getLocal("y"))))),e.addCode(a.i64_store32(a.getLocal("r"),a.getLocal("c")));for(let t=1;t<o;t++)e.addCode(a.setLocal("c",a.i64_add(a.i64_add(a.i64_load32_u(a.getLocal("x"),4*t),a.i64_load32_u(a.getLocal("y"),4*t)),a.i64_shr_u(a.getLocal("c"),a.i64_const(32))))),e.addCode(a.i64_store32(a.getLocal("r"),4*t,a.getLocal("c")));e.addCode(a.i32_wrap_i64(a.i64_shr_u(a.getLocal("c"),a.i64_const(32))))}(),function(){let e=t.addFunction(i+"_sub");e.addParam("x","i32"),e.addParam("y","i32"),e.addParam("r","i32"),e.setReturnType("i32"),e.addLocal("c","i64");let a=e.getCodeBuilder();e.addCode(a.setLocal("c",a.i64_sub(a.i64_load32_u(a.getLocal("x")),a.i64_load32_u(a.getLocal("y"))))),e.addCode(a.i64_store32(a.getLocal("r"),a.i64_and(a.getLocal("c"),a.i64_const("0xFFFFFFFF"))));for(let t=1;t<o;t++)e.addCode(a.setLocal("c",a.i64_add(a.i64_sub(a.i64_load32_u(a.getLocal("x"),4*t),a.i64_load32_u(a.getLocal("y"),4*t)),a.i64_shr_s(a.getLocal("c"),a.i64_const(32))))),e.addCode(a.i64_store32(a.getLocal("r"),4*t,a.i64_and(a.getLocal("c"),a.i64_const("0xFFFFFFFF"))));e.addCode(a.i32_wrap_i64(a.i64_shr_s(a.getLocal("c"),a.i64_const(32))))}(),function(){let e=t.addFunction(i+"_mul");e.addParam("x","i32"),e.addParam("y","i32"),e.addParam("r","i32"),e.addLocal("c0","i64"),e.addLocal("c1","i64");for(let t=0;t<o;t++)e.addLocal("x"+t,"i64"),e.addLocal("y"+t,"i64");let a=e.getCodeBuilder(),n=[],l=[],r="c0",s="c1";for(let t=0;t<2*o-1;t++){for(let i=Math.max(0,t-o+1);i<=t&&i<o;i++){let o=t-i;e.addCode(a.setLocal(r,a.i64_add(a.i64_and(a.getLocal(r),a.i64_const(4294967295)),function(t,e){let i,o;return n[t]?i=a.getLocal("x"+t):(i=a.teeLocal("x"+t,a.i64_load32_u(a.getLocal("x"),4*t)),n[t]=!0),l[e]?o=a.getLocal("y"+e):(o=a.teeLocal("y"+e,a.i64_load32_u(a.getLocal("y"),4*e)),l[e]=!0),a.i64_mul(i,o)}(i,o)))),e.addCode(a.setLocal(s,a.i64_add(a.getLocal(s),a.i64_shr_u(a.getLocal(r),a.i64_const(32)))))}e.addCode(a.i64_store32(a.getLocal("r"),4*t,a.getLocal(r))),[r,s]=[s,r],e.addCode(a.setLocal(s,a.i64_shr_u(a.getLocal(r),a.i64_const(32))))}e.addCode(a.i64_store32(a.getLocal("r"),8*o-4,a.getLocal(r)))}(),function(){let e=t.addFunction(i+"_square");e.addParam("x","i32"),e.addParam("r","i32"),e.addLocal("c0","i64"),e.addLocal("c1","i64"),e.addLocal("c0_old","i64"),e.addLocal("c1_old","i64");for(let t=0;t<o;t++)e.addLocal("x"+t,"i64");let a=e.getCodeBuilder(),n=[];function l(t,e){let i,o;return n[t]?i=a.getLocal("x"+t):(i=a.teeLocal("x"+t,a.i64_load32_u(a.getLocal("x"),4*t)),n[t]=!0),n[e]?o=a.getLocal("x"+e):(o=a.teeLocal("x"+e,a.i64_load32_u(a.getLocal("x"),4*e)),n[e]=!0),a.i64_mul(i,o)}let r="c0_old",s="c1_old";for(let t=0;t<2*o-1;t++){e.addCode(a.setLocal("c0",a.i64_const(0)),a.setLocal("c1",a.i64_const(0)));for(let i=Math.max(0,t-o+1);i<t+1>>1&&i<o;i++){let o=t-i;e.addCode(a.setLocal("c0",a.i64_add(a.i64_and(a.getLocal("c0"),a.i64_const(4294967295)),l(i,o)))),e.addCode(a.setLocal("c1",a.i64_add(a.getLocal("c1"),a.i64_shr_u(a.getLocal("c0"),a.i64_const(32)))))}e.addCode(a.setLocal("c0",a.i64_shl(a.i64_and(a.getLocal("c0"),a.i64_const(4294967295)),a.i64_const(1)))),e.addCode(a.setLocal("c1",a.i64_add(a.i64_shl(a.getLocal("c1"),a.i64_const(1)),a.i64_shr_u(a.getLocal("c0"),a.i64_const(32))))),t%2==0&&(e.addCode(a.setLocal("c0",a.i64_add(a.i64_and(a.getLocal("c0"),a.i64_const(4294967295)),l(t>>1,t>>1)))),e.addCode(a.setLocal("c1",a.i64_add(a.getLocal("c1"),a.i64_shr_u(a.getLocal("c0"),a.i64_const(32)))))),t>0&&(e.addCode(a.setLocal("c0",a.i64_add(a.i64_and(a.getLocal("c0"),a.i64_const(4294967295)),a.i64_and(a.getLocal(r),a.i64_const(4294967295))))),e.addCode(a.setLocal("c1",a.i64_add(a.i64_add(a.getLocal("c1"),a.i64_shr_u(a.getLocal("c0"),a.i64_const(32))),a.getLocal(s))))),e.addCode(a.i64_store32(a.getLocal("r"),4*t,a.getLocal("c0"))),e.addCode(a.setLocal(r,a.getLocal("c1")),a.setLocal(s,a.i64_shr_u(a.getLocal(r),a.i64_const(32))))}e.addCode(a.i64_store32(a.getLocal("r"),8*o-4,a.getLocal(r)))}(),function(){let e=t.addFunction(i+"_squareOld");e.addParam("x","i32"),e.addParam("r","i32");let a=e.getCodeBuilder();e.addCode(a.call(i+"_mul",a.getLocal("x"),a.getLocal("x"),a.getLocal("r")))}(),function(){(function(){let e=t.addFunction(i+"__mul1");e.addParam("px","i32"),e.addParam("y","i64"),e.addParam("pr","i32"),e.addLocal("c","i64");let a=e.getCodeBuilder();e.addCode(a.setLocal("c",a.i64_mul(a.i64_load32_u(a.getLocal("px"),0,0),a.getLocal("y")))),e.addCode(a.i64_store32(a.getLocal("pr"),0,0,a.getLocal("c")));for(let t=1;t<o;t++)e.addCode(a.setLocal("c",a.i64_add(a.i64_mul(a.i64_load32_u(a.getLocal("px"),4*t,0),a.getLocal("y")),a.i64_shr_u(a.getLocal("c"),a.i64_const(32))))),e.addCode(a.i64_store32(a.getLocal("pr"),4*t,0,a.getLocal("c")))})(),function(){let e=t.addFunction(i+"__add1");e.addParam("x","i32"),e.addParam("y","i64"),e.addLocal("c","i64"),e.addLocal("px","i32");let a=e.getCodeBuilder();e.addCode(a.setLocal("px",a.getLocal("x"))),e.addCode(a.setLocal("c",a.i64_add(a.i64_load32_u(a.getLocal("px"),0,0),a.getLocal("y")))),e.addCode(a.i64_store32(a.getLocal("px"),0,0,a.getLocal("c"))),e.addCode(a.setLocal("c",a.i64_shr_u(a.getLocal("c"),a.i64_const(32)))),e.addCode(a.block(a.loop(a.br_if(1,a.i64_eqz(a.getLocal("c"))),a.setLocal("px",a.i32_add(a.getLocal("px"),a.i32_const(4))),a.setLocal("c",a.i64_add(a.i64_load32_u(a.getLocal("px"),0,0),a.getLocal("c"))),a.i64_store32(a.getLocal("px"),0,0,a.getLocal("c")),a.setLocal("c",a.i64_shr_u(a.getLocal("c"),a.i64_const(32))),a.br(0))))}();let e=t.addFunction(i+"_div");e.addParam("x","i32"),e.addParam("y","i32"),e.addParam("c","i32"),e.addParam("r","i32"),e.addLocal("rr","i32"),e.addLocal("cc","i32"),e.addLocal("eX","i32"),e.addLocal("eY","i32"),e.addLocal("sy","i64"),e.addLocal("sx","i64"),e.addLocal("ec","i32");let a=e.getCodeBuilder(),l=a.i32_const(t.alloc(n)),r=a.i32_const(t.alloc(n)),s=a.i32_const(t.alloc(n)),c=a.getLocal("cc"),d=a.getLocal("rr"),u=t.alloc(2*n),f=a.i32_const(u),h=a.i32_const(u+n);e.addCode(a.if(a.getLocal("c"),a.setLocal("cc",a.getLocal("c")),a.setLocal("cc",r))),e.addCode(a.if(a.getLocal("r"),a.setLocal("rr",a.getLocal("r")),a.setLocal("rr",s))),e.addCode(a.call(i+"_copy",a.getLocal("x"),d)),e.addCode(a.call(i+"_copy",a.getLocal("y"),l)),e.addCode(a.call(i+"_zero",c)),e.addCode(a.call(i+"_zero",f)),e.addCode(a.setLocal("eX",a.i32_const(n-1))),e.addCode(a.setLocal("eY",a.i32_const(n-1))),e.addCode(a.block(a.loop(a.br_if(1,a.i32_or(a.i32_load8_u(a.i32_add(l,a.getLocal("eY")),0,0),a.i32_eq(a.getLocal("eY"),a.i32_const(3)))),a.setLocal("eY",a.i32_sub(a.getLocal("eY"),a.i32_const(1))),a.br(0)))),e.addCode(a.setLocal("sy",a.i64_add(a.i64_load32_u(a.i32_sub(a.i32_add(l,a.getLocal("eY")),a.i32_const(3)),0,0),a.i64_const(1)))),e.addCode(a.if(a.i64_eq(a.getLocal("sy"),a.i64_const(1)),a.drop(a.i64_div_u(a.i64_const(0),a.i64_const(0))))),e.addCode(a.block(a.loop(a.block(a.loop(a.br_if(1,a.i32_or(a.i32_load8_u(a.i32_add(d,a.getLocal("eX")),0,0),a.i32_eq(a.getLocal("eX"),a.i32_const(7)))),a.setLocal("eX",a.i32_sub(a.getLocal("eX"),a.i32_const(1))),a.br(0))),a.setLocal("sx",a.i64_load(a.i32_sub(a.i32_add(d,a.getLocal("eX")),a.i32_const(7)),0,0)),a.setLocal("sx",a.i64_div_u(a.getLocal("sx"),a.getLocal("sy"))),a.setLocal("ec",a.i32_sub(a.i32_sub(a.getLocal("eX"),a.getLocal("eY")),a.i32_const(4))),a.block(a.loop(a.br_if(1,a.i32_and(a.i64_eqz(a.i64_and(a.getLocal("sx"),a.i64_const("0xFFFFFFFF00000000"))),a.i32_ge_s(a.getLocal("ec"),a.i32_const(0)))),a.setLocal("sx",a.i64_shr_u(a.getLocal("sx"),a.i64_const(8))),a.setLocal("ec",a.i32_add(a.getLocal("ec"),a.i32_const(1))),a.br(0))),a.if(a.i64_eqz(a.getLocal("sx")),[...a.br_if(2,a.i32_eqz(a.call(i+"_gte",d,l))),...a.setLocal("sx",a.i64_const(1)),...a.setLocal("ec",a.i32_const(0))]),a.call(i+"__mul1",l,a.getLocal("sx"),h),a.drop(a.call(i+"_sub",d,a.i32_sub(h,a.getLocal("ec")),d)),a.call(i+"__add1",a.i32_add(c,a.getLocal("ec")),a.getLocal("sx")),a.br(0))))}(),function(){let e=t.addFunction(i+"_inverseMod");e.addParam("px","i32"),e.addParam("pm","i32"),e.addParam("pr","i32"),e.addLocal("t","i32"),e.addLocal("newt","i32"),e.addLocal("r","i32"),e.addLocal("qq","i32"),e.addLocal("qr","i32"),e.addLocal("newr","i32"),e.addLocal("swp","i32"),e.addLocal("x","i32"),e.addLocal("signt","i32"),e.addLocal("signnewt","i32"),e.addLocal("signx","i32");let a=e.getCodeBuilder(),o=a.i32_const(t.alloc(n)),l=a.i32_const(t.alloc(n)),r=a.i32_const(t.alloc(n)),s=a.i32_const(t.alloc(n)),c=a.i32_const(t.alloc(n)),d=a.i32_const(t.alloc(n)),u=a.i32_const(t.alloc(2*n)),f=a.i32_const(t.alloc(n));e.addCode(a.setLocal("t",o),a.call(i+"_zero",o),a.setLocal("signt",a.i32_const(0))),e.addCode(a.setLocal("r",l),a.call(i+"_copy",a.getLocal("pm"),l)),e.addCode(a.setLocal("newt",r),a.call(i+"_one",r),a.setLocal("signnewt",a.i32_const(0))),e.addCode(a.setLocal("newr",s),a.call(i+"_copy",a.getLocal("px"),s)),e.addCode(a.setLocal("qq",c)),e.addCode(a.setLocal("qr",d)),e.addCode(a.setLocal("x",f)),e.addCode(a.block(a.loop(a.br_if(1,a.call(i+"_isZero",a.getLocal("newr"))),a.call(i+"_div",a.getLocal("r"),a.getLocal("newr"),a.getLocal("qq"),a.getLocal("qr")),a.call(i+"_mul",a.getLocal("qq"),a.getLocal("newt"),u),a.if(a.getLocal("signt"),a.if(a.getLocal("signnewt"),a.if(a.call(i+"_gte",u,a.getLocal("t")),[...a.drop(a.call(i+"_sub",u,a.getLocal("t"),a.getLocal("x"))),...a.setLocal("signx",a.i32_const(0))],[...a.drop(a.call(i+"_sub",a.getLocal("t"),u,a.getLocal("x"))),...a.setLocal("signx",a.i32_const(1))]),[...a.drop(a.call(i+"_add",u,a.getLocal("t"),a.getLocal("x"))),...a.setLocal("signx",a.i32_const(1))]),a.if(a.getLocal("signnewt"),[...a.drop(a.call(i+"_add",u,a.getLocal("t"),a.getLocal("x"))),...a.setLocal("signx",a.i32_const(0))],a.if(a.call(i+"_gte",a.getLocal("t"),u),[...a.drop(a.call(i+"_sub",a.getLocal("t"),u,a.getLocal("x"))),...a.setLocal("signx",a.i32_const(0))],[...a.drop(a.call(i+"_sub",u,a.getLocal("t"),a.getLocal("x"))),...a.setLocal("signx",a.i32_const(1))]))),a.setLocal("swp",a.getLocal("t")),a.setLocal("t",a.getLocal("newt")),a.setLocal("newt",a.getLocal("x")),a.setLocal("x",a.getLocal("swp")),a.setLocal("signt",a.getLocal("signnewt")),a.setLocal("signnewt",a.getLocal("signx")),a.setLocal("swp",a.getLocal("r")),a.setLocal("r",a.getLocal("newr")),a.setLocal("newr",a.getLocal("qr")),a.setLocal("qr",a.getLocal("swp")),a.br(0)))),e.addCode(a.if(a.getLocal("signt"),a.drop(a.call(i+"_sub",a.getLocal("pm"),a.getLocal("t"),a.getLocal("pr"))),a.call(i+"_copy",a.getLocal("t"),a.getLocal("pr"))))}(),t.exportFunction(i+"_copy"),t.exportFunction(i+"_zero"),t.exportFunction(i+"_one"),t.exportFunction(i+"_isZero"),t.exportFunction(i+"_eq"),t.exportFunction(i+"_gte"),t.exportFunction(i+"_add"),t.exportFunction(i+"_sub"),t.exportFunction(i+"_mul"),t.exportFunction(i+"_square"),t.exportFunction(i+"_squareOld"),t.exportFunction(i+"_div"),t.exportFunction(i+"_inverseMod"),i}},3549:t=>{t.exports=function(t,e,a,i,o){let n=8*t.modules[e].n64;(function(){let e=t.addFunction(a+"_getChunk");e.addParam("pScalar","i32"),e.addParam("scalarSize","i32"),e.addParam("startBit","i32"),e.addParam("chunkSize","i32"),e.addLocal("bitsToEnd","i32"),e.addLocal("mask","i32"),e.setReturnType("i32");let i=e.getCodeBuilder();e.addCode(i.setLocal("bitsToEnd",i.i32_sub(i.i32_mul(i.getLocal("scalarSize"),i.i32_const(8)),i.getLocal("startBit"))),i.if(i.i32_gt_s(i.getLocal("chunkSize"),i.getLocal("bitsToEnd")),i.setLocal("mask",i.i32_sub(i.i32_shl(i.i32_const(1),i.getLocal("bitsToEnd")),i.i32_const(1))),i.setLocal("mask",i.i32_sub(i.i32_shl(i.i32_const(1),i.getLocal("chunkSize")),i.i32_const(1)))),i.i32_and(i.i32_shr_u(i.i32_load(i.i32_add(i.getLocal("pScalar"),i.i32_shr_u(i.getLocal("startBit"),i.i32_const(3))),0,0),i.i32_and(i.getLocal("startBit"),i.i32_const(7))),i.getLocal("mask")))})(),function(){let i=t.addFunction(a+"_reduceTable");i.addParam("pTable","i32"),i.addParam("p","i32"),i.addLocal("half","i32"),i.addLocal("it1","i32"),i.addLocal("it2","i32"),i.addLocal("pAcc","i32");let o=i.getCodeBuilder();i.addCode(o.if(o.i32_eq(o.getLocal("p"),o.i32_const(1)),o.ret([])),o.setLocal("half",o.i32_shl(o.i32_const(1),o.i32_sub(o.getLocal("p"),o.i32_const(1)))),o.setLocal("it1",o.getLocal("pTable")),o.setLocal("it2",o.i32_add(o.getLocal("pTable"),o.i32_mul(o.getLocal("half"),o.i32_const(n)))),o.setLocal("pAcc",o.i32_sub(o.getLocal("it2"),o.i32_const(n))),o.block(o.loop(o.br_if(1,o.i32_eq(o.getLocal("it1"),o.getLocal("pAcc"))),o.call(e+"_add",o.getLocal("it1"),o.getLocal("it2"),o.getLocal("it1")),o.call(e+"_add",o.getLocal("pAcc"),o.getLocal("it2"),o.getLocal("pAcc")),o.setLocal("it1",o.i32_add(o.getLocal("it1"),o.i32_const(n))),o.setLocal("it2",o.i32_add(o.getLocal("it2"),o.i32_const(n))),o.br(0))),o.call(a+"_reduceTable",o.getLocal("pTable"),o.i32_sub(o.getLocal("p"),o.i32_const(1))),o.setLocal("p",o.i32_sub(o.getLocal("p"),o.i32_const(1))),o.block(o.loop(o.br_if(1,o.i32_eqz(o.getLocal("p"))),o.call(e+"_double",o.getLocal("pAcc"),o.getLocal("pAcc")),o.setLocal("p",o.i32_sub(o.getLocal("p"),o.i32_const(1))),o.br(0))),o.call(e+"_add",o.getLocal("pTable"),o.getLocal("pAcc"),o.getLocal("pTable")))}(),function(){let l=t.addFunction(a+"_chunk");l.addParam("pBases","i32"),l.addParam("pScalars","i32"),l.addParam("scalarSize","i32"),l.addParam("n","i32"),l.addParam("startBit","i32"),l.addParam("chunkSize","i32"),l.addParam("pr","i32"),l.addLocal("nChunks","i32"),l.addLocal("itScalar","i32"),l.addLocal("endScalar","i32"),l.addLocal("itBase","i32"),l.addLocal("i","i32"),l.addLocal("j","i32"),l.addLocal("nTable","i32"),l.addLocal("pTable","i32"),l.addLocal("idx","i32"),l.addLocal("pIdxTable","i32");let r=l.getCodeBuilder();l.addCode(r.if(r.i32_eqz(r.getLocal("n")),[...r.call(e+"_zero",r.getLocal("pr")),...r.ret([])]),r.setLocal("nTable",r.i32_shl(r.i32_const(1),r.getLocal("chunkSize"))),r.setLocal("pTable",r.i32_load(r.i32_const(0))),r.i32_store(r.i32_const(0),r.i32_add(r.getLocal("pTable"),r.i32_mul(r.getLocal("nTable"),r.i32_const(n)))),r.setLocal("j",r.i32_const(0)),r.block(r.loop(r.br_if(1,r.i32_eq(r.getLocal("j"),r.getLocal("nTable"))),r.call(e+"_zero",r.i32_add(r.getLocal("pTable"),r.i32_mul(r.getLocal("j"),r.i32_const(n)))),r.setLocal("j",r.i32_add(r.getLocal("j"),r.i32_const(1))),r.br(0))),r.setLocal("itBase",r.getLocal("pBases")),r.setLocal("itScalar",r.getLocal("pScalars")),r.setLocal("endScalar",r.i32_add(r.getLocal("pScalars"),r.i32_mul(r.getLocal("n"),r.getLocal("scalarSize")))),r.block(r.loop(r.br_if(1,r.i32_eq(r.getLocal("itScalar"),r.getLocal("endScalar"))),r.setLocal("idx",r.call(a+"_getChunk",r.getLocal("itScalar"),r.getLocal("scalarSize"),r.getLocal("startBit"),r.getLocal("chunkSize"))),r.if(r.getLocal("idx"),[...r.setLocal("pIdxTable",r.i32_add(r.getLocal("pTable"),r.i32_mul(r.i32_sub(r.getLocal("idx"),r.i32_const(1)),r.i32_const(n)))),...r.call(i,r.getLocal("pIdxTable"),r.getLocal("itBase"),r.getLocal("pIdxTable"))]),r.setLocal("itScalar",r.i32_add(r.getLocal("itScalar"),r.getLocal("scalarSize"))),r.setLocal("itBase",r.i32_add(r.getLocal("itBase"),r.i32_const(o))),r.br(0))),r.call(a+"_reduceTable",r.getLocal("pTable"),r.getLocal("chunkSize")),r.call(e+"_copy",r.getLocal("pTable"),r.getLocal("pr")),r.i32_store(r.i32_const(0),r.getLocal("pTable")))}(),function(){let i=t.addFunction(a);i.addParam("pBases","i32"),i.addParam("pScalars","i32"),i.addParam("scalarSize","i32"),i.addParam("n","i32"),i.addParam("pr","i32"),i.addLocal("chunkSize","i32"),i.addLocal("nChunks","i32"),i.addLocal("itScalar","i32"),i.addLocal("endScalar","i32"),i.addLocal("itBase","i32"),i.addLocal("itBit","i32"),i.addLocal("i","i32"),i.addLocal("j","i32"),i.addLocal("nTable","i32"),i.addLocal("pTable","i32"),i.addLocal("idx","i32"),i.addLocal("pIdxTable","i32");let o=i.getCodeBuilder(),l=o.i32_const(t.alloc(n)),r=t.alloc([17,17,17,17,17,17,17,17,17,17,16,16,15,14,13,13,12,11,10,9,8,7,7,6,5,4,3,2,1,1,1,1]);i.addCode(o.call(e+"_zero",o.getLocal("pr")),o.if(o.i32_eqz(o.getLocal("n")),o.ret([])),o.setLocal("chunkSize",o.i32_load8_u(o.i32_clz(o.getLocal("n")),r)),o.setLocal("nChunks",o.i32_add(o.i32_div_u(o.i32_sub(o.i32_shl(o.getLocal("scalarSize"),o.i32_const(3)),o.i32_const(1)),o.getLocal("chunkSize")),o.i32_const(1))),o.setLocal("itBit",o.i32_mul(o.i32_sub(o.getLocal("nChunks"),o.i32_const(1)),o.getLocal("chunkSize"))),o.block(o.loop(o.br_if(1,o.i32_lt_s(o.getLocal("itBit"),o.i32_const(0))),o.if(o.i32_eqz(o.call(e+"_isZero",o.getLocal("pr"))),[...o.setLocal("j",o.i32_const(0)),...o.block(o.loop(o.br_if(1,o.i32_eq(o.getLocal("j"),o.getLocal("chunkSize"))),o.call(e+"_double",o.getLocal("pr"),o.getLocal("pr")),o.setLocal("j",o.i32_add(o.getLocal("j"),o.i32_const(1))),o.br(0)))]),o.call(a+"_chunk",o.getLocal("pBases"),o.getLocal("pScalars"),o.getLocal("scalarSize"),o.getLocal("n"),o.getLocal("itBit"),o.getLocal("chunkSize"),l),o.call(e+"_add",o.getLocal("pr"),l,o.getLocal("pr")),o.setLocal("itBit",o.i32_sub(o.getLocal("itBit"),o.getLocal("chunkSize"))),o.br(0))))}(),t.exportFunction(a),t.exportFunction(a+"_chunk")}},6989:t=>{t.exports=function(t,e,a){let i=8*t.modules[a].n64;return function(){let o=t.addFunction(e+"_zero");o.addParam("px","i32"),o.addParam("n","i32"),o.addLocal("lastp","i32"),o.addLocal("p","i32");let n=o.getCodeBuilder();o.addCode(n.setLocal("p",n.getLocal("px")),n.setLocal("lastp",n.i32_add(n.getLocal("px"),n.i32_mul(n.getLocal("n"),n.i32_const(i)))),n.block(n.loop(n.br_if(1,n.i32_eq(n.getLocal("p"),n.getLocal("lastp"))),n.call(a+"_zero",n.getLocal("p")),n.setLocal("p",n.i32_add(n.getLocal("p"),n.i32_const(i))),n.br(0))))}(),function(){let o=t.addFunction(e+"_constructLC");o.addParam("ppolynomials","i32"),o.addParam("psignals","i32"),o.addParam("nSignals","i32"),o.addParam("pres","i32"),o.addLocal("i","i32"),o.addLocal("j","i32"),o.addLocal("pp","i32"),o.addLocal("ps","i32"),o.addLocal("pd","i32"),o.addLocal("ncoefs","i32");let n=o.getCodeBuilder(),l=n.i32_const(t.alloc(i));o.addCode(n.setLocal("i",n.i32_const(0)),n.setLocal("pp",n.getLocal("ppolynomials")),n.setLocal("ps",n.getLocal("psignals")),n.block(n.loop(n.br_if(1,n.i32_eq(n.getLocal("i"),n.getLocal("nSignals"))),n.setLocal("ncoefs",n.i32_load(n.getLocal("pp"))),n.setLocal("pp",n.i32_add(n.getLocal("pp"),n.i32_const(4))),n.setLocal("j",n.i32_const(0)),n.block(n.loop(n.br_if(1,n.i32_eq(n.getLocal("j"),n.getLocal("ncoefs"))),n.setLocal("pd",n.i32_add(n.getLocal("pres"),n.i32_mul(n.i32_load(n.getLocal("pp")),n.i32_const(i)))),n.setLocal("pp",n.i32_add(n.getLocal("pp"),n.i32_const(4))),n.call(a+"_mul",n.getLocal("ps"),n.getLocal("pp"),l),n.call(a+"_add",l,n.getLocal("pd"),n.getLocal("pd")),n.setLocal("pp",n.i32_add(n.getLocal("pp"),n.i32_const(i))),n.setLocal("j",n.i32_add(n.getLocal("j"),n.i32_const(1))),n.br(0))),n.setLocal("ps",n.i32_add(n.getLocal("ps"),n.i32_const(i))),n.setLocal("i",n.i32_add(n.getLocal("i"),n.i32_const(1))),n.br(0))))}(),t.exportFunction(e+"_zero"),t.exportFunction(e+"_constructLC"),e}},7119:t=>{t.exports=function(t,e,a){let i=8*t.modules[a].n64;return function(){let o=t.addFunction(e+"_buildABC");o.addParam("pCoefs","i32"),o.addParam("nCoefs","i32"),o.addParam("pWitness","i32"),o.addParam("pA","i32"),o.addParam("pB","i32"),o.addParam("pC","i32"),o.addParam("offsetOut","i32"),o.addParam("nOut","i32"),o.addParam("offsetWitness","i32"),o.addParam("nWitness","i32"),o.addLocal("it","i32"),o.addLocal("ita","i32"),o.addLocal("itb","i32"),o.addLocal("last","i32"),o.addLocal("m","i32"),o.addLocal("c","i32"),o.addLocal("s","i32"),o.addLocal("pOut","i32");let n=o.getCodeBuilder(),l=n.i32_const(t.alloc(i));o.addCode(n.setLocal("ita",n.getLocal("pA")),n.setLocal("itb",n.getLocal("pB")),n.setLocal("last",n.i32_add(n.getLocal("pA"),n.i32_mul(n.getLocal("nOut"),n.i32_const(i)))),n.block(n.loop(n.br_if(1,n.i32_eq(n.getLocal("ita"),n.getLocal("last"))),n.call(a+"_zero",n.getLocal("ita")),n.call(a+"_zero",n.getLocal("itb")),n.setLocal("ita",n.i32_add(n.getLocal("ita"),n.i32_const(i))),n.setLocal("itb",n.i32_add(n.getLocal("itb"),n.i32_const(i))),n.br(0))),n.setLocal("it",n.getLocal("pCoefs")),n.setLocal("last",n.i32_add(n.getLocal("pCoefs"),n.i32_mul(n.getLocal("nCoefs"),n.i32_const(i+12)))),n.block(n.loop(n.br_if(1,n.i32_eq(n.getLocal("it"),n.getLocal("last"))),n.setLocal("s",n.i32_load(n.getLocal("it"),8)),n.if(n.i32_or(n.i32_lt_u(n.getLocal("s"),n.getLocal("offsetWitness")),n.i32_ge_u(n.getLocal("s"),n.i32_add(n.getLocal("offsetWitness"),n.getLocal("nWitness")))),[...n.setLocal("it",n.i32_add(n.getLocal("it"),n.i32_const(i+12))),...n.br(1)]),n.setLocal("m",n.i32_load(n.getLocal("it"))),n.if(n.i32_eq(n.getLocal("m"),n.i32_const(0)),n.setLocal("pOut",n.getLocal("pA")),n.if(n.i32_eq(n.getLocal("m"),n.i32_const(1)),n.setLocal("pOut",n.getLocal("pB")),[...n.setLocal("it",n.i32_add(n.getLocal("it"),n.i32_const(i+12))),...n.br(1)])),n.setLocal("c",n.i32_load(n.getLocal("it"),4)),n.if(n.i32_or(n.i32_lt_u(n.getLocal("c"),n.getLocal("offsetOut")),n.i32_ge_u(n.getLocal("c"),n.i32_add(n.getLocal("offsetOut"),n.getLocal("nOut")))),[...n.setLocal("it",n.i32_add(n.getLocal("it"),n.i32_const(i+12))),...n.br(1)]),n.setLocal("pOut",n.i32_add(n.getLocal("pOut"),n.i32_mul(n.i32_sub(n.getLocal("c"),n.getLocal("offsetOut")),n.i32_const(i)))),n.call(a+"_mul",n.i32_add(n.getLocal("pWitness"),n.i32_mul(n.i32_sub(n.getLocal("s"),n.getLocal("offsetWitness")),n.i32_const(i))),n.i32_add(n.getLocal("it"),n.i32_const(12)),l),n.call(a+"_add",n.getLocal("pOut"),l,n.getLocal("pOut")),n.setLocal("it",n.i32_add(n.getLocal("it"),n.i32_const(i+12))),n.br(0))),n.setLocal("ita",n.getLocal("pA")),n.setLocal("itb",n.getLocal("pB")),n.setLocal("it",n.getLocal("pC")),n.setLocal("last",n.i32_add(n.getLocal("pA"),n.i32_mul(n.getLocal("nOut"),n.i32_const(i)))),n.block(n.loop(n.br_if(1,n.i32_eq(n.getLocal("ita"),n.getLocal("last"))),n.call(a+"_mul",n.getLocal("ita"),n.getLocal("itb"),n.getLocal("it")),n.setLocal("ita",n.i32_add(n.getLocal("ita"),n.i32_const(i))),n.setLocal("itb",n.i32_add(n.getLocal("itb"),n.i32_const(i))),n.setLocal("it",n.i32_add(n.getLocal("it"),n.i32_const(i))),n.br(0))))}(),function(){let o=t.addFunction(e+"_joinABC");o.addParam("pA","i32"),o.addParam("pB","i32"),o.addParam("pC","i32"),o.addParam("n","i32"),o.addParam("pP","i32"),o.addLocal("ita","i32"),o.addLocal("itb","i32"),o.addLocal("itc","i32"),o.addLocal("itp","i32"),o.addLocal("last","i32");let n=o.getCodeBuilder(),l=n.i32_const(t.alloc(i));o.addCode(n.setLocal("ita",n.getLocal("pA")),n.setLocal("itb",n.getLocal("pB")),n.setLocal("itc",n.getLocal("pC")),n.setLocal("itp",n.getLocal("pP")),n.setLocal("last",n.i32_add(n.getLocal("pA"),n.i32_mul(n.getLocal("n"),n.i32_const(i)))),n.block(n.loop(n.br_if(1,n.i32_eq(n.getLocal("ita"),n.getLocal("last"))),n.call(a+"_mul",n.getLocal("ita"),n.getLocal("itb"),l),n.call(a+"_sub",l,n.getLocal("itc"),n.getLocal("itp")),n.setLocal("ita",n.i32_add(n.getLocal("ita"),n.i32_const(i))),n.setLocal("itb",n.i32_add(n.getLocal("itb"),n.i32_const(i))),n.setLocal("itc",n.i32_add(n.getLocal("itc"),n.i32_const(i))),n.setLocal("itp",n.i32_add(n.getLocal("itp"),n.i32_const(i))),n.br(0))))}(),function(){let o=t.addFunction(e+"_batchAdd");o.addParam("pa","i32"),o.addParam("pb","i32"),o.addParam("n","i32"),o.addParam("pr","i32"),o.addLocal("ita","i32"),o.addLocal("itb","i32"),o.addLocal("itr","i32"),o.addLocal("last","i32");let n=o.getCodeBuilder();o.addCode(n.setLocal("ita",n.getLocal("pa")),n.setLocal("itb",n.getLocal("pb")),n.setLocal("itr",n.getLocal("pr")),n.setLocal("last",n.i32_add(n.getLocal("pa"),n.i32_mul(n.getLocal("n"),n.i32_const(i)))),n.block(n.loop(n.br_if(1,n.i32_eq(n.getLocal("ita"),n.getLocal("last"))),n.call(a+"_add",n.getLocal("ita"),n.getLocal("itb"),n.getLocal("itr")),n.setLocal("ita",n.i32_add(n.getLocal("ita"),n.i32_const(i))),n.setLocal("itb",n.i32_add(n.getLocal("itb"),n.i32_const(i))),n.setLocal("itr",n.i32_add(n.getLocal("itr"),n.i32_const(i))),n.br(0))))}(),t.exportFunction(e+"_buildABC"),t.exportFunction(e+"_joinABC"),t.exportFunction(e+"_batchAdd"),e}},9492:t=>{t.exports=function(t,e,a,i,o,n,l){let r=t.addFunction(e);r.addParam("base","i32"),r.addParam("scalar","i32"),r.addParam("scalarLength","i32"),r.addParam("r","i32"),r.addLocal("i","i32"),r.addLocal("b","i32");let s=r.getCodeBuilder(),c=s.i32_const(t.alloc(a));r.addCode(s.if(s.i32_eqz(s.getLocal("scalarLength")),[...s.call(l,s.getLocal("r")),...s.ret([])])),r.addCode(s.call(n,s.getLocal("base"),c)),r.addCode(s.call(l,s.getLocal("r"))),r.addCode(s.setLocal("i",s.getLocal("scalarLength"))),r.addCode(s.block(s.loop(s.setLocal("i",s.i32_sub(s.getLocal("i"),s.i32_const(1))),s.setLocal("b",s.i32_load8_u(s.i32_add(s.getLocal("scalar"),s.getLocal("i")))),...function(){let t=[];for(let e=0;e<8;e++)t.push(...s.call(o,s.getLocal("r"),s.getLocal("r")),...s.if(s.i32_ge_u(s.getLocal("b"),s.i32_const(128>>e)),[...s.setLocal("b",s.i32_sub(s.getLocal("b"),s.i32_const(128>>e))),...s.call(i,s.getLocal("r"),c,s.getLocal("r"))]));return t}(),s.br_if(1,s.i32_eqz(s.getLocal("i"))),s.br(0))))}},1738:t=>{t.exports=function(t,e,a,i,o,n,l,r){let s=t.addFunction(e);s.addParam("base","i32"),s.addParam("scalar","i32"),s.addParam("scalarLength","i32"),s.addParam("r","i32"),s.addLocal("old0","i32"),s.addLocal("nbits","i32"),s.addLocal("i","i32"),s.addLocal("last","i32"),s.addLocal("cur","i32"),s.addLocal("carry","i32"),s.addLocal("p","i32");let c=s.getCodeBuilder(),d=c.i32_const(t.alloc(a));function u(t){return c.i32_and(c.i32_shr_u(c.i32_load(c.i32_add(c.getLocal("scalar"),c.i32_and(c.i32_shr_u(t,c.i32_const(3)),c.i32_const(4294967292)))),c.i32_and(t,c.i32_const(31))),c.i32_const(1))}function f(t){return[...c.i32_store8(c.getLocal("p"),c.i32_const(t)),...c.setLocal("p",c.i32_add(c.getLocal("p"),c.i32_const(1)))]}s.addCode(c.if(c.i32_eqz(c.getLocal("scalarLength")),[...c.call(r,c.getLocal("r")),...c.ret([])]),c.setLocal("nbits",c.i32_shl(c.getLocal("scalarLength"),c.i32_const(3))),c.setLocal("old0",c.i32_load(c.i32_const(0))),c.setLocal("p",c.getLocal("old0")),c.i32_store(c.i32_const(0),c.i32_and(c.i32_add(c.i32_add(c.getLocal("old0"),c.i32_const(32)),c.getLocal("nbits")),c.i32_const(4294967288))),c.setLocal("i",c.i32_const(1)),c.setLocal("last",u(c.i32_const(0))),c.setLocal("carry",c.i32_const(0)),c.block(c.loop(c.br_if(1,c.i32_eq(c.getLocal("i"),c.getLocal("nbits"))),c.setLocal("cur",u(c.getLocal("i"))),c.if(c.getLocal("last"),c.if(c.getLocal("cur"),c.if(c.getLocal("carry"),[...c.setLocal("last",c.i32_const(0)),...c.setLocal("carry",c.i32_const(1)),...f(1)],[...c.setLocal("last",c.i32_const(0)),...c.setLocal("carry",c.i32_const(1)),...f(255)]),c.if(c.getLocal("carry"),[...c.setLocal("last",c.i32_const(0)),...c.setLocal("carry",c.i32_const(1)),...f(255)],[...c.setLocal("last",c.i32_const(0)),...c.setLocal("carry",c.i32_const(0)),...f(1)])),c.if(c.getLocal("cur"),c.if(c.getLocal("carry"),[...c.setLocal("last",c.i32_const(0)),...c.setLocal("carry",c.i32_const(1)),...f(0)],[...c.setLocal("last",c.i32_const(1)),...c.setLocal("carry",c.i32_const(0)),...f(0)]),c.if(c.getLocal("carry"),[...c.setLocal("last",c.i32_const(1)),...c.setLocal("carry",c.i32_const(0)),...f(0)],[...c.setLocal("last",c.i32_const(0)),...c.setLocal("carry",c.i32_const(0)),...f(0)]))),c.setLocal("i",c.i32_add(c.getLocal("i"),c.i32_const(1))),c.br(0))),c.if(c.getLocal("last"),c.if(c.getLocal("carry"),[...f(255),...f(0),...f(1)],[...f(1)]),c.if(c.getLocal("carry"),[...f(0),...f(1)])),c.setLocal("p",c.i32_sub(c.getLocal("p"),c.i32_const(1))),c.call(l,c.getLocal("base"),d),c.call(r,c.getLocal("r")),c.block(c.loop(c.call(o,c.getLocal("r"),c.getLocal("r")),c.setLocal("cur",c.i32_load8_u(c.getLocal("p"))),c.if(c.getLocal("cur"),c.if(c.i32_eq(c.getLocal("cur"),c.i32_const(1)),c.call(i,c.getLocal("r"),d,c.getLocal("r")),c.call(n,c.getLocal("r"),d,c.getLocal("r")))),c.br_if(1,c.i32_eq(c.getLocal("old0"),c.getLocal("p"))),c.setLocal("p",c.i32_sub(c.getLocal("p"),c.i32_const(1))),c.br(0))),c.i32_store(c.i32_const(0),c.getLocal("old0")))}},1209:(t,e)=>{e.bigInt2BytesLE=function(t,e){let a=Array(e),i=BigInt(t);for(let t=0;t<e;t++)a[t]=Number(255n&i),i>>=8n;return a},e.bigInt2U32LE=function(t,e){let a=Array(e),i=BigInt(t);for(let t=0;t<e;t++)a[t]=Number(4294967295n&i),i>>=32n;return a},e.isOcamNum=function(t){return!!(Array.isArray(t)&&3==t.length&&"number"==typeof t[0]&&"number"==typeof t[1]&&Array.isArray(t[2]))}},4829:(t,e,a)=>{let i=a(7360),o=a(1520),n=a(6162),l=Symbol.for("worker"),r=Symbol.for("events");class s{constructor(){Object.defineProperty(this,r,{value:new Map})}dispatchEvent(t){if(t.target=t.currentTarget=this,this["on"+t.type])try{this["on"+t.type](t)}catch(t){console.error(t)}let e=this[r].get(t.type);null!=e&&e.forEach(e=>{try{e.call(this,t)}catch(t){console.error(t)}})}addEventListener(t,e){let a=this[r].get(t);a||this[r].set(t,a=[]),a.push(e)}removeEventListener(t,e){let a=this[r].get(t);if(a){let t=a.indexOf(e);-1!==t&&a.splice(t,1)}}}function c(t,e){this.type=t,this.timeStamp=Date.now(),this.target=this.currentTarget=this.data=null}t.exports=n.isMainThread?function(){class t extends s{constructor(t,e){let a;super();let{name:o,type:r}=e||{};t+="",a=/^data:/.test(t)?t:i.fileURLToPath(new i.URL(t,d));let s=new n.Worker(__filename,{workerData:{mod:a,name:o,type:r}});Object.defineProperty(this,l,{value:s}),s.on("message",t=>{let e=new c("message");e.data=t,this.dispatchEvent(e)}),s.on("error",t=>{t.type="error",this.dispatchEvent(t)}),s.on("exit",()=>{this.dispatchEvent(new c("close"))})}postMessage(t,e){this[l].postMessage(t,e)}terminate(){this[l].terminate()}}return t.prototype.onmessage=t.prototype.onerror=t.prototype.onclose=null,t}():function(){let{mod:t,name:e,type:i}=n.workerData,o=global.self=global,l=[];function r(){let t=l;l=null,t.forEach(t=>{o.dispatchEvent(t)})}n.parentPort.on("message",t=>{let e=new c("message");e.data=t,null==l?o.dispatchEvent(e):l.push(e)}),n.parentPort.on("error",t=>{t.type="Error",o.dispatchEvent(t)});class d extends s{postMessage(t,e){n.parentPort.postMessage(t,e)}close(){process.exit()}}let f=Object.getPrototypeOf(global);delete f.constructor,Object.defineProperties(d.prototype,f),f=Object.setPrototypeOf(global,new d),["postMessage","addEventListener","removeEventListener","dispatchEvent"].forEach(t=>{f[t]=f[t].bind(global)}),global.name=e;let h=/^data:/.test(t);if("module"===i)a(6421)(t).catch(a=>{if(h&&"Not supported"===a.message)return console.warn("Worker(): Importing data: URLs requires Node 12.10+. Falling back to classic worker."),u(t,e);console.error(a)}).then(r);else{try{/^data:/.test(t)?u(t,e):a(7092)(t)}catch(t){console.error(t)}Promise.resolve().then(r)}}();let d=i.pathToFileURL(process.cwd()+"/");function u(t,e){let{data:a}=function(t){let[e,a,i,o]=t.match(/^data: *([^;,]*)(?: *; *([^,]*))? *,(.*)$/)||[];if(!e)throw Error("Invalid Data URL.");if(i){if("base64"===i.toLowerCase())o=Buffer.from(o,"base64").toString();else throw Error('Unknown Data URL encoding "'+i+'"')}return{type:a,data:o}}(t);return o.runInThisContext(a,{filename:"worker.<"+(e||"data:")+">"})}},4645:(t,e,a)=>{"use strict";let i,o;a.r(e),a.d(e,{curves:()=>r,fflonk:()=>g,groth16:()=>s,plonk:()=>h,powersOfTau:()=>c,r1cs:()=>d,wtns:()=>u,zKey:()=>f});var n={};a.r(n),a.d(n,{abs:()=>M,add:()=>O,band:()=>K,bitLength:()=>L,bits:()=>v,bor:()=>H,bxor:()=>Z,div:()=>Q,e:()=>m,eq:()=>R,exp:()=>U,fromArray:()=>b,fromRprBE:()=>ta,fromRprLE:()=>te,fromString:()=>_,geq:()=>V,gt:()=>$,isNegative:()=>w,isOdd:()=>x,isZero:()=>y,land:()=>W,leq:()=>j,lnot:()=>J,lor:()=>Y,lt:()=>D,mod:()=>k,mul:()=>T,naf:()=>E,neg:()=>G,neq:()=>N,one:()=>tl,pow:()=>z,shiftLeft:()=>A,shiftRight:()=>C,shl:()=>I,shr:()=>F,square:()=>q,sub:()=>P,toArray:()=>S,toLEBuff:()=>to,toNumber:()=>B,toRprBE:()=>tt,toRprLE:()=>X,toString:()=>ti,zero:()=>tn});var l={};a.r(l),a.d(l,{array2buffer:()=>tv,beBuff2int:()=>tw,beInt2Buff:()=>ty,bitReverse:()=>tF,buffReverseBits:()=>tE,buffer2array:()=>tB,leBuff2int:()=>tA,leInt2Buff:()=>tC,log2:()=>tx,stringifyBigInts:()=>function t(e){if("bigint"==typeof e||void 0!==e.eq)return e.toString(10);if(e instanceof Uint8Array)return te(e,0);if(Array.isArray(e))return e.map(t);{if("object"!=typeof e)return e;let a={};return Object.keys(e).forEach(i=>{a[i]=t(e[i])}),a}},stringifyFElements:()=>function t(e,a){if("bigint"==typeof a||void 0!==a.eq)return a.toString(10);if(a instanceof Uint8Array)return e.toString(e.e(a));if(Array.isArray(a))return a.map(t.bind(this,e));{if("object"!=typeof a)return a;let i={};return Object.keys(a).forEach(o=>{i[o]=t(e,a[o])}),i}},unstringifyBigInts:()=>function t(e){if("string"==typeof e&&/^[0-9]+$/.test(e)||"string"==typeof e&&/^0x[0-9a-fA-F]+$/.test(e))return BigInt(e);if(Array.isArray(e))return e.map(t);{if("object"!=typeof e)return e;if(null===e)return null;let a={};return Object.keys(e).forEach(i=>{a[i]=t(e[i])}),a}},unstringifyFElements:()=>function t(e,a){if("string"==typeof a&&/^[0-9]+$/.test(a)||"string"==typeof a&&/^0x[0-9a-fA-F]+$/.test(a))return e.e(a);if(Array.isArray(a))return a.map(t.bind(this,e));{if("object"!=typeof a)return a;if(null===a)return null;let i={};return Object.keys(a).forEach(o=>{i[o]=t(e,a[o])}),i}}});var r={};a.r(r),a.d(r,{getCurveFromName:()=>eO,getCurveFromQ:()=>eS,getCurveFromR:()=>eB});var s={};a.r(s),a.d(s,{exportSolidityCallData:()=>aw,fullProve:()=>ap,prove:()=>ao,verify:()=>am});var c={};a.r(c),a.d(c,{beacon:()=>aj,challengeContribute:()=>a$,contribute:()=>aV,convert:()=>aZ,exportChallenge:()=>aM,exportJson:()=>aW,importResponse:()=>aQ,newAccumulator:()=>aU,preparePhase2:()=>aK,truncate:()=>aH,verify:()=>aR});var d={};a.r(d),a.d(d,{exportJson:()=>i6,info:()=>i4,print:()=>aY});var u={};a.r(u),a.d(u,{calculate:()=>ah,check:()=>oe,debug:()=>i9,exportJson:()=>ot});var f={};a.r(f),a.d(f,{beacon:()=>ou,bellmanContribute:()=>oh,contribute:()=>od,exportBellman:()=>ol,exportJson:()=>of,exportSolidityVerifier:()=>oC,exportVerificationKey:()=>op,importBellman:()=>or,newZKey:()=>on,verifyFromInit:()=>os,verifyFromR1cs:()=>oc});var h={};a.r(h),a.d(h,{exportSolidityCallData:()=>ok,fullProve:()=>oT,prove:()=>oP,setup:()=>oI,verify:()=>oz});var g={};a.r(g),a.d(g,{exportSolidityCallData:()=>o4,exportSolidityVerifier:()=>oA,fullProve:()=>oW,prove:()=>oH,setup:()=>oV,verify:()=>oJ});let p=[0,1,2,2,3,3,3,3,4,4,4,4,4,4,4,4];function _(t,e){return e&&10!=e?16==e?"0x"==t.slice(0,2)?BigInt(t):BigInt("0x"+t):void 0:BigInt(t)}let m=_;function b(t,e){let a=BigInt(0);e=BigInt(e);for(let i=0;i<t.length;i++)a=a*e+BigInt(t[i]);return a}function L(t){let e=t.toString(16);return(e.length-1)*4+p[parseInt(e[0],16)]}function w(t){return BigInt(t)<BigInt(0)}function y(t){return!t}function A(t,e){return BigInt(t)<<BigInt(e)}function C(t,e){return BigInt(t)>>BigInt(e)}let I=A,F=C;function x(t){return(BigInt(t)&BigInt(1))==BigInt(1)}function E(t){let e=BigInt(t),a=[];for(;e;){if(e&BigInt(1)){let t=2-Number(e%BigInt(4));a.push(t),e-=BigInt(t)}else a.push(0);e>>=BigInt(1)}return a}function v(t){let e=BigInt(t),a=[];for(;e;)e&BigInt(1)?a.push(1):a.push(0),e>>=BigInt(1);return a}function B(t){if(t>BigInt(Number.MAX_SAFE_INTEGER))throw Error("Number too big");return Number(t)}function S(t,e){let a=[],i=BigInt(t);for(e=BigInt(e);i;)a.unshift(Number(i%e)),i/=e;return a}function O(t,e){return BigInt(t)+BigInt(e)}function P(t,e){return BigInt(t)-BigInt(e)}function G(t){return-BigInt(t)}function T(t,e){return BigInt(t)*BigInt(e)}function q(t){return BigInt(t)*BigInt(t)}function z(t,e){return BigInt(t)**BigInt(e)}function U(t,e){return BigInt(t)**BigInt(e)}function M(t){return BigInt(t)>=0?BigInt(t):-BigInt(t)}function Q(t,e){return BigInt(t)/BigInt(e)}function k(t,e){return BigInt(t)%BigInt(e)}function R(t,e){return BigInt(t)==BigInt(e)}function N(t,e){return BigInt(t)!=BigInt(e)}function D(t,e){return BigInt(t)<BigInt(e)}function $(t,e){return BigInt(t)>BigInt(e)}function j(t,e){return BigInt(t)<=BigInt(e)}function V(t,e){return BigInt(t)>=BigInt(e)}function K(t,e){return BigInt(t)&BigInt(e)}function H(t,e){return BigInt(t)|BigInt(e)}function Z(t,e){return BigInt(t)^BigInt(e)}function W(t,e){return BigInt(t)&&BigInt(e)}function Y(t,e){return BigInt(t)||BigInt(e)}function J(t){return!BigInt(t)}function X(t,e,a,i){let o="0000000"+a.toString(16),n=new Uint32Array(t.buffer,t.byteOffset+e,i/4),l=((o.length-7)*4-1>>5)+1;for(let t=0;t<l;t++)n[t]=parseInt(o.substring(o.length-8*t-8,o.length-8*t),16);for(let t=l;t<n.length;t++)n[t]=0;for(let e=4*n.length;e<i;e++)t[e]=B(K(C(a,8*e),255))}function tt(t,e,a,i){let o="0000000"+a.toString(16),n=new DataView(t.buffer,t.byteOffset+e,i),l=((o.length-7)*4-1>>5)+1;for(let t=0;t<l;t++)n.setUint32(i-4*t-4,parseInt(o.substring(o.length-8*t-8,o.length-8*t),16),!1);for(let t=0;t<i/4-l;t++)n[t]=0}function te(t,e,a){a=a||t.byteLength,e=e||0;let i=new Uint32Array(t.buffer,t.byteOffset+e,a/4),o=Array(a/4);return i.forEach((t,e)=>o[o.length-e-1]=t.toString(16).padStart(8,"0")),_(o.join(""),16)}function ta(t,e,a){a=a||t.byteLength,e=e||0;let i=new DataView(t.buffer,t.byteOffset+e,a),o=Array(a/4);for(let t=0;t<a/4;t++)o[t]=i.getUint32(4*t,!1).toString(16).padStart(8,"0");return _(o.join(""),16)}function ti(t,e){return t.toString(e)}function to(t){let e=new Uint8Array(Math.floor((L(t)-1)/8)+1);return X(e,0,t,e.byteLength),e}let tn=m(0),tl=m(1),tr=[];for(let t=0;t<256;t++)tr[t]=function(t,e){let a=0,i=t;for(let t=0;t<8;t++)a<<=1,a|=1&i,i>>=1;return a}(t,0);function ts(t,e,a){if(!a)return t.one;let i=v(a);if(0==i.length)return t.one;let o=e;for(let a=i.length-2;a>=0;a--)o=t.square(o),i[a]&&(o=t.mul(o,e));return o}function tc(t,e,a,i,o){t[e]=t[e]+t[a]>>>0,t[o]=(t[o]^t[e])>>>0,t[o]=(t[o]<<16|t[o]>>>16&65535)>>>0,t[i]=t[i]+t[o]>>>0,t[a]=(t[a]^t[i])>>>0,t[a]=(t[a]<<12|t[a]>>>20&4095)>>>0,t[e]=t[e]+t[a]>>>0,t[o]=(t[o]^t[e])>>>0,t[o]=(t[o]<<8|t[o]>>>24&255)>>>0,t[i]=t[i]+t[o]>>>0,t[a]=(t[a]^t[i])>>>0,t[a]=(t[a]<<7|t[a]>>>25&127)>>>0}class td{constructor(t){t=t||[0,0,0,0,0,0,0,0],this.state=[1634760805,857760878,2036477234,1797285236,t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],0,0,0,0],this.idx=16,this.buff=Array(16)}nextU32(){return 16==this.idx&&this.update(),this.buff[this.idx++]}nextU64(){return O(T(this.nextU32(),4294967296),this.nextU32())}nextBool(){return(1&this.nextU32())==1}update(){for(let t=0;t<16;t++)this.buff[t]=this.state[t];for(let e=0;e<10;e++){var t;tc(t=this.buff,0,4,8,12),tc(t,1,5,9,13),tc(t,2,6,10,14),tc(t,3,7,11,15),tc(t,0,5,10,15),tc(t,1,6,11,12),tc(t,2,7,8,13),tc(t,3,4,9,14)}for(let t=0;t<16;t++)this.buff[t]=this.buff[t]+this.state[t]>>>0;this.idx=0,this.state[12]=this.state[12]+1>>>0,0==this.state[12]&&(this.state[13]=this.state[13]+1>>>0,0==this.state[13]&&(this.state[14]=this.state[14]+1>>>0,0==this.state[14]&&(this.state[15]=this.state[15]+1>>>0)))}}var tu=a(4770);function tf(t){let e=new Uint8Array(t);return tu.randomFillSync(e),e}let th=null;function tg(){return th||(th=new td(function(){let t=new Uint32Array(tf(32).buffer),e=[];for(let a=0;a<8;a++)e.push(t[a]);return e}()))}class tp{constructor(t,e,a){this.F=e,this.G=t,this.opMulGF=a;let i=e.sqrt_t||e.t,o=e.sqrt_s||e.s,n=e.one;for(;e.eq(e.pow(n,e.half),e.one);)n=e.add(n,e.one);this.w=Array(o+1),this.wi=Array(o+1),this.w[o]=this.F.pow(n,i),this.wi[o]=this.F.inv(this.w[o]);let l=o-1;for(;l>=0;)this.w[l]=this.F.square(this.w[l+1]),this.wi[l]=this.F.square(this.wi[l+1]),l--;this.roots=[],this._setRoots(Math.min(o,15))}_setRoots(t){for(let e=t;e>=0&&!this.roots[e];e--){let t=this.F.one,a=1<<e,i=Array(a);for(let o=0;o<a;o++)i[o]=t,t=this.F.mul(t,this.w[e]);this.roots[e]=i}}fft(t){if(t.length<=1)return t;let e=t_(t.length-1)+1;this._setRoots(e);let a=1<<e;if(t.length!=a)throw Error("Size must be multiple of 2");return tm(this,t,e,0,1)}ifft(t){if(t.length<=1)return t;let e=t_(t.length-1)+1;this._setRoots(e);let a=1<<e;if(t.length!=a)throw Error("Size must be multiple of 2");let i=tm(this,t,e,0,1),o=this.F.inv(this.F.mulScalar(this.F.one,a)),n=Array(a);for(let t=0;t<a;t++)n[t]=this.opMulGF(i[(a-t)%a],o);return n}}function t_(t){return((4294901760&t)!=0?(t&=4294901760,16):0)|((4278255360&t)!=0?(t&=4278255360,8):0)|((4042322160&t)!=0?(t&=4042322160,4):0)|((3435973836&t)!=0?(t&=3435973836,2):0)|(2863311530&t)!=0}function tm(t,e,a,i,o){let n=1<<a;if(1==n)return[e[i]];if(2==n)return[t.G.add(e[i],e[i+o]),t.G.sub(e[i],e[i+o])];let l=n>>1,r=tm(t,e,a-1,i,2*o),s=tm(t,e,a-1,i+o,2*o),c=Array(n);for(let e=0;e<l;e++)c[e]=t.G.add(r[e],t.opMulGF(s[e],t.roots[a][e])),c[e+l]=t.G.sub(r[e],t.opMulGF(s[e],t.roots[a][e]));return c}class tb{constructor(t){this.type="F1",this.one=BigInt(1),this.zero=BigInt(0),this.p=BigInt(t),this.m=1,this.negone=this.p-this.one,this.two=BigInt(2),this.half=this.p>>this.one,this.bitLength=L(this.p),this.mask=(this.one<<BigInt(this.bitLength))-this.one,this.n64=Math.floor((this.bitLength-1)/64)+1,this.n32=2*this.n64,this.n8=8*this.n64,this.R=this.e(this.one<<BigInt(64*this.n64)),this.Ri=this.inv(this.R);let e=this.negone>>this.one;this.nqr=this.two;let a=this.pow(this.nqr,e);for(;!this.eq(a,this.negone);)this.nqr=this.nqr+this.one,a=this.pow(this.nqr,e);for(this.s=0,this.t=this.negone;(this.t&this.one)==this.zero;)this.s=this.s+1,this.t=this.t>>this.one;this.nqr_to_t=this.pow(this.nqr,this.t),function(t){if(t.m%2==1){if(R(k(t.p,4),1)){if(R(k(t.p,8),1)){if(R(k(t.p,16),1))(function(t){for(t.sqrt_q=z(t.p,t.m),t.sqrt_s=0,t.sqrt_t=P(t.sqrt_q,1);!x(t.sqrt_t);)t.sqrt_s=t.sqrt_s+1,t.sqrt_t=Q(t.sqrt_t,2);let e=t.one;for(;t.eq(e,t.one);){let a=t.random();t.sqrt_z=t.pow(a,t.sqrt_t),e=t.pow(t.sqrt_z,2**(t.sqrt_s-1))}t.sqrt_tm1d2=Q(P(t.sqrt_t,1),2),t.sqrt=function(t){if(this.isZero(t))return this.zero;let e=this.pow(t,this.sqrt_tm1d2),a=this.pow(this.mul(this.square(e),t),2**(this.sqrt_s-1));if(this.eq(a,this.negone))return null;let i=this.sqrt_s,o=this.mul(t,e),n=this.mul(o,e),l=this.sqrt_z;for(;!this.eq(n,this.one);){let t=this.square(n),a=1;for(;!this.eq(t,this.one);)t=this.square(t),a++;e=l;for(let t=0;t<i-a-1;t++)e=this.square(e);l=this.square(e),n=this.mul(n,l),o=this.mul(o,e),i=a}return this.geq(o,this.zero)?o:this.neg(o)}})(t);else if(R(k(t.p,16),9))t.sqrt=function(){throw Error("Sqrt alg 4 not implemented")};else throw Error("Field withot sqrt")}else if(R(k(t.p,8),5))t.sqrt=function(){throw Error("Sqrt alg 3 not implemented")};else throw Error("Field withot sqrt")}else R(k(t.p,4),3)&&(t.sqrt_q=z(t.p,t.m),t.sqrt_e1=Q(P(t.sqrt_q,3),4),t.sqrt=function(e){if(this.isZero(e))return this.zero;let a=this.pow(e,this.sqrt_e1),i=this.mul(this.square(a),e);if(this.eq(i,this.negone))return null;let o=this.mul(a,e);return t.geq(o,t.zero)?o:t.neg(o)})}else{let e=k(z(t.p,t.m/2),4);1==e?t.sqrt=function(){throw Error("Sqrt alg 10 not implemented")}:3==e?(t.sqrt_q=z(t.p,t.m/2),t.sqrt_e34=Q(P(t.sqrt_q,3),4),t.sqrt_e12=Q(P(t.sqrt_q,1),2),t.frobenius=function(e,a){return e%2==1?t.conjugate(a):a},t.sqrt=function(t){let e;let a=this.pow(t,this.sqrt_e34),i=this.mul(this.square(a),t),o=this.mul(this.frobenius(1,i),i);if(this.eq(o,this.negone))return null;let n=this.mul(a,t);if(this.eq(i,this.negone))e=this.mul(n,[this.F.zero,this.F.one]);else{let t=this.pow(this.add(this.one,i),this.sqrt_e12);e=this.mul(t,n)}return this.geq(e,this.zero)?e:this.neg(e)}):t.sqrt=function(){throw Error("Sqrt alg 8 not implemented")}}}(this),this.FFT=new tp(this,this,this.mul.bind(this)),this.fft=this.FFT.fft.bind(this.FFT),this.ifft=this.FFT.ifft.bind(this.FFT),this.w=this.FFT.w,this.wi=this.FFT.wi,this.shift=this.square(this.nqr),this.k=this.exp(this.nqr,2**this.s)}e(t,e){let a;if(e?16==e&&(a=BigInt("0x"+t)):a=BigInt(t),!(a<0))return a>=this.p?a%this.p:a;{let t=-a;return t>=this.p&&(t%=this.p),this.p-t}}add(t,e){let a=t+e;return a>=this.p?a-this.p:a}sub(t,e){return t>=e?t-e:this.p-e+t}neg(t){return t?this.p-t:t}mul(t,e){return t*e%this.p}mulScalar(t,e){return t*this.e(e)%this.p}square(t){return t*t%this.p}eq(t,e){return t==e}neq(t,e){return t!=e}lt(t,e){return(t>this.half?t-this.p:t)<(e>this.half?e-this.p:e)}gt(t,e){return(t>this.half?t-this.p:t)>(e>this.half?e-this.p:e)}leq(t,e){return(t>this.half?t-this.p:t)<=(e>this.half?e-this.p:e)}geq(t,e){return(t>this.half?t-this.p:t)>=(e>this.half?e-this.p:e)}div(t,e){return this.mul(t,this.inv(e))}idiv(t,e){if(!e)throw Error("Division by zero");return t/e}inv(t){if(!t)throw Error("Division by zero");let e=this.zero,a=this.p,i=this.one,o=t%this.p;for(;o;){let t=a/o;[e,i]=[i,e-t*i],[a,o]=[o,a-t*o]}return e<this.zero&&(e+=this.p),e}mod(t,e){return t%e}pow(t,e){return ts(this,t,e)}exp(t,e){return ts(this,t,e)}band(t,e){let a=t&e&this.mask;return a>=this.p?a-this.p:a}bor(t,e){let a=(t|e)&this.mask;return a>=this.p?a-this.p:a}bxor(t,e){let a=(t^e)&this.mask;return a>=this.p?a-this.p:a}bnot(t){let e=t^this.mask;return e>=this.p?e-this.p:e}shl(t,e){if(Number(e)<this.bitLength){let a=t<<e&this.mask;return a>=this.p?a-this.p:a}{let a=this.p-e;return Number(a)<this.bitLength?t>>a:this.zero}}shr(t,e){if(Number(e)<this.bitLength)return t>>e;{let a=this.p-e;if(!(Number(a)<this.bitLength))return 0;{let e=t<<a&this.mask;return e>=this.p?e-this.p:e}}}land(t,e){return t&&e?this.one:this.zero}lor(t,e){return t||e?this.one:this.zero}lnot(t){return t?this.zero:this.one}sqrt_old(t){if(t==this.zero)return this.zero;if(this.pow(t,this.negone>>this.one)!=this.one)return null;let e=this.s,a=this.nqr_to_t,i=this.pow(t,this.t),o=this.pow(t,this.add(this.t,this.one)>>this.one);for(;i!=this.one;){let t=this.square(i),n=1;for(;t!=this.one;)n++,t=this.square(t);let l=a;for(let t=0;t<e-n-1;t++)l=this.square(l);e=n,a=this.square(l),i=this.mul(i,a),o=this.mul(o,l)}return o>this.p>>this.one&&(o=this.neg(o)),o}normalize(t,e){if(!((t=BigInt(t,e))<0))return t>=this.p?t%this.p:t;{let e=-t;return e>=this.p&&(e%=this.p),this.p-e}}random(){let t=2*this.bitLength/8,e=this.zero;for(let a=0;a<t;a++)e=(e<<BigInt(8))+BigInt(tf(1)[0]);return e%this.p}toString(t,e){return e=e||10,t>this.half&&10==e?"-"+(this.p-t).toString(e):t.toString(e)}isZero(t){return t==this.zero}fromRng(t){let e;do{e=this.zero;for(let a=0;a<this.n64;a++)e+=t.nextU64()<<BigInt(64*a);e&=this.mask}while(e>=this.p);return e*this.Ri%this.p}fft(t){return this.FFT.fft(t)}ifft(t){return this.FFT.ifft(t)}toRprLE(t,e,a){X(t,e,a,8*this.n64)}toRprBE(t,e,a){tt(t,e,a,8*this.n64)}toRprBEM(t,e,a){return this.toRprBE(t,e,this.mul(this.R,a))}toRprLEM(t,e,a){return this.toRprLE(t,e,this.mul(this.R,a))}fromRprLE(t,e){return te(t,e,this.n8)}fromRprBE(t,e){return ta(t,e,this.n8)}fromRprLEM(t,e){return this.mul(this.fromRprLE(t,e),this.Ri)}fromRprBEM(t,e){return this.mul(this.fromRprBE(t,e),this.Ri)}toObject(t){return t}}var tL=a(2434);function tw(t){let e=BigInt(0),a=t.length,i=0,o=new DataView(t.buffer,t.byteOffset,t.byteLength);for(;a>0;)a>=4?(a-=4,e+=BigInt(o.getUint32(a))<<BigInt(8*i),i+=4):a>=2?(a-=2,e+=BigInt(o.getUint16(a))<<BigInt(8*i),i+=2):(a-=1,e+=BigInt(o.getUint8(a))<<BigInt(8*i),i+=1);return e}function ty(t,e){let a=t,i=new Uint8Array(e),o=new DataView(i.buffer),n=e;for(;n>0;)n-4>=0?(n-=4,o.setUint32(n,Number(a&BigInt(4294967295))),a>>=BigInt(32)):n-2>=0?(n-=2,o.setUint16(n,Number(a&BigInt(65535))),a>>=BigInt(16)):(n-=1,o.setUint8(n,Number(a&BigInt(255))),a>>=BigInt(8));if(a)throw Error("Number does not fit in this length");return i}function tA(t){let e=BigInt(0),a=0,i=new DataView(t.buffer,t.byteOffset,t.byteLength);for(;a<t.length;)a+4<=t.length?(e+=BigInt(i.getUint32(a,!0))<<BigInt(8*a),a+=4):a+2<=t.length?(e+=BigInt(i.getUint16(a,!0))<<BigInt(8*a),a+=2):(e+=BigInt(i.getUint8(a,!0))<<BigInt(8*a),a+=1);return e}function tC(t,e){let a=t;void 0===e&&0==(e=Math.floor((L(t)-1)/8)+1)&&(e=1);let i=new Uint8Array(e),o=new DataView(i.buffer),n=0;for(;n<e;)n+4<=e?(o.setUint32(n,Number(a&BigInt(4294967295)),!0),n+=4,a>>=BigInt(32)):n+2<=e?(o.setUint16(n,Number(a&BigInt(65535)),!0),n+=2,a>>=BigInt(16)):(o.setUint8(n,Number(a&BigInt(255)),!0),n+=1,a>>=BigInt(8));if(a)throw Error("Number does not fit in this length");return i}let tI=[];for(let t=0;t<256;t++)tI[t]=function(t,e){let a=0,i=t;for(let t=0;t<8;t++)a<<=1,a|=1&i,i>>=1;return a}(t,0);function tF(t,e){return(tI[t>>>24]|tI[t>>>16&255]<<8|tI[t>>>8&255]<<16|tI[255&t]<<24)>>>32-e}function tx(t){return((4294901760&t)!=0?(t&=4294901760,16):0)|((4278255360&t)!=0?(t&=4278255360,8):0)|((4042322160&t)!=0?(t&=4042322160,4):0)|((3435973836&t)!=0?(t&=3435973836,2):0)|(2863311530&t)!=0}function tE(t,e){let a=t.byteLength/e,i=tx(a);if(a!=1<<i)throw Error("Invalid number of pointers");for(let o=0;o<a;o++){let a=tF(o,i);if(o>a){let i=t.slice(o*e,(o+1)*e);t.set(t.slice(a*e,(a+1)*e),o*e),t.set(i,a*e)}}}function tv(t,e){let a=new Uint8Array(e*t.length);for(let i=0;i<t.length;i++)a.set(t[i],i*e);return a}function tB(t,e){let a=t.byteLength/e,i=Array(a);for(let o=0;o<a;o++)i[o]=t.slice(o*e,o*e+e);return i}class tS{constructor(t){this.buffers=[],this.byteLength=t;for(let e=0;e<t;e+=1073741824){let a=Math.min(t-e,1073741824);this.buffers.push(new Uint8Array(a))}}slice(t,e){let a;void 0===e&&(e=this.byteLength),void 0===t&&(t=0);let i=e-t,o=Math.floor(t/1073741824);if(o==Math.floor((t+i-1)/1073741824)||0==i)return this.buffers[o].slice(t%1073741824,t%1073741824+i);let n=o,l=t%1073741824,r=i;for(;r>0;){let t=l+r>1073741824?1073741824-l:r,e=new Uint8Array(this.buffers[n].buffer,this.buffers[n].byteOffset+l,t);if(t==i)return e.slice();a||(a=i<=1073741824?new Uint8Array(i):new tS(i)),a.set(e,i-r),r-=t,n++,l=0}return a}set(t,e){void 0===e&&(e=0);let a=t.byteLength;if(0==a)return;let i=Math.floor(e/1073741824);if(i==Math.floor((e+a-1)/1073741824))return t instanceof tS&&1==t.buffers.length?this.buffers[i].set(t.buffers[0],e%1073741824):this.buffers[i].set(t,e%1073741824);let o=i,n=e%1073741824,l=a;for(;l>0;){let e=n+l>1073741824?1073741824-n:l,i=t.slice(a-l,a-l+e);new Uint8Array(this.buffers[o].buffer,this.buffers[o].byteOffset+n,e).set(i),l-=e,o++,n=0}}}function tO(t,e,a,i){return async function(o){let n;let l=Math.floor(o.byteLength/a);if(l*a!==o.byteLength)throw Error("Invalid buffer size");let r=Math.floor(l/t.concurrency),s=[];for(let n=0;n<t.concurrency;n++){let c;if(0==(c=n<t.concurrency-1?r:l-n*r))continue;let d=[{cmd:"ALLOCSET",var:0,buff:o.slice(n*r*a,n*r*a+c*a)},{cmd:"ALLOC",var:1,len:i*c},{cmd:"CALL",fnName:e,params:[{var:0},{val:c},{var:1}]},{cmd:"GET",out:0,var:1,len:i*c}];s.push(t.queueAction(d))}let c=await Promise.all(s);n=o instanceof tS?new tS(l*i):new Uint8Array(l*i);let d=0;for(let t=0;t<c.length;t++)n.set(c[t][0],d),d+=c[t][0].byteLength;return n}}class tP{constructor(t,e,a,i){if(this.tm=t,this.prefix=e,this.p=i,this.n8=a,this.type="F1",this.m=1,this.half=C(i,tl),this.bitLength=L(i),this.mask=P(A(tl,this.bitLength),tl),this.pOp1=t.alloc(a),this.pOp2=t.alloc(a),this.pOp3=t.alloc(a),this.tm.instance.exports[e+"_zero"](this.pOp1),this.zero=this.tm.getBuff(this.pOp1,this.n8),this.tm.instance.exports[e+"_one"](this.pOp1),this.one=this.tm.getBuff(this.pOp1,this.n8),this.negone=this.neg(this.one),this.two=this.add(this.one,this.one),this.n64=Math.floor(a/8),this.n32=Math.floor(a/4),8*this.n64!=this.n8)throw Error("n8 must be a multiple of 8");this.half=C(this.p,tl),this.nqr=this.two;let o=this.exp(this.nqr,this.half);for(;!this.eq(o,this.negone);)this.nqr=this.add(this.nqr,this.one),o=this.exp(this.nqr,this.half);this.shift=this.mul(this.nqr,this.nqr),this.shiftInv=this.inv(this.shift),this.s=0;let n=P(this.p,tl);for(;!x(n);)this.s=this.s+1,n=C(n,tl);this.w=[],this.w[this.s]=this.exp(this.nqr,n);for(let t=this.s-1;t>=0;t--)this.w[t]=this.square(this.w[t+1]);if(!this.eq(this.w[0],this.one))throw Error("Error calculating roots of unity");this.batchToMontgomery=tO(t,e+"_batchToMontgomery",this.n8,this.n8),this.batchFromMontgomery=tO(t,e+"_batchFromMontgomery",this.n8,this.n8)}op2(t,e,a){return this.tm.setBuff(this.pOp1,e),this.tm.setBuff(this.pOp2,a),this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp2,this.pOp3),this.tm.getBuff(this.pOp3,this.n8)}op2Bool(t,e,a){return this.tm.setBuff(this.pOp1,e),this.tm.setBuff(this.pOp2,a),!!this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp2)}op1(t,e){return this.tm.setBuff(this.pOp1,e),this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp3),this.tm.getBuff(this.pOp3,this.n8)}op1Bool(t,e){return this.tm.setBuff(this.pOp1,e),!!this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp3)}add(t,e){return this.op2("_add",t,e)}eq(t,e){return this.op2Bool("_eq",t,e)}isZero(t){return this.op1Bool("_isZero",t)}sub(t,e){return this.op2("_sub",t,e)}neg(t){return this.op1("_neg",t)}inv(t){return this.op1("_inverse",t)}toMontgomery(t){return this.op1("_toMontgomery",t)}fromMontgomery(t){return this.op1("_fromMontgomery",t)}mul(t,e){return this.op2("_mul",t,e)}div(t,e){return this.tm.setBuff(this.pOp1,t),this.tm.setBuff(this.pOp2,e),this.tm.instance.exports[this.prefix+"_inverse"](this.pOp2,this.pOp2),this.tm.instance.exports[this.prefix+"_mul"](this.pOp1,this.pOp2,this.pOp3),this.tm.getBuff(this.pOp3,this.n8)}square(t){return this.op1("_square",t)}isSquare(t){return this.op1Bool("_isSquare",t)}sqrt(t){return this.op1("_sqrt",t)}exp(t,e){return e instanceof Uint8Array||(e=to(m(e))),this.tm.setBuff(this.pOp1,t),this.tm.setBuff(this.pOp2,e),this.tm.instance.exports[this.prefix+"_exp"](this.pOp1,this.pOp2,e.byteLength,this.pOp3),this.tm.getBuff(this.pOp3,this.n8)}isNegative(t){return this.op1Bool("_isNegative",t)}e(t,e){if(t instanceof Uint8Array)return t;let a=m(t,e);w(a)?($(a=G(a),this.p)&&(a=k(a,this.p)),a=P(this.p,a)):$(a,this.p)&&(a=k(a,this.p));let i=tC(a,this.n8);return this.toMontgomery(i)}toString(t,e){return ti(te(this.fromMontgomery(t),0),e)}fromRng(t){let e;let a=new Uint8Array(this.n8);do{e=tn;for(let a=0;a<this.n64;a++)e=O(e,A(t.nextU64(),64*a));e=K(e,this.mask)}while(V(e,this.p));return X(a,0,e,this.n8),a}random(){return this.fromRng(tg())}toObject(t){return te(this.fromMontgomery(t),0)}fromObject(t){let e=new Uint8Array(this.n8);return X(e,0,t,this.n8),this.toMontgomery(e)}toRprLE(t,e,a){t.set(this.fromMontgomery(a),e)}toRprBE(t,e,a){let i=this.fromMontgomery(a);for(let t=0;t<this.n8/2;t++){let e=i[t];i[t]=i[this.n8-1-t],i[this.n8-1-t]=e}t.set(i,e)}fromRprLE(t,e){e=e||0;let a=t.slice(e,e+this.n8);return this.toMontgomery(a)}async batchInverse(t){let e,a=!1,i=this.n8,o=this.n8;Array.isArray(t)?(t=tv(t,i),a=!0):t=t.slice(0,t.byteLength);let n=Math.floor(t.byteLength/i);if(n*i!==t.byteLength)throw Error("Invalid buffer size");let l=Math.floor(n/this.tm.concurrency),r=[];for(let e=0;e<this.tm.concurrency;e++){let a;if(0==(a=e<this.tm.concurrency-1?l:n-e*l))continue;let s=[{cmd:"ALLOCSET",var:0,buff:t.slice(e*l*i,e*l*i+a*i)},{cmd:"ALLOC",var:1,len:o*a},{cmd:"CALL",fnName:this.prefix+"_batchInverse",params:[{var:0},{val:i},{val:a},{var:1},{val:o}]},{cmd:"GET",out:0,var:1,len:o*a}];r.push(this.tm.queueAction(s))}let s=await Promise.all(r);e=t instanceof tS?new tS(n*o):new Uint8Array(n*o);let c=0;for(let t=0;t<s.length;t++)e.set(s[t][0],c),c+=s[t][0].byteLength;return a?tB(e,o):e}}class tG{constructor(t,e,a){this.tm=t,this.prefix=e,this.F=a,this.type="F2",this.m=2*a.m,this.n8=2*this.F.n8,this.n32=2*this.F.n32,this.n64=2*this.F.n64,this.pOp1=t.alloc(2*a.n8),this.pOp2=t.alloc(2*a.n8),this.pOp3=t.alloc(2*a.n8),this.tm.instance.exports[e+"_zero"](this.pOp1),this.zero=t.getBuff(this.pOp1,this.n8),this.tm.instance.exports[e+"_one"](this.pOp1),this.one=t.getBuff(this.pOp1,this.n8),this.negone=this.neg(this.one),this.two=this.add(this.one,this.one)}op2(t,e,a){return this.tm.setBuff(this.pOp1,e),this.tm.setBuff(this.pOp2,a),this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp2,this.pOp3),this.tm.getBuff(this.pOp3,this.n8)}op2Bool(t,e,a){return this.tm.setBuff(this.pOp1,e),this.tm.setBuff(this.pOp2,a),!!this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp2)}op1(t,e){return this.tm.setBuff(this.pOp1,e),this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp3),this.tm.getBuff(this.pOp3,this.n8)}op1Bool(t,e){return this.tm.setBuff(this.pOp1,e),!!this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp3)}add(t,e){return this.op2("_add",t,e)}eq(t,e){return this.op2Bool("_eq",t,e)}isZero(t){return this.op1Bool("_isZero",t)}sub(t,e){return this.op2("_sub",t,e)}neg(t){return this.op1("_neg",t)}inv(t){return this.op1("_inverse",t)}isNegative(t){return this.op1Bool("_isNegative",t)}toMontgomery(t){return this.op1("_toMontgomery",t)}fromMontgomery(t){return this.op1("_fromMontgomery",t)}mul(t,e){return this.op2("_mul",t,e)}mul1(t,e){return this.op2("_mul1",t,e)}div(t,e){return this.tm.setBuff(this.pOp1,t),this.tm.setBuff(this.pOp2,e),this.tm.instance.exports[this.prefix+"_inverse"](this.pOp2,this.pOp2),this.tm.instance.exports[this.prefix+"_mul"](this.pOp1,this.pOp2,this.pOp3),this.tm.getBuff(this.pOp3,this.n8)}square(t){return this.op1("_square",t)}isSquare(t){return this.op1Bool("_isSquare",t)}sqrt(t){return this.op1("_sqrt",t)}exp(t,e){return e instanceof Uint8Array||(e=to(m(e))),this.tm.setBuff(this.pOp1,t),this.tm.setBuff(this.pOp2,e),this.tm.instance.exports[this.prefix+"_exp"](this.pOp1,this.pOp2,e.byteLength,this.pOp3),this.tm.getBuff(this.pOp3,this.n8)}e(t,e){if(t instanceof Uint8Array)return t;if(Array.isArray(t)&&2==t.length){let a=this.F.e(t[0],e),i=this.F.e(t[1],e),o=new Uint8Array(2*this.F.n8);return o.set(a),o.set(i,2*this.F.n8),o}throw Error("invalid F2")}toString(t,e){let a=this.F.toString(t.slice(0,this.F.n8),e),i=this.F.toString(t.slice(this.F.n8),e);return`[${a}, ${i}]`}fromRng(t){let e=this.F.fromRng(t),a=this.F.fromRng(t),i=new Uint8Array(2*this.F.n8);return i.set(e),i.set(a,this.F.n8),i}random(){return this.fromRng(tg())}toObject(t){return[this.F.toObject(t.slice(0,this.F.n8)),this.F.toObject(t.slice(this.F.n8,2*this.F.n8))]}fromObject(t){let e=new Uint8Array(2*this.F.n8),a=this.F.fromObject(t[0]),i=this.F.fromObject(t[1]);return e.set(a),e.set(i,this.F.n8),e}c1(t){return t.slice(0,this.F.n8)}c2(t){return t.slice(this.F.n8)}}class tT{constructor(t,e,a){this.tm=t,this.prefix=e,this.F=a,this.type="F3",this.m=3*a.m,this.n8=3*this.F.n8,this.n32=3*this.F.n32,this.n64=3*this.F.n64,this.pOp1=t.alloc(3*a.n8),this.pOp2=t.alloc(3*a.n8),this.pOp3=t.alloc(3*a.n8),this.tm.instance.exports[e+"_zero"](this.pOp1),this.zero=t.getBuff(this.pOp1,this.n8),this.tm.instance.exports[e+"_one"](this.pOp1),this.one=t.getBuff(this.pOp1,this.n8),this.negone=this.neg(this.one),this.two=this.add(this.one,this.one)}op2(t,e,a){return this.tm.setBuff(this.pOp1,e),this.tm.setBuff(this.pOp2,a),this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp2,this.pOp3),this.tm.getBuff(this.pOp3,this.n8)}op2Bool(t,e,a){return this.tm.setBuff(this.pOp1,e),this.tm.setBuff(this.pOp2,a),!!this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp2)}op1(t,e){return this.tm.setBuff(this.pOp1,e),this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp3),this.tm.getBuff(this.pOp3,this.n8)}op1Bool(t,e){return this.tm.setBuff(this.pOp1,e),!!this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp3)}eq(t,e){return this.op2Bool("_eq",t,e)}isZero(t){return this.op1Bool("_isZero",t)}add(t,e){return this.op2("_add",t,e)}sub(t,e){return this.op2("_sub",t,e)}neg(t){return this.op1("_neg",t)}inv(t){return this.op1("_inverse",t)}isNegative(t){return this.op1Bool("_isNegative",t)}toMontgomery(t){return this.op1("_toMontgomery",t)}fromMontgomery(t){return this.op1("_fromMontgomery",t)}mul(t,e){return this.op2("_mul",t,e)}div(t,e){return this.tm.setBuff(this.pOp1,t),this.tm.setBuff(this.pOp2,e),this.tm.instance.exports[this.prefix+"_inverse"](this.pOp2,this.pOp2),this.tm.instance.exports[this.prefix+"_mul"](this.pOp1,this.pOp2,this.pOp3),this.tm.getBuff(this.pOp3,this.n8)}square(t){return this.op1("_square",t)}isSquare(t){return this.op1Bool("_isSquare",t)}sqrt(t){return this.op1("_sqrt",t)}exp(t,e){return e instanceof Uint8Array||(e=to(m(e))),this.tm.setBuff(this.pOp1,t),this.tm.setBuff(this.pOp2,e),this.tm.instance.exports[this.prefix+"_exp"](this.pOp1,this.pOp2,e.byteLength,this.pOp3),this.getBuff(this.pOp3,this.n8)}e(t,e){if(t instanceof Uint8Array)return t;if(Array.isArray(t)&&3==t.length){let a=this.F.e(t[0],e),i=this.F.e(t[1],e),o=this.F.e(t[2],e),n=new Uint8Array(3*this.F.n8);return n.set(a),n.set(i,this.F.n8),n.set(o,2*this.F.n8),n}throw Error("invalid F3")}toString(t,e){let a=this.F.toString(t.slice(0,this.F.n8),e),i=this.F.toString(t.slice(this.F.n8,2*this.F.n8),e),o=this.F.toString(t.slice(2*this.F.n8),e);return`[${a}, ${i}, ${o}]`}fromRng(t){let e=this.F.fromRng(t),a=this.F.fromRng(t),i=this.F.fromRng(t),o=new Uint8Array(3*this.F.n8);return o.set(e),o.set(a,this.F.n8),o.set(i,2*this.F.n8),o}random(){return this.fromRng(tg())}toObject(t){return[this.F.toObject(t.slice(0,this.F.n8)),this.F.toObject(t.slice(this.F.n8,2*this.F.n8)),this.F.toObject(t.slice(2*this.F.n8,3*this.F.n8))]}fromObject(t){let e=new Uint8Array(3*this.F.n8),a=this.F.fromObject(t[0]),i=this.F.fromObject(t[1]),o=this.F.fromObject(t[2]);return e.set(a),e.set(i,this.F.n8),e.set(o,2*this.F.n8),e}c1(t){return t.slice(0,this.F.n8)}c2(t){return t.slice(this.F.n8,2*this.F.n8)}c3(t){return t.slice(2*this.F.n8)}}class tq{constructor(t,e,a,i,o,n){this.tm=t,this.prefix=e,this.F=a,this.pOp1=t.alloc(3*a.n8),this.pOp2=t.alloc(3*a.n8),this.pOp3=t.alloc(3*a.n8),this.tm.instance.exports[e+"_zero"](this.pOp1),this.zero=this.tm.getBuff(this.pOp1,3*a.n8),this.tm.instance.exports[e+"_zeroAffine"](this.pOp1),this.zeroAffine=this.tm.getBuff(this.pOp1,2*a.n8),this.one=this.tm.getBuff(i,3*a.n8),this.g=this.one,this.oneAffine=this.tm.getBuff(i,2*a.n8),this.gAffine=this.oneAffine,this.b=this.tm.getBuff(o,a.n8),n&&(this.cofactor=to(n)),this.negone=this.neg(this.one),this.two=this.add(this.one,this.one),this.batchLEMtoC=tO(t,e+"_batchLEMtoC",2*a.n8,a.n8),this.batchLEMtoU=tO(t,e+"_batchLEMtoU",2*a.n8,2*a.n8),this.batchCtoLEM=tO(t,e+"_batchCtoLEM",a.n8,2*a.n8),this.batchUtoLEM=tO(t,e+"_batchUtoLEM",2*a.n8,2*a.n8),this.batchToJacobian=tO(t,e+"_batchToJacobian",2*a.n8,3*a.n8),this.batchToAffine=tO(t,e+"_batchToAffine",3*a.n8,2*a.n8)}op2(t,e,a){return this.tm.setBuff(this.pOp1,e),this.tm.setBuff(this.pOp2,a),this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp2,this.pOp3),this.tm.getBuff(this.pOp3,3*this.F.n8)}op2bool(t,e,a){return this.tm.setBuff(this.pOp1,e),this.tm.setBuff(this.pOp2,a),!!this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp2,this.pOp3)}op1(t,e){return this.tm.setBuff(this.pOp1,e),this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp3),this.tm.getBuff(this.pOp3,3*this.F.n8)}op1Affine(t,e){return this.tm.setBuff(this.pOp1,e),this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp3),this.tm.getBuff(this.pOp3,2*this.F.n8)}op1Bool(t,e){return this.tm.setBuff(this.pOp1,e),!!this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp3)}add(t,e){if(t.byteLength==3*this.F.n8){if(e.byteLength==3*this.F.n8)return this.op2("_add",t,e);if(e.byteLength==2*this.F.n8)return this.op2("_addMixed",t,e);throw Error("invalid point size")}if(t.byteLength==2*this.F.n8){if(e.byteLength==3*this.F.n8)return this.op2("_addMixed",e,t);if(e.byteLength==2*this.F.n8)return this.op2("_addAffine",t,e)}throw Error("invalid point size")}sub(t,e){if(t.byteLength==3*this.F.n8){if(e.byteLength==3*this.F.n8)return this.op2("_sub",t,e);if(e.byteLength==2*this.F.n8)return this.op2("_subMixed",t,e);throw Error("invalid point size")}if(t.byteLength==2*this.F.n8){if(e.byteLength==3*this.F.n8)return this.op2("_subMixed",e,t);if(e.byteLength==2*this.F.n8)return this.op2("_subAffine",t,e)}throw Error("invalid point size")}neg(t){if(t.byteLength==3*this.F.n8)return this.op1("_neg",t);if(t.byteLength==2*this.F.n8)return this.op1Affine("_negAffine",t);throw Error("invalid point size")}double(t){if(t.byteLength==3*this.F.n8)return this.op1("_double",t);if(t.byteLength==2*this.F.n8)return this.op1("_doubleAffine",t);throw Error("invalid point size")}isZero(t){if(t.byteLength==3*this.F.n8)return this.op1Bool("_isZero",t);if(t.byteLength==2*this.F.n8)return this.op1Bool("_isZeroAffine",t);throw Error("invalid point size")}timesScalar(t,e){let a;if(e instanceof Uint8Array||(e=to(m(e))),t.byteLength==3*this.F.n8)a=this.prefix+"_timesScalar";else if(t.byteLength==2*this.F.n8)a=this.prefix+"_timesScalarAffine";else throw Error("invalid point size");return this.tm.setBuff(this.pOp1,t),this.tm.setBuff(this.pOp2,e),this.tm.instance.exports[a](this.pOp1,this.pOp2,e.byteLength,this.pOp3),this.tm.getBuff(this.pOp3,3*this.F.n8)}timesFr(t,e){let a;if(t.byteLength==3*this.F.n8)a=this.prefix+"_timesFr";else if(t.byteLength==2*this.F.n8)a=this.prefix+"_timesFrAffine";else throw Error("invalid point size");return this.tm.setBuff(this.pOp1,t),this.tm.setBuff(this.pOp2,e),this.tm.instance.exports[a](this.pOp1,this.pOp2,this.pOp3),this.tm.getBuff(this.pOp3,3*this.F.n8)}eq(t,e){if(t.byteLength==3*this.F.n8){if(e.byteLength==3*this.F.n8)return this.op2bool("_eq",t,e);if(e.byteLength==2*this.F.n8)return this.op2bool("_eqMixed",t,e);throw Error("invalid point size")}if(t.byteLength==2*this.F.n8){if(e.byteLength==3*this.F.n8)return this.op2bool("_eqMixed",e,t);if(e.byteLength==2*this.F.n8)return this.op2bool("_eqAffine",t,e)}throw Error("invalid point size")}toAffine(t){if(t.byteLength==3*this.F.n8)return this.op1Affine("_toAffine",t);if(t.byteLength==2*this.F.n8)return t;throw Error("invalid point size")}toJacobian(t){if(t.byteLength==3*this.F.n8)return t;if(t.byteLength==2*this.F.n8)return this.op1("_toJacobian",t);throw Error("invalid point size")}toRprUncompressed(t,e,a){if(this.tm.setBuff(this.pOp1,a),a.byteLength==3*this.F.n8)this.tm.instance.exports[this.prefix+"_toAffine"](this.pOp1,this.pOp1);else if(a.byteLength!=2*this.F.n8)throw Error("invalid point size");this.tm.instance.exports[this.prefix+"_LEMtoU"](this.pOp1,this.pOp1);let i=this.tm.getBuff(this.pOp1,2*this.F.n8);t.set(i,e)}fromRprUncompressed(t,e){let a=t.slice(e,e+2*this.F.n8);return this.tm.setBuff(this.pOp1,a),this.tm.instance.exports[this.prefix+"_UtoLEM"](this.pOp1,this.pOp1),this.tm.getBuff(this.pOp1,2*this.F.n8)}toRprCompressed(t,e,a){if(this.tm.setBuff(this.pOp1,a),a.byteLength==3*this.F.n8)this.tm.instance.exports[this.prefix+"_toAffine"](this.pOp1,this.pOp1);else if(a.byteLength!=2*this.F.n8)throw Error("invalid point size");this.tm.instance.exports[this.prefix+"_LEMtoC"](this.pOp1,this.pOp1);let i=this.tm.getBuff(this.pOp1,this.F.n8);t.set(i,e)}fromRprCompressed(t,e){let a=t.slice(e,e+this.F.n8);return this.tm.setBuff(this.pOp1,a),this.tm.instance.exports[this.prefix+"_CtoLEM"](this.pOp1,this.pOp2),this.tm.getBuff(this.pOp2,2*this.F.n8)}toUncompressed(t){let e=new Uint8Array(2*this.F.n8);return this.toRprUncompressed(e,0,t),e}toRprLEM(t,e,a){if(a.byteLength==2*this.F.n8){t.set(a,e);return}if(a.byteLength==3*this.F.n8){this.tm.setBuff(this.pOp1,a),this.tm.instance.exports[this.prefix+"_toAffine"](this.pOp1,this.pOp1);let i=this.tm.getBuff(this.pOp1,2*this.F.n8);t.set(i,e)}else throw Error("invalid point size")}fromRprLEM(t,e){return e=e||0,t.slice(e,e+2*this.F.n8)}toString(t,e){if(t.byteLength==3*this.F.n8){let a=this.F.toString(t.slice(0,this.F.n8),e),i=this.F.toString(t.slice(this.F.n8,2*this.F.n8),e),o=this.F.toString(t.slice(2*this.F.n8),e);return`[ ${a}, ${i}, ${o} ]`}if(t.byteLength==2*this.F.n8){let a=this.F.toString(t.slice(0,this.F.n8),e),i=this.F.toString(t.slice(this.F.n8),e);return`[ ${a}, ${i} ]`}throw Error("invalid point size")}isValid(t){if(this.isZero(t))return!0;let e=this.F,a=this.toAffine(t),i=a.slice(0,this.F.n8),o=a.slice(this.F.n8,2*this.F.n8),n=e.add(e.mul(e.square(i),i),this.b),l=e.square(o);return e.eq(n,l)}fromRng(t){let e,a;let i=this.F,o=[];do o[0]=i.fromRng(t),e=t.nextBool(),a=i.add(i.mul(i.square(o[0]),o[0]),this.b);while(!i.isSquare(a));o[1]=i.sqrt(a),e^i.isNegative(o[1])&&(o[1]=i.neg(o[1]));let n=new Uint8Array(2*this.F.n8);return n.set(o[0]),n.set(o[1],this.F.n8),this.cofactor&&(n=this.timesScalar(n,this.cofactor)),n}toObject(t){return this.isZero(t)?[this.F.toObject(this.F.zero),this.F.toObject(this.F.one),this.F.toObject(this.F.zero)]:[this.F.toObject(t.slice(0,this.F.n8)),this.F.toObject(t.slice(this.F.n8,2*this.F.n8)),t.byteLength==3*this.F.n8?this.F.toObject(t.slice(2*this.F.n8,3*this.F.n8)):this.F.toObject(this.F.one)]}fromObject(t){let e;let a=this.F.fromObject(t[0]),i=this.F.fromObject(t[1]);if(e=3==t.length?this.F.fromObject(t[2]):this.F.one,this.F.isZero(e,this.F.one))return this.zeroAffine;if(this.F.eq(e,this.F.one)){let t=new Uint8Array(2*this.F.n8);return t.set(a),t.set(i,this.F.n8),t}{let t=new Uint8Array(3*this.F.n8);return t.set(a),t.set(i,this.F.n8),t.set(e,2*this.F.n8),t}}e(t){return t instanceof Uint8Array?t:this.fromObject(t)}x(t){return this.toAffine(t).slice(0,this.F.n8)}y(t){return this.toAffine(t).slice(this.F.n8)}}function tz(t){let e,a;async function i(t){let i=new Uint8Array(t.code),o=await WebAssembly.compile(i);a=new WebAssembly.Memory({initial:t.init,maximum:32767}),e=await WebAssembly.instantiate(o,{env:{memory:a}})}function o(t){let e=new Uint32Array(a.buffer,0,1);for(;3&e[0];)e[0]++;let i=e[0];if(e[0]+=t,e[0]+t>a.buffer.byteLength){let i=a.buffer.byteLength/65536,o=Math.floor((e[0]+t)/65536)+1;o>32767&&(o=32767),a.grow(o-i)}return i}function n(t,e){new Uint8Array(a.buffer).set(new Uint8Array(e),t)}function l(t){if("INIT"==t[0].cmd)return i(t[0]);let l={vars:[],out:[]},r=new Uint32Array(a.buffer,0,1)[0];for(let i=0;i<t.length;i++)switch(t[i].cmd){case"ALLOCSET":l.vars[t[i].var]=function(t){let e=o(t.byteLength);return n(e,t),e}(t[i].buff);break;case"ALLOC":l.vars[t[i].var]=o(t[i].len);break;case"SET":n(l.vars[t[i].var],t[i].buff);break;case"CALL":{let a=[];for(let e=0;e<t[i].params.length;e++){let o=t[i].params[e];void 0!==o.var?a.push(l.vars[o.var]+(o.offset||0)):void 0!==o.val&&a.push(o.val)}e.exports[t[i].fnName](...a);break}case"GET":l.out[t[i].out]=(function(t,e){let i=new Uint8Array(a.buffer);return new Uint8Array(i.buffer,i.byteOffset+t,e)})(l.vars[t[i].var],t[i].len).slice();break;default:throw Error("Invalid cmd")}return new Uint32Array(a.buffer,0,1)[0]=r,l.out}return t&&(t.onmessage=function(e){let a;if("INIT"==(a=e.data?e.data:e)[0].cmd)i(a[0]).then(function(){t.postMessage(a.result)});else if("TERMINATE"==a[0].cmd)t.close();else{let e=l(a);t.postMessage(e)}}),l}var tU=a(9801),tM=a(4829);class tQ{constructor(){this.promise=new Promise((t,e)=>{this.reject=e,this.resolve=t})}}let tk=`(${tz.toString()})(self)`;async function tR(t,e){let a=new tN;a.memory=new WebAssembly.Memory({initial:25}),a.u8=new Uint8Array(a.memory.buffer),a.u32=new Uint32Array(a.memory.buffer);let o=await WebAssembly.compile(t.code);if(a.instance=await WebAssembly.instantiate(o,{env:{memory:a.memory}}),a.singleThread=e,a.initalPFree=a.u32[0],a.pq=t.pq,a.pr=t.pr,a.pG1gen=t.pG1gen,a.pG1zero=t.pG1zero,a.pG2gen=t.pG2gen,a.pG2zero=t.pG2zero,a.pOneT=t.pOneT,e)a.code=t.code,a.taskManager=tz(),await a.taskManager([{cmd:"INIT",init:25,code:a.code.slice()}]),a.concurrency=1;else{a.workers=[],a.pendingDeferreds=[],a.working=[];let e=2;0==(e=tU.cpus().length)&&(e=2),e>64&&(e=64),a.concurrency=e;for(let t=0;t<e;t++)a.workers[t]=new tM(i),a.workers[t].addEventListener("message",function(t){return function(e){let i;i=e&&e.data?e.data:e,a.working[t]=!1,a.pendingDeferreds[t].resolve(i),a.processWorks()}}(t)),a.working[t]=!1;let o=[];for(let e=0;e<a.workers.length;e++){let i=t.code.slice();o.push(a.postAction(e,[{cmd:"INIT",init:25,code:i}],[i.buffer]))}await Promise.all(o)}return a}i="data:application/javascript;base64,"+Buffer.from(tk).toString("base64");class tN{constructor(){this.actionQueue=[],this.oldPFree=0}startSyncOp(){if(0!=this.oldPFree)throw Error("Sync operation in progress");this.oldPFree=this.u32[0]}endSyncOp(){if(0==this.oldPFree)throw Error("No sync operation in progress");this.u32[0]=this.oldPFree,this.oldPFree=0}postAction(t,e,a,i){if(this.working[t])throw Error("Posting a job t a working worker");return this.working[t]=!0,this.pendingDeferreds[t]=i||new tQ,this.workers[t].postMessage(e,a),this.pendingDeferreds[t].promise}processWorks(){for(let t=0;t<this.workers.length&&this.actionQueue.length>0;t++)if(!1==this.working[t]){let e=this.actionQueue.shift();this.postAction(t,e.data,e.transfers,e.deferred)}}queueAction(t,e){let a=new tQ;if(this.singleThread){let e=this.taskManager(t);a.resolve(e)}else this.actionQueue.push({data:t,transfers:e,deferred:a}),this.processWorks();return a.promise}resetMemory(){this.u32[0]=this.initalPFree}allocBuff(t){let e=this.alloc(t.byteLength);return this.setBuff(e,t),e}getBuff(t,e){return this.u8.slice(t,t+e)}setBuff(t,e){this.u8.set(new Uint8Array(e),t)}alloc(t){for(;3&this.u32[0];)this.u32[0]++;let e=this.u32[0];return this.u32[0]+=t,e}async terminate(){for(let t=0;t<this.workers.length;t++)this.workers[t].postMessage([{cmd:"TERMINATE"}]);await new Promise(t=>setTimeout(t,200))}}function tD(t,e){let a=t[e],i=t.Fr,o=t.tm;t[e].batchApplyKey=async function(t,n,l,r,s){let c,d,u,f,h,g;if(r=r||"affine",s=s||"affine","G1"==e)"jacobian"==r?(u=3*a.F.n8,c="g1m_batchApplyKey"):(u=2*a.F.n8,c="g1m_batchApplyKeyMixed"),f=3*a.F.n8,"jacobian"==s?h=3*a.F.n8:(d="g1m_batchToAffine",h=2*a.F.n8);else if("G2"==e)"jacobian"==r?(u=3*a.F.n8,c="g2m_batchApplyKey"):(u=2*a.F.n8,c="g2m_batchApplyKeyMixed"),f=3*a.F.n8,"jacobian"==s?h=3*a.F.n8:(d="g2m_batchToAffine",h=2*a.F.n8);else if("Fr"==e)c="frm_batchApplyKey",u=a.n8,f=a.n8,h=a.n8;else throw Error("Invalid group: "+e);let p=Math.floor(t.byteLength/u),_=Math.floor(p/o.concurrency),m=[];l=i.e(l);let b=i.e(n);for(let e=0;e<o.concurrency;e++){let a;if(0==(a=e<o.concurrency-1?_:p-e*_))continue;let n=[];n.push({cmd:"ALLOCSET",var:0,buff:t.slice(e*_*u,e*_*u+a*u)}),n.push({cmd:"ALLOCSET",var:1,buff:b}),n.push({cmd:"ALLOCSET",var:2,buff:l}),n.push({cmd:"ALLOC",var:3,len:a*Math.max(f,h)}),n.push({cmd:"CALL",fnName:c,params:[{var:0},{val:a},{var:1},{var:2},{var:3}]}),d&&n.push({cmd:"CALL",fnName:d,params:[{var:3},{val:a},{var:3}]}),n.push({cmd:"GET",out:0,var:3,len:a*h}),m.push(o.queueAction(n)),b=i.mul(b,i.exp(l,a))}let L=await Promise.all(m);g=t instanceof tS?new tS(p*h):new Uint8Array(p*h);let w=0;for(let t=0;t<L.length;t++)g.set(L[t][0],w),w+=L[t][0].byteLength;return g}}let t$=[1,1,1,1,2,3,4,5,6,7,7,8,9,10,11,12,13,13,14,15,16,16,17,17,17,17,17,17,17,17,17,17];function tj(t,e){let a=t[e],i=a.tm;async function o(t,i,o,n,l){let r,s;if(!(t instanceof Uint8Array))throw n&&n.error(`${l} _multiExpChunk buffBases is not Uint8Array`),Error(`${l} _multiExpChunk buffBases is not Uint8Array`);if(!(i instanceof Uint8Array))throw n&&n.error(`${l} _multiExpChunk buffScalars is not Uint8Array`),Error(`${l} _multiExpChunk buffScalars is not Uint8Array`);if(o=o||"affine","G1"==e)"affine"==o?(s="g1m_multiexpAffine_chunk",r=2*a.F.n8):(s="g1m_multiexp_chunk",r=3*a.F.n8);else if("G2"==e)"affine"==o?(s="g2m_multiexpAffine_chunk",r=2*a.F.n8):(s="g2m_multiexp_chunk",r=3*a.F.n8);else throw Error("Invalid group");let c=Math.floor(t.byteLength/r);if(0==c)return a.zero;let d=Math.floor(i.byteLength/c);if(d*c!=i.byteLength)throw Error("Scalar size does not match");let u=t$[tx(c)],f=Math.floor((8*d-1)/u)+1,h=[];for(let e=0;e<f;e++){let o=[{cmd:"ALLOCSET",var:0,buff:t},{cmd:"ALLOCSET",var:1,buff:i},{cmd:"ALLOC",var:2,len:3*a.F.n8},{cmd:"CALL",fnName:s,params:[{var:0},{var:1},{val:d},{val:c},{val:e*u},{val:Math.min(8*d-e*u,u)},{var:2}]},{cmd:"GET",out:0,var:2,len:3*a.F.n8}];h.push(a.tm.queueAction(o))}let g=await Promise.all(h),p=a.zero;for(let t=g.length-1;t>=0;t--){if(!a.isZero(p))for(let t=0;t<u;t++)p=a.double(p);p=a.add(p,g[t][0])}return p}async function n(t,n,l,r,s){let c,d;if("G1"==e)c="affine"==l?2*a.F.n8:3*a.F.n8;else if("G2"==e)c="affine"==l?2*a.F.n8:3*a.F.n8;else throw Error("Invalid group");let u=Math.floor(t.byteLength/c);if(0==u)return a.zero;let f=Math.floor(n.byteLength/u);if(f*u!=n.byteLength)throw Error("Scalar size does not match");let h=t$[tx(u)];(d=Math.floor(u/(i.concurrency/(Math.floor((8*f-1)/h)+1))))>4194304&&(d=4194304),d<1024&&(d=1024);let g=[];for(let e=0;e<u;e+=d){r&&r.debug(`Multiexp start: ${s}: ${e}/${u}`);let a=Math.min(u-e,d),i=t.slice(e*c,(e+a)*c),h=n.slice(e*f,(e+a)*f);g.push(o(i,h,l,r,s).then(t=>(r&&r.debug(`Multiexp end: ${s}: ${e}/${u}`),t)))}let p=await Promise.all(g),_=a.zero;for(let t=p.length-1;t>=0;t--)_=a.add(_,p[t]);return _}a.multiExp=async function(t,e,a,i){return await n(t,e,"jacobian",a,i)},a.multiExpAffine=async function(t,e,a,i){return await n(t,e,"affine",a,i)}}function tV(t,e){let a=t[e],i=t.Fr,o=a.tm;async function n(t,n,s,c,d,u){let f,h,g,p,_,m,b,L,w,y,A;s=s||"affine",c=c||"affine","G1"==e?("affine"==s?(f=2*a.F.n8,p="g1m_batchToJacobian"):f=3*a.F.n8,h=3*a.F.n8,n&&(L="g1m_fftFinal"),b="g1m_fftJoin",m="g1m_fftMix","affine"==c?(g=2*a.F.n8,_="g1m_batchToAffine"):g=3*a.F.n8):"G2"==e?("affine"==s?(f=2*a.F.n8,p="g2m_batchToJacobian"):f=3*a.F.n8,h=3*a.F.n8,n&&(L="g2m_fftFinal"),b="g2m_fftJoin",m="g2m_fftMix","affine"==c?(g=2*a.F.n8,_="g2m_batchToAffine"):g=3*a.F.n8):"Fr"==e&&(f=a.n8,h=a.n8,g=a.n8,n&&(L="frm_fftFinal"),m="frm_fftMix",b="frm_fftJoin");let C=!1;Array.isArray(t)?(t=tv(t,f),C=!0):t=t.slice(0,t.byteLength);let I=t.byteLength/f,F=tx(I);if(1<<F!=I)throw Error("fft must be multiple of 2");if(F==i.s+1){let e;return(e=n?await r(t,s,c,d,u):await l(t,s,c,d,u),C)?tB(e,g):e}n&&(w=i.inv(i.e(I))),tE(t,f);let x=Math.min(16384,I),E=I/x;for(;E<o.concurrency&&x>=16;)E*=2,x/=2;let v=tx(x),B=[];for(let e=0;e<E;e++){d&&d.debug(`${u}: fft ${F} mix start: ${e}/${E}`);let a=[];a.push({cmd:"ALLOC",var:0,len:h*x});let i=t.slice(x*e*f,x*(e+1)*f);a.push({cmd:"SET",var:0,buff:i}),p&&a.push({cmd:"CALL",fnName:p,params:[{var:0},{val:x},{var:0}]});for(let t=1;t<=v;t++)a.push({cmd:"CALL",fnName:m,params:[{var:0},{val:x},{val:t}]});v==F?(L&&(a.push({cmd:"ALLOCSET",var:1,buff:w}),a.push({cmd:"CALL",fnName:L,params:[{var:0},{val:x},{var:1}]})),_&&a.push({cmd:"CALL",fnName:_,params:[{var:0},{val:x},{var:0}]}),a.push({cmd:"GET",out:0,var:0,len:x*g})):a.push({cmd:"GET",out:0,var:0,len:h*x}),B.push(o.queueAction(a).then(t=>(d&&d.debug(`${u}: fft ${F} mix end: ${e}/${E}`),t)))}A=await Promise.all(B);for(let t=0;t<E;t++)A[t]=A[t][0];for(let t=v+1;t<=F;t++){d&&d.debug(`${u}: fft  ${F}  join: ${t}/${F}`);let e=1<<F-t,a=E/e,n=[];for(let l=0;l<e;l++)for(let r=0;r<a/2;r++){let s=i.exp(i.w[t],r*x),c=i.w[t],f=l*a+r,p=l*a+r+a/2,m=[];m.push({cmd:"ALLOCSET",var:0,buff:A[f]}),m.push({cmd:"ALLOCSET",var:1,buff:A[p]}),m.push({cmd:"ALLOCSET",var:2,buff:s}),m.push({cmd:"ALLOCSET",var:3,buff:c}),m.push({cmd:"CALL",fnName:b,params:[{var:0},{var:1},{val:x},{var:2},{var:3}]}),t==F?(L&&(m.push({cmd:"ALLOCSET",var:4,buff:w}),m.push({cmd:"CALL",fnName:L,params:[{var:0},{val:x},{var:4}]}),m.push({cmd:"CALL",fnName:L,params:[{var:1},{val:x},{var:4}]})),_&&(m.push({cmd:"CALL",fnName:_,params:[{var:0},{val:x},{var:0}]}),m.push({cmd:"CALL",fnName:_,params:[{var:1},{val:x},{var:1}]})),m.push({cmd:"GET",out:0,var:0,len:x*g}),m.push({cmd:"GET",out:1,var:1,len:x*g})):(m.push({cmd:"GET",out:0,var:0,len:x*h}),m.push({cmd:"GET",out:1,var:1,len:x*h})),n.push(o.queueAction(m).then(i=>(d&&d.debug(`${u}: fft ${F} join  ${t}/${F}  ${l+1}/${e} ${r}/${a/2}`),i)))}let l=await Promise.all(n);for(let t=0;t<e;t++)for(let e=0;e<a/2;e++){let i=t*a+e,o=t*a+e+a/2,n=l.shift();A[i]=n[0],A[o]=n[1]}}if(y=t instanceof tS?new tS(I*g):new Uint8Array(I*g),n){y.set(A[0].slice((x-1)*g));let t=g;for(let e=E-1;e>0;e--)y.set(A[e],t),t+=x*g,delete A[e];y.set(A[0].slice(0,(x-1)*g),t),delete A[0]}else for(let t=0;t<E;t++)y.set(A[t],x*g*t),delete A[t];return C?tB(y,g):y}async function l(t,e,a,o,l){let r,c,d;r=t.slice(0,t.byteLength/2),c=t.slice(t.byteLength/2,t.byteLength);let u=[];[r,c]=await s(r,c,"fftJoinExt",i.one,i.shift,e,"jacobian",o,l),u.push(n(r,!1,"jacobian",a,o,l)),u.push(n(c,!1,"jacobian",a,o,l));let f=await Promise.all(u);return(d=f[0].byteLength>268435456?new tS(2*f[0].byteLength):new Uint8Array(2*f[0].byteLength)).set(f[0]),d.set(f[1],f[0].byteLength),d}async function r(t,e,a,o,l){let r,c,d;r=t.slice(0,t.byteLength/2),c=t.slice(t.byteLength/2,t.byteLength);let u=[];u.push(n(r,!0,e,"jacobian",o,l)),u.push(n(c,!0,e,"jacobian",o,l)),[r,c]=await Promise.all(u);let f=await s(r,c,"fftJoinExtInv",i.one,i.shiftInv,"jacobian",a,o,l);return(d=f[0].byteLength>268435456?new tS(2*f[0].byteLength):new Uint8Array(2*f[0].byteLength)).set(f[0]),d.set(f[1],f[0].byteLength),d}async function s(t,n,l,r,s,c,d,u,f){let h,g,p,_,m,b,L,w;if("G1"==e)"affine"==c?(m=2*a.F.n8,g="g1m_batchToJacobian"):m=3*a.F.n8,b=3*a.F.n8,h="g1m_"+l,"affine"==d?(p="g1m_batchToAffine",_=2*a.F.n8):_=3*a.F.n8;else if("G2"==e)"affine"==c?(m=2*a.F.n8,g="g2m_batchToJacobian"):m=3*a.F.n8,h="g2m_"+l,b=3*a.F.n8,"affine"==d?(p="g2m_batchToAffine",_=2*a.F.n8):_=3*a.F.n8;else if("Fr"==e)m=i.n8,_=i.n8,b=i.n8,h="frm_"+l;else throw Error("Invalid group");if(t.byteLength!=n.byteLength)throw Error("Invalid buffer size");let y=Math.floor(t.byteLength/m);if(y!=1<<tx(y))throw Error("Invalid number of points");let A=Math.floor(y/o.concurrency);A<16&&(A=16),A>65536&&(A=65536);let C=[];for(let e=0;e<y;e+=A){u&&u.debug(`${f}: fftJoinExt Start: ${e}/${y}`);let a=Math.min(y-e,A),l=i.mul(r,i.exp(s,e)),c=[],d=t.slice(e*m,(e+a)*m),L=n.slice(e*m,(e+a)*m);c.push({cmd:"ALLOC",var:0,len:b*a}),c.push({cmd:"SET",var:0,buff:d}),c.push({cmd:"ALLOC",var:1,len:b*a}),c.push({cmd:"SET",var:1,buff:L}),c.push({cmd:"ALLOCSET",var:2,buff:l}),c.push({cmd:"ALLOCSET",var:3,buff:s}),g&&(c.push({cmd:"CALL",fnName:g,params:[{var:0},{val:a},{var:0}]}),c.push({cmd:"CALL",fnName:g,params:[{var:1},{val:a},{var:1}]})),c.push({cmd:"CALL",fnName:h,params:[{var:0},{var:1},{val:a},{var:2},{var:3},{val:i.s}]}),p&&(c.push({cmd:"CALL",fnName:p,params:[{var:0},{val:a},{var:0}]}),c.push({cmd:"CALL",fnName:p,params:[{var:1},{val:a},{var:1}]})),c.push({cmd:"GET",out:0,var:0,len:a*_}),c.push({cmd:"GET",out:1,var:1,len:a*_}),C.push(o.queueAction(c).then(t=>(u&&u.debug(`${f}: fftJoinExt End: ${e}/${y}`),t)))}let I=await Promise.all(C);y*_>268435456?(L=new tS(y*_),w=new tS(y*_)):(L=new Uint8Array(y*_),w=new Uint8Array(y*_));let F=0;for(let t=0;t<I.length;t++)L.set(I[t][0],F),w.set(I[t][1],F),F+=I[t][0].byteLength;return[L,w]}a.fft=async function(t,e,a,i,o){return await n(t,!1,e,a,i,o)},a.ifft=async function(t,e,a,i,o){return await n(t,!0,e,a,i,o)},a.lagrangeEvaluations=async function(t,o,l,r,c){let d,u;if(o=o||"affine",l=l||"affine","G1"==e)d="affine"==o?2*a.F.n8:3*a.F.n8;else if("G2"==e)d="affine"==o?2*a.F.n8:3*a.F.n8;else if("Fr"==e)d=i.n8;else throw Error("Invalid group");let f=t.byteLength/d,h=tx(f);if(2**h*d!=t.byteLength)throw r&&r.error("lagrangeEvaluations iinvalid input size"),Error("lagrangeEvaluations invalid Input size");if(h<=i.s)return await a.ifft(t,o,l,r,c);if(h>i.s+1)throw r&&r.error("lagrangeEvaluations input too big"),Error("lagrangeEvaluations input too big");let g=t.slice(0,t.byteLength/2),p=t.slice(t.byteLength/2,t.byteLength),_=i.exp(i.shift,f/2),m=i.inv(i.sub(i.one,_));[g,p]=await s(g,p,"prepareLagrangeEvaluation",m,i.shiftInv,o,"jacobian",r,c+" prep");let b=[];return b.push(n(g,!0,"jacobian",l,r,c+" t0")),b.push(n(p,!0,"jacobian",l,r,c+" t1")),[g,p]=await Promise.all(b),(u=g.byteLength>268435456?new tS(2*g.byteLength):new Uint8Array(2*g.byteLength)).set(g),u.set(p,g.byteLength),u},a.fftMix=async function(t){let n,l,r;let s=3*a.F.n8;if("G1"==e)n="g1m_fftMix",l="g1m_fftJoin";else if("G2"==e)n="g2m_fftMix",l="g2m_fftJoin";else if("Fr"==e)n="frm_fftMix",l="frm_fftJoin";else throw Error("Invalid group");let c=Math.floor(t.byteLength/s),d=tx(c),u=1<<tx(o.concurrency);c<=2*u&&(u=1);let f=c/u,h=tx(f),g=[];for(let e=0;e<u;e++){let a=[],i=t.slice(e*f*s,(e+1)*f*s);a.push({cmd:"ALLOCSET",var:0,buff:i});for(let t=1;t<=h;t++)a.push({cmd:"CALL",fnName:n,params:[{var:0},{val:f},{val:t}]});a.push({cmd:"GET",out:0,var:0,len:f*s}),g.push(o.queueAction(a))}let p=await Promise.all(g),_=[];for(let t=0;t<p.length;t++)_[t]=p[t][0];for(let t=h+1;t<=d;t++){let e=1<<d-t,a=u/e,n=[];for(let r=0;r<e;r++)for(let e=0;e<a/2;e++){let c=i.exp(i.w[t],e*f),d=i.w[t],u=r*a+e,h=r*a+e+a/2,g=[];g.push({cmd:"ALLOCSET",var:0,buff:_[u]}),g.push({cmd:"ALLOCSET",var:1,buff:_[h]}),g.push({cmd:"ALLOCSET",var:2,buff:c}),g.push({cmd:"ALLOCSET",var:3,buff:d}),g.push({cmd:"CALL",fnName:l,params:[{var:0},{var:1},{val:f},{var:2},{var:3}]}),g.push({cmd:"GET",out:0,var:0,len:f*s}),g.push({cmd:"GET",out:1,var:1,len:f*s}),n.push(o.queueAction(g))}let r=await Promise.all(n);for(let t=0;t<e;t++)for(let e=0;e<a/2;e++){let i=t*a+e,o=t*a+e+a/2,n=r.shift();_[i]=n[0],_[o]=n[1]}}r=t instanceof tS?new tS(c*s):new Uint8Array(c*s);let m=0;for(let t=0;t<u;t++)r.set(_[t],m),m+=_[t].byteLength;return r},a.fftJoin=async function(t,n,l,r){let s,c,d;let u=3*a.F.n8;if("G1"==e)s="g1m_fftJoin";else if("G2"==e)s="g2m_fftJoin";else if("Fr"==e)s="frm_fftJoin";else throw Error("Invalid group");if(t.byteLength!=n.byteLength)throw Error("Invalid buffer size");let f=Math.floor(t.byteLength/u);if(f!=1<<tx(f))throw Error("Invalid number of points");let h=1<<tx(o.concurrency);f<=2*h&&(h=1);let g=f/h,p=[];for(let e=0;e<h;e++){let a=[],c=i.mul(l,i.exp(r,e*g)),d=t.slice(e*g*u,(e+1)*g*u),f=n.slice(e*g*u,(e+1)*g*u);a.push({cmd:"ALLOCSET",var:0,buff:d}),a.push({cmd:"ALLOCSET",var:1,buff:f}),a.push({cmd:"ALLOCSET",var:2,buff:c}),a.push({cmd:"ALLOCSET",var:3,buff:r}),a.push({cmd:"CALL",fnName:s,params:[{var:0},{var:1},{val:g},{var:2},{var:3}]}),a.push({cmd:"GET",out:0,var:0,len:g*u}),a.push({cmd:"GET",out:1,var:1,len:g*u}),p.push(o.queueAction(a))}let _=await Promise.all(p);t instanceof tS?(c=new tS(f*u),d=new tS(f*u)):(c=new Uint8Array(f*u),d=new Uint8Array(f*u));let m=0;for(let t=0;t<_.length;t++)c.set(_[t][0],m),d.set(_[t][1],m),m+=_[t][0].byteLength;return[c,d]},a.fftFinal=async function(t,i){let n,l,r;let s=3*a.F.n8,c=2*a.F.n8;if("G1"==e)n="g1m_fftFinal",l="g1m_batchToAffine";else if("G2"==e)n="g2m_fftFinal",l="g2m_batchToAffine";else throw Error("Invalid group");let d=Math.floor(t.byteLength/s);if(d!=1<<tx(d))throw Error("Invalid number of points");let u=Math.floor(d/o.concurrency),f=[];for(let e=0;e<o.concurrency;e++){let a;if(0==(a=e<o.concurrency-1?u:d-e*u))continue;let r=[],h=t.slice(e*u*s,(e*u+a)*s);r.push({cmd:"ALLOCSET",var:0,buff:h}),r.push({cmd:"ALLOCSET",var:1,buff:i}),r.push({cmd:"CALL",fnName:n,params:[{var:0},{val:a},{var:1}]}),r.push({cmd:"CALL",fnName:l,params:[{var:0},{val:a},{var:0}]}),r.push({cmd:"GET",out:0,var:0,len:a*c}),f.push(o.queueAction(r))}let h=await Promise.all(f);r=t instanceof tS?new tS(d*c):new Uint8Array(d*c);let g=0;for(let t=h.length-1;t>=0;t--)r.set(h[t][0],g),g+=h[t][0].byteLength;return r}}async function tK(t){let e=await tR(t.wasm,t.singleThread),a={};return a.q=m(t.wasm.q.toString()),a.r=m(t.wasm.r.toString()),a.name=t.name,a.tm=e,a.prePSize=t.wasm.prePSize,a.preQSize=t.wasm.preQSize,a.Fr=new tP(e,"frm",t.n8r,t.r),a.F1=new tP(e,"f1m",t.n8q,t.q),a.F2=new tG(e,"f2m",a.F1),a.G1=new tq(e,"g1m",a.F1,t.wasm.pG1gen,t.wasm.pG1b,t.cofactorG1),a.G2=new tq(e,"g2m",a.F2,t.wasm.pG2gen,t.wasm.pG2b,t.cofactorG2),a.F6=new tT(e,"f6m",a.F2),a.F12=new tG(e,"ftm",a.F6),a.Gt=a.F12,tD(a,"G1"),tD(a,"G2"),tD(a,"Fr"),tj(a,"G1"),tj(a,"G2"),tV(a,"G1"),tV(a,"G2"),tV(a,"Fr"),function(t){let e=t.tm;t.pairing=function(a,i){e.startSyncOp();let o=e.allocBuff(t.G1.toJacobian(a)),n=e.allocBuff(t.G2.toJacobian(i)),l=e.alloc(t.Gt.n8);e.instance.exports[t.name+"_pairing"](o,n,l);let r=e.getBuff(l,t.Gt.n8);return e.endSyncOp(),r},t.pairingEq=async function(){let a,i;arguments.length%2==1?(a=arguments[arguments.length-1],i=(arguments.length-1)/2):(a=t.Gt.one,i=arguments.length/2);let o=[];for(let a=0;a<i;a++){let i=[],n=t.G1.toJacobian(arguments[2*a]);i.push({cmd:"ALLOCSET",var:0,buff:n}),i.push({cmd:"ALLOC",var:1,len:t.prePSize});let l=t.G2.toJacobian(arguments[2*a+1]);i.push({cmd:"ALLOCSET",var:2,buff:l}),i.push({cmd:"ALLOC",var:3,len:t.preQSize}),i.push({cmd:"ALLOC",var:4,len:t.Gt.n8}),i.push({cmd:"CALL",fnName:t.name+"_prepareG1",params:[{var:0},{var:1}]}),i.push({cmd:"CALL",fnName:t.name+"_prepareG2",params:[{var:2},{var:3}]}),i.push({cmd:"CALL",fnName:t.name+"_millerLoop",params:[{var:1},{var:3},{var:4}]}),i.push({cmd:"GET",out:0,var:4,len:t.Gt.n8}),o.push(e.queueAction(i))}let n=await Promise.all(o);e.startSyncOp();let l=e.alloc(t.Gt.n8);e.instance.exports.ftm_one(l);for(let t=0;t<n.length;t++){let a=e.allocBuff(n[t][0]);e.instance.exports.ftm_mul(l,a,l)}e.instance.exports[t.name+"_finalExponentiation"](l,l);let r=e.allocBuff(a),s=!!e.instance.exports.ftm_eq(l,r);return e.endSyncOp(),s},t.prepareG1=function(t){this.tm.startSyncOp();let e=this.tm.allocBuff(t),a=this.tm.alloc(this.prePSize);this.tm.instance.exports[this.name+"_prepareG1"](e,a);let i=this.tm.getBuff(a,this.prePSize);return this.tm.endSyncOp(),i},t.prepareG2=function(t){this.tm.startSyncOp();let e=this.tm.allocBuff(t),a=this.tm.alloc(this.preQSize);this.tm.instance.exports[this.name+"_prepareG2"](e,a);let i=this.tm.getBuff(a,this.preQSize);return this.tm.endSyncOp(),i},t.millerLoop=function(t,e){this.tm.startSyncOp();let a=this.tm.allocBuff(t),i=this.tm.allocBuff(e),o=this.tm.alloc(this.Gt.n8);this.tm.instance.exports[this.name+"_millerLoop"](a,i,o);let n=this.tm.getBuff(o,this.Gt.n8);return this.tm.endSyncOp(),n},t.finalExponentiation=function(t){this.tm.startSyncOp();let e=this.tm.allocBuff(t),a=this.tm.alloc(this.Gt.n8);this.tm.instance.exports[this.name+"_finalExponentiation"](e,a);let i=this.tm.getBuff(a,this.Gt.n8);return this.tm.endSyncOp(),i}}(a),a.array2buffer=function(t,e){let a=new Uint8Array(e*t.length);for(let i=0;i<t.length;i++)a.set(t[i],i*e);return a},a.buffer2array=function(t,e){let a=t.byteLength/e,i=Array(a);for(let o=0;o<a;o++)i[o]=t.slice(o*e,o*e+e);return i},a}function tH(t){return BigInt(t)}function tZ(t){let e=[],a=tH(t);return e.push(Number(255n&a)),e.push(Number(a>>8n&255n)),e.push(Number(a>>16n&255n)),e.push(Number(a>>24n&255n)),e}function tW(t){let e=function(t){for(var e=[],a=0;a<t.length;a++){var i=t.charCodeAt(a);i<128?e.push(i):i<2048?e.push(192|i>>6,128|63&i):i<55296||i>=57344?e.push(224|i>>12,128|i>>6&63,128|63&i):(a++,i=65536+((1023&i)<<10|1023&t.charCodeAt(a)),e.push(240|i>>18,128|i>>12&63,128|i>>6&63,128|63&i))}return e}(t);return[...t2(e.length),...e]}function tY(t){let e=[],a=tH(t);if(a<0n)throw Error("Number cannot be negative");for(;0n!==a;)e.push(Number(127n&a)),a>>=7n;0==e.length&&e.push(0);for(let t=0;t<e.length-1;t++)e[t]=128|e[t];return e}function tJ(t){let e,a;let i=t<0n?t.toString(2).length-1:t.toString(2).length;t<0?(a=!0,e=(1n<<BigInt(i))+t):(a=!1,e=tH(t));let o=7-i%7,n=tY(e+((1n<<BigInt(o))-1n<<BigInt(i)));return a||(n[n.length-1]=n[n.length-1]&((1<<7-o)-1|128)),n}function tX(t){let e=tH(t);if(e>4294967295n)throw Error("Number too big");if(e>2147483647n&&(e-=4294967296n),e<-2147483648n)throw Error("Number too small");return tJ(e)}function t2(t){let e=tH(t);if(e>4294967295n)throw Error("Number too big");return tY(e)}function t1(t){return Array.from(t,function(t){return("0"+(255&t).toString(16)).slice(-2)}).join("")}class t3{constructor(t){this.func=t,this.functionName=t.functionName,this.module=t.module}setLocal(t,e){let a=this.func.localIdxByName[t];if(void 0===a)throw Error(`Local Variable not defined: Function: ${this.functionName} local: ${t} `);return[...e,33,...t2(a)]}teeLocal(t,e){let a=this.func.localIdxByName[t];if(void 0===a)throw Error(`Local Variable not defined: Function: ${this.functionName} local: ${t} `);return[...e,34,...t2(a)]}getLocal(t){let e=this.func.localIdxByName[t];if(void 0===e)throw Error(`Local Variable not defined: Function: ${this.functionName} local: ${t} `);return[32,...t2(e)]}i64_load8_s(t,e,a){return[...t,48,void 0===a?0:a,...t2(e||0)]}i64_load8_u(t,e,a){return[...t,49,void 0===a?0:a,...t2(e||0)]}i64_load16_s(t,e,a){return[...t,50,void 0===a?1:a,...t2(e||0)]}i64_load16_u(t,e,a){return[...t,51,void 0===a?1:a,...t2(e||0)]}i64_load32_s(t,e,a){return[...t,52,void 0===a?2:a,...t2(e||0)]}i64_load32_u(t,e,a){return[...t,53,void 0===a?2:a,...t2(e||0)]}i64_load(t,e,a){return[...t,41,void 0===a?3:a,...t2(e||0)]}i64_store(t,e,a,i){let o,n,l;return Array.isArray(e)?(o=0,n=3,l=e):Array.isArray(a)?(o=e,n=3,l=a):Array.isArray(i)&&(o=e,n=a,l=i),[...t,...l,55,n,...t2(o)]}i64_store32(t,e,a,i){let o,n,l;return Array.isArray(e)?(o=0,n=2,l=e):Array.isArray(a)?(o=e,n=2,l=a):Array.isArray(i)&&(o=e,n=a,l=i),[...t,...l,62,n,...t2(o)]}i64_store16(t,e,a,i){let o,n,l;return Array.isArray(e)?(o=0,n=1,l=e):Array.isArray(a)?(o=e,n=1,l=a):Array.isArray(i)&&(o=e,n=a,l=i),[...t,...l,61,n,...t2(o)]}i64_store8(t,e,a,i){let o,n,l;return Array.isArray(e)?(o=0,n=0,l=e):Array.isArray(a)?(o=e,n=0,l=a):Array.isArray(i)&&(o=e,n=a,l=i),[...t,...l,60,n,...t2(o)]}i32_load8_s(t,e,a){return[...t,44,void 0===a?0:a,...t2(e||0)]}i32_load8_u(t,e,a){return[...t,45,void 0===a?0:a,...t2(e||0)]}i32_load16_s(t,e,a){return[...t,46,void 0===a?1:a,...t2(e||0)]}i32_load16_u(t,e,a){return[...t,47,void 0===a?1:a,...t2(e||0)]}i32_load(t,e,a){return[...t,40,void 0===a?2:a,...t2(e||0)]}i32_store(t,e,a,i){let o,n,l;return Array.isArray(e)?(o=0,n=2,l=e):Array.isArray(a)?(o=e,n=2,l=a):Array.isArray(i)&&(o=e,n=a,l=i),[...t,...l,54,n,...t2(o)]}i32_store16(t,e,a,i){let o,n,l;return Array.isArray(e)?(o=0,n=1,l=e):Array.isArray(a)?(o=e,n=1,l=a):Array.isArray(i)&&(o=e,n=a,l=i),[...t,...l,59,n,...t2(o)]}i32_store8(t,e,a,i){let o,n,l;return Array.isArray(e)?(o=0,n=0,l=e):Array.isArray(a)?(o=e,n=0,l=a):Array.isArray(i)&&(o=e,n=a,l=i),[...t,...l,58,n,...t2(o)]}call(t,...e){let a=this.module.functionIdxByName[t];if(void 0===a)throw Error(`Function not defined: Function: ${t}`);return[...[].concat(...e),16,...t2(a)]}call_indirect(t,...e){return[...[].concat(...e),...t,17,0,0]}if(t,e,a){return a?[...t,4,64,...e,5,...a,11]:[...t,4,64,...e,11]}block(t){return[2,64,...t,11]}loop(...t){return[3,64,...[].concat(...t),11]}br_if(t,e){return[...e,13,...t2(t)]}br(t){return[12,...t2(t)]}ret(t){return[...t,15]}drop(t){return[...t,26]}i64_const(t){return[66,...function(t){let e=tH(t);if(e>0xffffffffffffffffn)throw Error("Number too big");if(e>0x7fffffffffffffffn&&(e-=0x10000000000000000n),e<-0x8000000000000000n)throw Error("Number too small");return tJ(e)}(t)]}i32_const(t){return[65,...tX(t)]}i64_eqz(t){return[...t,80]}i64_eq(t,e){return[...t,...e,81]}i64_ne(t,e){return[...t,...e,82]}i64_lt_s(t,e){return[...t,...e,83]}i64_lt_u(t,e){return[...t,...e,84]}i64_gt_s(t,e){return[...t,...e,85]}i64_gt_u(t,e){return[...t,...e,86]}i64_le_s(t,e){return[...t,...e,87]}i64_le_u(t,e){return[...t,...e,88]}i64_ge_s(t,e){return[...t,...e,89]}i64_ge_u(t,e){return[...t,...e,90]}i64_add(t,e){return[...t,...e,124]}i64_sub(t,e){return[...t,...e,125]}i64_mul(t,e){return[...t,...e,126]}i64_div_s(t,e){return[...t,...e,127]}i64_div_u(t,e){return[...t,...e,128]}i64_rem_s(t,e){return[...t,...e,129]}i64_rem_u(t,e){return[...t,...e,130]}i64_and(t,e){return[...t,...e,131]}i64_or(t,e){return[...t,...e,132]}i64_xor(t,e){return[...t,...e,133]}i64_shl(t,e){return[...t,...e,134]}i64_shr_s(t,e){return[...t,...e,135]}i64_shr_u(t,e){return[...t,...e,136]}i64_extend_i32_s(t){return[...t,172]}i64_extend_i32_u(t){return[...t,173]}i64_clz(t){return[...t,121]}i64_ctz(t){return[...t,122]}i32_eqz(t){return[...t,69]}i32_eq(t,e){return[...t,...e,70]}i32_ne(t,e){return[...t,...e,71]}i32_lt_s(t,e){return[...t,...e,72]}i32_lt_u(t,e){return[...t,...e,73]}i32_gt_s(t,e){return[...t,...e,74]}i32_gt_u(t,e){return[...t,...e,75]}i32_le_s(t,e){return[...t,...e,76]}i32_le_u(t,e){return[...t,...e,77]}i32_ge_s(t,e){return[...t,...e,78]}i32_ge_u(t,e){return[...t,...e,79]}i32_add(t,e){return[...t,...e,106]}i32_sub(t,e){return[...t,...e,107]}i32_mul(t,e){return[...t,...e,108]}i32_div_s(t,e){return[...t,...e,109]}i32_div_u(t,e){return[...t,...e,110]}i32_rem_s(t,e){return[...t,...e,111]}i32_rem_u(t,e){return[...t,...e,112]}i32_and(t,e){return[...t,...e,113]}i32_or(t,e){return[...t,...e,114]}i32_xor(t,e){return[...t,...e,115]}i32_shl(t,e){return[...t,...e,116]}i32_shr_s(t,e){return[...t,...e,117]}i32_shr_u(t,e){return[...t,...e,118]}i32_rotl(t,e){return[...t,...e,119]}i32_rotr(t,e){return[...t,...e,120]}i32_wrap_i64(t){return[...t,167]}i32_clz(t){return[...t,103]}i32_ctz(t){return[...t,104]}unreachable(){return[0]}current_memory(){return[63,0]}comment(){return[]}}let t0={i32:127,i64:126,f32:125,f64:124,anyfunc:112,func:96,emptyblock:64};class t8{constructor(t,e,a,i,o){if("import"==a)this.fnType="import",this.moduleName=i,this.fieldName=o;else if("internal"==a)this.fnType="internal";else throw Error("Invalid function fnType: "+a);this.module=t,this.fnName=e,this.params=[],this.locals=[],this.localIdxByName={},this.code=[],this.returnType=null,this.nextLocal=0}addParam(t,e){if(this.localIdxByName[t])throw Error(`param already exists. Function: ${this.fnName}, Param: ${t} `);let a=this.nextLocal++;this.localIdxByName[t]=a,this.params.push({type:e})}addLocal(t,e,a){if(this.localIdxByName[t])throw Error(`local already exists. Function: ${this.fnName}, Param: ${t} `);let i=this.nextLocal++;this.localIdxByName[t]=i,this.locals.push({type:e,length:a||1})}setReturnType(t){if(this.returnType)throw Error(`returnType already defined. Function: ${this.fnName}`);this.returnType=t}getSignature(){return[96,...t2(this.params.length),...this.params.map(t=>t0[t.type]),...this.returnType?[1,t0[this.returnType]]:[0]]}getBody(){let t=this.locals.map(t=>[...t2(t.length),t0[t.type]]),e=[...t2(this.locals.length),...[].concat(...t),...this.code,11];return[...t2(e.length),...e]}addCode(...t){this.code.push(...[].concat(...t))}getCodeBuilder(){return new t3(this)}}class t4{constructor(){this.functions=[],this.functionIdxByName={},this.nImportFunctions=0,this.nInternalFunctions=0,this.memory={pagesSize:1,moduleName:"env",fieldName:"memory"},this.free=8,this.datas=[],this.modules={},this.exports=[],this.functionsTable=[]}build(){return this._setSignatures(),new Uint8Array([...tZ(1836278016),...tZ(1),...this._buildType(),...this._buildImport(),...this._buildFunctionDeclarations(),...this._buildFunctionsTable(),...this._buildExports(),...this._buildElements(),...this._buildCode(),...this._buildData()])}addFunction(t){if(void 0!==this.functionIdxByName[t])throw Error(`Function already defined: ${t}`);let e=this.functions.length;return this.functionIdxByName[t]=e,this.functions.push(new t8(this,t,"internal")),this.nInternalFunctions++,this.functions[e]}addIimportFunction(t,e,a){if(void 0!==this.functionIdxByName[t])throw Error(`Function already defined: ${t}`);if(this.functions.length>0&&"internal"==this.functions[this.functions.length-1].type)throw Error(`Import functions must be declared before internal: ${t}`);let i=a||t,o=this.functions.length;return this.functionIdxByName[t]=o,this.functions.push(new t8(this,t,"import",e,i)),this.nImportFunctions++,this.functions[o]}setMemory(t,e,a){this.memory={pagesSize:t,moduleName:e||"env",fieldName:a||"memory"}}exportFunction(t,e){let a=e||t;if(void 0===this.functionIdxByName[t])throw Error(`Function not defined: ${t}`);let i=this.functionIdxByName[t];a!=t&&(this.functionIdxByName[a]=i),this.exports.push({exportName:a,idx:i})}addFunctionToTable(t){let e=this.functionIdxByName[t];this.functionsTable.push(e)}addData(t,e){this.datas.push({offset:t,bytes:e})}alloc(t,e){let a,i;(Array.isArray(t)||ArrayBuffer.isView(t))&&void 0===e?(a=t.length,i=t):(a=t,i=e),a=(a-1>>3)+1<<3;let o=this.free;return this.free+=a,i&&this.addData(o,i),o}allocString(t){let e=new globalThis.TextEncoder().encode(t);return this.alloc([...e,0])}_setSignatures(){this.signatures=[];let t={};if(this.functionsTable.length>0){let e=this.functions[this.functionsTable[0]].getSignature();t["s_"+t1(e)]=0,this.signatures.push(e)}for(let e=0;e<this.functions.length;e++){let a=this.functions[e].getSignature(),i="s_"+t1(a);void 0===t[i]&&(t[i]=this.signatures.length,this.signatures.push(a)),this.functions[e].signatureIdx=t[i]}}_buildSection(t,e){return[t,...t2(e.length),...e]}_buildType(){return this._buildSection(1,[...t2(this.signatures.length),...[].concat(...this.signatures)])}_buildImport(){let t=[];t.push([...tW(this.memory.moduleName),...tW(this.memory.fieldName),2,0,...t2(this.memory.pagesSize)]);for(let e=0;e<this.nImportFunctions;e++)t.push([...tW(this.functions[e].moduleName),...tW(this.functions[e].fieldName),0,...t2(this.functions[e].signatureIdx)]);return this._buildSection(2,t2(t.length).concat(...t))}_buildFunctionDeclarations(){let t=[];for(let e=this.nImportFunctions;e<this.nImportFunctions+this.nInternalFunctions;e++)t.push(...t2(this.functions[e].signatureIdx));return this._buildSection(3,[...t2(t.length),...t])}_buildFunctionsTable(){return 0==this.functionsTable.length?[]:this._buildSection(4,[...t2(1),112,0,...t2(this.functionsTable.length)])}_buildElements(){if(0==this.functionsTable.length)return[];let t=[];for(let e=0;e<this.functionsTable.length;e++)t.push(...t2(this.functionsTable[e]));return this._buildSection(9,[...t2(1),...t2(0),65,...tX(0),11,...t2(this.functionsTable.length),...t])}_buildExports(){let t=[];for(let e=0;e<this.exports.length;e++)t.push([...tW(this.exports[e].exportName),0,...t2(this.exports[e].idx)]);return this._buildSection(7,t2(t.length).concat(...t))}_buildCode(){let t=[];for(let e=this.nImportFunctions;e<this.nImportFunctions+this.nInternalFunctions;e++)t.push(this.functions[e].getBody());return this._buildSection(10,t2(t.length).concat(...t))}_buildData(){let t=[];t.push([0,65,0,11,4,...tZ(this.free)]);for(let e=0;e<this.datas.length;e++)t.push([0,65,...tX(this.datas[e].offset),11,...t2(this.datas[e].bytes.length),...this.datas[e].bytes]);return this._buildSection(11,t2(t.length).concat(...t))}}async function t6(t,e){if(!t&&globalThis.curve_bn128)return globalThis.curve_bn128;let a=new t4;a.setMemory(25),(0,tL.buildBn128)(a),e&&e(a);let i={};i.code=a.build(),i.pq=a.modules.f1m.pq,i.pr=a.modules.frm.pq,i.pG1gen=a.modules.bn128.pG1gen,i.pG1zero=a.modules.bn128.pG1zero,i.pG1b=a.modules.bn128.pG1b,i.pG2gen=a.modules.bn128.pG2gen,i.pG2zero=a.modules.bn128.pG2zero,i.pG2b=a.modules.bn128.pG2b,i.pOneT=a.modules.bn128.pOneT,i.prePSize=a.modules.bn128.prePSize,i.preQSize=a.modules.bn128.preQSize,i.n8q=32,i.n8r=32,i.q=a.modules.bn128.q,i.r=a.modules.bn128.r;let o={name:"bn128",wasm:i,q:m("21888242871839275222246405745257275088696311157297823662689037894645226208583"),r:m("21888242871839275222246405745257275088548364400416034343698204186575808495617"),n8q:32,n8r:32,cofactorG2:m("30644e72e131a029b85045b68181585e06ceecda572a2489345f2299c0f9fa8d",16),singleThread:!!t},n=await tK(o);return n.terminate=async function(){o.singleThread||(globalThis.curve_bn128=null,await this.tm.terminate())},t||(globalThis.curve_bn128=n),n}async function t7(t,e){if(!t&&globalThis.curve_bls12381)return globalThis.curve_bls12381;let a=new t4;a.setMemory(25),(0,tL.buildBls12381)(a),e&&e(a);let i={};i.code=a.build(),i.pq=a.modules.f1m.pq,i.pr=a.modules.frm.pq,i.pG1gen=a.modules.bls12381.pG1gen,i.pG1zero=a.modules.bls12381.pG1zero,i.pG1b=a.modules.bls12381.pG1b,i.pG2gen=a.modules.bls12381.pG2gen,i.pG2zero=a.modules.bls12381.pG2zero,i.pG2b=a.modules.bls12381.pG2b,i.pOneT=a.modules.bls12381.pOneT,i.prePSize=a.modules.bls12381.prePSize,i.preQSize=a.modules.bls12381.preQSize,i.n8q=48,i.n8r=32,i.q=a.modules.bls12381.q,i.r=a.modules.bls12381.r;let o={name:"bls12381",wasm:i,q:m("1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffaaab",16),r:m("73eda753299d7d483339d80809a1d80553bda402fffe5bfeffffffff00000001",16),n8q:48,n8r:32,cofactorG1:m("0x396c8c005555e1568c00aaab0000aaab",16),cofactorG2:m("0x5d543a95414e7f1091d50792876a202cd91de4547085abaa68a205b2e5a7ddfa628f1cb4d9e82ef21537e293a6691ae1616ec6e786f0c70cf1c38e31c7238e5",16),singleThread:!!t},n=await tK(o);return n.terminate=async function(){o.singleThread||(globalThis.curve_bls12381=null,await this.tm.terminate())},t||(globalThis.curve_bls12381=n),n}globalThis.curve_bn128=null,globalThis.curve_bls12381=null,m("73eda753299d7d483339d80809a1d80553bda402fffe5bfeffffffff00000001",16),m("21888242871839275222246405745257275088548364400416034343698204186575808495617"),m("1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffaaab",16),m("21888242871839275222246405745257275088696311157297823662689037894645226208583");var t5=a(2048);async function t9(t,e,a,i){if(a=a||262144,"number"!=typeof e&&0>["w+","wx+","r","ax+","a+"].indexOf(e))throw Error("Invalid open option");let o=await t5.promises.open(t,e),n=await o.stat();return new et(o,n,a,i,t)}class et{constructor(t,e,a,i,o){for(this.fileName=o,this.fd=t,this.pos=0,this.pageSize=i||256;this.pageSize<e.blksize;)this.pageSize*=2;this.totalSize=e.size,this.totalPages=Math.floor((e.size-1)/this.pageSize)+1,this.maxPagesLoaded=Math.floor(a/this.pageSize)+1,this.pages={},this.pendingLoads=[],this.writing=!1,this.reading=!1,this.avBuffs=[],this.history={}}_loadPage(t){let e=this,a=new Promise((a,i)=>{e.pendingLoads.push({page:t,resolve:a,reject:i})});return e.__statusPage("After Load request: ",t),a}__statusPage(t,e){let a=[];if(!this.logHistory)return;a.push("=="+t+" "+e);let i="";for(let t=0;t<this.pendingLoads.length;t++)this.pendingLoads[t].page==e&&(i=i+" "+t);if(i&&a.push("Pending loads:"+i),void 0!==this.pages[e]){let t=this.pages[e];a.push("Loaded"),a.push("pendingOps: "+t.pendingOps),t.loading&&a.push("loading: "+t.loading),t.writing&&a.push("writing"),t.dirty&&a.push("dirty")}a.push("=="),this.history[e]||(this.history[e]=[]),this.history[e].push(a)}__printHistory(t){this.history[t]||console.log("Empty History ",t),console.log("History "+t);for(let e=0;e<this.history[t].length;e++)for(let a=0;a<this.history[t][e].length;a++)console.log("-> "+this.history[t][e][a])}_triggerLoad(){let t=this;if(t.reading||0==t.pendingLoads.length)return;let e=Object.keys(t.pages),a=[];for(let i=0;i<e.length;i++){let o=t.pages[parseInt(e[i])];!1!=o.dirty||0!=o.pendingOps||o.writing||o.loading||a.push(parseInt(e[i]))}let i=t.maxPagesLoaded-e.length,o=[];for(;t.pendingLoads.length>0&&(void 0!==t.pages[t.pendingLoads[0].page]||i>0||a.length>0);){let e=t.pendingLoads.shift();if(void 0!==t.pages[e.page]){t.pages[e.page].pendingOps++;let i=a.indexOf(e.page);i>=0&&a.splice(i,1),t.pages[e.page].loading?t.pages[e.page].loading.push(e):e.resolve(),t.__statusPage("After Load (cached): ",e.page)}else{if(i)i--;else{let e=a.shift();t.__statusPage("Before Unload: ",e),t.avBuffs.unshift(t.pages[e]),delete t.pages[e],t.__statusPage("After Unload: ",e)}e.page>=t.totalPages?(t.pages[e.page]=n(),e.resolve(),t.__statusPage("After Load (new): ",e.page)):(t.reading=!0,t.pages[e.page]=n(),t.pages[e.page].loading=[e],o.push(t.fd.read(t.pages[e.page].buff,0,t.pageSize,e.page*t.pageSize).then(a=>{t.pages[e.page].size=a.bytesRead;let i=t.pages[e.page].loading;delete t.pages[e.page].loading;for(let t=0;t<i.length;t++)i[t].resolve();return t.__statusPage("After Load (loaded): ",e.page),a},t=>{e.reject(t)})),t.__statusPage("After Load (loading): ",e.page))}}function n(){if(!(t.avBuffs.length>0))return{dirty:!1,buff:new Uint8Array(t.pageSize),pendingOps:1,size:0};{let e=t.avBuffs.shift();return e.dirty=!1,e.pendingOps=1,e.size=0,e}}Promise.all(o).then(()=>{t.reading=!1,t.pendingLoads.length>0&&setImmediate(t._triggerLoad.bind(t)),t._tryClose()})}_triggerWrite(){let t=this;if(t.writing)return;let e=Object.keys(t.pages),a=[];for(let i=0;i<e.length;i++){let o=t.pages[parseInt(e[i])];o.dirty&&(o.dirty=!1,o.writing=!0,t.writing=!0,a.push(t.fd.write(o.buff,0,o.size,parseInt(e[i])*t.pageSize).then(()=>{o.writing=!1},e=>{console.log("ERROR Writing: "+e),t.error=e,t._tryClose()})))}t.writing&&Promise.all(a).then(()=>{t.writing=!1,setImmediate(t._triggerWrite.bind(t)),t._tryClose(),t.pendingLoads.length>0&&setImmediate(t._triggerLoad.bind(t))})}_getDirtyPage(){for(let t in this.pages)if(this.pages[t].dirty)return t;return -1}async write(t,e){if(0==t.byteLength)return;if(void 0===e&&(e=this.pos),this.pos=e+t.byteLength,this.totalSize<e+t.byteLength&&(this.totalSize=e+t.byteLength),this.pendingClose)throw Error("Writing a closing file");let a=Math.floor(e/this.pageSize),i=Math.floor((e+t.byteLength-1)/this.pageSize),o=[];for(let t=a;t<=i;t++)o.push(this._loadPage(t));this._triggerLoad();let n=a,l=e%this.pageSize,r=t.byteLength;for(;r>0;){await o[n-a];let e=l+r>this.pageSize?this.pageSize-l:r,i=t.slice(t.byteLength-r,t.byteLength-r+e);new Uint8Array(this.pages[n].buff.buffer,l,e).set(i),this.pages[n].dirty=!0,this.pages[n].pendingOps--,this.pages[n].size=Math.max(l+e,this.pages[n].size),n>=this.totalPages&&(this.totalPages=n+1),r-=e,n++,l=0,this.writing||setImmediate(this._triggerWrite.bind(this))}}async read(t,e){let a=new Uint8Array(t);return await this.readToBuffer(a,0,t,e),a}async readToBuffer(t,e,a,i){if(0==a)return;if(a>this.pageSize*this.maxPagesLoaded*.8&&(this.maxPagesLoaded=Math.floor(Math.floor(1.1*a)/this.pageSize)+1),void 0===i&&(i=this.pos),this.pos=i+a,this.pendingClose)throw Error("Reading a closing file");let o=Math.floor(i/this.pageSize),n=Math.floor((i+a-1)/this.pageSize),l=[];for(let t=o;t<=n;t++)l.push(this._loadPage(t));this._triggerLoad();let r=o,s=i%this.pageSize,c=i+a>this.totalSize?a-(i+a-this.totalSize):a;for(;c>0;){await l[r-o],this.__statusPage("After Await (read): ",r);let i=s+c>this.pageSize?this.pageSize-s:c,n=new Uint8Array(this.pages[r].buff.buffer,this.pages[r].buff.byteOffset+s,i);t.set(n,e+a-c),this.pages[r].pendingOps--,this.__statusPage("After Op done: ",r),c-=i,r++,s=0,this.pendingLoads.length>0&&setImmediate(this._triggerLoad.bind(this))}this.pos=i+a}_tryClose(){this.pendingClose&&(this.error&&this.pendingCloseReject(this.error),this._getDirtyPage()>=0||this.writing||this.reading||this.pendingLoads.length>0||this.pendingClose())}close(){let t=this;if(t.pendingClose)throw Error("Closing the file twice");return new Promise((e,a)=>{t.pendingClose=e,t.pendingCloseReject=a,t._tryClose()}).then(()=>{t.fd.close()},e=>{throw t.fd.close(),e})}async discard(){await this.close(),await t5.promises.unlink(this.fileName)}async writeULE32(t,e){let a=new Uint8Array(4);new DataView(a.buffer).setUint32(0,t,!0),await this.write(a,e)}async writeUBE32(t,e){let a=new Uint8Array(4);new DataView(a.buffer).setUint32(0,t,!1),await this.write(a,e)}async writeULE64(t,e){let a=new Uint8Array(8),i=new DataView(a.buffer);i.setUint32(0,4294967295&t,!0),i.setUint32(4,Math.floor(t/4294967296),!0),await this.write(a,e)}async readULE32(t){return new Uint32Array((await this.read(4,t)).buffer)[0]}async readUBE32(t){return new DataView((await this.read(4,t)).buffer).getUint32(0,!1)}async readULE64(t){let e=new Uint32Array((await this.read(8,t)).buffer);return 4294967296*e[1]+e[0]}async readString(t){if(this.pendingClose)throw Error("Reading a closing file");let e=void 0===t?this.pos:t,a=Math.floor(e/this.pageSize),i=!1,o="";for(;!i;){let t=this._loadPage(a);this._triggerLoad(),await t,this.__statusPage("After Await (read): ",a);let n=e%this.pageSize,l=new Uint8Array(this.pages[a].buff.buffer,this.pages[a].buff.byteOffset+n,this.pageSize-n),r=l.findIndex(t=>0===t);(i=-1!==r)?(o+=new TextDecoder().decode(l.slice(0,r)),this.pos=a*this.pageSize+n+r+1):(o+=new TextDecoder().decode(l),this.pos=a*this.pageSize+n+l.length),this.pages[a].pendingOps--,this.__statusPage("After Op done: ",a),e=this.pos,a++,this.pendingLoads.length>0&&setImmediate(this._triggerLoad.bind(this))}return o}}let ee=new Uint8Array(4),ea=new DataView(ee.buffer),ei=new Uint8Array(8),eo=new DataView(ei.buffer);class en{constructor(){this.pageSize=16384}_resizeIfNeeded(t){if(t>this.allocSize){let e=Math.max(this.allocSize+1048576,Math.floor(1.1*this.allocSize),t),a=new Uint8Array(e);a.set(this.o.data),this.o.data=a,this.allocSize=e}}async write(t,e){if(void 0===e&&(e=this.pos),this.readOnly)throw Error("Writing a read only file");this._resizeIfNeeded(e+t.byteLength),this.o.data.set(t.slice(),e),e+t.byteLength>this.totalSize&&(this.totalSize=e+t.byteLength),this.pos=e+t.byteLength}async readToBuffer(t,e,a,i){if(void 0===i&&(i=this.pos),this.readOnly&&i+a>this.totalSize)throw Error("Reading out of bounds");this._resizeIfNeeded(i+a);let o=new Uint8Array(this.o.data.buffer,this.o.data.byteOffset+i,a);t.set(o,e),this.pos=i+a}async read(t,e){let a=new Uint8Array(t);return await this.readToBuffer(a,0,t,e),a}close(){this.o.data.byteLength!=this.totalSize&&(this.o.data=this.o.data.slice(0,this.totalSize))}async discard(){}async writeULE32(t,e){ea.setUint32(0,t,!0),await this.write(ee,e)}async writeUBE32(t,e){ea.setUint32(0,t,!1),await this.write(ee,e)}async writeULE64(t,e){eo.setUint32(0,4294967295&t,!0),eo.setUint32(4,Math.floor(t/4294967296),!0),await this.write(ei,e)}async readULE32(t){return new Uint32Array((await this.read(4,t)).buffer)[0]}async readUBE32(t){return new DataView((await this.read(4,t)).buffer).getUint32(0,!1)}async readULE64(t){let e=new Uint32Array((await this.read(8,t)).buffer);return 4294967296*e[1]+e[0]}async readString(t){let e=void 0===t?this.pos:t;if(e>this.totalSize){if(this.readOnly)throw Error("Reading out of bounds");this._resizeIfNeeded(t)}let a=new Uint8Array(this.o.data.buffer,e,this.totalSize-e),i=a.findIndex(t=>0===t),o="";return -1!==i?(o=new TextDecoder().decode(a.slice(0,i)),this.pos=e+i+1):this.pos=e,o}}let el=new Uint8Array(4),er=new DataView(el.buffer),es=new Uint8Array(8),ec=new DataView(es.buffer);class ed{constructor(){this.pageSize=16384}_resizeIfNeeded(t){if(t<=this.totalSize)return;if(this.readOnly)throw Error("Reading out of file bounds");let e=Math.floor((t-1)/4194304)+1;for(let a=Math.max(this.o.data.length-1,0);a<e;a++){let i=new Uint8Array(a<e-1?4194304:t-(e-1)*4194304);a==this.o.data.length-1&&i.set(this.o.data[a]),this.o.data[a]=i}this.totalSize=t}async write(t,e){if(void 0===e&&(e=this.pos),this.readOnly)throw Error("Writing a read only file");this._resizeIfNeeded(e+t.byteLength);let a=Math.floor(e/4194304),i=e%4194304,o=t.byteLength;for(;o>0;){let e=i+o>4194304?4194304-i:o,n=t.slice(t.byteLength-o,t.byteLength-o+e);new Uint8Array(this.o.data[a].buffer,i,e).set(n),o-=e,a++,i=0}this.pos=e+t.byteLength}async readToBuffer(t,e,a,i){if(void 0===i&&(i=this.pos),this.readOnly&&i+a>this.totalSize)throw Error("Reading out of bounds");this._resizeIfNeeded(i+a);let o=Math.floor(i/4194304),n=i%4194304,l=a;for(;l>0;){let i=n+l>4194304?4194304-n:l,r=new Uint8Array(this.o.data[o].buffer,n,i);t.set(r,e+a-l),l-=i,o++,n=0}this.pos=i+a}async read(t,e){let a=new Uint8Array(t);return await this.readToBuffer(a,0,t,e),a}close(){}async discard(){}async writeULE32(t,e){er.setUint32(0,t,!0),await this.write(el,e)}async writeUBE32(t,e){er.setUint32(0,t,!1),await this.write(el,e)}async writeULE64(t,e){ec.setUint32(0,4294967295&t,!0),ec.setUint32(4,Math.floor(t/4294967296),!0),await this.write(es,e)}async readULE32(t){return new Uint32Array((await this.read(4,t)).buffer)[0]}async readUBE32(t){return new DataView((await this.read(4,t)).buffer).getUint32(0,!1)}async readULE64(t){let e=new Uint32Array((await this.read(8,t)).buffer);return 4294967296*e[1]+e[0]}async readString(t){let e=void 0===t?this.pos:t;if(e>this.totalSize){if(this.readOnly)throw Error("Reading out of bounds");this._resizeIfNeeded(t)}let a=!1,i="";for(;!a;){let t=Math.floor(e/4194304),o=e%4194304;if(void 0===this.o.data[t])throw Error("ERROR");let n=Math.min(2048,this.o.data[t].length-o),l=new Uint8Array(this.o.data[t].buffer,o,n),r=l.findIndex(t=>0===t);(a=-1!==r)?(i+=new TextDecoder().decode(l.slice(0,r)),this.pos=4194304*t+o+r+1):(i+=new TextDecoder().decode(l),this.pos=4194304*t+o+l.length),e=this.pos}return i}}var eu=a(9714);async function ef(t,e,a){if("string"==typeof t&&(t={type:"file",fileName:t,cacheSize:e||65536,pageSize:a||8192}),"file"==t.type)return await t9(t.fileName,eu.O_TRUNC|eu.O_CREAT|eu.O_RDWR,t.cacheSize,t.pageSize);if("mem"==t.type)return function(t){let e=t.initialSize||1048576,a=new en;return a.o=t,a.o.data=new Uint8Array(e),a.allocSize=e,a.totalSize=0,a.readOnly=!1,a.pos=0,a}(t);if("bigMem"==t.type)return function(t){let e=t.initialSize||0,a=new ed;a.o=t;let i=e?Math.floor((e-1)/4194304)+1:0;a.o.data=[];for(let t=0;t<i-1;t++)a.o.data.push(new Uint8Array(4194304));return i&&a.o.data.push(new Uint8Array(e-4194304*(i-1))),a.totalSize=0,a.readOnly=!1,a.pos=0,a}(t);throw Error("Invalid FastFile type: "+t.type)}async function eh(t,e,a){if(t instanceof Uint8Array&&(t={type:"mem",data:t}),"string"==typeof t&&(t={type:"file",fileName:t,cacheSize:e||65536,pageSize:a||8192}),"file"==t.type)return await t9(t.fileName,eu.O_RDONLY,t.cacheSize,t.pageSize);if("mem"==t.type)return await function(t){let e=new en;return e.o=t,e.allocSize=t.data.byteLength,e.totalSize=t.data.byteLength,e.readOnly=!0,e.pos=0,e}(t);if("bigMem"==t.type)return await function(t){let e=new ed;return e.o=t,e.totalSize=(t.data.length-1)*4194304+t.data[t.data.length-1].byteLength,e.readOnly=!0,e.pos=0,e}(t);throw Error("Invalid FastFile type: "+t.type)}async function eg(t,e,a,i,o){let n=await eh(t,i,o),l=await n.read(4),r="";for(let t=0;t<4;t++)r+=String.fromCharCode(l[t]);if(r!=e)throw Error(t+": Invalid File format");if(await n.readULE32()>a)throw Error("Version not supported");let s=await n.readULE32(),c=[];for(let t=0;t<s;t++){let t=await n.readULE32(),e=await n.readULE64();void 0===c[t]&&(c[t]=[]),c[t].push({p:n.pos,size:e}),n.pos+=e}return{fd:n,sections:c}}async function ep(t,e,a,i,o,n){let l=await ef(t,o,n),r=new Uint8Array(4);for(let t=0;t<4;t++)r[t]=e.charCodeAt(t);return await l.write(r,0),await l.writeULE32(a),await l.writeULE32(i),l}async function e_(t,e){if(void 0!==t.writingSection)throw Error("Already writing a section");await t.writeULE32(e),t.writingSection={pSectionSize:t.pos},await t.writeULE64(0)}async function em(t){if(void 0===t.writingSection)throw Error("Not writing a section");let e=t.pos-t.writingSection.pSectionSize-8,a=t.pos;t.pos=t.writingSection.pSectionSize,await t.writeULE64(e),t.pos=a,delete t.writingSection}async function eb(t,e,a){if(void 0!==t.readingSection)throw Error("Already reading a section");if(!e[a])throw Error(t.fileName+": Missing section "+a);if(e[a].length>1)throw Error(t.fileName+": Section Duplicated "+a);t.pos=e[a][0].p,t.readingSection=e[a][0]}async function eL(t,e){if(void 0===t.readingSection)throw Error("Not reading a section");if(!e&&t.pos-t.readingSection.p!=t.readingSection.size)throw Error("Invalid section size reading");delete t.readingSection}async function ew(t,e,a,i){let o=new Uint8Array(a);n.toRprLE(o,0,e,a),await t.write(o,i)}async function ey(t,e,a){let i=await t.read(e,a);return n.fromRprLE(i,0,e)}async function eA(t,e,a,i,o){void 0===o&&(o=e[i][0].size);let n=t.pageSize;await eb(t,e,i),await e_(a,i);for(let e=0;e<o;e+=n){let i=Math.min(o-e,n),l=await t.read(i);await a.write(l)}await em(a),await eL(t,o!=e[i][0].size)}async function eC(t,e,a,i,o){let n;if(i=void 0===i?0:i,o=void 0===o?e[a][0].size-i:o,i+o>e[a][0].size)throw Error("Reading out of the range of the section");return n=o<1073741824?new Uint8Array(o):new tS(o),await t.readToBuffer(n,0,o,e[a][0].p+i),n}async function eI(t,e,a,i,o){let n=16*t.pageSize;if(await eb(t,e,o),await eb(a,i,o),e[o][0].size!=i[o][0].size)return!1;let l=e[o][0].size;for(let e=0;e<l;e+=n){let i=Math.min(l-e,n),o=await t.read(i),r=await a.read(i);for(let t=0;t<i;t++)if(o[t]!=r[t])return!1}return await eL(t),await eL(a),!0}let eF=n.e("73eda753299d7d483339d80809a1d80553bda402fffe5bfeffffffff00000001",16),ex=n.e("21888242871839275222246405745257275088548364400416034343698204186575808495617"),eE=n.e("1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffaaab",16),ev=n.e("21888242871839275222246405745257275088696311157297823662689037894645226208583");async function eB(t,e){let a;let i=e&&e.singleThread;if(n.eq(t,ex))a=await t6(i);else if(n.eq(t,eF))a=await t7(i);else throw Error(`Curve not supported: ${n.toString(t)}`);return a}async function eS(t,e){let a;let i=e&&e.singleThread;if(n.eq(t,ev))a=await t6(i);else if(n.eq(t,eE))a=await t7(i);else throw Error(`Curve not supported: ${n.toString(t)}`);return a}async function eO(t,e){let a;let i=e&&e.singleThread,o=t.toUpperCase().match(/[A-Za-z0-9]+/g).join("");if(["BN128","BN254","ALTBN128"].indexOf(o)>=0)a=await t6(i);else if(["BLS12381"].indexOf(o)>=0)a=await t7(i);else throw Error(`Curve not supported: ${t}`);return a}var eP=a(8694),eG=a(6027);let eT=[];for(let t=0;t<256;t++)eT[t]=function(t,e){let a=0,i=t;for(let t=0;t<8;t++)a<<=1,a|=1&i,i>>=1;return a}(t,0);function eq(t){return((4294901760&t)!=0?(t&=4294901760,16):0)|((4278255360&t)!=0?(t&=4278255360,8):0)|((4042322160&t)!=0?(t&=4042322160,4):0)|((3435973836&t)!=0?(t&=3435973836,2):0)|(2863311530&t)!=0}function ez(t,e){let a=new DataView(t.buffer,t.byteOffset,t.byteLength),i="";for(let t=0;t<4;t++){t>0&&(i+="\n"),i+="		";for(let e=0;e<4;e++)e>0&&(i+=" "),i+=a.getUint32(16*t+4*e).toString(16).padStart(8,"0")}return e&&(i=e+"\n"+i),i}function eU(t,e){if(t.byteLength!=e.byteLength)return!1;for(var a=new Int8Array(t),i=new Int8Array(e),o=0;o!=t.byteLength;o++)if(a[o]!=i[o])return!1;return!0}async function eM(t,e,a,i,o){return!(t.G1.isZero(e)||t.G1.isZero(a)||t.G2.isZero(i)||t.G2.isZero(o))&&await t.pairingEq(e,o,t.G1.neg(a),i)}function eQ(t){let e=new Uint8Array(t);return tu.randomFillSync(e),e}async function ek(t){return tu.createHash("sha256").update(t).digest()}function eR(t,e){return new DataView(t.buffer).getUint32(e,!1)}async function eN(t){for(;!t;)t=await function(){{let t=eG.createInterface({input:process.stdin,output:process.stdout});return new Promise(e=>{t.question("Enter a random text. (Entropy): ",t=>e(t))})}}();let e=eP(64);e.update(eQ(64));let a=new TextEncoder;e.update(a.encode(t));let i=e.digest(),o=[];for(let t=0;t<8;t++)o[t]=eR(i,4*t);return new td(o)}async function eD(t,e){let a,i;e<32?(a=1<<e>>>0,i=1):(a=4294967296,i=1<<e-32>>>0);let o=t;for(let t=0;t<i;t++)for(let t=0;t<a;t++)o=await ek(o);let n=new DataView(o.buffer,o.byteOffset,o.byteLength),l=[];for(let t=0;t<8;t++)l[t]=n.getUint32(4*t,!1);return new td(l)}function e$(t){return t instanceof Uint8Array?t:("0x"==t.slice(0,2)&&(t=t.slice(2)),new Uint8Array(t.match(/[\da-f]{2}/gi).map(function(t){return parseInt(t,16)})))}function ej(t){return Array.prototype.map.call(t,function(t){return("0"+(255&t).toString(16)).slice(-2)}).join("")}function eV(t,e){if(e instanceof Uint8Array)return t.toString(e);if(Array.isArray(e))return e.map(eV.bind(null,t));if("object"==typeof e){let a={};return Object.keys(e).forEach(i=>{a[i]=eV(t,e[i])}),a}return"bigint"==typeof e||void 0!==e.eq?e.toString(10):e}async function eK(t,e){await e_(t,1),await t.writeULE32(1),await em(t);let a=await eS(e.q);await e_(t,2);let i=a.q,o=(Math.floor((n.bitLength(i)-1)/64)+1)*8,l=a.r,r=(Math.floor((n.bitLength(l)-1)/64)+1)*8;await t.writeULE32(o),await ew(t,i,o),await t.writeULE32(r),await ew(t,l,r),await t.writeULE32(e.nVars),await t.writeULE32(e.nPublic),await t.writeULE32(e.domainSize),await eH(t,a,e.vk_alpha_1),await eH(t,a,e.vk_beta_1),await eZ(t,a,e.vk_beta_2),await eZ(t,a,e.vk_gamma_2),await eH(t,a,e.vk_delta_1),await eZ(t,a,e.vk_delta_2),await em(t)}async function eH(t,e,a){let i=new Uint8Array(2*e.G1.F.n8);e.G1.toRprLEM(i,0,a),await t.write(i)}async function eZ(t,e,a){let i=new Uint8Array(2*e.G2.F.n8);e.G2.toRprLEM(i,0,a),await t.write(i)}async function eW(t,e,a){let i=await t.read(2*e.G1.F.n8),o=e.G1.fromRprLEM(i,0);return a?e.G1.toObject(o):o}async function eY(t,e,a){let i=await t.read(2*e.G2.F.n8),o=e.G2.fromRprLEM(i,0);return a?e.G2.toObject(o):o}async function eJ(t,e,a,i){await eb(t,e,1);let o=await t.readULE32();if(await eL(t),1===o)return await eX(t,e,a,i);if(2===o)return await e2(t,e,a,i);if(10===o)return await e1(t,e,a,i);throw Error("Protocol not supported: ")}async function eX(t,e,a,i){let o={};o.protocol="groth16",await eb(t,e,2);let n=await t.readULE32();o.n8q=n,o.q=await ey(t,n);let l=await t.readULE32();return o.n8r=l,o.r=await ey(t,l),o.curve=await eS(o.q,i),o.nVars=await t.readULE32(),o.nPublic=await t.readULE32(),o.domainSize=await t.readULE32(),o.power=eq(o.domainSize),o.vk_alpha_1=await eW(t,o.curve,a),o.vk_beta_1=await eW(t,o.curve,a),o.vk_beta_2=await eY(t,o.curve,a),o.vk_gamma_2=await eY(t,o.curve,a),o.vk_delta_1=await eW(t,o.curve,a),o.vk_delta_2=await eY(t,o.curve,a),await eL(t),o}async function e2(t,e,a,i){let o={};o.protocol="plonk",await eb(t,e,2);let n=await t.readULE32();o.n8q=n,o.q=await ey(t,n);let l=await t.readULE32();return o.n8r=l,o.r=await ey(t,l),o.curve=await eS(o.q,i),o.nVars=await t.readULE32(),o.nPublic=await t.readULE32(),o.domainSize=await t.readULE32(),o.power=eq(o.domainSize),o.nAdditions=await t.readULE32(),o.nConstraints=await t.readULE32(),o.k1=await t.read(l),o.k2=await t.read(l),o.Qm=await eW(t,o.curve,a),o.Ql=await eW(t,o.curve,a),o.Qr=await eW(t,o.curve,a),o.Qo=await eW(t,o.curve,a),o.Qc=await eW(t,o.curve,a),o.S1=await eW(t,o.curve,a),o.S2=await eW(t,o.curve,a),o.S3=await eW(t,o.curve,a),o.X_2=await eY(t,o.curve,a),await eL(t),o}async function e1(t,e,a,i){let o={};o.protocol="fflonk",o.protocolId=10,await eb(t,e,2);let n=await t.readULE32();o.n8q=n,o.q=await ey(t,n),o.curve=await eS(o.q,i);let l=await t.readULE32();return o.n8r=l,o.r=await ey(t,l),o.nVars=await t.readULE32(),o.nPublic=await t.readULE32(),o.domainSize=await t.readULE32(),o.power=eq(o.domainSize),o.nAdditions=await t.readULE32(),o.nConstraints=await t.readULE32(),o.k1=await t.read(l),o.k2=await t.read(l),o.w3=await t.read(l),o.w4=await t.read(l),o.w8=await t.read(l),o.wr=await t.read(l),o.X_2=await eY(t,o.curve,a),o.C0=await eW(t,o.curve,a),await eL(t),o}async function e3(t,e){let{fd:a,sections:i}=await eg(t,"zkey",1),o=await eJ(a,i,e),l=new tb(o.r),r=n.mod(n.shl(1,8*o.n8r),o.r),s=l.inv(r),c=l.mul(s,s),d=await eS(o.q);await eb(a,i,3),o.IC=[];for(let t=0;t<=o.nPublic;t++){let t=await eW(a,d,e);o.IC.push(t)}await eL(a),await eb(a,i,4);let u=await a.readULE32();o.ccoefs=[];for(let t=0;t<u;t++){let t=await a.readULE32(),i=await a.readULE32(),n=await a.readULE32(),l=await f(e);o.ccoefs.push({matrix:t,constraint:i,signal:n,value:l})}await eL(a),await eb(a,i,5),o.A=[];for(let t=0;t<o.nVars;t++){let i=await eW(a,d,e);o.A[t]=i}await eL(a),await eb(a,i,6),o.B1=[];for(let t=0;t<o.nVars;t++){let i=await eW(a,d,e);o.B1[t]=i}await eL(a),await eb(a,i,7),o.B2=[];for(let t=0;t<o.nVars;t++){let i=await eY(a,d,e);o.B2[t]=i}await eL(a),await eb(a,i,8),o.C=[];for(let t=o.nPublic+1;t<o.nVars;t++){let i=await eW(a,d,e);o.C[t]=i}await eL(a),await eb(a,i,9),o.hExps=[];for(let t=0;t<o.domainSize;t++){let t=await eW(a,d,e);o.hExps.push(t)}return await eL(a),await a.close(),o;async function f(){let t=await ey(a,o.n8r);return l.mul(t,c)}}async function e0(t,e,a){let i={delta:{}};i.deltaAfter=await eW(t,e,a),i.delta.g1_s=await eW(t,e,a),i.delta.g1_sx=await eW(t,e,a),i.delta.g2_spx=await eY(t,e,a),i.transcript=await t.read(64),i.type=await t.readULE32();let o=await t.readULE32(),n=t.pos,l=0;for(;t.pos-n<o;){let e=await t.read(1);if(e[0]<=l)throw Error("Parameters in the contribution must be sorted");if(l=e[0],1==e[0]){let e=await t.read(1),a=await t.read(e[0]);i.name=new TextDecoder().decode(a)}else if(2==e[0]){let e=await t.read(1);i.numIterationsExp=e[0]}else if(3==e[0]){let e=await t.read(1);i.beaconHash=await t.read(e[0])}else throw Error("Parameter not recognized")}if(t.pos!=n+o)throw Error("Parameters do not match");return i}async function e8(t,e,a){await eb(t,a,10);let i={contributions:[]};i.csHash=await t.read(64);let o=await t.readULE32();for(let a=0;a<o;a++){let a=await e0(t,e);i.contributions.push(a)}return await eL(t),i}async function e4(t,e,a){await eH(t,e,a.deltaAfter),await eH(t,e,a.delta.g1_s),await eH(t,e,a.delta.g1_sx),await eZ(t,e,a.delta.g2_spx),await t.write(a.transcript),await t.writeULE32(a.type||0);let i=[];if(a.name){i.push(1);let t=new TextEncoder("utf-8").encode(a.name.substring(0,64));i.push(t.byteLength);for(let e=0;e<t.byteLength;e++)i.push(t[e])}if(1==a.type){i.push(2),i.push(a.numIterationsExp),i.push(3),i.push(a.beaconHash.byteLength);for(let t=0;t<a.beaconHash.byteLength;t++)i.push(a.beaconHash[t])}if(i.length>0){let e=new Uint8Array(i);await t.writeULE32(e.byteLength),await t.write(e)}else await t.writeULE32(0)}async function e6(t,e,a){await e_(t,10),await t.write(a.csHash),await t.writeULE32(a.contributions.length);for(let i=0;i<a.contributions.length;i++)await e4(t,e,a.contributions[i]);await em(t)}function e7(t,e,a){let i=new Uint8Array(2*e.G1.F.n8);e.G1.toRprUncompressed(i,0,a),t.update(i)}function e5(t,e,a){e7(t,e,a.deltaAfter),e7(t,e,a.delta.g1_s),e7(t,e,a.delta.g1_sx),function(t,e,a){let i=new Uint8Array(2*e.G2.F.n8);e.G2.toRprUncompressed(i,0,a),t.update(i)}(t,e,a.delta.g2_spx),t.update(a.transcript)}async function e9(t,e,a){await e_(t,1);let i=(Math.floor((n.bitLength(a)-1)/64)+1)*8;await t.writeULE32(i),await ew(t,a,i),await t.writeULE32(e.length),await em(t),await e_(t,2);for(let a=0;a<e.length;a++)await ew(t,e[a],i);await em(t,2)}async function at(t,e,a){await e_(t,1);let i=(Math.floor((n.bitLength(a)-1)/64)+1)*8;if(await t.writeULE32(i),await ew(t,a,i),e.byteLength%i!=0)throw Error("Invalid witness length");await t.writeULE32(e.byteLength/i),await em(t),await e_(t,2),await t.write(e),await em(t)}async function ae(t,e){await eb(t,e,1);let a=await t.readULE32(),i=await ey(t,a),o=await t.readULE32();return await eL(t),{n8:a,q:i,nWitness:o}}async function aa(t){let{fd:e,sections:a}=await eg(t,"wtns",2),{n8:i,nWitness:o}=await ae(e,a);await eb(e,a,2);let n=[];for(let t=0;t<o;t++){let t=await ey(e,i);n.push(t)}return await eL(e),await e.close(),n}let{stringifyBigInts:ai}=l;async function ao(t,e,a,i){let{fd:o,sections:l}=await eg(e,"wtns",2,33554432,8388608),r=await ae(o,l),{fd:s,sections:c}=await eg(t,"zkey",2,33554432,8388608),d=await eJ(s,c,void 0,i);if("groth16"!=d.protocol)throw Error("zkey file is not groth16");if(!n.eq(d.r,r.q))throw Error("Curve of the witness does not match the curve of the proving key");if(r.nWitness!=d.nVars)throw Error(`Invalid witness length. Circuit: ${d.nVars}, witness: ${r.nWitness}`);let u=d.curve,f=u.Fr,h=u.G1,g=u.G2,p=eq(d.domainSize);a&&a.debug("Reading Wtns");let _=await eC(o,l,2);a&&a.debug("Reading Coeffs");let m=await eC(s,c,4);a&&a.debug("Building ABC");let[b,L,w]=await an(u,d,_,m,a),y=p==f.s?u.Fr.shift:u.Fr.w[p+1],A=await f.ifft(b,"","",a,"IFFT_A"),C=await f.batchApplyKey(A,f.e(1),y),I=await f.fft(C,"","",a,"FFT_A"),F=await f.ifft(L,"","",a,"IFFT_B"),x=await f.batchApplyKey(F,f.e(1),y),E=await f.fft(x,"","",a,"FFT_B"),v=await f.ifft(w,"","",a,"IFFT_C"),B=await f.batchApplyKey(v,f.e(1),y),S=await f.fft(B,"","",a,"FFT_C");a&&a.debug("Join ABC");let O=await al(u,d,I,E,S,a),P={};a&&a.debug("Reading A Points");let G=await eC(s,c,5);P.pi_a=await u.G1.multiExpAffine(G,_,a,"multiexp A"),a&&a.debug("Reading B1 Points");let T=await eC(s,c,6),q=await u.G1.multiExpAffine(T,_,a,"multiexp B1");a&&a.debug("Reading B2 Points");let z=await eC(s,c,7);P.pi_b=await u.G2.multiExpAffine(z,_,a,"multiexp B2"),a&&a.debug("Reading C Points");let U=await eC(s,c,8);P.pi_c=await u.G1.multiExpAffine(U,_.slice((d.nPublic+1)*u.Fr.n8),a,"multiexp C"),a&&a.debug("Reading H Points");let M=await eC(s,c,9),Q=await u.G1.multiExpAffine(M,O,a,"multiexp H"),k=u.Fr.random(),R=u.Fr.random();P.pi_a=h.add(P.pi_a,d.vk_alpha_1),P.pi_a=h.add(P.pi_a,h.timesFr(d.vk_delta_1,k)),P.pi_b=g.add(P.pi_b,d.vk_beta_2),P.pi_b=g.add(P.pi_b,g.timesFr(d.vk_delta_2,R)),q=h.add(q,d.vk_beta_1),q=h.add(q,h.timesFr(d.vk_delta_1,R)),P.pi_c=h.add(P.pi_c,Q),P.pi_c=h.add(P.pi_c,h.timesFr(P.pi_a,R)),P.pi_c=h.add(P.pi_c,h.timesFr(q,k)),P.pi_c=h.add(P.pi_c,h.timesFr(d.vk_delta_1,f.neg(f.mul(k,R))));let N=[];for(let t=1;t<=d.nPublic;t++){let e=_.slice(t*f.n8,t*f.n8+f.n8);N.push(n.fromRprLE(e))}return P.pi_a=h.toObject(h.toAffine(P.pi_a)),P.pi_b=g.toObject(g.toAffine(P.pi_b)),P.pi_c=h.toObject(h.toAffine(P.pi_c)),P.protocol="groth16",P.curve=u.name,await s.close(),await o.close(),{proof:P=ai(P),publicSignals:N=ai(N)}}async function an(t,e,a,i,o){let n=t.Fr.n8,l=12+e.n8r,r=(i.byteLength-4)/l,s=new tS(e.domainSize*n),c=new tS(e.domainSize*n),d=new tS(e.domainSize*n),u=[s,c];for(let e=0;e<r;e++){o&&e%1e6==0&&o.debug(`QAP AB: ${e}/${r}`);let s=i.slice(4+e*l,4+e*l+l),c=new DataView(s.buffer),d=c.getUint32(0,!0),f=c.getUint32(4,!0),h=c.getUint32(8,!0),g=s.slice(12,12+n);u[d].set(t.Fr.add(u[d].slice(f*n,f*n+n),t.Fr.mul(g,a.slice(h*n,h*n+n))),f*n)}for(let a=0;a<e.domainSize;a++)o&&a%1e6==0&&o.debug(`QAP C: ${a}/${e.domainSize}`),d.set(t.Fr.mul(s.slice(a*n,a*n+n),c.slice(a*n,a*n+n)),a*n);return[s,c,d]}async function al(t,e,a,i,o,n){let l;let r=t.Fr.n8,s=Math.floor(a.byteLength/t.Fr.n8),c=[];for(let e=0;e<s;e+=4194304){n&&n.debug(`JoinABC: ${e}/${s}`);let l=Math.min(s-e,4194304),d=[],u=a.slice(e*r,(e+l)*r),f=i.slice(e*r,(e+l)*r),h=o.slice(e*r,(e+l)*r);d.push({cmd:"ALLOCSET",var:0,buff:u}),d.push({cmd:"ALLOCSET",var:1,buff:f}),d.push({cmd:"ALLOCSET",var:2,buff:h}),d.push({cmd:"ALLOC",var:3,len:l*r}),d.push({cmd:"CALL",fnName:"qap_joinABC",params:[{var:0},{var:1},{var:2},{val:l},{var:3}]}),d.push({cmd:"CALL",fnName:"frm_batchFromMontgomery",params:[{var:3},{val:l},{var:3}]}),d.push({cmd:"GET",out:0,var:3,len:l*r}),c.push(t.tm.queueAction(d))}let d=await Promise.all(c);l=a instanceof tS?new tS(a.byteLength):new Uint8Array(a.byteLength);let u=0;for(let t=0;t<d.length;t++)l.set(d[t][0],u),u+=d[t][0].byteLength;return l}function ar(t){let e=[];return function t(e,a){if(Array.isArray(a))for(let i=0;i<a.length;i++)t(e,a[i]);else e.push(a)}(e,t),e}function as(t){let e=BigInt(2)**BigInt(64),a=BigInt("0xCBF29CE484222325");for(let i=0;i<t.length;i++)a^=BigInt(t[i].charCodeAt(0)),a*=BigInt(1099511628211),a%=e;let i=a.toString(16),o=16-i.length;return"0".repeat(o).concat(i)}async function ac(t,e){let a,i,o;e=e||{};let l=1,r=0,s=0,c=!1;if(t instanceof WebAssembly.Instance)a=t,c=!0;else{let c=32767;if(e.memorySize&&(c=parseInt(e.memorySize))<0)throw Error("Invalid memory size");let d=!1;for(;!d;)try{o=new WebAssembly.Memory({initial:c}),d=!0}catch(t){if(c<=1)throw t;console.warn("Could not allocate "+65536*c+" bytes. This may cause severe instability. Trying with "+65536*c/2+" bytes"),c=Math.floor(c/2)}let h=await WebAssembly.compile(t),g="",p="";a=await WebAssembly.instantiate(h,{env:{memory:o},runtime:{printDebug:function(t){console.log("printDebug:",t)},exceptionHandler:function(t){let e;throw e=1===t?"Signal not found. ":2===t?"Too many signals set. ":3===t?"Signal already set. ":4===t?"Assert Failed. ":5===t?"Not enough memory. ":6===t?"Input signal array access exceeds the size. ":"Unknown error. ",console.error("ERROR: ",t,g),Error(e+g)},printErrorMessage:function(){g+=u()+"\n"},writeBufferMessage:function(){let t=u();"\n"===t?(console.log(p),p=""):(""!==p&&(p+=" "),p+=t)},showSharedRWMemory:function(){let t=a.exports.getFieldNumLen32(),e=new Uint32Array(t);for(let i=0;i<t;i++)e[t-1-i]=a.exports.readSharedRWMemory(i);if(l>=2&&(r>=1||s>=7)){""!==p&&(p+=" ");let t=n.fromArray(e,4294967296).toString();p+=t}else console.log(n.fromArray(e,4294967296))},error:function(t,a,o,n,l,r){let s;throw s=7===t?f(a)+" "+i.getFr(n).toString()+" != "+i.getFr(l).toString()+" "+f(r):9===t?f(a)+" "+i.getFr(n).toString()+" "+f(l):5===t&&e.sym?f(a)+" "+e.sym.labelIdx2Name[l]:f(a)+" "+o+" "+n+" "+l+" "+r,console.log("ERROR: ",t,s),Error(s)},log:function(t){console.log(i.getFr(t).toString())},logGetSignal:function(t,a){e.logGetSignal&&e.logGetSignal(t,i.getFr(a))},logSetSignal:function(t,a){e.logSetSignal&&e.logSetSignal(t,i.getFr(a))},logStartComponent:function(t){e.logStartComponent&&e.logStartComponent(t)},logFinishComponent:function(t){e.logFinishComponent&&e.logFinishComponent(t)}}})}"function"==typeof a.exports.getVersion&&(l=a.exports.getVersion()),"function"==typeof a.exports.getMinorVersion&&(r=a.exports.getMinorVersion()),"function"==typeof a.exports.getPatchVersion&&(s=a.exports.getPatchVersion());let d=e&&(e.sanityCheck||e.logGetSignal||e.logSetSignal||e.logStartComponent||e.logFinishComponent);if(2===l)i=new au(a,d);else if(1===l){if(c)throw Error("Loading code from WebAssembly instance is not supported for circom version 1");i=new ad(o,a,d)}else throw Error(`Unsupported circom version: ${l}`);return i;function u(){let t="",e=a.exports.getMessageChar();for(;0!==e;)t+=String.fromCharCode(e),e=a.exports.getMessageChar();return t}function f(t){let e=new Uint8Array(o.buffer),a=[];for(let i=0;e[t+i]>0;i++)a.push(e[t+i]);return String.fromCharCode.apply(null,a)}}class ad{constructor(t,e,a){this.memory=t,this.i32=new Uint32Array(t.buffer),this.instance=e,this.n32=(this.instance.exports.getFrLen()>>2)-2;let i=this.instance.exports.getPRawPrime(),o=Array(this.n32);for(let t=0;t<this.n32;t++)o[this.n32-1-t]=this.i32[(i>>2)+t];this.prime=n.fromArray(o,4294967296),this.Fr=new tb(this.prime),this.mask32=n.fromString("FFFFFFFF",16),this.NVars=this.instance.exports.getNVars(),this.n64=Math.floor((this.Fr.bitLength-1)/64)+1,this.R=this.Fr.e(n.shiftLeft(1,64*this.n64)),this.RInv=this.Fr.inv(this.R),this.sanityCheck=a}circom_version(){return 1}async _doCalculateWitness(t,e){this.instance.exports.init(this.sanityCheck||e?1:0);let a=this.allocInt(),i=this.allocFr();Object.keys(t).forEach(e=>{let o=as(e),n=parseInt(o.slice(0,8),16),l=parseInt(o.slice(8,16),16);try{this.instance.exports.getSignalOffset32(a,0,n,l)}catch(t){throw Error(`Signal ${e} is not an input of the circuit.`)}let r=this.getInt(a),s=ar(t[e]);for(let t=0;t<s.length;t++)this.setFr(i,s[t]),this.instance.exports.setSignal(0,0,r+t,i)})}async calculateWitness(t,e){let a=this.i32[0],i=[];await this._doCalculateWitness(t,e);for(let t=0;t<this.NVars;t++){let e=this.instance.exports.getPWitness(t);i.push(this.getFr(e))}return this.i32[0]=a,i}async calculateBinWitness(t,e){let a=this.i32[0];await this._doCalculateWitness(t,e);let i=this.instance.exports.getWitnessBuffer();return this.i32[0]=a,new Uint8Array(this.memory.buffer.slice(i,i+this.NVars*this.n64*8))}allocInt(){let t=this.i32[0];return this.i32[0]=t+8,t}allocFr(){let t=this.i32[0];return this.i32[0]=t+4*this.n32+8,t}getInt(t){return this.i32[t>>2]}setInt(t,e){this.i32[t>>2]=e}getFr(t){let e=t>>2;if(2147483648&this.i32[e+1]){let t=Array(this.n32);for(let a=0;a<this.n32;a++)t[this.n32-1-a]=this.i32[e+2+a];let a=this.Fr.e(n.fromArray(t,4294967296));return 1073741824&this.i32[e+1]?this.Fr.mul(this.RInv,a):a}return 2147483648&this.i32[e]?this.Fr.e(this.i32[e]-4294967296):this.Fr.e(this.i32[e])}setFr(t,e){e=this.Fr.e(e);let a=this.Fr.neg(this.Fr.e("80000000",16)),i=this.Fr.e("7FFFFFFF",16);if(this.Fr.geq(e,a)&&this.Fr.leq(e,i)){let i;i=this.Fr.geq(e,this.Fr.zero)?n.toNumber(e):4294967296+(i=n.toNumber(this.Fr.sub(e,a))-2147483648),this.i32[t>>2]=i,this.i32[(t>>2)+1]=0;return}this.i32[t>>2]=0,this.i32[(t>>2)+1]=2147483648;let o=n.toArray(e,4294967296);for(let e=0;e<this.n32;e++){let a=o.length-1-e;a>=0?this.i32[(t>>2)+2+e]=o[a]:this.i32[(t>>2)+2+e]=0}}}class au{constructor(t,e){this.instance=t,this.version=this.instance.exports.getVersion(),this.n32=this.instance.exports.getFieldNumLen32(),this.instance.exports.getRawPrime();let a=new Uint32Array(this.n32);for(let t=0;t<this.n32;t++)a[this.n32-1-t]=this.instance.exports.readSharedRWMemory(t);this.prime=n.fromArray(a,4294967296),this.witnessSize=this.instance.exports.getWitnessSize(),this.sanityCheck=e}circom_version(){return this.instance.exports.getVersion()}async _doCalculateWitness(t,e){this.instance.exports.init(this.sanityCheck||e?1:0);let a=Object.keys(t),i=0;if(a.forEach(e=>{let a=as(e),o=parseInt(a.slice(0,8),16),n=parseInt(a.slice(8,16),16),l=ar(t[e]);if("function"==typeof this.instance.exports.getInputSignalSize){let t=this.instance.exports.getInputSignalSize(o,n);if(t<0)throw Error(`Signal ${e} not found
`);if(l.length<t)throw Error(`Not enough values for input signal ${e}
`);if(l.length>t)throw Error(`Too many values for input signal ${e}
`)}for(let t=0;t<l.length;t++){let e=function(t,e){let a=[],i=BigInt(t),o=BigInt(4294967296);for(;i;)a.unshift(Number(i%o)),i/=o;if(e){let t=e-a.length;for(;t>0;)a.unshift(0),t--}return a}(function(t,e){let a=BigInt(t)%e;return a<0&&(a+=e),a}(l[t],this.prime),this.n32);for(let t=0;t<this.n32;t++)this.instance.exports.writeSharedRWMemory(t,e[this.n32-1-t]);try{this.instance.exports.setInputSignal(o,n,t),i++}catch(t){throw Error(t)}}}),i<this.instance.exports.getInputSize())throw Error(`Not all inputs have been set. Only ${i} out of ${this.instance.exports.getInputSize()}`)}async calculateWitness(t,e){let a=[];await this._doCalculateWitness(t,e);for(let t=0;t<this.witnessSize;t++){this.instance.exports.getWitness(t);let e=new Uint32Array(this.n32);for(let t=0;t<this.n32;t++)e[this.n32-1-t]=this.instance.exports.readSharedRWMemory(t);a.push(n.fromArray(e,4294967296))}return a}async calculateWTNSBin(t,e){let a=new Uint32Array(this.witnessSize*this.n32+this.n32+11),i=new Uint8Array(a.buffer);await this._doCalculateWitness(t,e),i[0]=119,i[1]=116,i[2]=110,i[3]=115,a[1]=2,a[2]=2,a[3]=1;let o=4*this.n32,n=(8+o).toString(16);a[4]=parseInt(n.slice(0,8),16),a[5]=parseInt(n.slice(8,16),16),a[6]=o,this.instance.exports.getRawPrime();let l=7;for(let t=0;t<this.n32;t++)a[l+t]=this.instance.exports.readSharedRWMemory(t);a[l+=this.n32]=this.witnessSize,a[++l]=2,l++;let r=(o*this.witnessSize).toString(16);a[l]=parseInt(r.slice(0,8),16),a[l+1]=parseInt(r.slice(8,16),16),l+=2;for(let t=0;t<this.witnessSize;t++){this.instance.exports.getWitness(t);for(let t=0;t<this.n32;t++)a[l+t]=this.instance.exports.readSharedRWMemory(t);l+=this.n32}return i}}let{unstringifyBigInts:af}=l;async function ah(t,e,a,i){let o=af(t),n=await eh(e),l=await n.read(n.totalSize);await n.close();let r=await ac(l,i);if(1===r.circom_version()){let t=await r.calculateBinWitness(o),e=await ep(a,"wtns",2,2);await at(e,t,r.prime),await e.close()}else{let t=await ef(a),e=await r.calculateWTNSBin(o);await t.write(e),await t.close()}}let{unstringifyBigInts:ag}=l;async function ap(t,e,a,i,o,n){let l=ag(t),r={type:"mem"};return await ah(l,e,r,o),await ao(a,r,i,n)}let{unstringifyBigInts:a_}=l;async function am(t,e,a,i){let o=a_(t),l=a_(a),r=a_(e),s=await eO(o.curve),c=s.G1.fromObject(o.IC[0]),d=new Uint8Array(2*s.G1.F.n8*r.length),u=new Uint8Array(s.Fr.n8*r.length);if(!function(t,e){for(let a=0;a<e.length;a++)if(!n.lt(e[a],t.r))return!1;return!0}(s,r))return i&&i.error("Public inputs are not valid."),!1;for(let t=0;t<r.length;t++){let e=s.G1.fromObject(o.IC[t+1]);d.set(e,t*s.G1.F.n8*2),n.toRprLE(u,s.Fr.n8*t,r[t],s.Fr.n8)}let f=await s.G1.multiExpAffine(d,u);f=s.G1.add(f,c);let h=s.G1.fromObject(l.pi_a),g=s.G2.fromObject(l.pi_b),p=s.G1.fromObject(l.pi_c);if(!function(t,e){let a=t.G1,i=t.G2;return a.isValid(e.pi_a)&&i.isValid(e.pi_b)&&a.isValid(e.pi_c)}(s,{pi_a:h,pi_b:g,pi_c:p}))return i&&i.error("Proof commitments are not valid."),!1;let _=s.G2.fromObject(o.vk_gamma_2),m=s.G2.fromObject(o.vk_delta_2),b=s.G1.fromObject(o.vk_alpha_1),L=s.G2.fromObject(o.vk_beta_2);return await s.pairingEq(s.G1.neg(h),g,f,_,p,m,b,L)?(i&&i.info("OK!"),!0):(i&&i.error("Invalid proof"),!1)}let{unstringifyBigInts:ab}=l;function aL(t){let e=t.toString(16);for(;e.length<64;)e="0"+e;return`"0x${e}"`}async function aw(t,e){let a=ab(t),i=ab(e),o="";for(let t=0;t<i.length;t++)""!=o&&(o+=","),o+=aL(i[t]);return`[${aL(a.pi_a[0])}, ${aL(a.pi_a[1])}],[[${aL(a.pi_b[0][1])}, ${aL(a.pi_b[0][0])}],[${aL(a.pi_b[1][1])}, ${aL(a.pi_b[1][0])}]],[${aL(a.pi_c[0])}, ${aL(a.pi_c[1])}],[${o}]`}function ay(t,e){let a=new DataView(e.buffer,e.byteOffset,e.byteLength),i=[];for(let t=0;t<8;t++)i[t]=a.getUint32(4*t);let o=new td(i);return t.G2.fromRng(o)}function aA(t,e,a,i,o){let n=eP(64),l=new Uint8Array([e]);n.update(l),n.update(a);let r=t.G1.toUncompressed(i);n.update(r);let s=t.G1.toUncompressed(o);return n.update(s),ay(t,n.digest())}function aC(t,e,a,i,o){return t.g1_s=e.G1.toAffine(e.G1.fromRng(o)),t.g1_sx=e.G1.toAffine(e.G1.timesFr(t.g1_s,t.prvKey)),t.g2_sp=e.G2.toAffine(aA(e,a,i,t.g1_s,t.g1_sx)),t.g2_spx=e.G2.toAffine(e.G2.timesFr(t.g2_sp,t.prvKey)),t}function aI(t,e,a){let i={tau:{},alpha:{},beta:{}};return i.tau.prvKey=t.Fr.fromRng(a),i.alpha.prvKey=t.Fr.fromRng(a),i.beta.prvKey=t.Fr.fromRng(a),aC(i.tau,t,0,e,a),aC(i.alpha,t,1,e,a),aC(i.beta,t,2,e,a),i}async function aF(t,e,a,i){i||(i=a),await t.writeULE32(1);let o=t.pos;await t.writeULE64(0),await t.writeULE32(8*e.F1.n64);let l=new Uint8Array(e.F1.n8);n.toRprLE(l,0,e.q,e.F1.n8),await t.write(l),await t.writeULE32(a),await t.writeULE32(i);let r=t.pos-o-8,s=t.pos;await t.writeULE64(r,o),t.pos=s}async function ax(t,e){if(!e[1])throw Error(t.fileName+": File has no  header");if(e[1].length>1)throw Error(t.fileName+": File has more than one header");t.pos=e[1][0].p;let a=await t.readULE32(),i=await t.read(a),o=n.fromRprLE(i),l=await eS(o);if(8*l.F1.n64!=a)throw Error(t.fileName+": Invalid size");let r=await t.readULE32(),s=await t.readULE32();if(t.pos-e[1][0].p!=e[1][0].size)throw Error("Invalid PTau header size");return{curve:l,power:r,ceremonyPower:s}}async function aE(t,e,a){return av(await t.read(12*e.F1.n8+6*e.F2.n8),0,e,a)}function av(t,e,a,i){let o={tau:{},alpha:{},beta:{}};return o.tau.g1_s=n(),o.tau.g1_sx=n(),o.alpha.g1_s=n(),o.alpha.g1_sx=n(),o.beta.g1_s=n(),o.beta.g1_sx=n(),o.tau.g2_spx=l(),o.alpha.g2_spx=l(),o.beta.g2_spx=l(),o;function n(){let o;return o=i?a.G1.fromRprLEM(t,e):a.G1.fromRprUncompressed(t,e),e+=2*a.G1.F.n8,o}function l(){let o;return o=i?a.G2.fromRprLEM(t,e):a.G2.fromRprUncompressed(t,e),e+=2*a.G2.F.n8,o}}function aB(t,e,a,i,o){async function n(i){o?a.G1.toRprLEM(t,e,i):a.G1.toRprUncompressed(t,e,i),e+=2*a.F1.n8}async function l(i){o?a.G2.toRprLEM(t,e,i):a.G2.toRprUncompressed(t,e,i),e+=2*a.F2.n8}return n(i.tau.g1_s),n(i.tau.g1_sx),n(i.alpha.g1_s),n(i.alpha.g1_sx),n(i.beta.g1_s),n(i.beta.g1_sx),l(i.tau.g2_spx),l(i.alpha.g2_spx),l(i.beta.g2_spx),t}async function aS(t,e,a,i){let o=new Uint8Array(12*e.F1.n8+6*e.F2.n8);aB(o,0,e,a,i),await t.write(o)}async function aO(t,e){let a={};a.tauG1=await s(),a.tauG2=await c(),a.alphaG1=await s(),a.betaG1=await s(),a.betaG2=await c(),a.key=await aE(t,e,!0),a.partialHash=await t.read(216),a.nextChallenge=await t.read(64),a.type=await t.readULE32();let i=new Uint8Array(12*e.G1.F.n8+6*e.G2.F.n8);aB(i,0,e,a.key,!1);let o=eP(64);o.setPartialHash(a.partialHash),o.update(i),a.responseHash=o.digest();let n=await t.readULE32(),l=t.pos,r=0;for(;t.pos-l<n;){let t=await d(1);if(t[0]<=r)throw Error("Parameters in the contribution must be sorted");if(r=t[0],1==t[0]){let t=await d(1),e=await d(t[0]);a.name=new TextDecoder().decode(e)}else if(2==t[0]){let t=await d(1);a.numIterationsExp=t[0]}else if(3==t[0]){let t=await d(1);a.beaconHash=await d(t[0])}else throw Error("Parameter not recognized")}if(t.pos!=l+n)throw Error("Parameters do not match");return a;async function s(){let a=await t.read(2*e.G1.F.n8);return e.G1.fromRprLEM(a)}async function c(){let a=await t.read(2*e.G2.F.n8);return e.G2.fromRprLEM(a)}async function d(e){return new Uint8Array(await t.read(e))}}async function aP(t,e,a){if(!a[7])throw Error(t.fileName+": File has no  contributions");if(a[7][0].length>1)throw Error(t.fileName+": File has more than one contributions section");t.pos=a[7][0].p;let i=await t.readULE32(),o=[];for(let a=0;a<i;a++){let i=await aO(t,e);i.id=a+1,o.push(i)}if(t.pos-a[7][0].p!=a[7][0].size)throw Error("Invalid contribution section size");return o}async function aG(t,e,a){let i=new Uint8Array(2*e.F1.n8),o=new Uint8Array(2*e.F2.n8);await l(a.tauG1),await r(a.tauG2),await l(a.alphaG1),await l(a.betaG1),await r(a.betaG2),await aS(t,e,a.key,!0),await t.write(a.partialHash),await t.write(a.nextChallenge),await t.writeULE32(a.type||0);let n=[];if(a.name){n.push(1);let t=new TextEncoder("utf-8").encode(a.name.substring(0,64));n.push(t.byteLength);for(let e=0;e<t.byteLength;e++)n.push(t[e])}if(1==a.type){n.push(2),n.push(a.numIterationsExp),n.push(3),n.push(a.beaconHash.byteLength);for(let t=0;t<a.beaconHash.byteLength;t++)n.push(a.beaconHash[t])}if(n.length>0){let e=new Uint8Array(n);await t.writeULE32(e.byteLength),await t.write(e)}else await t.writeULE32(0);async function l(a){e.G1.toRprLEM(i,0,a),await t.write(i)}async function r(a){e.G2.toRprLEM(o,0,a),await t.write(o)}}async function aT(t,e,a){await t.writeULE32(7);let i=t.pos;await t.writeULE64(0),await t.writeULE32(a.length);for(let i=0;i<a.length;i++)await aG(t,e,a[i]);let o=t.pos-i-8,n=t.pos;await t.writeULE64(o,i),t.pos=n}function aq(t,e,a){let i;a&&a.debug("Calculating First Challenge Hash");let o=new eP(64),n=new Uint8Array(2*t.G1.F.n8),l=new Uint8Array(2*t.G2.F.n8);return t.G1.toRprUncompressed(n,0,t.G1.g),t.G2.toRprUncompressed(l,0,t.G2.g),o.update(eP(64).digest()),i=2**e*2-1,a&&a.debug("Calculate Initial Hash: tauG1"),r(n,i),i=2**e,a&&a.debug("Calculate Initial Hash: tauG2"),r(l,i),a&&a.debug("Calculate Initial Hash: alphaTauG1"),r(n,i),a&&a.debug("Calculate Initial Hash: betaTauG1"),r(n,i),o.update(l),o.digest();function r(t,e){let i=Math.floor(e/341e3),n=e%341e3,l=new Uint8Array(341e3*t.byteLength);for(let e=0;e<341e3;e++)l.set(t,e*t.byteLength);for(let t=0;t<i;t++)o.update(l),a&&a.debug("Initial hash: "+341e3*t);for(let e=0;e<n;e++)o.update(t)}}async function az(t,e,a,i){return aI(t,e,await eD(a,i))}async function aU(t,e,a,i){await eP.ready();let o=await ep(a,"ptau",1,7);await aF(o,t,e,0);let n=t.G1.oneAffine,l=t.G2.oneAffine;await e_(o,2);let r=2**e*2-1;for(let t=0;t<r;t++)await o.write(n),i&&t%1e5==0&&t&&i.log("tauG1: "+t);await em(o),await e_(o,3);let s=2**e;for(let t=0;t<s;t++)await o.write(l),i&&t%1e5==0&&t&&i.log("tauG2: "+t);await em(o),await e_(o,4);let c=2**e;for(let t=0;t<c;t++)await o.write(n),i&&t%1e5==0&&t&&i.log("alphaTauG1: "+t);await em(o),await e_(o,5);let d=2**e;for(let t=0;t<d;t++)await o.write(n),i&&t%1e5==0&&t&&i.log("betaTauG1: "+t);await em(o),await e_(o,6),await o.write(l),await em(o),await e_(o,7),await o.writeULE32(0),await em(o),await o.close();let u=aq(t,e,i);return i&&i.debug(ez(eP(64).digest(),"Blank Contribution Hash:")),i&&i.info(ez(u,"First Contribution Hash:")),u}async function aM(t,e,a){let i,o;await eP.ready();let{fd:n,sections:l}=await eg(t,"ptau",1),{curve:r,power:s}=await ax(n,l),c=await aP(n,r,l);0==c.length?(i=eP(64).digest(),o=aq(r,s)):(i=c[c.length-1].responseHash,o=c[c.length-1].nextChallenge),a&&a.info(ez(i,"Last Response Hash: ")),a&&a.info(ez(o,"New Challenge Hash: "));let d=await ef(e),u=eP(64);await d.write(i),u.update(i),await h(2,"G1",2**s*2-1,"tauG1"),await h(3,"G2",2**s,"tauG2"),await h(4,"G1",2**s,"alphaTauG1"),await h(5,"G1",2**s,"betaTauG1"),await h(6,"G2",1,"betaG2"),await n.close(),await d.close();let f=u.digest();if(!eU(o,f))throw a&&a.info(ez(f,"Calc Curret Challenge Hash: ")),a&&a.error("PTau file is corrupted. Calculated new challenge hash does not match with the eclared one"),Error("PTau file is corrupted. Calculated new challenge hash does not match with the eclared one");return o;async function h(t,e,i,o){let s=r[e],c=2*s.F.n8,f=Math.floor(16777216/c);await eb(n,l,t);for(let t=0;t<i;t+=f){let e;a&&a.debug(`Exporting ${o}: ${t}/${i}`);let l=Math.min(i-t,f);e=await n.read(l*c),e=await s.batchLEMtoU(e),await d.write(e),u.update(e)}await eL(n)}}async function aQ(t,e,a,i,o,n){let l,r;await eP.ready();let s=new Uint8Array(64);for(let t=0;t<64;t++)s[t]=255;let{fd:c,sections:d}=await eg(t,"ptau",1),{curve:u,power:f}=await ax(c,d),h=await aP(c,u,d),g={};i&&(g.name=i);let p=2*u.F1.n8,_=u.F1.n8,m=2*u.F2.n8,b=u.F2.n8,L=await eh(e);if(L.totalSize!=64+(2**f*2-1)*_+2**f*b+2**f*_+2**f*_+b+6*p+3*m)throw Error("Size of the contribution is invalid");l=h.length>0?h[h.length-1].nextChallenge:aq(u,f,n);let w=await ep(a,"ptau",1,o?7:2);await aF(w,u,f);let y=await L.read(64);if(eU(s,l)&&(l=y,h[h.length-1].nextChallenge=l),!eU(y,l))throw Error("Wrong contribution. This contribution is not based on the previous hash");let A=new eP(64);A.update(y);let C=[];r=await x(L,w,"G1",2,2**f*2-1,[1],"tauG1"),g.tauG1=r[0],r=await x(L,w,"G2",3,2**f,[1],"tauG2"),g.tauG2=r[0],r=await x(L,w,"G1",4,2**f,[0],"alphaG1"),g.alphaG1=r[0],r=await x(L,w,"G1",5,2**f,[0],"betaG1"),g.betaG1=r[0],r=await x(L,w,"G2",6,1,[0],"betaG2"),g.betaG2=r[0],g.partialHash=A.getPartialHash();let I=await L.read(12*u.F1.n8+6*u.F2.n8);g.key=av(I,0,u,!1),A.update(new Uint8Array(I));let F=A.digest();if(n&&n.info(ez(F,"Contribution Response Hash imported: ")),o){let t=new eP(64);t.update(F),await B(t,w,"G1",2,2**f*2-1,"tauG1",n),await B(t,w,"G2",3,2**f,"tauG2",n),await B(t,w,"G1",4,2**f,"alphaTauG1",n),await B(t,w,"G1",5,2**f,"betaTauG1",n),await B(t,w,"G2",6,1,"betaG2",n),g.nextChallenge=t.digest(),n&&n.info(ez(g.nextChallenge,"Next Challenge Hash: "))}else g.nextChallenge=s;return h.push(g),await aT(w,u,h),await L.close(),await w.close(),await c.close(),g.nextChallenge;async function x(t,e,a,i,n,l,r){return o?await E(t,e,a,i,n,l,r):await v(t,e,a,i,n,l,r)}async function E(t,e,a,i,o,l,r){let s=u[a],c=s.F.n8,d=2*s.F.n8,f=[];await e_(e,i);let h=Math.floor(16777216/d);C[i]=e.pos;for(let a=0;a<o;a+=h){n&&n.debug(`Importing ${r}: ${a}/${o}`);let i=Math.min(o-a,h),u=await t.read(i*c);A.update(u);let g=await s.batchCtoLEM(u);await e.write(g);for(let t=0;t<l.length;t++){let e=l[t];if(e>=a&&e<a+i){let t=s.fromRprLEM(g,(e-a)*d);f.push(t)}}}return await em(e),f}async function v(t,e,a,i,o,l,r){let s=u[a],c=s.F.n8,d=[],f=Math.floor(16777216/c);for(let e=0;e<o;e+=f){n&&n.debug(`Importing ${r}: ${e}/${o}`);let a=Math.min(o-e,f),i=await t.read(a*c);A.update(i);for(let t=0;t<l.length;t++){let o=l[t];if(o>=e&&o<e+a){let t=s.fromRprCompressed(i,(o-e)*c);d.push(t)}}}return d}async function B(t,e,a,i,o,n,l){let r=u[a],s=2*r.F.n8,c=Math.floor(16777216/s),d=e.pos;e.pos=C[i];for(let a=0;a<o;a+=c){l&&l.debug(`Hashing ${n}: ${a}/${o}`);let i=Math.min(o-a,c),d=await e.read(i*s),u=await r.batchLEMtoU(d);t.update(u)}e.pos=d}}async function ak(t,e,a,i){if(1==e.type){let o=await az(t,a.nextChallenge,e.beaconHash,e.numIterationsExp);if(!t.G1.eq(e.key.tau.g1_s,o.tau.g1_s))return i&&i.error(`BEACON key (tauG1_s) is not generated correctly in challenge #${e.id}  ${e.name||""}`),!1;if(!t.G1.eq(e.key.tau.g1_sx,o.tau.g1_sx))return i&&i.error(`BEACON key (tauG1_sx) is not generated correctly in challenge #${e.id}  ${e.name||""}`),!1;if(!t.G2.eq(e.key.tau.g2_spx,o.tau.g2_spx))return i&&i.error(`BEACON key (tauG2_spx) is not generated correctly in challenge #${e.id}  ${e.name||""}`),!1;if(!t.G1.eq(e.key.alpha.g1_s,o.alpha.g1_s))return i&&i.error(`BEACON key (alphaG1_s) is not generated correctly in challenge #${e.id}  ${e.name||""}`),!1;if(!t.G1.eq(e.key.alpha.g1_sx,o.alpha.g1_sx))return i&&i.error(`BEACON key (alphaG1_sx) is not generated correctly in challenge #${e.id}  ${e.name||""}`),!1;if(!t.G2.eq(e.key.alpha.g2_spx,o.alpha.g2_spx))return i&&i.error(`BEACON key (alphaG2_spx) is not generated correctly in challenge #${e.id}  ${e.name||""}`),!1;if(!t.G1.eq(e.key.beta.g1_s,o.beta.g1_s))return i&&i.error(`BEACON key (betaG1_s) is not generated correctly in challenge #${e.id}  ${e.name||""}`),!1;if(!t.G1.eq(e.key.beta.g1_sx,o.beta.g1_sx))return i&&i.error(`BEACON key (betaG1_sx) is not generated correctly in challenge #${e.id}  ${e.name||""}`),!1;if(!t.G2.eq(e.key.beta.g2_spx,o.beta.g2_spx))return i&&i.error(`BEACON key (betaG2_spx) is not generated correctly in challenge #${e.id}  ${e.name||""}`),!1}return(e.key.tau.g2_sp=t.G2.toAffine(aA(t,0,a.nextChallenge,e.key.tau.g1_s,e.key.tau.g1_sx)),e.key.alpha.g2_sp=t.G2.toAffine(aA(t,1,a.nextChallenge,e.key.alpha.g1_s,e.key.alpha.g1_sx)),e.key.beta.g2_sp=t.G2.toAffine(aA(t,2,a.nextChallenge,e.key.beta.g1_s,e.key.beta.g1_sx)),!0!==await eM(t,e.key.tau.g1_s,e.key.tau.g1_sx,e.key.tau.g2_sp,e.key.tau.g2_spx))?(i&&i.error("INVALID key (tau) in challenge #"+e.id),!1):!0!==await eM(t,e.key.alpha.g1_s,e.key.alpha.g1_sx,e.key.alpha.g2_sp,e.key.alpha.g2_spx)?(i&&i.error("INVALID key (alpha) in challenge #"+e.id),!1):!0!==await eM(t,e.key.beta.g1_s,e.key.beta.g1_sx,e.key.beta.g2_sp,e.key.beta.g2_spx)?(i&&i.error("INVALID key (beta) in challenge #"+e.id),!1):!0!==await eM(t,a.tauG1,e.tauG1,e.key.tau.g2_sp,e.key.tau.g2_spx)?(i&&i.error("INVALID tau*G1. challenge #"+e.id+" It does not follow the previous contribution"),!1):!0!==await eM(t,e.key.tau.g1_s,e.key.tau.g1_sx,a.tauG2,e.tauG2)?(i&&i.error("INVALID tau*G2. challenge #"+e.id+" It does not follow the previous contribution"),!1):!0!==await eM(t,a.alphaG1,e.alphaG1,e.key.alpha.g2_sp,e.key.alpha.g2_spx)?(i&&i.error("INVALID alpha*G1. challenge #"+e.id+" It does not follow the previous contribution"),!1):!0!==await eM(t,a.betaG1,e.betaG1,e.key.beta.g2_sp,e.key.beta.g2_spx)?(i&&i.error("INVALID beta*G1. challenge #"+e.id+" It does not follow the previous contribution"),!1):!0!==await eM(t,e.key.beta.g1_s,e.key.beta.g1_sx,a.betaG2,e.betaG2)?(i&&i.error("INVALID beta*G2. challenge #"+e.id+"It does not follow the previous contribution"),!1):(i&&i.info("Powers Of tau file OK!"),!0)}async function aR(t,e){let a;await eP.ready();let{fd:i,sections:o}=await eg(t,"ptau",1),{curve:n,power:l,ceremonyPower:r}=await ax(i,o),s=await aP(i,n,o);e&&e.debug("power: 2**"+l),e&&e.debug("Computing initial contribution hash");let c={tauG1:n.G1.g,tauG2:n.G2.g,alphaG1:n.G1.g,betaG1:n.G1.g,betaG2:n.G2.g,nextChallenge:aq(n,r,e),responseHash:eP(64).digest()};if(0==s.length)return e&&e.error("This file has no contribution! It cannot be used in production"),!1;a=s.length>1?s[s.length-2]:c;let d=s[s.length-1];if(e&&e.debug("Validating contribution #"+s[s.length-1].id),!await ak(n,d,a,e))return!1;let u=eP(64);u.update(d.responseHash),e&&e.debug("Verifying powers in tau*G1 section");let f=await w(2,"G1","tauG1",2**l*2-1,[0,1],e);if(!0!==await eM(n,f.R1,f.R2,n.G2.g,d.tauG2))return e&&e.error("tauG1 section. Powers do not match"),!1;if(!n.G1.eq(n.G1.g,f.singularPoints[0]))return e&&e.error("First element of tau*G1 section must be the generator"),!1;if(!n.G1.eq(d.tauG1,f.singularPoints[1]))return e&&e.error("Second element of tau*G1 section does not match the one in the contribution section"),!1;e&&e.debug("Verifying powers in tau*G2 section");let h=await w(3,"G2","tauG2",2**l,[0,1],e);if(!0!==await eM(n,n.G1.g,d.tauG1,h.R1,h.R2))return e&&e.error("tauG2 section. Powers do not match"),!1;if(!n.G2.eq(n.G2.g,h.singularPoints[0]))return e&&e.error("First element of tau*G2 section must be the generator"),!1;if(!n.G2.eq(d.tauG2,h.singularPoints[1]))return e&&e.error("Second element of tau*G2 section does not match the one in the contribution section"),!1;e&&e.debug("Verifying powers in alpha*tau*G1 section");let g=await w(4,"G1","alphatauG1",2**l,[0],e);if(!0!==await eM(n,g.R1,g.R2,n.G2.g,d.tauG2))return e&&e.error("alphaTauG1 section. Powers do not match"),!1;if(!n.G1.eq(d.alphaG1,g.singularPoints[0]))return e&&e.error("First element of alpha*tau*G1 section (alpha*G1) does not match the one in the contribution section"),!1;e&&e.debug("Verifying powers in beta*tau*G1 section");let p=await w(5,"G1","betatauG1",2**l,[0],e);if(!0!==await eM(n,p.R1,p.R2,n.G2.g,d.tauG2))return e&&e.error("betaTauG1 section. Powers do not match"),!1;if(!n.G1.eq(d.betaG1,p.singularPoints[0]))return e&&e.error("First element of beta*tau*G1 section (beta*G1) does not match the one in the contribution section"),!1;let _=await L(e);if(!n.G2.eq(d.betaG2,_))return e&&e.error("betaG2 element in betaG2 section does not match the one in the contribution section"),!1;let m=u.digest();if(l==r&&!eU(m,d.nextChallenge))return e&&e.error("Hash of the values does not match the next challenge of the last contributor in the contributions section"),!1;e&&e.info(ez(m,"Next challenge hash: ")),b(d,a);for(let t=s.length-2;t>=0;t--){let a=s[t],i=t>0?s[t-1]:c;if(!await ak(n,a,i,e))return!1;b(a,i,e)}if(e&&e.info("-----------------------------------------------------"),o[12]&&o[13]&&o[14]&&o[15]){if(!await y("G1",2,12,"tauG1",e)||!await y("G2",3,13,"tauG2",e)||!await y("G1",4,14,"alphaTauG1",e)||!await y("G1",5,15,"betaTauG1",e))return!1}else e&&e.warn('this file does not contain phase2 precalculated values. Please run: \n   snarkjs "powersoftau preparephase2" to prepare this file to be used in the phase2 ceremony.');return await i.close(),e&&e.info("Powers of Tau Ok!"),!0;function b(t,a){if(!e)return;e.info("-----------------------------------------------------"),e.info(`Contribution #${t.id}: ${t.name||""}`),e.info(ez(t.nextChallenge,"Next Challenge: "));let i=new Uint8Array(12*n.G1.F.n8+6*n.G2.F.n8);aB(i,0,n,t.key,!1);let o=eP(64);o.setPartialHash(t.partialHash),o.update(i);let l=o.digest();e.info(ez(l,"Response Hash:")),e.info(ez(a.nextChallenge,"Response Hash:")),1==t.type&&(e.info(`Beacon generator: ${ej(t.beaconHash)}`),e.info(`Beacon iterations Exp: ${t.numIterationsExp}`))}async function L(t){let e=n.G2,a=2*e.F.n8,l=new Uint8Array(a);if(!o[6])throw t.error("File has no BetaG2 section"),Error("File has no BetaG2 section");if(o[6].length>1)throw t.error("File has no BetaG2 section"),Error("File has more than one GetaG2 section");i.pos=o[6][0].p;let r=await i.read(a),s=e.fromRprLEM(r);return e.toRprUncompressed(l,0,s),u.update(l),s}async function w(t,e,a,l,r,s){let c=n[e],d=2*c.F.n8;await eb(i,o,t);let f=[],h=c.zero,g=c.zero,p=c.zero;for(let t=0;t<l;t+=65536){s&&s.debug(`points relations: ${a}: ${t}/${l} `);let e=Math.min(l-t,65536),o=await i.read(e*d),n=await c.batchLEMtoU(o);u.update(n);let _=eQ(4*(e-1));if(t>0){let t=c.fromRprLEM(o,0),e=eR(eQ(4),0);h=c.add(h,c.timesScalar(p,e)),g=c.add(g,c.timesScalar(t,e))}let m=await c.multiExpAffine(o.slice(0,(e-1)*d),_),b=await c.multiExpAffine(o.slice(d),_);h=c.add(h,m),g=c.add(g,b),p=c.fromRprLEM(o,(e-1)*d);for(let a=0;a<r.length;a++){let i=r[a];if(i>=t&&i<t+e){let e=c.fromRprLEM(o,(i-t)*d);f.push(e)}}}return await eL(i),{R1:h,R2:g,singularPoints:f}}async function y(t,e,a,r,s){s&&s.debug(`Verifying phase2 calculated values ${r}...`);let c=n[t],d=2*c.F.n8,u=Array(8);for(let t=0;t<8;t++)u[t]=eR(eQ(4),0);for(let t=0;t<=l;t++)if(!await f(t))return!1;if(2==e&&!await f(l+1))return!1;return!0;async function f(t){let f;s&&s.debug(`Power ${t}...`);let h=n.Fr.n8,g=2**t,p=new Uint32Array(g),_=new td(u);s&&s.debug(`Creating random numbers Powers${t}...`);for(let e=0;e<g;e++)t==l+1&&e==g-1?p[e]=0:p[e]=_.nextU32();p=new Uint8Array(p.buffer,p.byteOffset,p.byteLength),s&&s.debug(`reading points Powers${t}...`),await eb(i,o,e),f=new tS(g*d),t==l+1?(await i.readToBuffer(f,0,(g-1)*d),f.set(n.G1.zeroAffine,(g-1)*d)):await i.readToBuffer(f,0,g*d),await eL(i,!0);let m=await c.multiExpAffine(f,p,s,r+"_"+t);p=new tS(g*h),_=new td(u);let b=new Uint8Array(4),L=new DataView(b.buffer);s&&s.debug(`Creating random numbers Powers${t}...`);for(let e=0;e<g;e++)(e!=g-1||t!=l+1)&&(L.setUint32(0,_.nextU32(),!0),p.set(b,e*h));s&&s.debug(`batchToMontgomery ${t}...`),p=await n.Fr.batchToMontgomery(p),s&&s.debug(`fft ${t}...`),p=await n.Fr.fft(p),s&&s.debug(`batchFromMontgomery ${t}...`),p=await n.Fr.batchFromMontgomery(p),s&&s.debug(`reading points Lagrange${t}...`),await eb(i,o,a),i.pos+=d*(2**t-1),await i.readToBuffer(f,0,g*d),await eL(i,!0);let w=await c.multiExpAffine(f,p,s,r+"_"+t+"_transformed");return!!c.eq(m,w)||(s&&s.error("Phase2 caclutation does not match with powers of tau"),!1)}}}async function aN(t,e,a,i,o,n,l,r,s,c){let d=o[n],u=2*d.F.n8,f=e[i][0].size/u;await eb(t,e,i),await e_(a,i);let h=l;for(let e=0;e<f;e+=65536){let i;c&&c.debug(`Applying key: ${s}: ${e}/${f}`);let n=Math.min(f-e,65536);i=await t.read(n*u),i=await d.batchApplyKey(i,h,r),await a.write(i),h=o.Fr.mul(h,o.Fr.exp(r,n))}await em(a),await eL(t)}async function aD(t,e,a,i,o,n,l,r,s,c,d){let u=i[o],f=2*u.F.n8,h=Math.floor(1048576/f),g=l;for(let o=0;o<n;o+=h){let l;d&&d.debug(`Applying key ${c}: ${o}/${n}`);let p=Math.min(n-o,h),_=await t.read(p*f),m=await u.batchUtoLEM(_),b=await u.batchApplyKey(m,g,r);l="COMPRESSED"==s?await u.batchLEMtoC(b):await u.batchLEMtoU(b),a&&a.update(l),await e.write(l),g=i.Fr.mul(g,i.Fr.exp(r,p))}}async function a$(t,e,a,i,o){await eP.ready();let n=await eh(e),l=16*t.F1.n64,r=16*t.F2.n64,s=(n.totalSize+l-64-r)/(4*l+r),c=s,d=0;for(;c>1;)c/=2,d+=1;if(2**d!=s)throw Error("Invalid file size");o&&o.debug("Power to tau size: "+d);let u=await eN(i),f=await ef(a),h=eP(64);for(let t=0;t<n.totalSize;t+=n.pageSize){o&&o.debug(`Hashing challenge ${t}/${n.totalSize}`);let e=Math.min(n.totalSize-t,n.pageSize),a=await n.read(e);h.update(a)}let g=await n.read(64,0);o&&o.info(ez(g,"Claimed Previous Response Hash: "));let p=h.digest();o&&o.info(ez(p,"Current Challenge Hash: "));let _=aI(t,p,u);o&&["tau","alpha","beta"].forEach(e=>{o.debug(e+".g1_s: "+t.G1.toString(_[e].g1_s,16)),o.debug(e+".g1_sx: "+t.G1.toString(_[e].g1_sx,16)),o.debug(e+".g2_sp: "+t.G2.toString(_[e].g2_sp,16)),o.debug(e+".g2_spx: "+t.G2.toString(_[e].g2_spx,16)),o.debug("")});let m=eP(64);await f.write(p),m.update(p),await aD(n,f,m,t,"G1",2**d*2-1,t.Fr.one,_.tau.prvKey,"COMPRESSED","tauG1",o),await aD(n,f,m,t,"G2",2**d,t.Fr.one,_.tau.prvKey,"COMPRESSED","tauG2",o),await aD(n,f,m,t,"G1",2**d,_.alpha.prvKey,_.tau.prvKey,"COMPRESSED","alphaTauG1",o),await aD(n,f,m,t,"G1",2**d,_.beta.prvKey,_.tau.prvKey,"COMPRESSED","betaTauG1",o),await aD(n,f,m,t,"G2",1,_.beta.prvKey,_.tau.prvKey,"COMPRESSED","betaTauG2",o);let b=new Uint8Array(12*t.F1.n8+6*t.F2.n8);aB(b,0,t,_,!1),await f.write(b),m.update(b);let L=m.digest();o&&o.info(ez(L,"Contribution Response Hash: ")),await f.close(),await n.close()}async function aj(t,e,a,i,o,n){let l,r;let s=e$(i);if(0==s.byteLength||2*s.byteLength!=i.length)return n&&n.error("Invalid Beacon Hash. (It must be a valid hexadecimal sequence)"),!1;if(s.length>=256)return n&&n.error("Maximum length of beacon hash is 255 bytes"),!1;if((o=parseInt(o))<10||o>63)return n&&n.error("Invalid numIterationsExp. (Must be between 10 and 63)"),!1;await eP.ready();let{fd:c,sections:d}=await eg(t,"ptau",1),{curve:u,power:f,ceremonyPower:h}=await ax(c,d);if(f!=h)return n&&n.error("This file has been reduced. You cannot contribute into a reduced file."),!1;d[12]&&n&&n.warn("Contributing into a file that has phase2 calculated. You will have to prepare phase2 again.");let g=await aP(c,u,d),p={name:a,type:1,numIterationsExp:o,beaconHash:s};l=g.length>0?g[g.length-1].nextChallenge:aq(u,f,n),p.key=await az(u,l,s,o);let _=new eP(64);_.update(l);let m=await ep(e,"ptau",1,7);await aF(m,u,f);let b=[];r=await A(2,"G1",2**f*2-1,u.Fr.e(1),p.key.tau.prvKey,"tauG1",n),p.tauG1=r[1],r=await A(3,"G2",2**f,u.Fr.e(1),p.key.tau.prvKey,"tauG2",n),p.tauG2=r[1],r=await A(4,"G1",2**f,p.key.alpha.prvKey,p.key.tau.prvKey,"alphaTauG1",n),p.alphaG1=r[0],r=await A(5,"G1",2**f,p.key.beta.prvKey,p.key.tau.prvKey,"betaTauG1",n),p.betaG1=r[0],r=await A(6,"G2",1,p.key.beta.prvKey,p.key.tau.prvKey,"betaTauG2",n),p.betaG2=r[0],p.partialHash=_.getPartialHash();let L=new Uint8Array(12*u.F1.n8+6*u.F2.n8);aB(L,0,u,p.key,!1),_.update(new Uint8Array(L));let w=_.digest();n&&n.info(ez(w,"Contribution Response Hash imported: "));let y=new eP(64);return y.update(w),await C(m,"G1",2,2**f*2-1,"tauG1",n),await C(m,"G2",3,2**f,"tauG2",n),await C(m,"G1",4,2**f,"alphaTauG1",n),await C(m,"G1",5,2**f,"betaTauG1",n),await C(m,"G2",6,1,"betaG2",n),p.nextChallenge=y.digest(),n&&n.info(ez(p.nextChallenge,"Next Challenge Hash: ")),g.push(p),await aT(m,u,g),await c.close(),await m.close(),w;async function A(t,e,a,i,o,n,l){let r=[];c.pos=d[t][0].p,await e_(m,t),b[t]=m.pos;let s=u[e],f=2*s.F.n8,h=Math.floor(1048576/f),g=i;for(let t=0;t<a;t+=h){l&&l.debug(`applying key${n}: ${t}/${a}`);let e=Math.min(a-t,h),i=await c.read(e*f),d=await s.batchApplyKey(i,g,o),p=m.write(d),b=await s.batchLEMtoC(d);if(_.update(b),await p,0==t)for(let t=0;t<Math.min(2,a);t++)r.push(s.fromRprLEM(d,t*f));g=u.Fr.mul(g,u.Fr.exp(o,e))}return await em(m),r}async function C(t,e,a,i,o,n){let l=u[e],r=2*l.F.n8,s=Math.floor(16777216/r),c=t.pos;t.pos=b[a];for(let e=0;e<i;e+=s){n&&n.debug(`Hashing ${o}: ${e}/${i}`);let a=Math.min(i-e,s),c=await t.read(a*r),d=await l.batchLEMtoU(c);y.update(d)}t.pos=c}}async function aV(t,e,a,i,o){let n,l;await eP.ready();let{fd:r,sections:s}=await eg(t,"ptau",1),{curve:c,power:d,ceremonyPower:u}=await ax(r,s);if(d!=u)throw o&&o.error("This file has been reduced. You cannot contribute into a reduced file."),Error("This file has been reduced. You cannot contribute into a reduced file.");s[12]&&o&&o.warn("WARNING: Contributing into a file that has phase2 calculated. You will have to prepare phase2 again.");let f=await aP(r,c,s),h={name:a,type:0},g=await eN(i);n=f.length>0?f[f.length-1].nextChallenge:aq(c,d,o),h.key=aI(c,n,g);let p=new eP(64);p.update(n);let _=await ep(e,"ptau",1,7);await aF(_,c,d);let m=[];l=await y(2,"G1",2**d*2-1,c.Fr.e(1),h.key.tau.prvKey,"tauG1"),h.tauG1=l[1],l=await y(3,"G2",2**d,c.Fr.e(1),h.key.tau.prvKey,"tauG2"),h.tauG2=l[1],l=await y(4,"G1",2**d,h.key.alpha.prvKey,h.key.tau.prvKey,"alphaTauG1"),h.alphaG1=l[0],l=await y(5,"G1",2**d,h.key.beta.prvKey,h.key.tau.prvKey,"betaTauG1"),h.betaG1=l[0],l=await y(6,"G2",1,h.key.beta.prvKey,h.key.tau.prvKey,"betaTauG2"),h.betaG2=l[0],h.partialHash=p.getPartialHash();let b=new Uint8Array(12*c.F1.n8+6*c.F2.n8);aB(b,0,c,h.key,!1),p.update(new Uint8Array(b));let L=p.digest();o&&o.info(ez(L,"Contribution Response Hash imported: "));let w=new eP(64);return w.update(L),await A(_,"G1",2,2**d*2-1,"tauG1"),await A(_,"G2",3,2**d,"tauG2"),await A(_,"G1",4,2**d,"alphaTauG1"),await A(_,"G1",5,2**d,"betaTauG1"),await A(_,"G2",6,1,"betaG2"),h.nextChallenge=w.digest(),o&&o.info(ez(h.nextChallenge,"Next Challenge Hash: ")),f.push(h),await aT(_,c,f),await r.close(),await _.close(),L;async function y(t,e,a,i,n,l){let d=[];r.pos=s[t][0].p,await e_(_,t),m[t]=_.pos;let u=c[e],f=2*u.F.n8,h=Math.floor(1048576/f),g=i;for(let t=0;t<a;t+=h){o&&o.debug(`processing: ${l}: ${t}/${a}`);let e=Math.min(a-t,h),i=await r.read(e*f),s=await u.batchApplyKey(i,g,n),m=_.write(s),b=await u.batchLEMtoC(s);if(p.update(b),await m,0==t)for(let t=0;t<Math.min(2,a);t++)d.push(u.fromRprLEM(s,t*f));g=c.Fr.mul(g,c.Fr.exp(n,e))}return await em(_),d}async function A(t,e,a,i,n){let l=c[e],r=2*l.F.n8,s=Math.floor(16777216/r),d=t.pos;t.pos=m[a];for(let e=0;e<i;e+=s){o&&e&&o.debug(`Hashing ${n}: `+e);let a=Math.min(i-e,s),c=await t.read(a*r),d=await l.batchLEMtoU(c);w.update(d)}t.pos=d}}async function aK(t,e,a){let{fd:i,sections:o}=await eg(t,"ptau",1),{curve:n,power:l}=await ax(i,o),r=await ep(e,"ptau",1,11);async function s(t,e,s,c){a&&a.debug("Starting section: "+c),await e_(r,e);for(let t=0;t<=l;t++)await d(t);async function d(e){let d;let u=2**e,f=n[s];n.Fr;let h=2*f.F.n8;f.F.n8,d=new tS(u*h),await eb(i,o,t),2==t&&e==l+1?(await i.readToBuffer(d,0,(u-1)*h),d.set(n.G1.zeroAffine,(u-1)*h)):await i.readToBuffer(d,0,u*h),await eL(i,!0),d=await f.lagrangeEvaluations(d,"affine","affine",a,c),await r.write(d)}2==t&&await d(l+1),await em(r)}await aF(r,n,l),await eA(i,o,r,2),await eA(i,o,r,3),await eA(i,o,r,4),await eA(i,o,r,5),await eA(i,o,r,6),await eA(i,o,r,7),await s(2,12,"G1","tauG1"),await s(3,13,"G2","tauG2"),await s(4,14,"G1","alphaTauG1"),await s(5,15,"G1","betaTauG1"),await i.close(),await r.close()}async function aH(t,e,a){let{fd:i,sections:o}=await eg(t,"ptau",1),{curve:n,power:l,ceremonyPower:r}=await ax(i,o),s=2*n.G1.F.n8,c=2*n.G2.F.n8;for(let t=1;t<l;t++)await d(t);return await i.close(),!0;async function d(t){let l=t.toString();for(;l.length<2;)l="0"+l;a&&a.debug("Writing Power: "+l);let d=await ep(e+l+".ptau","ptau",1,11);await aF(d,n,t,r),await eA(i,o,d,2,(2**t*2-1)*s),await eA(i,o,d,3,2**t*c),await eA(i,o,d,4,2**t*s),await eA(i,o,d,5,2**t*s),await eA(i,o,d,6,c),await eA(i,o,d,7),await eA(i,o,d,12,(2**(t+1)*2-1)*s),await eA(i,o,d,13,(2**t*2-1)*c),await eA(i,o,d,14,(2**t*2-1)*s),await eA(i,o,d,15,(2**t*2-1)*s),await d.close()}}async function aZ(t,e,a){let{fd:i,sections:o}=await eg(t,"ptau",1),{curve:n,power:l}=await ax(i,o),r=await ep(e,"ptau",1,11);async function s(t,e,s,c){a&&a.debug("Starting section: "+c),await e_(r,e);let d=o[e][0].size,u=i.pageSize;await eb(i,o,e);for(let t=0;t<d;t+=u){let e=Math.min(d-t,u),a=await i.read(e);await r.write(a)}async function f(e){let d;let u=2**e,f=n[s],h=2*f.F.n8;d=new tS(u*h),await eb(i,o,t),2==t&&e==l+1?(await i.readToBuffer(d,0,(u-1)*h),d.set(n.G1.zeroAffine,(u-1)*h)):await i.readToBuffer(d,0,u*h),await eL(i,!0),d=await f.lagrangeEvaluations(d,"affine","affine",a,c),await r.write(d)}await eL(i),2==t&&await f(l+1),await em(r)}await aF(r,n,l),await eA(i,o,r,2),await eA(i,o,r,3),await eA(i,o,r,4),await eA(i,o,r,5),await eA(i,o,r,6),await eA(i,o,r,7),await s(2,12,"G1","tauG1"),await eA(i,o,r,13),await eA(i,o,r,14),await eA(i,o,r,15),await i.close(),await r.close()}async function aW(t,e){let{fd:a,sections:i}=await eg(t,"ptau",1),{curve:o,power:n}=await ax(a,i),l={};return l.q=o.q,l.power=n,l.contributions=await aP(a,o,i),l.tauG1=await r(2,"G1",2**n*2-1,"tauG1"),l.tauG2=await r(3,"G2",2**n,"tauG2"),l.alphaTauG1=await r(4,"G1",2**n,"alphaTauG1"),l.betaTauG1=await r(5,"G1",2**n,"betaTauG1"),l.betaG2=await r(6,"G2",1,"betaG2"),l.lTauG1=await s(12,"G1","lTauG1"),l.lTauG2=await s(13,"G2","lTauG2"),l.lAlphaTauG1=await s(14,"G1","lAlphaTauG2"),l.lBetaTauG1=await s(15,"G1","lBetaTauG2"),await a.close(),eV(o.Fr,l);async function r(t,n,l,r){let s=o[n],c=2*s.F.n8,d=[];await eb(a,i,t);for(let t=0;t<l;t++){e&&t&&t%1e4==0&&console.log(`${r}: `+t);let i=await a.read(c);d.push(s.fromRprLEM(i,0))}return await eL(a),d}async function s(t,l,r){let s=o[l],c=2*s.F.n8,d=[];await eb(a,i,t);for(let t=0;t<=n;t++){e&&console.log(`${r}: Power: ${t}`),d[t]=[];let i=2**t;for(let o=0;o<i;o++){e&&o&&o%1e4==0&&console.log(`${r}: ${o}/${i}`);let n=await a.read(c);d[t].push(s.fromRprLEM(n,0))}}return await eL(a,!0),d}}function aY(t,e,a){for(let i=0;i<t.constraints.length;i++)(function(i){let o=a=>{let i="";return Object.keys(a).forEach(o=>{let n=e.varIdx2Name[o];"one"==n&&(n="1");let l=t.curve.Fr.toString(a[o]);"1"==l&&(l=""),"-1"==l&&(l="-"),""!=i&&"-"!=l[0]&&(l="+"+l),""!=i&&(l=" "+l),i=i+l+n}),i},n=`[ ${o(i[0])} ] * [ ${o(i[1])} ] - [ ${o(i[2])} ] = 0`;a&&a.info(n)})(t.constraints[i])}let aJ=[0,1,2,2,3,3,3,3,4,4,4,4,4,4,4,4];function aX(t,e){return e&&10!=e?16==e?"0x"==t.slice(0,2)?BigInt(t):BigInt("0x"+t):void 0:BigInt(t)}function a2(t){let e=t.toString(16);return(e.length-1)*4+aJ[parseInt(e[0],16)]}function a1(t,e){return BigInt(t)<<BigInt(e)}function a3(t,e){return BigInt(t)>>BigInt(e)}function a0(t){return(BigInt(t)&BigInt(1))==BigInt(1)}function a8(t,e){return BigInt(t)+BigInt(e)}function a4(t,e){return BigInt(t)-BigInt(e)}function a6(t,e){return BigInt(t)**BigInt(e)}function a7(t,e){return BigInt(t)/BigInt(e)}function a5(t,e){return BigInt(t)%BigInt(e)}function a9(t,e){return BigInt(t)==BigInt(e)}function it(t,e){return BigInt(t)>BigInt(e)}function ie(t,e){return BigInt(t)&BigInt(e)}function ia(t,e,a,i){let o="0000000"+a.toString(16),n=new Uint32Array(t.buffer,t.byteOffset+e,i/4),l=((o.length-7)*4-1>>5)+1;for(let t=0;t<l;t++)n[t]=parseInt(o.substring(o.length-8*t-8,o.length-8*t),16);for(let t=l;t<n.length;t++)n[t]=0;for(let e=4*n.length;e<i;e++)t[e]=function(t){if(t>BigInt(Number.MAX_SAFE_INTEGER))throw Error("Number too big");return Number(t)}(ie(a3(a,8*e),255))}function ii(t,e,a){a=a||t.byteLength,e=e||0;let i=new Uint32Array(t.buffer,t.byteOffset+e,a/4),o=Array(a/4);return i.forEach((t,e)=>o[o.length-e-1]=t.toString(16).padStart(8,"0")),aX(o.join(""),16)}function io(t){let e=new Uint8Array(Math.floor((a2(t)-1)/8)+1);return ia(e,0,t,e.byteLength),e}let il=aX(0),ir=aX(1),is=[];for(let t=0;t<256;t++)is[t]=function(t,e){let a=0,i=t;for(let t=0;t<8;t++)a<<=1,a|=1&i,i>>=1;return a}(t,0);function ic(t,e,a){if(!a)return t.one;let i=function(t){let e=BigInt(t),a=[];for(;e;)e&BigInt(1)?a.push(1):a.push(0),e>>=BigInt(1);return a}(a);if(0==i.length)return t.one;let o=e;for(let a=i.length-2;a>=0;a--)o=t.square(o),i[a]&&(o=t.mul(o,e));return o}function id(t,e,a,i,o){t[e]=t[e]+t[a]>>>0,t[o]=(t[o]^t[e])>>>0,t[o]=(t[o]<<16|t[o]>>>16&65535)>>>0,t[i]=t[i]+t[o]>>>0,t[a]=(t[a]^t[i])>>>0,t[a]=(t[a]<<12|t[a]>>>20&4095)>>>0,t[e]=t[e]+t[a]>>>0,t[o]=(t[o]^t[e])>>>0,t[o]=(t[o]<<8|t[o]>>>24&255)>>>0,t[i]=t[i]+t[o]>>>0,t[a]=(t[a]^t[i])>>>0,t[a]=(t[a]<<7|t[a]>>>25&127)>>>0}class iu{constructor(t){t=t||[0,0,0,0,0,0,0,0],this.state=[1634760805,857760878,2036477234,1797285236,t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],0,0,0,0],this.idx=16,this.buff=Array(16)}nextU32(){return 16==this.idx&&this.update(),this.buff[this.idx++]}nextU64(){return a8(BigInt(this.nextU32())*BigInt(4294967296),this.nextU32())}nextBool(){return(1&this.nextU32())==1}update(){for(let t=0;t<16;t++)this.buff[t]=this.state[t];for(let e=0;e<10;e++){var t;id(t=this.buff,0,4,8,12),id(t,1,5,9,13),id(t,2,6,10,14),id(t,3,7,11,15),id(t,0,5,10,15),id(t,1,6,11,12),id(t,2,7,8,13),id(t,3,4,9,14)}for(let t=0;t<16;t++)this.buff[t]=this.buff[t]+this.state[t]>>>0;this.idx=0,this.state[12]=this.state[12]+1>>>0,0==this.state[12]&&(this.state[13]=this.state[13]+1>>>0,0==this.state[13]&&(this.state[14]=this.state[14]+1>>>0,0==this.state[14]&&(this.state[15]=this.state[15]+1>>>0)))}}function ih(t){let e=new Uint8Array(t);return tu.randomFillSync(e),e}let ig=null;function ip(){return ig||(ig=new iu(function(){let t=new Uint32Array(ih(32).buffer),e=[];for(let a=0;a<8;a++)e.push(t[a]);return e}()))}class i_{constructor(t,e,a){this.F=e,this.G=t,this.opMulGF=a;let i=e.sqrt_t||e.t,o=e.sqrt_s||e.s,n=e.one;for(;e.eq(e.pow(n,e.half),e.one);)n=e.add(n,e.one);this.w=Array(o+1),this.wi=Array(o+1),this.w[o]=this.F.pow(n,i),this.wi[o]=this.F.inv(this.w[o]);let l=o-1;for(;l>=0;)this.w[l]=this.F.square(this.w[l+1]),this.wi[l]=this.F.square(this.wi[l+1]),l--;this.roots=[],this._setRoots(Math.min(o,15))}_setRoots(t){for(let e=t;e>=0&&!this.roots[e];e--){let t=this.F.one,a=1<<e,i=Array(a);for(let o=0;o<a;o++)i[o]=t,t=this.F.mul(t,this.w[e]);this.roots[e]=i}}fft(t){if(t.length<=1)return t;let e=im(t.length-1)+1;this._setRoots(e);let a=1<<e;if(t.length!=a)throw Error("Size must be multiple of 2");return ib(this,t,e,0,1)}ifft(t){if(t.length<=1)return t;let e=im(t.length-1)+1;this._setRoots(e);let a=1<<e;if(t.length!=a)throw Error("Size must be multiple of 2");let i=ib(this,t,e,0,1),o=this.F.inv(this.F.mulScalar(this.F.one,a)),n=Array(a);for(let t=0;t<a;t++)n[t]=this.opMulGF(i[(a-t)%a],o);return n}}function im(t){return((4294901760&t)!=0?(t&=4294901760,16):0)|((4278255360&t)!=0?(t&=4278255360,8):0)|((4042322160&t)!=0?(t&=4042322160,4):0)|((3435973836&t)!=0?(t&=3435973836,2):0)|(2863311530&t)!=0}function ib(t,e,a,i,o){let n=1<<a;if(1==n)return[e[i]];if(2==n)return[t.G.add(e[i],e[i+o]),t.G.sub(e[i],e[i+o])];let l=n>>1,r=ib(t,e,a-1,i,2*o),s=ib(t,e,a-1,i+o,2*o),c=Array(n);for(let e=0;e<l;e++)c[e]=t.G.add(r[e],t.opMulGF(s[e],t.roots[a][e])),c[e+l]=t.G.sub(r[e],t.opMulGF(s[e],t.roots[a][e]));return c}class iL{constructor(t){this.type="F1",this.one=BigInt(1),this.zero=BigInt(0),this.p=BigInt(t),this.m=1,this.negone=this.p-this.one,this.two=BigInt(2),this.half=this.p>>this.one,this.bitLength=a2(this.p),this.mask=(this.one<<BigInt(this.bitLength))-this.one,this.n64=Math.floor((this.bitLength-1)/64)+1,this.n32=2*this.n64,this.n8=8*this.n64,this.R=this.e(this.one<<BigInt(64*this.n64)),this.Ri=this.inv(this.R);let e=this.negone>>this.one;this.nqr=this.two;let a=this.pow(this.nqr,e);for(;!this.eq(a,this.negone);)this.nqr=this.nqr+this.one,a=this.pow(this.nqr,e);for(this.s=0,this.t=this.negone;(this.t&this.one)==this.zero;)this.s=this.s+1,this.t=this.t>>this.one;this.nqr_to_t=this.pow(this.nqr,this.t),function(t){if(t.m%2==1){if(a9(a5(t.p,4),1)){if(a9(a5(t.p,8),1)){if(a9(a5(t.p,16),1))(function(t){for(t.sqrt_q=a6(t.p,t.m),t.sqrt_s=0,t.sqrt_t=a4(t.sqrt_q,1);!a0(t.sqrt_t);)t.sqrt_s=t.sqrt_s+1,t.sqrt_t=a7(t.sqrt_t,2);let e=t.one;for(;t.eq(e,t.one);){let a=t.random();t.sqrt_z=t.pow(a,t.sqrt_t),e=t.pow(t.sqrt_z,2**(t.sqrt_s-1))}t.sqrt_tm1d2=a7(a4(t.sqrt_t,1),2),t.sqrt=function(t){if(this.isZero(t))return this.zero;let e=this.pow(t,this.sqrt_tm1d2),a=this.pow(this.mul(this.square(e),t),2**(this.sqrt_s-1));if(this.eq(a,this.negone))return null;let i=this.sqrt_s,o=this.mul(t,e),n=this.mul(o,e),l=this.sqrt_z;for(;!this.eq(n,this.one);){let t=this.square(n),a=1;for(;!this.eq(t,this.one);)t=this.square(t),a++;e=l;for(let t=0;t<i-a-1;t++)e=this.square(e);l=this.square(e),n=this.mul(n,l),o=this.mul(o,e),i=a}return this.geq(o,this.zero)?o:this.neg(o)}})(t);else if(a9(a5(t.p,16),9))t.sqrt=function(){throw Error("Sqrt alg 4 not implemented")};else throw Error("Field withot sqrt")}else if(a9(a5(t.p,8),5))t.sqrt=function(){throw Error("Sqrt alg 3 not implemented")};else throw Error("Field withot sqrt")}else a9(a5(t.p,4),3)&&(t.sqrt_q=a6(t.p,t.m),t.sqrt_e1=a7(a4(t.sqrt_q,3),4),t.sqrt=function(e){if(this.isZero(e))return this.zero;let a=this.pow(e,this.sqrt_e1),i=this.mul(this.square(a),e);if(this.eq(i,this.negone))return null;let o=this.mul(a,e);return t.geq(o,t.zero)?o:t.neg(o)})}else{let e=a5(a6(t.p,t.m/2),4);1==e?t.sqrt=function(){throw Error("Sqrt alg 10 not implemented")}:3==e?(t.sqrt_q=a6(t.p,t.m/2),t.sqrt_e34=a7(a4(t.sqrt_q,3),4),t.sqrt_e12=a7(a4(t.sqrt_q,1),2),t.frobenius=function(e,a){return e%2==1?t.conjugate(a):a},t.sqrt=function(t){let e;let a=this.pow(t,this.sqrt_e34),i=this.mul(this.square(a),t),o=this.mul(this.frobenius(1,i),i);if(this.eq(o,this.negone))return null;let n=this.mul(a,t);if(this.eq(i,this.negone))e=this.mul(n,[this.F.zero,this.F.one]);else{let t=this.pow(this.add(this.one,i),this.sqrt_e12);e=this.mul(t,n)}return this.geq(e,this.zero)?e:this.neg(e)}):t.sqrt=function(){throw Error("Sqrt alg 8 not implemented")}}}(this),this.FFT=new i_(this,this,this.mul.bind(this)),this.fft=this.FFT.fft.bind(this.FFT),this.ifft=this.FFT.ifft.bind(this.FFT),this.w=this.FFT.w,this.wi=this.FFT.wi,this.shift=this.square(this.nqr),this.k=this.exp(this.nqr,2**this.s)}e(t,e){let a;if(e?16==e&&(a=BigInt("0x"+t)):a=BigInt(t),!(a<0))return a>=this.p?a%this.p:a;{let t=-a;return t>=this.p&&(t%=this.p),this.p-t}}add(t,e){let a=t+e;return a>=this.p?a-this.p:a}sub(t,e){return t>=e?t-e:this.p-e+t}neg(t){return t?this.p-t:t}mul(t,e){return t*e%this.p}mulScalar(t,e){return t*this.e(e)%this.p}square(t){return t*t%this.p}eq(t,e){return t==e}neq(t,e){return t!=e}lt(t,e){return(t>this.half?t-this.p:t)<(e>this.half?e-this.p:e)}gt(t,e){return(t>this.half?t-this.p:t)>(e>this.half?e-this.p:e)}leq(t,e){return(t>this.half?t-this.p:t)<=(e>this.half?e-this.p:e)}geq(t,e){return(t>this.half?t-this.p:t)>=(e>this.half?e-this.p:e)}div(t,e){return this.mul(t,this.inv(e))}idiv(t,e){if(!e)throw Error("Division by zero");return t/e}inv(t){if(!t)throw Error("Division by zero");let e=this.zero,a=this.p,i=this.one,o=t%this.p;for(;o;){let t=a/o;[e,i]=[i,e-t*i],[a,o]=[o,a-t*o]}return e<this.zero&&(e+=this.p),e}mod(t,e){return t%e}pow(t,e){return ic(this,t,e)}exp(t,e){return ic(this,t,e)}band(t,e){let a=t&e&this.mask;return a>=this.p?a-this.p:a}bor(t,e){let a=(t|e)&this.mask;return a>=this.p?a-this.p:a}bxor(t,e){let a=(t^e)&this.mask;return a>=this.p?a-this.p:a}bnot(t){let e=t^this.mask;return e>=this.p?e-this.p:e}shl(t,e){if(Number(e)<this.bitLength){let a=t<<e&this.mask;return a>=this.p?a-this.p:a}{let a=this.p-e;return Number(a)<this.bitLength?t>>a:this.zero}}shr(t,e){if(Number(e)<this.bitLength)return t>>e;{let a=this.p-e;if(!(Number(a)<this.bitLength))return 0;{let e=t<<a&this.mask;return e>=this.p?e-this.p:e}}}land(t,e){return t&&e?this.one:this.zero}lor(t,e){return t||e?this.one:this.zero}lnot(t){return t?this.zero:this.one}sqrt_old(t){if(t==this.zero)return this.zero;if(this.pow(t,this.negone>>this.one)!=this.one)return null;let e=this.s,a=this.nqr_to_t,i=this.pow(t,this.t),o=this.pow(t,this.add(this.t,this.one)>>this.one);for(;i!=this.one;){let t=this.square(i),n=1;for(;t!=this.one;)n++,t=this.square(t);let l=a;for(let t=0;t<e-n-1;t++)l=this.square(l);e=n,a=this.square(l),i=this.mul(i,a),o=this.mul(o,l)}return o>this.p>>this.one&&(o=this.neg(o)),o}normalize(t,e){if(!((t=BigInt(t,e))<0))return t>=this.p?t%this.p:t;{let e=-t;return e>=this.p&&(e%=this.p),this.p-e}}random(){let t=2*this.bitLength/8,e=this.zero;for(let a=0;a<t;a++)e=(e<<BigInt(8))+BigInt(ih(1)[0]);return e%this.p}toString(t,e){return e=e||10,t>this.half&&10==e?"-"+(this.p-t).toString(e):t.toString(e)}isZero(t){return t==this.zero}fromRng(t){let e;do{e=this.zero;for(let a=0;a<this.n64;a++)e+=t.nextU64()<<BigInt(64*a);e&=this.mask}while(e>=this.p);return e*this.Ri%this.p}fft(t){return this.FFT.fft(t)}ifft(t){return this.FFT.ifft(t)}toRprLE(t,e,a){ia(t,e,a,8*this.n64)}toRprBE(t,e,a){!function(t,e,a,i){let o="0000000"+a.toString(16),n=new DataView(t.buffer,t.byteOffset+e,i),l=((o.length-7)*4-1>>5)+1;for(let t=0;t<l;t++)n.setUint32(i-4*t-4,parseInt(o.substring(o.length-8*t-8,o.length-8*t),16),!1);for(let t=0;t<i/4-l;t++)n[t]=0}(t,e,a,8*this.n64)}toRprBEM(t,e,a){return this.toRprBE(t,e,this.mul(this.R,a))}toRprLEM(t,e,a){return this.toRprLE(t,e,this.mul(this.R,a))}fromRprLE(t,e){return ii(t,e,this.n8)}fromRprBE(t,e){return function(t,e,a){a=a||t.byteLength,e=e||0;let i=new DataView(t.buffer,t.byteOffset+e,a),o=Array(a/4);for(let t=0;t<a/4;t++)o[t]=i.getUint32(4*t,!1).toString(16).padStart(8,"0");return aX(o.join(""),16)}(t,e,this.n8)}fromRprLEM(t,e){return this.mul(this.fromRprLE(t,e),this.Ri)}fromRprBEM(t,e){return this.mul(this.fromRprBE(t,e),this.Ri)}toObject(t){return t}}function iw(t){if("bigint"==typeof t||void 0!==t.eq)return t.toString(10);if(t instanceof Uint8Array)return Scalar.fromRprLE(t,0);if(Array.isArray(t))return t.map(iw);{if("object"!=typeof t)return t;let e={};return Object.keys(t).forEach(a=>{e[a]=iw(t[a])}),e}}function iy(t){if("string"==typeof t&&/^[0-9]+$/.test(t)||"string"==typeof t&&/^0x[0-9a-fA-F]+$/.test(t))return BigInt(t);if(Array.isArray(t))return t.map(iy);{if("object"!=typeof t)return t;if(null===t)return null;let e={};return Object.keys(t).forEach(a=>{e[a]=iy(t[a])}),e}}let iA=[];for(let t=0;t<256;t++)iA[t]=function(t,e){let a=0,i=t;for(let t=0;t<8;t++)a<<=1,a|=1&i,i>>=1;return a}(t,0);function iC(t){return((4294901760&t)!=0?(t&=4294901760,16):0)|((4278255360&t)!=0?(t&=4278255360,8):0)|((4042322160&t)!=0?(t&=4042322160,4):0)|((3435973836&t)!=0?(t&=3435973836,2):0)|(2863311530&t)!=0}function iI(t,e){let a=new Uint8Array(e*t.length);for(let i=0;i<t.length;i++)a.set(t[i],i*e);return a}function iF(t,e){let a=t.byteLength/e,i=Array(a);for(let o=0;o<a;o++)i[o]=t.slice(o*e,o*e+e);return i}class ix{constructor(t){this.buffers=[],this.byteLength=t;for(let e=0;e<t;e+=1073741824){let a=Math.min(t-e,1073741824);this.buffers.push(new Uint8Array(a))}}slice(t,e){let a;void 0===e&&(e=this.byteLength),void 0===t&&(t=0);let i=e-t,o=Math.floor(t/1073741824);if(o==Math.floor((t+i-1)/1073741824)||0==i)return this.buffers[o].slice(t%1073741824,t%1073741824+i);let n=o,l=t%1073741824,r=i;for(;r>0;){let t=l+r>1073741824?1073741824-l:r,e=new Uint8Array(this.buffers[n].buffer,this.buffers[n].byteOffset+l,t);if(t==i)return e.slice();a||(a=i<=1073741824?new Uint8Array(i):new ix(i)),a.set(e,i-r),r-=t,n++,l=0}return a}set(t,e){void 0===e&&(e=0);let a=t.byteLength;if(0==a)return;let i=Math.floor(e/1073741824);if(i==Math.floor((e+a-1)/1073741824))return t instanceof ix&&1==t.buffers.length?this.buffers[i].set(t.buffers[0],e%1073741824):this.buffers[i].set(t,e%1073741824);let o=i,n=e%1073741824,l=a;for(;l>0;){let e=n+l>1073741824?1073741824-n:l,i=t.slice(a-l,a-l+e);new Uint8Array(this.buffers[o].buffer,this.buffers[o].byteOffset+n,e).set(i),l-=e,o++,n=0}}}function iE(t,e,a,i){return async function(o){let n;let l=Math.floor(o.byteLength/a);if(l*a!==o.byteLength)throw Error("Invalid buffer size");let r=Math.floor(l/t.concurrency),s=[];for(let n=0;n<t.concurrency;n++){let c;if(0==(c=n<t.concurrency-1?r:l-n*r))continue;let d=[{cmd:"ALLOCSET",var:0,buff:o.slice(n*r*a,n*r*a+c*a)},{cmd:"ALLOC",var:1,len:i*c},{cmd:"CALL",fnName:e,params:[{var:0},{val:c},{var:1}]},{cmd:"GET",out:0,var:1,len:i*c}];s.push(t.queueAction(d))}let c=await Promise.all(s);n=o instanceof ix?new ix(l*i):new Uint8Array(l*i);let d=0;for(let t=0;t<c.length;t++)n.set(c[t][0],d),d+=c[t][0].byteLength;return n}}class iv{constructor(t,e,a,i){if(this.tm=t,this.prefix=e,this.p=i,this.n8=a,this.type="F1",this.m=1,this.half=a3(i,ir),this.bitLength=a2(i),this.mask=a4(a1(ir,this.bitLength),ir),this.pOp1=t.alloc(a),this.pOp2=t.alloc(a),this.pOp3=t.alloc(a),this.tm.instance.exports[e+"_zero"](this.pOp1),this.zero=this.tm.getBuff(this.pOp1,this.n8),this.tm.instance.exports[e+"_one"](this.pOp1),this.one=this.tm.getBuff(this.pOp1,this.n8),this.negone=this.neg(this.one),this.two=this.add(this.one,this.one),this.n64=Math.floor(a/8),this.n32=Math.floor(a/4),8*this.n64!=this.n8)throw Error("n8 must be a multiple of 8");this.half=a3(this.p,ir),this.nqr=this.two;let o=this.exp(this.nqr,this.half);for(;!this.eq(o,this.negone);)this.nqr=this.add(this.nqr,this.one),o=this.exp(this.nqr,this.half);this.shift=this.mul(this.nqr,this.nqr),this.shiftInv=this.inv(this.shift),this.s=0;let n=a4(this.p,ir);for(;!a0(n);)this.s=this.s+1,n=a3(n,ir);this.w=[],this.w[this.s]=this.exp(this.nqr,n);for(let t=this.s-1;t>=0;t--)this.w[t]=this.square(this.w[t+1]);if(!this.eq(this.w[0],this.one))throw Error("Error calculating roots of unity");this.batchToMontgomery=iE(t,e+"_batchToMontgomery",this.n8,this.n8),this.batchFromMontgomery=iE(t,e+"_batchFromMontgomery",this.n8,this.n8)}op2(t,e,a){return this.tm.setBuff(this.pOp1,e),this.tm.setBuff(this.pOp2,a),this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp2,this.pOp3),this.tm.getBuff(this.pOp3,this.n8)}op2Bool(t,e,a){return this.tm.setBuff(this.pOp1,e),this.tm.setBuff(this.pOp2,a),!!this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp2)}op1(t,e){return this.tm.setBuff(this.pOp1,e),this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp3),this.tm.getBuff(this.pOp3,this.n8)}op1Bool(t,e){return this.tm.setBuff(this.pOp1,e),!!this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp3)}add(t,e){return this.op2("_add",t,e)}eq(t,e){return this.op2Bool("_eq",t,e)}isZero(t){return this.op1Bool("_isZero",t)}sub(t,e){return this.op2("_sub",t,e)}neg(t){return this.op1("_neg",t)}inv(t){return this.op1("_inverse",t)}toMontgomery(t){return this.op1("_toMontgomery",t)}fromMontgomery(t){return this.op1("_fromMontgomery",t)}mul(t,e){return this.op2("_mul",t,e)}div(t,e){return this.tm.setBuff(this.pOp1,t),this.tm.setBuff(this.pOp2,e),this.tm.instance.exports[this.prefix+"_inverse"](this.pOp2,this.pOp2),this.tm.instance.exports[this.prefix+"_mul"](this.pOp1,this.pOp2,this.pOp3),this.tm.getBuff(this.pOp3,this.n8)}square(t){return this.op1("_square",t)}isSquare(t){return this.op1Bool("_isSquare",t)}sqrt(t){return this.op1("_sqrt",t)}exp(t,e){return e instanceof Uint8Array||(e=io(aX(e))),this.tm.setBuff(this.pOp1,t),this.tm.setBuff(this.pOp2,e),this.tm.instance.exports[this.prefix+"_exp"](this.pOp1,this.pOp2,e.byteLength,this.pOp3),this.tm.getBuff(this.pOp3,this.n8)}isNegative(t){return this.op1Bool("_isNegative",t)}e(t,e){if(t instanceof Uint8Array)return t;let a=aX(t,e);BigInt(a)<BigInt(0)?(it(a=-BigInt(a),this.p)&&(a=a5(a,this.p)),a=a4(this.p,a)):it(a,this.p)&&(a=a5(a,this.p));let i=function(t,e){let a=t;void 0===e&&0==(e=Math.floor((a2(t)-1)/8)+1)&&(e=1);let i=new Uint8Array(e),o=new DataView(i.buffer),n=0;for(;n<e;)n+4<=e?(o.setUint32(n,Number(a&BigInt(4294967295)),!0),n+=4,a>>=BigInt(32)):n+2<=e?(o.setUint16(n,Number(a&BigInt(65535)),!0),n+=2,a>>=BigInt(16)):(o.setUint8(n,Number(a&BigInt(255)),!0),n+=1,a>>=BigInt(8));if(a)throw Error("Number does not fit in this length");return i}(a,this.n8);return this.toMontgomery(i)}toString(t,e){return ii(this.fromMontgomery(t),0).toString(e)}fromRng(t){var e,a;let i;let o=new Uint8Array(this.n8);do{i=il;for(let e=0;e<this.n64;e++)i=a8(i,a1(t.nextU64(),64*e));i=ie(i,this.mask)}while(e=i,a=this.p,BigInt(e)>=BigInt(a));return ia(o,0,i,this.n8),o}random(){return this.fromRng(ip())}toObject(t){return ii(this.fromMontgomery(t),0)}fromObject(t){let e=new Uint8Array(this.n8);return ia(e,0,t,this.n8),this.toMontgomery(e)}toRprLE(t,e,a){t.set(this.fromMontgomery(a),e)}toRprBE(t,e,a){let i=this.fromMontgomery(a);for(let t=0;t<this.n8/2;t++){let e=i[t];i[t]=i[this.n8-1-t],i[this.n8-1-t]=e}t.set(i,e)}fromRprLE(t,e){e=e||0;let a=t.slice(e,e+this.n8);return this.toMontgomery(a)}async batchInverse(t){let e,a=!1,i=this.n8,o=this.n8;Array.isArray(t)?(t=iI(t,i),a=!0):t=t.slice(0,t.byteLength);let n=Math.floor(t.byteLength/i);if(n*i!==t.byteLength)throw Error("Invalid buffer size");let l=Math.floor(n/this.tm.concurrency),r=[];for(let e=0;e<this.tm.concurrency;e++){let a;if(0==(a=e<this.tm.concurrency-1?l:n-e*l))continue;let s=[{cmd:"ALLOCSET",var:0,buff:t.slice(e*l*i,e*l*i+a*i)},{cmd:"ALLOC",var:1,len:o*a},{cmd:"CALL",fnName:this.prefix+"_batchInverse",params:[{var:0},{val:i},{val:a},{var:1},{val:o}]},{cmd:"GET",out:0,var:1,len:o*a}];r.push(this.tm.queueAction(s))}let s=await Promise.all(r);e=t instanceof ix?new ix(n*o):new Uint8Array(n*o);let c=0;for(let t=0;t<s.length;t++)e.set(s[t][0],c),c+=s[t][0].byteLength;return a?iF(e,o):e}}class iB{constructor(t,e,a){this.tm=t,this.prefix=e,this.F=a,this.type="F2",this.m=2*a.m,this.n8=2*this.F.n8,this.n32=2*this.F.n32,this.n64=2*this.F.n64,this.pOp1=t.alloc(2*a.n8),this.pOp2=t.alloc(2*a.n8),this.pOp3=t.alloc(2*a.n8),this.tm.instance.exports[e+"_zero"](this.pOp1),this.zero=t.getBuff(this.pOp1,this.n8),this.tm.instance.exports[e+"_one"](this.pOp1),this.one=t.getBuff(this.pOp1,this.n8),this.negone=this.neg(this.one),this.two=this.add(this.one,this.one)}op2(t,e,a){return this.tm.setBuff(this.pOp1,e),this.tm.setBuff(this.pOp2,a),this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp2,this.pOp3),this.tm.getBuff(this.pOp3,this.n8)}op2Bool(t,e,a){return this.tm.setBuff(this.pOp1,e),this.tm.setBuff(this.pOp2,a),!!this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp2)}op1(t,e){return this.tm.setBuff(this.pOp1,e),this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp3),this.tm.getBuff(this.pOp3,this.n8)}op1Bool(t,e){return this.tm.setBuff(this.pOp1,e),!!this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp3)}add(t,e){return this.op2("_add",t,e)}eq(t,e){return this.op2Bool("_eq",t,e)}isZero(t){return this.op1Bool("_isZero",t)}sub(t,e){return this.op2("_sub",t,e)}neg(t){return this.op1("_neg",t)}inv(t){return this.op1("_inverse",t)}isNegative(t){return this.op1Bool("_isNegative",t)}toMontgomery(t){return this.op1("_toMontgomery",t)}fromMontgomery(t){return this.op1("_fromMontgomery",t)}mul(t,e){return this.op2("_mul",t,e)}mul1(t,e){return this.op2("_mul1",t,e)}div(t,e){return this.tm.setBuff(this.pOp1,t),this.tm.setBuff(this.pOp2,e),this.tm.instance.exports[this.prefix+"_inverse"](this.pOp2,this.pOp2),this.tm.instance.exports[this.prefix+"_mul"](this.pOp1,this.pOp2,this.pOp3),this.tm.getBuff(this.pOp3,this.n8)}square(t){return this.op1("_square",t)}isSquare(t){return this.op1Bool("_isSquare",t)}sqrt(t){return this.op1("_sqrt",t)}exp(t,e){return e instanceof Uint8Array||(e=io(aX(e))),this.tm.setBuff(this.pOp1,t),this.tm.setBuff(this.pOp2,e),this.tm.instance.exports[this.prefix+"_exp"](this.pOp1,this.pOp2,e.byteLength,this.pOp3),this.tm.getBuff(this.pOp3,this.n8)}e(t,e){if(t instanceof Uint8Array)return t;if(Array.isArray(t)&&2==t.length){let a=this.F.e(t[0],e),i=this.F.e(t[1],e),o=new Uint8Array(2*this.F.n8);return o.set(a),o.set(i,2*this.F.n8),o}throw Error("invalid F2")}toString(t,e){let a=this.F.toString(t.slice(0,this.F.n8),e),i=this.F.toString(t.slice(this.F.n8),e);return`[${a}, ${i}]`}fromRng(t){let e=this.F.fromRng(t),a=this.F.fromRng(t),i=new Uint8Array(2*this.F.n8);return i.set(e),i.set(a,this.F.n8),i}random(){return this.fromRng(ip())}toObject(t){return[this.F.toObject(t.slice(0,this.F.n8)),this.F.toObject(t.slice(this.F.n8,2*this.F.n8))]}fromObject(t){let e=new Uint8Array(2*this.F.n8),a=this.F.fromObject(t[0]),i=this.F.fromObject(t[1]);return e.set(a),e.set(i,this.F.n8),e}c1(t){return t.slice(0,this.F.n8)}c2(t){return t.slice(this.F.n8)}}class iS{constructor(t,e,a){this.tm=t,this.prefix=e,this.F=a,this.type="F3",this.m=3*a.m,this.n8=3*this.F.n8,this.n32=3*this.F.n32,this.n64=3*this.F.n64,this.pOp1=t.alloc(3*a.n8),this.pOp2=t.alloc(3*a.n8),this.pOp3=t.alloc(3*a.n8),this.tm.instance.exports[e+"_zero"](this.pOp1),this.zero=t.getBuff(this.pOp1,this.n8),this.tm.instance.exports[e+"_one"](this.pOp1),this.one=t.getBuff(this.pOp1,this.n8),this.negone=this.neg(this.one),this.two=this.add(this.one,this.one)}op2(t,e,a){return this.tm.setBuff(this.pOp1,e),this.tm.setBuff(this.pOp2,a),this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp2,this.pOp3),this.tm.getBuff(this.pOp3,this.n8)}op2Bool(t,e,a){return this.tm.setBuff(this.pOp1,e),this.tm.setBuff(this.pOp2,a),!!this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp2)}op1(t,e){return this.tm.setBuff(this.pOp1,e),this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp3),this.tm.getBuff(this.pOp3,this.n8)}op1Bool(t,e){return this.tm.setBuff(this.pOp1,e),!!this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp3)}eq(t,e){return this.op2Bool("_eq",t,e)}isZero(t){return this.op1Bool("_isZero",t)}add(t,e){return this.op2("_add",t,e)}sub(t,e){return this.op2("_sub",t,e)}neg(t){return this.op1("_neg",t)}inv(t){return this.op1("_inverse",t)}isNegative(t){return this.op1Bool("_isNegative",t)}toMontgomery(t){return this.op1("_toMontgomery",t)}fromMontgomery(t){return this.op1("_fromMontgomery",t)}mul(t,e){return this.op2("_mul",t,e)}div(t,e){return this.tm.setBuff(this.pOp1,t),this.tm.setBuff(this.pOp2,e),this.tm.instance.exports[this.prefix+"_inverse"](this.pOp2,this.pOp2),this.tm.instance.exports[this.prefix+"_mul"](this.pOp1,this.pOp2,this.pOp3),this.tm.getBuff(this.pOp3,this.n8)}square(t){return this.op1("_square",t)}isSquare(t){return this.op1Bool("_isSquare",t)}sqrt(t){return this.op1("_sqrt",t)}exp(t,e){return e instanceof Uint8Array||(e=io(aX(e))),this.tm.setBuff(this.pOp1,t),this.tm.setBuff(this.pOp2,e),this.tm.instance.exports[this.prefix+"_exp"](this.pOp1,this.pOp2,e.byteLength,this.pOp3),this.getBuff(this.pOp3,this.n8)}e(t,e){if(t instanceof Uint8Array)return t;if(Array.isArray(t)&&3==t.length){let a=this.F.e(t[0],e),i=this.F.e(t[1],e),o=this.F.e(t[2],e),n=new Uint8Array(3*this.F.n8);return n.set(a),n.set(i,this.F.n8),n.set(o,2*this.F.n8),n}throw Error("invalid F3")}toString(t,e){let a=this.F.toString(t.slice(0,this.F.n8),e),i=this.F.toString(t.slice(this.F.n8,2*this.F.n8),e),o=this.F.toString(t.slice(2*this.F.n8),e);return`[${a}, ${i}, ${o}]`}fromRng(t){let e=this.F.fromRng(t),a=this.F.fromRng(t),i=this.F.fromRng(t),o=new Uint8Array(3*this.F.n8);return o.set(e),o.set(a,this.F.n8),o.set(i,2*this.F.n8),o}random(){return this.fromRng(ip())}toObject(t){return[this.F.toObject(t.slice(0,this.F.n8)),this.F.toObject(t.slice(this.F.n8,2*this.F.n8)),this.F.toObject(t.slice(2*this.F.n8,3*this.F.n8))]}fromObject(t){let e=new Uint8Array(3*this.F.n8),a=this.F.fromObject(t[0]),i=this.F.fromObject(t[1]),o=this.F.fromObject(t[2]);return e.set(a),e.set(i,this.F.n8),e.set(o,2*this.F.n8),e}c1(t){return t.slice(0,this.F.n8)}c2(t){return t.slice(this.F.n8,2*this.F.n8)}c3(t){return t.slice(2*this.F.n8)}}class iO{constructor(t,e,a,i,o,n){this.tm=t,this.prefix=e,this.F=a,this.pOp1=t.alloc(3*a.n8),this.pOp2=t.alloc(3*a.n8),this.pOp3=t.alloc(3*a.n8),this.tm.instance.exports[e+"_zero"](this.pOp1),this.zero=this.tm.getBuff(this.pOp1,3*a.n8),this.tm.instance.exports[e+"_zeroAffine"](this.pOp1),this.zeroAffine=this.tm.getBuff(this.pOp1,2*a.n8),this.one=this.tm.getBuff(i,3*a.n8),this.g=this.one,this.oneAffine=this.tm.getBuff(i,2*a.n8),this.gAffine=this.oneAffine,this.b=this.tm.getBuff(o,a.n8),n&&(this.cofactor=io(n)),this.negone=this.neg(this.one),this.two=this.add(this.one,this.one),this.batchLEMtoC=iE(t,e+"_batchLEMtoC",2*a.n8,a.n8),this.batchLEMtoU=iE(t,e+"_batchLEMtoU",2*a.n8,2*a.n8),this.batchCtoLEM=iE(t,e+"_batchCtoLEM",a.n8,2*a.n8),this.batchUtoLEM=iE(t,e+"_batchUtoLEM",2*a.n8,2*a.n8),this.batchToJacobian=iE(t,e+"_batchToJacobian",2*a.n8,3*a.n8),this.batchToAffine=iE(t,e+"_batchToAffine",3*a.n8,2*a.n8)}op2(t,e,a){return this.tm.setBuff(this.pOp1,e),this.tm.setBuff(this.pOp2,a),this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp2,this.pOp3),this.tm.getBuff(this.pOp3,3*this.F.n8)}op2bool(t,e,a){return this.tm.setBuff(this.pOp1,e),this.tm.setBuff(this.pOp2,a),!!this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp2,this.pOp3)}op1(t,e){return this.tm.setBuff(this.pOp1,e),this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp3),this.tm.getBuff(this.pOp3,3*this.F.n8)}op1Affine(t,e){return this.tm.setBuff(this.pOp1,e),this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp3),this.tm.getBuff(this.pOp3,2*this.F.n8)}op1Bool(t,e){return this.tm.setBuff(this.pOp1,e),!!this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp3)}add(t,e){if(t.byteLength==3*this.F.n8){if(e.byteLength==3*this.F.n8)return this.op2("_add",t,e);if(e.byteLength==2*this.F.n8)return this.op2("_addMixed",t,e);throw Error("invalid point size")}if(t.byteLength==2*this.F.n8){if(e.byteLength==3*this.F.n8)return this.op2("_addMixed",e,t);if(e.byteLength==2*this.F.n8)return this.op2("_addAffine",t,e)}throw Error("invalid point size")}sub(t,e){if(t.byteLength==3*this.F.n8){if(e.byteLength==3*this.F.n8)return this.op2("_sub",t,e);if(e.byteLength==2*this.F.n8)return this.op2("_subMixed",t,e);throw Error("invalid point size")}if(t.byteLength==2*this.F.n8){if(e.byteLength==3*this.F.n8)return this.op2("_subMixed",e,t);if(e.byteLength==2*this.F.n8)return this.op2("_subAffine",t,e)}throw Error("invalid point size")}neg(t){if(t.byteLength==3*this.F.n8)return this.op1("_neg",t);if(t.byteLength==2*this.F.n8)return this.op1Affine("_negAffine",t);throw Error("invalid point size")}double(t){if(t.byteLength==3*this.F.n8)return this.op1("_double",t);if(t.byteLength==2*this.F.n8)return this.op1("_doubleAffine",t);throw Error("invalid point size")}isZero(t){if(t.byteLength==3*this.F.n8)return this.op1Bool("_isZero",t);if(t.byteLength==2*this.F.n8)return this.op1Bool("_isZeroAffine",t);throw Error("invalid point size")}timesScalar(t,e){let a;if(e instanceof Uint8Array||(e=io(aX(e))),t.byteLength==3*this.F.n8)a=this.prefix+"_timesScalar";else if(t.byteLength==2*this.F.n8)a=this.prefix+"_timesScalarAffine";else throw Error("invalid point size");return this.tm.setBuff(this.pOp1,t),this.tm.setBuff(this.pOp2,e),this.tm.instance.exports[a](this.pOp1,this.pOp2,e.byteLength,this.pOp3),this.tm.getBuff(this.pOp3,3*this.F.n8)}timesFr(t,e){let a;if(t.byteLength==3*this.F.n8)a=this.prefix+"_timesFr";else if(t.byteLength==2*this.F.n8)a=this.prefix+"_timesFrAffine";else throw Error("invalid point size");return this.tm.setBuff(this.pOp1,t),this.tm.setBuff(this.pOp2,e),this.tm.instance.exports[a](this.pOp1,this.pOp2,this.pOp3),this.tm.getBuff(this.pOp3,3*this.F.n8)}eq(t,e){if(t.byteLength==3*this.F.n8){if(e.byteLength==3*this.F.n8)return this.op2bool("_eq",t,e);if(e.byteLength==2*this.F.n8)return this.op2bool("_eqMixed",t,e);throw Error("invalid point size")}if(t.byteLength==2*this.F.n8){if(e.byteLength==3*this.F.n8)return this.op2bool("_eqMixed",e,t);if(e.byteLength==2*this.F.n8)return this.op2bool("_eqAffine",t,e)}throw Error("invalid point size")}toAffine(t){if(t.byteLength==3*this.F.n8)return this.op1Affine("_toAffine",t);if(t.byteLength==2*this.F.n8)return t;throw Error("invalid point size")}toJacobian(t){if(t.byteLength==3*this.F.n8)return t;if(t.byteLength==2*this.F.n8)return this.op1("_toJacobian",t);throw Error("invalid point size")}toRprUncompressed(t,e,a){if(this.tm.setBuff(this.pOp1,a),a.byteLength==3*this.F.n8)this.tm.instance.exports[this.prefix+"_toAffine"](this.pOp1,this.pOp1);else if(a.byteLength!=2*this.F.n8)throw Error("invalid point size");this.tm.instance.exports[this.prefix+"_LEMtoU"](this.pOp1,this.pOp1);let i=this.tm.getBuff(this.pOp1,2*this.F.n8);t.set(i,e)}fromRprUncompressed(t,e){let a=t.slice(e,e+2*this.F.n8);return this.tm.setBuff(this.pOp1,a),this.tm.instance.exports[this.prefix+"_UtoLEM"](this.pOp1,this.pOp1),this.tm.getBuff(this.pOp1,2*this.F.n8)}toRprCompressed(t,e,a){if(this.tm.setBuff(this.pOp1,a),a.byteLength==3*this.F.n8)this.tm.instance.exports[this.prefix+"_toAffine"](this.pOp1,this.pOp1);else if(a.byteLength!=2*this.F.n8)throw Error("invalid point size");this.tm.instance.exports[this.prefix+"_LEMtoC"](this.pOp1,this.pOp1);let i=this.tm.getBuff(this.pOp1,this.F.n8);t.set(i,e)}fromRprCompressed(t,e){let a=t.slice(e,e+this.F.n8);return this.tm.setBuff(this.pOp1,a),this.tm.instance.exports[this.prefix+"_CtoLEM"](this.pOp1,this.pOp2),this.tm.getBuff(this.pOp2,2*this.F.n8)}toUncompressed(t){let e=new Uint8Array(2*this.F.n8);return this.toRprUncompressed(e,0,t),e}toRprLEM(t,e,a){if(a.byteLength==2*this.F.n8){t.set(a,e);return}if(a.byteLength==3*this.F.n8){this.tm.setBuff(this.pOp1,a),this.tm.instance.exports[this.prefix+"_toAffine"](this.pOp1,this.pOp1);let i=this.tm.getBuff(this.pOp1,2*this.F.n8);t.set(i,e)}else throw Error("invalid point size")}fromRprLEM(t,e){return e=e||0,t.slice(e,e+2*this.F.n8)}toString(t,e){if(t.byteLength==3*this.F.n8){let a=this.F.toString(t.slice(0,this.F.n8),e),i=this.F.toString(t.slice(this.F.n8,2*this.F.n8),e),o=this.F.toString(t.slice(2*this.F.n8),e);return`[ ${a}, ${i}, ${o} ]`}if(t.byteLength==2*this.F.n8){let a=this.F.toString(t.slice(0,this.F.n8),e),i=this.F.toString(t.slice(this.F.n8),e);return`[ ${a}, ${i} ]`}throw Error("invalid point size")}isValid(t){if(this.isZero(t))return!0;let e=this.F,a=this.toAffine(t),i=a.slice(0,this.F.n8),o=a.slice(this.F.n8,2*this.F.n8),n=e.add(e.mul(e.square(i),i),this.b),l=e.square(o);return e.eq(n,l)}fromRng(t){let e,a;let i=this.F,o=[];do o[0]=i.fromRng(t),e=t.nextBool(),a=i.add(i.mul(i.square(o[0]),o[0]),this.b);while(!i.isSquare(a));o[1]=i.sqrt(a),e^i.isNegative(o[1])&&(o[1]=i.neg(o[1]));let n=new Uint8Array(2*this.F.n8);return n.set(o[0]),n.set(o[1],this.F.n8),this.cofactor&&(n=this.timesScalar(n,this.cofactor)),n}toObject(t){return this.isZero(t)?[this.F.toObject(this.F.zero),this.F.toObject(this.F.one),this.F.toObject(this.F.zero)]:[this.F.toObject(t.slice(0,this.F.n8)),this.F.toObject(t.slice(this.F.n8,2*this.F.n8)),t.byteLength==3*this.F.n8?this.F.toObject(t.slice(2*this.F.n8,3*this.F.n8)):this.F.toObject(this.F.one)]}fromObject(t){let e;let a=this.F.fromObject(t[0]),i=this.F.fromObject(t[1]);if(e=3==t.length?this.F.fromObject(t[2]):this.F.one,this.F.isZero(e,this.F.one))return this.zeroAffine;if(this.F.eq(e,this.F.one)){let t=new Uint8Array(2*this.F.n8);return t.set(a),t.set(i,this.F.n8),t}{let t=new Uint8Array(3*this.F.n8);return t.set(a),t.set(i,this.F.n8),t.set(e,2*this.F.n8),t}}e(t){return t instanceof Uint8Array?t:this.fromObject(t)}x(t){return this.toAffine(t).slice(0,this.F.n8)}y(t){return this.toAffine(t).slice(this.F.n8)}}function iP(t){let e,a;async function i(t){let i=new Uint8Array(t.code),o=await WebAssembly.compile(i);a=new WebAssembly.Memory({initial:t.init,maximum:32767}),e=await WebAssembly.instantiate(o,{env:{memory:a}})}function o(t){let e=new Uint32Array(a.buffer,0,1);for(;3&e[0];)e[0]++;let i=e[0];if(e[0]+=t,e[0]+t>a.buffer.byteLength){let i=a.buffer.byteLength/65536,o=Math.floor((e[0]+t)/65536)+1;o>32767&&(o=32767),a.grow(o-i)}return i}function n(t,e){new Uint8Array(a.buffer).set(new Uint8Array(e),t)}function l(t){if("INIT"==t[0].cmd)return i(t[0]);let l={vars:[],out:[]},r=new Uint32Array(a.buffer,0,1)[0];for(let i=0;i<t.length;i++)switch(t[i].cmd){case"ALLOCSET":l.vars[t[i].var]=function(t){let e=o(t.byteLength);return n(e,t),e}(t[i].buff);break;case"ALLOC":l.vars[t[i].var]=o(t[i].len);break;case"SET":n(l.vars[t[i].var],t[i].buff);break;case"CALL":{let a=[];for(let e=0;e<t[i].params.length;e++){let o=t[i].params[e];void 0!==o.var?a.push(l.vars[o.var]+(o.offset||0)):void 0!==o.val&&a.push(o.val)}e.exports[t[i].fnName](...a);break}case"GET":l.out[t[i].out]=(function(t,e){let i=new Uint8Array(a.buffer);return new Uint8Array(i.buffer,i.byteOffset+t,e)})(l.vars[t[i].var],t[i].len).slice();break;default:throw Error("Invalid cmd")}return new Uint32Array(a.buffer,0,1)[0]=r,l.out}return t&&(t.onmessage=function(e){let a;if("INIT"==(a=e.data?e.data:e)[0].cmd)i(a[0]).then(function(){t.postMessage(a.result)});else if("TERMINATE"==a[0].cmd)t.close();else{let e=l(a);t.postMessage(e)}}),l}class iG{constructor(){this.promise=new Promise((t,e)=>{this.reject=e,this.resolve=t})}}let iT=`(${iP.toString()})(self)`;async function iq(t,e){let a=new iz;a.memory=new WebAssembly.Memory({initial:25}),a.u8=new Uint8Array(a.memory.buffer),a.u32=new Uint32Array(a.memory.buffer);let i=await WebAssembly.compile(t.code);if(a.instance=await WebAssembly.instantiate(i,{env:{memory:a.memory}}),a.singleThread=e,a.initalPFree=a.u32[0],a.pq=t.pq,a.pr=t.pr,a.pG1gen=t.pG1gen,a.pG1zero=t.pG1zero,a.pG2gen=t.pG2gen,a.pG2zero=t.pG2zero,a.pOneT=t.pOneT,e)a.code=t.code,a.taskManager=iP(),await a.taskManager([{cmd:"INIT",init:25,code:a.code.slice()}]),a.concurrency=1;else{a.workers=[],a.pendingDeferreds=[],a.working=[];let e=2;0==(e=tU.cpus().length)&&(e=2),e>64&&(e=64),a.concurrency=e;for(let t=0;t<e;t++)a.workers[t]=new tM(o),a.workers[t].addEventListener("message",function(t){return function(e){let i;i=e&&e.data?e.data:e,a.working[t]=!1,a.pendingDeferreds[t].resolve(i),a.processWorks()}}(t)),a.working[t]=!1;let i=[];for(let e=0;e<a.workers.length;e++){let o=t.code.slice();i.push(a.postAction(e,[{cmd:"INIT",init:25,code:o}],[o.buffer]))}await Promise.all(i)}return a}o="data:application/javascript;base64,"+Buffer.from(iT).toString("base64");class iz{constructor(){this.actionQueue=[],this.oldPFree=0}startSyncOp(){if(0!=this.oldPFree)throw Error("Sync operation in progress");this.oldPFree=this.u32[0]}endSyncOp(){if(0==this.oldPFree)throw Error("No sync operation in progress");this.u32[0]=this.oldPFree,this.oldPFree=0}postAction(t,e,a,i){if(this.working[t])throw Error("Posting a job t a working worker");return this.working[t]=!0,this.pendingDeferreds[t]=i||new iG,this.workers[t].postMessage(e,a),this.pendingDeferreds[t].promise}processWorks(){for(let t=0;t<this.workers.length&&this.actionQueue.length>0;t++)if(!1==this.working[t]){let e=this.actionQueue.shift();this.postAction(t,e.data,e.transfers,e.deferred)}}queueAction(t,e){let a=new iG;if(this.singleThread){let e=this.taskManager(t);a.resolve(e)}else this.actionQueue.push({data:t,transfers:e,deferred:a}),this.processWorks();return a.promise}resetMemory(){this.u32[0]=this.initalPFree}allocBuff(t){let e=this.alloc(t.byteLength);return this.setBuff(e,t),e}getBuff(t,e){return this.u8.slice(t,t+e)}setBuff(t,e){this.u8.set(new Uint8Array(e),t)}alloc(t){for(;3&this.u32[0];)this.u32[0]++;let e=this.u32[0];return this.u32[0]+=t,e}async terminate(){for(let t=0;t<this.workers.length;t++)this.workers[t].postMessage([{cmd:"TERMINATE"}]);await new Promise(t=>setTimeout(t,200))}}function iU(t,e){let a=t[e],i=t.Fr,o=t.tm;t[e].batchApplyKey=async function(t,n,l,r,s){let c,d,u,f,h,g;if(r=r||"affine",s=s||"affine","G1"==e)"jacobian"==r?(u=3*a.F.n8,c="g1m_batchApplyKey"):(u=2*a.F.n8,c="g1m_batchApplyKeyMixed"),f=3*a.F.n8,"jacobian"==s?h=3*a.F.n8:(d="g1m_batchToAffine",h=2*a.F.n8);else if("G2"==e)"jacobian"==r?(u=3*a.F.n8,c="g2m_batchApplyKey"):(u=2*a.F.n8,c="g2m_batchApplyKeyMixed"),f=3*a.F.n8,"jacobian"==s?h=3*a.F.n8:(d="g2m_batchToAffine",h=2*a.F.n8);else if("Fr"==e)c="frm_batchApplyKey",u=a.n8,f=a.n8,h=a.n8;else throw Error("Invalid group: "+e);let p=Math.floor(t.byteLength/u),_=Math.floor(p/o.concurrency),m=[];l=i.e(l);let b=i.e(n);for(let e=0;e<o.concurrency;e++){let a;if(0==(a=e<o.concurrency-1?_:p-e*_))continue;let n=[];n.push({cmd:"ALLOCSET",var:0,buff:t.slice(e*_*u,e*_*u+a*u)}),n.push({cmd:"ALLOCSET",var:1,buff:b}),n.push({cmd:"ALLOCSET",var:2,buff:l}),n.push({cmd:"ALLOC",var:3,len:a*Math.max(f,h)}),n.push({cmd:"CALL",fnName:c,params:[{var:0},{val:a},{var:1},{var:2},{var:3}]}),d&&n.push({cmd:"CALL",fnName:d,params:[{var:3},{val:a},{var:3}]}),n.push({cmd:"GET",out:0,var:3,len:a*h}),m.push(o.queueAction(n)),b=i.mul(b,i.exp(l,a))}let L=await Promise.all(m);g=t instanceof ix?new ix(p*h):new Uint8Array(p*h);let w=0;for(let t=0;t<L.length;t++)g.set(L[t][0],w),w+=L[t][0].byteLength;return g}}let iM=[1,1,1,1,2,3,4,5,6,7,7,8,9,10,11,12,13,13,14,15,16,16,17,17,17,17,17,17,17,17,17,17];function iQ(t,e){let a=t[e],i=a.tm;async function o(t,i,o,n,l){let r,s;if(!(t instanceof Uint8Array))throw n&&n.error(`${l} _multiExpChunk buffBases is not Uint8Array`),Error(`${l} _multiExpChunk buffBases is not Uint8Array`);if(!(i instanceof Uint8Array))throw n&&n.error(`${l} _multiExpChunk buffScalars is not Uint8Array`),Error(`${l} _multiExpChunk buffScalars is not Uint8Array`);if(o=o||"affine","G1"==e)"affine"==o?(s="g1m_multiexpAffine_chunk",r=2*a.F.n8):(s="g1m_multiexp_chunk",r=3*a.F.n8);else if("G2"==e)"affine"==o?(s="g2m_multiexpAffine_chunk",r=2*a.F.n8):(s="g2m_multiexp_chunk",r=3*a.F.n8);else throw Error("Invalid group");let c=Math.floor(t.byteLength/r);if(0==c)return a.zero;let d=Math.floor(i.byteLength/c);if(d*c!=i.byteLength)throw Error("Scalar size does not match");let u=iM[iC(c)],f=Math.floor((8*d-1)/u)+1,h=[];for(let e=0;e<f;e++){let o=[{cmd:"ALLOCSET",var:0,buff:t},{cmd:"ALLOCSET",var:1,buff:i},{cmd:"ALLOC",var:2,len:3*a.F.n8},{cmd:"CALL",fnName:s,params:[{var:0},{var:1},{val:d},{val:c},{val:e*u},{val:Math.min(8*d-e*u,u)},{var:2}]},{cmd:"GET",out:0,var:2,len:3*a.F.n8}];h.push(a.tm.queueAction(o))}let g=await Promise.all(h),p=a.zero;for(let t=g.length-1;t>=0;t--){if(!a.isZero(p))for(let t=0;t<u;t++)p=a.double(p);p=a.add(p,g[t][0])}return p}async function n(t,n,l,r,s){let c,d;if("G1"==e)c="affine"==l?2*a.F.n8:3*a.F.n8;else if("G2"==e)c="affine"==l?2*a.F.n8:3*a.F.n8;else throw Error("Invalid group");let u=Math.floor(t.byteLength/c),f=Math.floor(n.byteLength/u);if(f*u!=n.byteLength)throw Error("Scalar size does not match");let h=iM[iC(u)];(d=Math.floor(u/(i.concurrency/(Math.floor((8*f-1)/h)+1))))>4194304&&(d=4194304),d<1024&&(d=1024);let g=[];for(let e=0;e<u;e+=d){r&&r.debug(`Multiexp start: ${s}: ${e}/${u}`);let a=Math.min(u-e,d),i=t.slice(e*c,(e+a)*c),h=n.slice(e*f,(e+a)*f);g.push(o(i,h,l,r,s).then(t=>(r&&r.debug(`Multiexp end: ${s}: ${e}/${u}`),t)))}let p=await Promise.all(g),_=a.zero;for(let t=p.length-1;t>=0;t--)_=a.add(_,p[t]);return _}a.multiExp=async function(t,e,a,i){return await n(t,e,"jacobian",a,i)},a.multiExpAffine=async function(t,e,a,i){return await n(t,e,"affine",a,i)}}function ik(t,e){let a=t[e],i=t.Fr,o=a.tm;async function n(t,n,s,c,d,u){let f,h,g,p,_,m,b,L,w,y,A;s=s||"affine",c=c||"affine","G1"==e?("affine"==s?(f=2*a.F.n8,p="g1m_batchToJacobian"):f=3*a.F.n8,h=3*a.F.n8,n&&(L="g1m_fftFinal"),b="g1m_fftJoin",m="g1m_fftMix","affine"==c?(g=2*a.F.n8,_="g1m_batchToAffine"):g=3*a.F.n8):"G2"==e?("affine"==s?(f=2*a.F.n8,p="g2m_batchToJacobian"):f=3*a.F.n8,h=3*a.F.n8,n&&(L="g2m_fftFinal"),b="g2m_fftJoin",m="g2m_fftMix","affine"==c?(g=2*a.F.n8,_="g2m_batchToAffine"):g=3*a.F.n8):"Fr"==e&&(f=a.n8,h=a.n8,g=a.n8,n&&(L="frm_fftFinal"),m="frm_fftMix",b="frm_fftJoin");let C=!1;Array.isArray(t)?(t=iI(t,f),C=!0):t=t.slice(0,t.byteLength);let I=t.byteLength/f,F=iC(I);if(1<<F!=I)throw Error("fft must be multiple of 2");if(F==i.s+1){let e;return(e=n?await r(t,s,c,d,u):await l(t,s,c,d,u),C)?iF(e,g):e}n&&(w=i.inv(i.e(I))),function(t,e){let a=t.byteLength/e,i=iC(a);if(a!=1<<i)throw Error("Invalid number of pointers");for(let n=0;n<a;n++){var o;let a=(iA[(o=n)>>>24]|iA[o>>>16&255]<<8|iA[o>>>8&255]<<16|iA[255&o]<<24)>>>32-i;if(n>a){let i=t.slice(n*e,(n+1)*e);t.set(t.slice(a*e,(a+1)*e),n*e),t.set(i,a*e)}}}(t,f);let x=Math.min(16384,I),E=I/x;for(;E<o.concurrency&&x>=16;)E*=2,x/=2;let v=iC(x),B=[];for(let e=0;e<E;e++){d&&d.debug(`${u}: fft ${F} mix start: ${e}/${E}`);let a=[];a.push({cmd:"ALLOC",var:0,len:h*x});let i=t.slice(x*e*f,x*(e+1)*f);a.push({cmd:"SET",var:0,buff:i}),p&&a.push({cmd:"CALL",fnName:p,params:[{var:0},{val:x},{var:0}]});for(let t=1;t<=v;t++)a.push({cmd:"CALL",fnName:m,params:[{var:0},{val:x},{val:t}]});v==F?(L&&(a.push({cmd:"ALLOCSET",var:1,buff:w}),a.push({cmd:"CALL",fnName:L,params:[{var:0},{val:x},{var:1}]})),_&&a.push({cmd:"CALL",fnName:_,params:[{var:0},{val:x},{var:0}]}),a.push({cmd:"GET",out:0,var:0,len:x*g})):a.push({cmd:"GET",out:0,var:0,len:h*x}),B.push(o.queueAction(a).then(t=>(d&&d.debug(`${u}: fft ${F} mix end: ${e}/${E}`),t)))}A=await Promise.all(B);for(let t=0;t<E;t++)A[t]=A[t][0];for(let t=v+1;t<=F;t++){d&&d.debug(`${u}: fft  ${F}  join: ${t}/${F}`);let e=1<<F-t,a=E/e,n=[];for(let l=0;l<e;l++)for(let r=0;r<a/2;r++){let s=i.exp(i.w[t],r*x),c=i.w[t],f=l*a+r,p=l*a+r+a/2,m=[];m.push({cmd:"ALLOCSET",var:0,buff:A[f]}),m.push({cmd:"ALLOCSET",var:1,buff:A[p]}),m.push({cmd:"ALLOCSET",var:2,buff:s}),m.push({cmd:"ALLOCSET",var:3,buff:c}),m.push({cmd:"CALL",fnName:b,params:[{var:0},{var:1},{val:x},{var:2},{var:3}]}),t==F?(L&&(m.push({cmd:"ALLOCSET",var:4,buff:w}),m.push({cmd:"CALL",fnName:L,params:[{var:0},{val:x},{var:4}]}),m.push({cmd:"CALL",fnName:L,params:[{var:1},{val:x},{var:4}]})),_&&(m.push({cmd:"CALL",fnName:_,params:[{var:0},{val:x},{var:0}]}),m.push({cmd:"CALL",fnName:_,params:[{var:1},{val:x},{var:1}]})),m.push({cmd:"GET",out:0,var:0,len:x*g}),m.push({cmd:"GET",out:1,var:1,len:x*g})):(m.push({cmd:"GET",out:0,var:0,len:x*h}),m.push({cmd:"GET",out:1,var:1,len:x*h})),n.push(o.queueAction(m).then(i=>(d&&d.debug(`${u}: fft ${F} join  ${t}/${F}  ${l+1}/${e} ${r}/${a/2}`),i)))}let l=await Promise.all(n);for(let t=0;t<e;t++)for(let e=0;e<a/2;e++){let i=t*a+e,o=t*a+e+a/2,n=l.shift();A[i]=n[0],A[o]=n[1]}}if(y=t instanceof ix?new ix(I*g):new Uint8Array(I*g),n){y.set(A[0].slice((x-1)*g));let t=g;for(let e=E-1;e>0;e--)y.set(A[e],t),t+=x*g,delete A[e];y.set(A[0].slice(0,(x-1)*g),t),delete A[0]}else for(let t=0;t<E;t++)y.set(A[t],x*g*t),delete A[t];return C?iF(y,g):y}async function l(t,e,a,o,l){let r,c,d;r=t.slice(0,t.byteLength/2),c=t.slice(t.byteLength/2,t.byteLength);let u=[];[r,c]=await s(r,c,"fftJoinExt",i.one,i.shift,e,"jacobian",o,l),u.push(n(r,!1,"jacobian",a,o,l)),u.push(n(c,!1,"jacobian",a,o,l));let f=await Promise.all(u);return(d=f[0].byteLength>268435456?new ix(2*f[0].byteLength):new Uint8Array(2*f[0].byteLength)).set(f[0]),d.set(f[1],f[0].byteLength),d}async function r(t,e,a,o,l){let r,c,d;r=t.slice(0,t.byteLength/2),c=t.slice(t.byteLength/2,t.byteLength);let u=[];u.push(n(r,!0,e,"jacobian",o,l)),u.push(n(c,!0,e,"jacobian",o,l)),[r,c]=await Promise.all(u);let f=await s(r,c,"fftJoinExtInv",i.one,i.shiftInv,"jacobian",a,o,l);return(d=f[0].byteLength>268435456?new ix(2*f[0].byteLength):new Uint8Array(2*f[0].byteLength)).set(f[0]),d.set(f[1],f[0].byteLength),d}async function s(t,n,l,r,s,c,d,u,f){let h,g,p,_,m,b,L,w;if("G1"==e)"affine"==c?(m=2*a.F.n8,g="g1m_batchToJacobian"):m=3*a.F.n8,b=3*a.F.n8,h="g1m_"+l,"affine"==d?(p="g1m_batchToAffine",_=2*a.F.n8):_=3*a.F.n8;else if("G2"==e)"affine"==c?(m=2*a.F.n8,g="g2m_batchToJacobian"):m=3*a.F.n8,h="g2m_"+l,b=3*a.F.n8,"affine"==d?(p="g2m_batchToAffine",_=2*a.F.n8):_=3*a.F.n8;else if("Fr"==e)m=i.n8,_=i.n8,b=i.n8,h="frm_"+l;else throw Error("Invalid group");if(t.byteLength!=n.byteLength)throw Error("Invalid buffer size");let y=Math.floor(t.byteLength/m);if(y!=1<<iC(y))throw Error("Invalid number of points");let A=Math.floor(y/o.concurrency);A<16&&(A=16),A>65536&&(A=65536);let C=[];for(let e=0;e<y;e+=A){u&&u.debug(`${f}: fftJoinExt Start: ${e}/${y}`);let a=Math.min(y-e,A),l=i.mul(r,i.exp(s,e)),c=[],d=t.slice(e*m,(e+a)*m),L=n.slice(e*m,(e+a)*m);c.push({cmd:"ALLOC",var:0,len:b*a}),c.push({cmd:"SET",var:0,buff:d}),c.push({cmd:"ALLOC",var:1,len:b*a}),c.push({cmd:"SET",var:1,buff:L}),c.push({cmd:"ALLOCSET",var:2,buff:l}),c.push({cmd:"ALLOCSET",var:3,buff:s}),g&&(c.push({cmd:"CALL",fnName:g,params:[{var:0},{val:a},{var:0}]}),c.push({cmd:"CALL",fnName:g,params:[{var:1},{val:a},{var:1}]})),c.push({cmd:"CALL",fnName:h,params:[{var:0},{var:1},{val:a},{var:2},{var:3},{val:i.s}]}),p&&(c.push({cmd:"CALL",fnName:p,params:[{var:0},{val:a},{var:0}]}),c.push({cmd:"CALL",fnName:p,params:[{var:1},{val:a},{var:1}]})),c.push({cmd:"GET",out:0,var:0,len:a*_}),c.push({cmd:"GET",out:1,var:1,len:a*_}),C.push(o.queueAction(c).then(t=>(u&&u.debug(`${f}: fftJoinExt End: ${e}/${y}`),t)))}let I=await Promise.all(C);y*_>268435456?(L=new ix(y*_),w=new ix(y*_)):(L=new Uint8Array(y*_),w=new Uint8Array(y*_));let F=0;for(let t=0;t<I.length;t++)L.set(I[t][0],F),w.set(I[t][1],F),F+=I[t][0].byteLength;return[L,w]}a.fft=async function(t,e,a,i,o){return await n(t,!1,e,a,i,o)},a.ifft=async function(t,e,a,i,o){return await n(t,!0,e,a,i,o)},a.lagrangeEvaluations=async function(t,o,l,r,c){let d,u;if(o=o||"affine",l=l||"affine","G1"==e)d="affine"==o?2*a.F.n8:3*a.F.n8;else if("G2"==e)d="affine"==o?2*a.F.n8:3*a.F.n8;else if("Fr"==e)d=i.n8;else throw Error("Invalid group");let f=t.byteLength/d,h=iC(f);if(2**h*d!=t.byteLength)throw r&&r.error("lagrangeEvaluations iinvalid input size"),Error("lagrangeEvaluations invalid Input size");if(h<=i.s)return await a.ifft(t,o,l,r,c);if(h>i.s+1)throw r&&r.error("lagrangeEvaluations input too big"),Error("lagrangeEvaluations input too big");let g=t.slice(0,t.byteLength/2),p=t.slice(t.byteLength/2,t.byteLength),_=i.exp(i.shift,f/2),m=i.inv(i.sub(i.one,_));[g,p]=await s(g,p,"prepareLagrangeEvaluation",m,i.shiftInv,o,"jacobian",r,c+" prep");let b=[];return b.push(n(g,!0,"jacobian",l,r,c+" t0")),b.push(n(p,!0,"jacobian",l,r,c+" t1")),[g,p]=await Promise.all(b),(u=g.byteLength>268435456?new ix(2*g.byteLength):new Uint8Array(2*g.byteLength)).set(g),u.set(p,g.byteLength),u},a.fftMix=async function(t){let n,l,r;let s=3*a.F.n8;if("G1"==e)n="g1m_fftMix",l="g1m_fftJoin";else if("G2"==e)n="g2m_fftMix",l="g2m_fftJoin";else if("Fr"==e)n="frm_fftMix",l="frm_fftJoin";else throw Error("Invalid group");let c=Math.floor(t.byteLength/s),d=iC(c),u=1<<iC(o.concurrency);c<=2*u&&(u=1);let f=c/u,h=iC(f),g=[];for(let e=0;e<u;e++){let a=[],i=t.slice(e*f*s,(e+1)*f*s);a.push({cmd:"ALLOCSET",var:0,buff:i});for(let t=1;t<=h;t++)a.push({cmd:"CALL",fnName:n,params:[{var:0},{val:f},{val:t}]});a.push({cmd:"GET",out:0,var:0,len:f*s}),g.push(o.queueAction(a))}let p=await Promise.all(g),_=[];for(let t=0;t<p.length;t++)_[t]=p[t][0];for(let t=h+1;t<=d;t++){let e=1<<d-t,a=u/e,n=[];for(let r=0;r<e;r++)for(let e=0;e<a/2;e++){let c=i.exp(i.w[t],e*f),d=i.w[t],u=r*a+e,h=r*a+e+a/2,g=[];g.push({cmd:"ALLOCSET",var:0,buff:_[u]}),g.push({cmd:"ALLOCSET",var:1,buff:_[h]}),g.push({cmd:"ALLOCSET",var:2,buff:c}),g.push({cmd:"ALLOCSET",var:3,buff:d}),g.push({cmd:"CALL",fnName:l,params:[{var:0},{var:1},{val:f},{var:2},{var:3}]}),g.push({cmd:"GET",out:0,var:0,len:f*s}),g.push({cmd:"GET",out:1,var:1,len:f*s}),n.push(o.queueAction(g))}let r=await Promise.all(n);for(let t=0;t<e;t++)for(let e=0;e<a/2;e++){let i=t*a+e,o=t*a+e+a/2,n=r.shift();_[i]=n[0],_[o]=n[1]}}r=t instanceof ix?new ix(c*s):new Uint8Array(c*s);let m=0;for(let t=0;t<u;t++)r.set(_[t],m),m+=_[t].byteLength;return r},a.fftJoin=async function(t,n,l,r){let s,c,d;let u=3*a.F.n8;if("G1"==e)s="g1m_fftJoin";else if("G2"==e)s="g2m_fftJoin";else if("Fr"==e)s="frm_fftJoin";else throw Error("Invalid group");if(t.byteLength!=n.byteLength)throw Error("Invalid buffer size");let f=Math.floor(t.byteLength/u);if(f!=1<<iC(f))throw Error("Invalid number of points");let h=1<<iC(o.concurrency);f<=2*h&&(h=1);let g=f/h,p=[];for(let e=0;e<h;e++){let a=[],c=i.mul(l,i.exp(r,e*g)),d=t.slice(e*g*u,(e+1)*g*u),f=n.slice(e*g*u,(e+1)*g*u);a.push({cmd:"ALLOCSET",var:0,buff:d}),a.push({cmd:"ALLOCSET",var:1,buff:f}),a.push({cmd:"ALLOCSET",var:2,buff:c}),a.push({cmd:"ALLOCSET",var:3,buff:r}),a.push({cmd:"CALL",fnName:s,params:[{var:0},{var:1},{val:g},{var:2},{var:3}]}),a.push({cmd:"GET",out:0,var:0,len:g*u}),a.push({cmd:"GET",out:1,var:1,len:g*u}),p.push(o.queueAction(a))}let _=await Promise.all(p);t instanceof ix?(c=new ix(f*u),d=new ix(f*u)):(c=new Uint8Array(f*u),d=new Uint8Array(f*u));let m=0;for(let t=0;t<_.length;t++)c.set(_[t][0],m),d.set(_[t][1],m),m+=_[t][0].byteLength;return[c,d]},a.fftFinal=async function(t,i){let n,l,r;let s=3*a.F.n8,c=2*a.F.n8;if("G1"==e)n="g1m_fftFinal",l="g1m_batchToAffine";else if("G2"==e)n="g2m_fftFinal",l="g2m_batchToAffine";else throw Error("Invalid group");let d=Math.floor(t.byteLength/s);if(d!=1<<iC(d))throw Error("Invalid number of points");let u=Math.floor(d/o.concurrency),f=[];for(let e=0;e<o.concurrency;e++){let a;if(0==(a=e<o.concurrency-1?u:d-e*u))continue;let r=[],h=t.slice(e*u*s,(e*u+a)*s);r.push({cmd:"ALLOCSET",var:0,buff:h}),r.push({cmd:"ALLOCSET",var:1,buff:i}),r.push({cmd:"CALL",fnName:n,params:[{var:0},{val:a},{var:1}]}),r.push({cmd:"CALL",fnName:l,params:[{var:0},{val:a},{var:0}]}),r.push({cmd:"GET",out:0,var:0,len:a*c}),f.push(o.queueAction(r))}let h=await Promise.all(f);r=t instanceof ix?new ix(d*c):new Uint8Array(d*c);let g=0;for(let t=h.length-1;t>=0;t--)r.set(h[t][0],g),g+=h[t][0].byteLength;return r}}async function iR(t){let e=await iq(t.wasm,t.singleThread),a={};return a.q=aX(t.wasm.q.toString()),a.r=aX(t.wasm.r.toString()),a.name=t.name,a.tm=e,a.prePSize=t.wasm.prePSize,a.preQSize=t.wasm.preQSize,a.Fr=new iv(e,"frm",t.n8r,t.r),a.F1=new iv(e,"f1m",t.n8q,t.q),a.F2=new iB(e,"f2m",a.F1),a.G1=new iO(e,"g1m",a.F1,t.wasm.pG1gen,t.wasm.pG1b,t.cofactorG1),a.G2=new iO(e,"g2m",a.F2,t.wasm.pG2gen,t.wasm.pG2b,t.cofactorG2),a.F6=new iS(e,"f6m",a.F2),a.F12=new iB(e,"ftm",a.F6),a.Gt=a.F12,iU(a,"G1"),iU(a,"G2"),iU(a,"Fr"),iQ(a,"G1"),iQ(a,"G2"),ik(a,"G1"),ik(a,"G2"),ik(a,"Fr"),function(t){let e=t.tm;t.pairing=function(a,i){e.startSyncOp();let o=e.allocBuff(t.G1.toJacobian(a)),n=e.allocBuff(t.G2.toJacobian(i)),l=e.alloc(t.Gt.n8);e.instance.exports[t.name+"_pairing"](o,n,l);let r=e.getBuff(l,t.Gt.n8);return e.endSyncOp(),r},t.pairingEq=async function(){let a,i;arguments.length%2==1?(a=arguments[arguments.length-1],i=(arguments.length-1)/2):(a=t.Gt.one,i=arguments.length/2);let o=[];for(let a=0;a<i;a++){let i=[],n=t.G1.toJacobian(arguments[2*a]);i.push({cmd:"ALLOCSET",var:0,buff:n}),i.push({cmd:"ALLOC",var:1,len:t.prePSize});let l=t.G2.toJacobian(arguments[2*a+1]);i.push({cmd:"ALLOCSET",var:2,buff:l}),i.push({cmd:"ALLOC",var:3,len:t.preQSize}),i.push({cmd:"ALLOC",var:4,len:t.Gt.n8}),i.push({cmd:"CALL",fnName:t.name+"_prepareG1",params:[{var:0},{var:1}]}),i.push({cmd:"CALL",fnName:t.name+"_prepareG2",params:[{var:2},{var:3}]}),i.push({cmd:"CALL",fnName:t.name+"_millerLoop",params:[{var:1},{var:3},{var:4}]}),i.push({cmd:"GET",out:0,var:4,len:t.Gt.n8}),o.push(e.queueAction(i))}let n=await Promise.all(o);e.startSyncOp();let l=e.alloc(t.Gt.n8);e.instance.exports.ftm_one(l);for(let t=0;t<n.length;t++){let a=e.allocBuff(n[t][0]);e.instance.exports.ftm_mul(l,a,l)}e.instance.exports[t.name+"_finalExponentiation"](l,l);let r=e.allocBuff(a),s=!!e.instance.exports.ftm_eq(l,r);return e.endSyncOp(),s},t.prepareG1=function(t){this.tm.startSyncOp();let e=this.tm.allocBuff(t),a=this.tm.alloc(this.prePSize);this.tm.instance.exports[this.name+"_prepareG1"](e,a);let i=this.tm.getBuff(a,this.prePSize);return this.tm.endSyncOp(),i},t.prepareG2=function(t){this.tm.startSyncOp();let e=this.tm.allocBuff(t),a=this.tm.alloc(this.preQSize);this.tm.instance.exports[this.name+"_prepareG2"](e,a);let i=this.tm.getBuff(a,this.preQSize);return this.tm.endSyncOp(),i},t.millerLoop=function(t,e){this.tm.startSyncOp();let a=this.tm.allocBuff(t),i=this.tm.allocBuff(e),o=this.tm.alloc(this.Gt.n8);this.tm.instance.exports[this.name+"_millerLoop"](a,i,o);let n=this.tm.getBuff(o,this.Gt.n8);return this.tm.endSyncOp(),n},t.finalExponentiation=function(t){this.tm.startSyncOp();let e=this.tm.allocBuff(t),a=this.tm.alloc(this.Gt.n8);this.tm.instance.exports[this.name+"_finalExponentiation"](e,a);let i=this.tm.getBuff(a,this.Gt.n8);return this.tm.endSyncOp(),i}}(a),a.array2buffer=function(t,e){let a=new Uint8Array(e*t.length);for(let i=0;i<t.length;i++)a.set(t[i],i*e);return a},a.buffer2array=function(t,e){let a=t.byteLength/e,i=Array(a);for(let o=0;o<a;o++)i[o]=t.slice(o*e,o*e+e);return i},a}async function iN(t,e){if(!t&&globalThis.curve_bn128)return globalThis.curve_bn128;let a=new t4;a.setMemory(25),(0,tL.buildBn128)(a),e&&e(a);let i={};i.code=a.build(),i.pq=a.modules.f1m.pq,i.pr=a.modules.frm.pq,i.pG1gen=a.modules.bn128.pG1gen,i.pG1zero=a.modules.bn128.pG1zero,i.pG1b=a.modules.bn128.pG1b,i.pG2gen=a.modules.bn128.pG2gen,i.pG2zero=a.modules.bn128.pG2zero,i.pG2b=a.modules.bn128.pG2b,i.pOneT=a.modules.bn128.pOneT,i.prePSize=a.modules.bn128.prePSize,i.preQSize=a.modules.bn128.preQSize,i.n8q=32,i.n8r=32,i.q=a.modules.bn128.q,i.r=a.modules.bn128.r;let o={name:"bn128",wasm:i,q:aX("21888242871839275222246405745257275088696311157297823662689037894645226208583"),r:aX("21888242871839275222246405745257275088548364400416034343698204186575808495617"),n8q:32,n8r:32,cofactorG2:aX("30644e72e131a029b85045b68181585e06ceecda572a2489345f2299c0f9fa8d",16),singleThread:!!t},n=await iR(o);return n.terminate=async function(){o.singleThread||(globalThis.curve_bn128=null,await this.tm.terminate())},t||(globalThis.curve_bn128=n),n}async function iD(t,e){if(!t&&globalThis.curve_bls12381)return globalThis.curve_bls12381;let a=new t4;a.setMemory(25),(0,tL.buildBls12381)(a),e&&e(a);let i={};i.code=a.build(),i.pq=a.modules.f1m.pq,i.pr=a.modules.frm.pq,i.pG1gen=a.modules.bls12381.pG1gen,i.pG1zero=a.modules.bls12381.pG1zero,i.pG1b=a.modules.bls12381.pG1b,i.pG2gen=a.modules.bls12381.pG2gen,i.pG2zero=a.modules.bls12381.pG2zero,i.pG2b=a.modules.bls12381.pG2b,i.pOneT=a.modules.bls12381.pOneT,i.prePSize=a.modules.bls12381.prePSize,i.preQSize=a.modules.bls12381.preQSize,i.n8q=48,i.n8r=32,i.q=a.modules.bls12381.q,i.r=a.modules.bls12381.r;let o={name:"bls12381",wasm:i,q:aX("1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffaaab",16),r:aX("73eda753299d7d483339d80809a1d80553bda402fffe5bfeffffffff00000001",16),n8q:48,n8r:32,cofactorG1:aX("0x396c8c005555e1568c00aaab0000aaab",16),cofactorG2:aX("0x5d543a95414e7f1091d50792876a202cd91de4547085abaa68a205b2e5a7ddfa628f1cb4d9e82ef21537e293a6691ae1616ec6e786f0c70cf1c38e31c7238e5",16),singleThread:!!t},n=await iR(o);return n.terminate=async function(){o.singleThread||(globalThis.curve_bls12381=null,await this.tm.terminate())},t||(globalThis.curve_bls12381=n),n}globalThis.curve_bn128=null,globalThis.curve_bls12381=null;let i$=aX("73eda753299d7d483339d80809a1d80553bda402fffe5bfeffffffff00000001",16),ij=aX("21888242871839275222246405745257275088548364400416034343698204186575808495617");async function iV(t,e,a){let i;if(a9(t,ij))i=await iN(e,a);else if(a9(t,i$))i=await iD(e,a);else throw Error(`Curve not supported: ${t.toString(void 0)}`);return i}aX("1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffaaab",16),aX("21888242871839275222246405745257275088696311157297823662689037894645226208583");let iK={get:function(t,e){return isNaN(e)?t[e]:t.getElement(e)},set:function(t,e,a){return isNaN(e)?(t[e]=a,!0):t.setElement(e,a)}};class iH{constructor(t){this.length=t||0,this.arr=Array(262144);for(let e=0;e<t;e+=262144)this.arr[e/262144]=Array(Math.min(262144,t-e));return this}push(){for(let t=0;t<arguments.length;t++)this.setElement(this.length,arguments[t])}slice(t,e){let a=Array(e-t);for(let i=t;i<e;i++)a[i-t]=this.getElement(i);return a}getElement(t){let e=Math.floor((t=parseInt(t))/262144),a=t%262144;return this.arr[e]?this.arr[e][a]:void 0}setElement(t,e){let a=Math.floor((t=parseInt(t))/262144);this.arr[a]||(this.arr[a]=Array(262144));let i=t%262144;return this.arr[a][i]=e,t>=this.length&&(this.length=t+1),!0}getKeys(){let t=new iZ;for(let e=0;e<this.arr.length;e++)if(this.arr[e])for(let a=0;a<this.arr[e].length;a++)void 0!==this.arr[e][a]&&t.push(262144*e+a);return t}}class iZ{constructor(t){return new Proxy(new iH(t),iK)}}async function iW(t,e,a){let i;i="object"==typeof a?a:void 0===a?{singleThread:!1}:{singleThread:a};let o={};if(await eb(t,e,1),o.n8=await t.readULE32(),o.prime=await ey(t,o.n8),i.F){if(i.F.p!=o.prime)throw Error("Different Prime");o.F=i.F}else if(i.getFieldFromPrime)o.F=await i.getFieldFromPrime(o.prime,i.singleThread);else if(i.getCurveFromPrime)o.curve=await i.getCurveFromPrime(o.prime,i.singleThread),o.F=o.curve.Fr;else try{o.curve=await iV(o.prime,i.singleThread),o.F=o.curve.Fr}catch(t){o.F=new iL(o.prime)}return o.nVars=await t.readULE32(),o.nOutputs=await t.readULE32(),o.nPubInputs=await t.readULE32(),o.nPrvInputs=await t.readULE32(),o.nLabels=await t.readULE64(),o.nConstraints=await t.readULE32(),o.useCustomGates=void 0!==e[4]&&null!==e[4]&&void 0!==e[5]&&null!==e[5],await eL(t),o}async function iY(t,e,a,i,o){let n,l;n="object"==typeof i?i:void 0===i?{}:{logger:i,loggerCtx:o};let r=await eC(t,e,2),s=0;l=a.nConstraints>1048576?new iZ:[];for(let t=0;t<a.nConstraints;t++){n.logger&&t%1e5==0&&n.logger.info(`${n.loggerCtx}: Loading constraints: ${t}/${a.nConstraints}`);let e=function(){let t=[];return t[0]=c(),t[1]=c(),t[2]=c(),t}();l.push(e)}return l;function c(){let t={},e=r.slice(s,s+4);s+=4;let i=new DataView(e.buffer).getUint32(0,!0),o=r.slice(s,s+(4+a.n8)*i);s+=(4+a.n8)*i;let n=new DataView(o.buffer);for(let e=0;e<i;e++){let i=n.getUint32(e*(4+a.n8),!0),l=a.F.fromRprLE(o,e*(4+a.n8)+4);t[i]=l}return t}}async function iJ(t,e,a,i,o){let n,l;n="object"==typeof i?i:void 0===i?{}:{logger:i,loggerCtx:o};let r=await eC(t,e,3),s=0;l=a.nVars>1048576?new iZ:[];for(let t=0;t<a.nVars;t++){n.logger&&t%1e4==0&&n.logger.info(`${n.loggerCtx}: Loading map: ${t}/${a.nVars}`);let e=function(){let t=r.slice(s,s+8);s+=8;let e=new DataView(t.buffer),a=e.getUint32(0,!0);return 4294967296*e.getUint32(4,!0)+a}();l.push(e)}return l}async function iX(t,e,a){if("object"!=typeof a)throw Error("readR1csFd: options must be an object");a.loadConstraints=!("loadConstraints"in a)||a.loadConstraints,a.loadMap="loadMap"in a&&a.loadMap,a.loadCustomGates=!("loadCustomGates"in a)||a.loadCustomGates;let i=await iW(t,e,a);return a.loadConstraints&&(i.constraints=await iY(t,e,i,a)),a.loadMap&&(i.map=await iJ(t,e,i,a)),a.loadCustomGates&&(i.useCustomGates?(i.customGates=await i1(t,e,i),i.customGatesUses=await i3(t,e,a)):(i.customGates=[],i.customGatesUses=[])),i}async function i2(t,e,a,i,o,n){let l;l="object"==typeof e?e:void 0===e?{loadConstraints:!0,loadMap:!1,loadCustomGates:!0}:{loadConstraints:e,loadMap:a,singleThread:i,logger:o,loggerCtx:n};let{fd:r,sections:s}=await eg(t,"r1cs",1,33554432,4194304),c=await iX(r,s,l);return await r.close(),c}async function i1(t,e,a){await eb(t,e,4);let i=await t.readULE32(),o=[];for(let e=0;e<i;e++){let e={};e.templateName=await t.readString();let i=await t.readULE32();e.parameters=Array(i);let n=await t.read(a.n8*i);for(let t=0;t<i;t++)e.parameters[t]=a.F.fromRprLE(n,t*a.n8,a.n8);o.push(e)}return await eL(t),o}async function i3(t,e,a){let i;let o=await eC(t,e,5),n=new Uint32Array(o.buffer,o.byteOffset,o.byteLength/4),l=n[0],r=1;i=l>1048576?new iZ:[];for(let t=0;t<l;t++){a.logger&&t%1e5==0&&a.logger.info(`${a.loggerCtx}: Loading custom gate uses: ${t}/${l}`);let e={};e.id=n[r++];let o=n[r++];e.signals=[];for(let t=0;t<o;t++){let t=n[r++],a=n[r++];e.signals.push(4294967296*a+t)}i.push(e)}return i}let i0=n.e("73eda753299d7d483339d80809a1d80553bda402fffe5bfeffffffff00000001",16),i8=n.e("21888242871839275222246405745257275088548364400416034343698204186575808495617");async function i4(t,e){let a=await i2(t);return n.eq(a.prime,i8)?e&&e.info("Curve: bn-128"):n.eq(a.prime,i0)?e&&e.info("Curve: bls12-381"):e&&e.info(`Unknown Curve. Prime: ${n.toString(a.prime)}`),e&&e.info(`# of Wires: ${a.nVars}`),e&&e.info(`# of Constraints: ${a.nConstraints}`),e&&e.info(`# of Private Inputs: ${a.nPrvInputs}`),e&&e.info(`# of Public Inputs: ${a.nPubInputs}`),e&&e.info(`# of Labels: ${a.nLabels}`),e&&e.info(`# of Outputs: ${a.nOutputs}`),a}async function i6(t,e){let a=await i2(t,!0,!0,!0,e),i=a.curve.Fr;return delete a.curve,delete a.F,eV(i,a)}async function i7(t){let e={labelIdx2Name:["one"],varIdx2Name:["one"],componentIdx2Name:[]},a=await eh(t),i=await a.read(a.totalSize),o=new TextDecoder("utf-8").decode(i).split("\n");for(let t=0;t<o.length;t++){let a=o[t].split(",");4!=a.length||(e.varIdx2Name[a[1]]?e.varIdx2Name[a[1]]+="|"+a[3]:e.varIdx2Name[a[1]]=a[3],e.labelIdx2Name[a[0]]=a[3],e.componentIdx2Name[a[2]]||(e.componentIdx2Name[a[2]]=function(t){let e=t.split(".");return e.pop(),e.join(".")}(a[3])))}return await a.close(),e}let{unstringifyBigInts:i5}=l;async function i9(t,e,a,i,o,n){let l=i5(t),r=await eh(e),s=await r.read(r.totalSize);await r.close();let c={...o,sanityCheck:!0},d=await i7(i);o.set&&(d||(d=await i7(i)),c.logSetSignal=function(t,e){n&&n.info("SET "+d.labelIdx2Name[t]+" <-- "+e.toString())}),o.get&&(d||(d=await i7(i)),c.logGetSignal=function(t,e){n&&n.info("GET "+d.labelIdx2Name[t]+" --> "+e.toString())}),o.trigger&&(d||(d=await i7(i)),c.logStartComponent=function(t){n&&n.info("START: "+d.componentIdx2Name[t])},c.logFinishComponent=function(t){n&&n.info("FINISH: "+d.componentIdx2Name[t])}),c.sym=d;let u=await ac(s,c),f=await u.calculateWitness(l,!0),h=await ep(a,"wtns",2,2);await e9(h,f,u.prime),await h.close()}async function ot(t){return await aa(t)}async function oe(t,e,a){a&&a.info("WITNESS CHECKING STARTED"),a&&a.info("> Reading r1cs file");let{fd:i,sections:o}=await eg(t,"r1cs",1,4194304,16777216),l=await iX(i,o,{loadConstraints:!1,loadCustomGates:!1});a&&a.info("> Reading witness file");let{fd:r,sections:s}=await eg(e,"wtns",2,4194304,16777216),c=await ae(r,s);if(!n.eq(l.prime,c.q))throw Error("Curve of the witness does not match the curve of the proving key");let d=await eC(r,s,2);await r.close();let u=(await eB(l.prime)).Fr,f=u.n8,h=await eC(i,o,2);a&&(a.info("----------------------------"),a.info("  WITNESS CHECK"),a.info(`  Curve:          ${l.curve.name}`),a.info(`  Vars (wires):   ${l.nVars}`),a.info(`  Outputs:        ${l.nOutputs}`),a.info(`  Public Inputs:  ${l.nPubInputs}`),a.info(`  Private Inputs: ${l.nPrvInputs}`),a.info(`  Labels:         ${l.nLabels}`),a.info(`  Constraints:    ${l.nConstraints}`),a.info(`  Custom Gates:   ${l.useCustomGates}`),a.info("----------------------------")),a&&a.info("> Checking witness correctness");let g=0,p=!0;for(let t=0;t<l.nConstraints;t++){a&&0!==t&&t%5e5==0&&a.info(`\xb7\xb7\xb7 processing r1cs constraints ${t}/${l.nConstraints}`);let e=m(),i=m(),o=m(),n=_(e),r=_(i),s=_(o);if(!u.eq(u.sub(u.mul(n,r),s),u.zero)){a.warn("\xb7\xb7\xb7 aborting checking process at constraint "+t),p=!1;break}}return i.close(),a&&(p?(a.info("WITNESS IS CORRECT"),a.info("WITNESS CHECKING FINISHED SUCCESSFULLY")):(a.warn("WITNESS IS NOT CORRECT"),a.warn("WITNESS CHECKING FINISHED UNSUCCESSFULLY"))),p;function _(t){let e=u.zero;return Object.keys(t).forEach(a=>{let i=u.fromRprLE(d.slice(a*f,a*f+f)),o=t[a];e=u.add(e,u.mul(i,o))}),e}function m(){let t={},e=h.slice(g,g+4);g+=4;let a=new DataView(e.buffer).getUint32(0,!0),i=h.slice(g,g+(4+l.n8)*a);g+=(4+l.n8)*a;let o=new DataView(i.buffer);for(let e=0;e<a;e++){let a=o.getUint32(e*(4+l.n8),!0),n=l.F.fromRprLE(i,e*(4+l.n8)+4);t[a]=n}return t}}let oa={get:function(t,e){return isNaN(e)?t[e]:t.getElement(e)},set:function(t,e,a){return isNaN(e)?(t[e]=a,!0):t.setElement(e,a)}};class oi{constructor(t){this.length=t||0,this.arr=Array(262144);for(let e=0;e<t;e+=262144)this.arr[e/262144]=Array(Math.min(262144,t-e));return this}push(){for(let t=0;t<arguments.length;t++)this.setElement(this.length,arguments[t])}slice(t,e){let a=Array(e-t);for(let i=t;i<e;i++)a[i-t]=this.getElement(i);return a}getElement(t){let e=Math.floor((t=parseInt(t))/262144),a=t%262144;return this.arr[e]?this.arr[e][a]:void 0}setElement(t,e){let a=Math.floor((t=parseInt(t))/262144);this.arr[a]||(this.arr[a]=Array(262144));let i=t%262144;return this.arr[a][i]=e,t>=this.length&&(this.length=t+1),!0}getKeys(){let t=new oo;for(let e=0;e<this.arr.length;e++)if(this.arr[e])for(let a=0;a<this.arr[e].length;a++)void 0!==this.arr[e][a]&&t.push(262144*e+a);return t}}class oo{constructor(t){return new Proxy(new oi(t),oa)}}async function on(t,e,a,i){let o,l,r;await eP.ready();let s=eP(64),{fd:c,sections:d}=await eg(e,"ptau",1,4194304,16777216),{curve:u,power:f}=await ax(c,d),{fd:h,sections:g}=await eg(t,"r1cs",1,4194304,16777216),p=await iW(h,g,!1),_=await ep(a,"zkey",1,10,4194304,16777216),m=2*u.G1.F.n8,b=2*u.G2.F.n8;if(p.prime!=u.r)return i&&i.error("r1cs curve does not match powers of tau ceremony curve"),-1;let L=eq(p.nConstraints+p.nPubInputs+p.nOutputs+1-1)+1;if(L>f)return i&&i.error(`circuit too big for this power of tau ceremony. ${p.nConstraints}*2 > 2**${f}`),-1;if(!d[12])return i&&i.error("Powers of tau is not prepared."),-1;let w=p.nOutputs+p.nPubInputs,y=2**L;await e_(_,1),await _.writeULE32(1),await em(_),await e_(_,2);let A=u.q,C=(Math.floor((n.bitLength(A)-1)/64)+1)*8,I=u.r,F=(Math.floor((n.bitLength(I)-1)/64)+1)*8,x=n.mod(n.shl(1,8*F),I),E=u.Fr.e(n.mod(n.mul(x,x),I));await _.writeULE32(C),await ew(_,A,C),await _.writeULE32(F),await ew(_,I,F),await _.writeULE32(p.nVars),await _.writeULE32(w),await _.writeULE32(y),o=await c.read(m,d[4][0].p),await _.write(o),o=await u.G1.batchLEMtoU(o),s.update(o),l=await c.read(m,d[5][0].p),await _.write(l),l=await u.G1.batchLEMtoU(l),s.update(l),r=await c.read(b,d[6][0].p),await _.write(r),r=await u.G2.batchLEMtoU(r),s.update(r);let v=new Uint8Array(m);u.G1.toRprLEM(v,0,u.G1.g);let B=new Uint8Array(b);u.G2.toRprLEM(B,0,u.G2.g);let S=new Uint8Array(m);u.G1.toRprUncompressed(S,0,u.G1.g);let O=new Uint8Array(b);u.G2.toRprUncompressed(O,0,u.G2.g),await _.write(B),await _.write(v),await _.write(B),s.update(O),s.update(S),s.update(O),await em(_),i&&i.info("Reading r1cs");let P=await eC(h,g,2),G=new oo(p.nVars),T=new oo(p.nVars),q=new oo(p.nVars),z=new oo(p.nVars-w-1),U=Array(w+1);i&&i.info("Reading tauG1");let M=await eC(c,d,12,(y-1)*m,y*m);i&&i.info("Reading tauG2");let Q=await eC(c,d,13,(y-1)*b,y*b);i&&i.info("Reading alphatauG1");let k=await eC(c,d,14,(y-1)*m,y*m);i&&i.info("Reading betatauG1");let R=await eC(c,d,15,(y-1)*m,y*m);await $(),await j(3,"G1",U,"IC"),await D(),await K(),await j(8,"G1",z,"C"),await j(5,"G1",G,"A"),await j(6,"G1",T,"B1"),await j(7,"G2",q,"B2");let N=s.digest();return await e_(_,10),await _.write(N),await _.writeULE32(0),await em(_),i&&i.info(ez(N,"Circuit hash: ")),await _.close(),await h.close(),await c.close(),N;async function D(){await e_(_,9);let t=new tS(y*m);if(L<u.Fr.s){let e=await eC(c,d,12,(2*y-1)*m,2*y*m);for(let a=0;a<y;a++){i&&a%1e4==0&&i.debug(`splitting buffer: ${a}/${y}`);let o=e.slice((2*a+1)*m,(2*a+1)*m+m);t.set(o,a*m)}}else if(L==u.Fr.s){let e=d[12][0].p+(2**(L+1)-1)*m;await c.readToBuffer(t,0,y*m,e+y*m)}else throw i&&i.error("Circuit too big"),Error("Circuit too big for this curve");await _.write(t),await em(_)}async function $(){let t=new Uint8Array(12+u.Fr.n8),e=new DataView(t.buffer),a=new Uint8Array(u.Fr.n8);u.Fr.toRprLE(a,0,u.Fr.e(1));let o=0;function n(){let t=P.slice(o,o+4);return o+=4,new DataView(t.buffer).getUint32(0,!0)}let l=new oo;for(let t=0;t<p.nConstraints;t++){i&&t%1e4==0&&i.debug(`processing constraints: ${t}/${p.nConstraints}`);let e=n();for(let a=0;a<e;a++){let e=n(),a=o;o+=u.Fr.n8;let i=m*t,r=m*t;void 0===G[e]&&(G[e]=[]),G[e].push([0,i,a]),e<=w?(void 0===U[e]&&(U[e]=[]),U[e].push([3,r,a])):(void 0===z[e-w-1]&&(z[e-w-1]=[]),z[e-w-1].push([3,r,a])),l.push([0,t,e,a])}let a=n();for(let e=0;e<a;e++){let e=n(),a=o;o+=u.Fr.n8;let i=m*t,r=b*t,s=m*t;void 0===T[e]&&(T[e]=[]),T[e].push([0,i,a]),void 0===q[e]&&(q[e]=[]),q[e].push([1,r,a]),e<=w?(void 0===U[e]&&(U[e]=[]),U[e].push([2,s,a])):(void 0===z[e-w-1]&&(z[e-w-1]=[]),z[e-w-1].push([2,s,a])),l.push([1,t,e,a])}let r=n();for(let e=0;e<r;e++){let e=n(),a=o;o+=u.Fr.n8;let i=m*t;e<=w?(void 0===U[e]&&(U[e]=[]),U[e].push([0,i,a])):(void 0===z[e-w-1]&&(z[e-w-1]=[]),z[e-w-1].push([0,i,a]))}}for(let t=0;t<=w;t++){let e=m*(p.nConstraints+t),a=m*(p.nConstraints+t);void 0===G[t]&&(G[t]=[]),G[t].push([0,e,-1]),void 0===U[t]&&(U[t]=[]),U[t].push([3,a,-1]),l.push([0,p.nConstraints+t,t,-1])}await e_(_,4);let r=new tS(l.length*(12+u.Fr.n8)+4),s=new Uint8Array(4);new DataView(s.buffer).setUint32(0,l.length,!0),r.set(s);let c=4;for(let o=0;o<l.length;o++)i&&o%1e5==0&&i.debug(`writing coeffs: ${o}/${l.length}`),function(i){let o;e.setUint32(0,i[0],!0),e.setUint32(4,i[1],!0),e.setUint32(8,i[2],!0),o=i[3]>=0?u.Fr.fromRprLE(P.slice(i[3],i[3]+u.Fr.n8),0):u.Fr.fromRprLE(a,0);let n=u.Fr.mul(o,E);u.Fr.toRprLE(t,12,n),r.set(t,c),c+=t.length}(l[o]);await _.write(r),await em(_)}async function j(t,e,a,o){let n=u[e];W(a.length),await e_(_,t);let l=[],r=0;for(;r<a.length;){let t=0;for(;r<a.length&&t<u.tm.concurrency;){i&&i.debug(`Writing points start ${o}: ${r}/${a.length}`);let n=1,s=a[r]?a[r].length:0;for(;r+n<a.length&&s+(a[r+n]?a[r+n].length:0)<32768&&n<32768;)s+=a[r+n]?a[r+n].length:0,n++;let c=a.slice(r,r+n),d=r;l.push(V(e,c,i,o).then(t=>(i&&i.debug(`Writing points end ${o}: ${d}/${a.length}`),t))),r+=n,t++}let c=await Promise.all(l);for(let t=0;t<c.length;t++){await _.write(c[t][0]);let e=await n.batchLEMtoU(c[t][0]);s.update(e)}l=[]}await em(_)}async function V(t,e,a,i){let o,n,l,r,s,c;let d=u[t],f=2*d.F.n8,h=3*d.F.n8,g=2*d.F.n8;if("G1"==t)o="g1m_timesScalarAffine",n="g1m_multiexpAffine",l="g1m_batchToAffine",r="g1m_zero";else if("G2"==t)o="g2m_timesScalarAffine",n="g2m_multiexpAffine",l="g2m_batchToAffine",r="g2m_zero";else throw Error("Invalid group");let p=0;for(let t=0;t<e.length;t++)p+=e[t]?e[t].length:0;p>32768?(s=new tS(p*f),c=new tS(p*u.Fr.n8)):(s=new Uint8Array(p*f),c=new Uint8Array(p*u.Fr.n8));let _=0,m=0,b=[M,Q,k,R],L=new Uint8Array(u.Fr.n8);u.Fr.toRprLE(L,0,u.Fr.e(1));let w=0;for(let t=0;t<e.length;t++)if(e[t])for(let o=0;o<e[t].length;o++)a&&o&&o%1e4==0&&a.debug(`Configuring big array ${i}: ${o}/${e[t].length}`),s.set(b[e[t][o][0]].slice(e[t][o][1],e[t][o][1]+f),w*f),e[t][o][2]>=0?c.set(P.slice(e[t][o][2],e[t][o][2]+u.Fr.n8),w*u.Fr.n8):c.set(L,w*u.Fr.n8),w++;if(e.length>1){let t=[];t.push({cmd:"ALLOCSET",var:0,buff:s}),t.push({cmd:"ALLOCSET",var:1,buff:c}),t.push({cmd:"ALLOC",var:2,len:e.length*h}),_=0,m=0;let a=0;for(let i=0;i<e.length;i++){if(!e[i]){t.push({cmd:"CALL",fnName:r,params:[{var:2,offset:a}]}),a+=h;continue}1==e[i].length?t.push({cmd:"CALL",fnName:o,params:[{var:0,offset:_},{var:1,offset:m},{val:u.Fr.n8},{var:2,offset:a}]}):t.push({cmd:"CALL",fnName:n,params:[{var:0,offset:_},{var:1,offset:m},{val:u.Fr.n8},{val:e[i].length},{var:2,offset:a}]}),_+=f*e[i].length,m+=u.Fr.n8*e[i].length,a+=h}return t.push({cmd:"CALL",fnName:l,params:[{var:2},{val:e.length},{var:2}]}),t.push({cmd:"GET",out:0,var:2,len:e.length*g}),await u.tm.queueAction(t)}{let t=await d.multiExpAffine(s,c,a,i);return[d.toAffine(t)]}}async function K(){W(y-1);for(let t=0;t<y-1;t+=16384){i&&i.debug(`HashingHPoints: ${t}/${y}`);let e=Math.min(y-1,16384);await H(t,e)}}async function H(t,e){let a=await c.read(e*m,d[2][0].p+(t+y)*m),i=await c.read(e*m,d[2][0].p+t*m),o=u.tm.concurrency,n=Math.floor(e/o),l=[];for(let t=0;t<o;t++){let r;if(0==(r=t<o-1?n:e-t*n))continue;let s=a.slice(t*n*m,(t*n+r)*m),c=i.slice(t*n*m,(t*n+r)*m);l.push(Z(s,c))}let r=await Promise.all(l);for(let t=0;t<r.length;t++)s.update(r[t][0])}async function Z(t,e){let a=t.byteLength/m,i=3*u.G1.F.n8,o=[];o.push({cmd:"ALLOCSET",var:0,buff:t}),o.push({cmd:"ALLOCSET",var:1,buff:e}),o.push({cmd:"ALLOC",var:2,len:a*i});for(let t=0;t<a;t++)o.push({cmd:"CALL",fnName:"g1m_subAffine",params:[{var:0,offset:t*m},{var:1,offset:t*m},{var:2,offset:t*i}]});return o.push({cmd:"CALL",fnName:"g1m_batchToAffine",params:[{var:2},{val:a},{var:2}]}),o.push({cmd:"CALL",fnName:"g1m_batchLEMtoU",params:[{var:2},{val:a},{var:2}]}),o.push({cmd:"GET",out:0,var:2,len:a*m}),await u.tm.queueAction(o)}function W(t){let e=new Uint8Array(4);new DataView(e.buffer,e.byteOffset,e.byteLength).setUint32(0,t,!1),s.update(e)}}async function ol(t,e,a){let i,o,n,l,r,s;let{fd:c,sections:d}=await eg(t,"zkey",2),u=await eJ(c,d);if("groth16"!=u.protocol)throw Error("zkey file is not groth16");let f=await eS(u.q),h=2*f.G1.F.n8,g=2*f.G2.F.n8,p=await e8(c,f,d),_=await ef(e);await b(u.vk_alpha_1),await b(u.vk_beta_1),await L(u.vk_beta_2),await L(u.vk_gamma_2),await b(u.vk_delta_1),await L(u.vk_delta_2),i=await eC(c,d,3),i=await f.G1.batchLEMtoU(i),await w("G1",i);let m=await eC(c,d,9);o=await f.G1.fft(m,"affine","jacobian",a),o=(o=await f.G1.batchApplyKey(o,f.Fr.neg(f.Fr.e(2)),f.Fr.w[u.power+1],"jacobian","affine",a)).slice(0,o.byteLength-h),o=await f.G1.batchLEMtoU(o),await w("G1",o),n=await eC(c,d,8),n=await f.G1.batchLEMtoU(n),await w("G1",n),l=await eC(c,d,5),l=await f.G1.batchLEMtoU(l),await w("G1",l),r=await eC(c,d,6),r=await f.G1.batchLEMtoU(r),await w("G1",r),s=await eC(c,d,7),s=await f.G2.batchLEMtoU(s),await w("G2",s),await _.write(p.csHash),await y(p.contributions.length);for(let t=0;t<p.contributions.length;t++){let e=p.contributions[t];await b(e.deltaAfter),await b(e.delta.g1_s),await b(e.delta.g1_sx),await L(e.delta.g2_spx),await _.write(e.transcript)}async function b(t){let e=new Uint8Array(h);f.G1.toRprUncompressed(e,0,t),await _.write(e)}async function L(t){let e=new Uint8Array(g);f.G2.toRprUncompressed(e,0,t),await _.write(e)}async function w(t,e){let a;a="G1"==t?h:g;let i=new Uint8Array(4);new DataView(i.buffer,i.byteOffset,i.byteLength).setUint32(0,e.byteLength/a,!1),await _.write(i),await _.write(e)}async function y(t){let e=new Uint8Array(4);new DataView(e.buffer,e.byteOffset,e.byteLength).setUint32(0,t,!1),await _.write(e)}await c.close(),await _.close()}async function or(t,e,a,i,o){let n,l;let{fd:r,sections:s}=await eg(t,"zkey",2),c=await eJ(r,s,!1);if("groth16"!=c.protocol)throw Error("zkey file is not groth16");let d=await eS(c.q),u=2*d.G1.F.n8,f=2*d.G2.F.n8,h=await e8(r,d,s),g={},p=await eh(e);p.pos=3*u+3*f+8+u*c.nVars+4+u*(c.domainSize-1)+4+u*c.nVars+4+u*c.nVars+4+f*c.nVars,g.csHash=await p.read(64);let _=await p.readUBE32();g.contributions=[];for(let t=0;t<_;t++){let e={delta:{}};e.deltaAfter=await I(p),e.delta.g1_s=await I(p),e.delta.g1_sx=await I(p),e.delta.g2_spx=await F(p),e.transcript=await p.read(64),t<h.contributions.length&&(e.type=h.contributions[t].type,1==e.type&&(e.beaconHash=h.contributions[t].beaconHash,e.numIterationsExp=h.contributions[t].numIterationsExp),h.contributions[t].name&&(e.name=h.contributions[t].name)),g.contributions.push(e)}if(!eU(g.csHash,h.csHash))return o&&o.error("Hash of the original circuit does not match with the MPC one"),!1;if(h.contributions.length>g.contributions.length)return o&&o.error("The impoerted file does not include new contributions"),!1;for(let t=0;t<h.contributions.length;t++){var m,b;if(m=h.contributions[t],b=g.contributions[t],!(d.G1.eq(m.deltaAfter,b.deltaAfter)&&d.G1.eq(m.delta.g1_s,b.delta.g1_s)&&d.G1.eq(m.delta.g1_sx,b.delta.g1_sx)&&d.G2.eq(m.delta.g2_spx,b.delta.g2_spx)&&eU(m.transcript,b.transcript)))return o&&o.error(`Previous contribution ${t} does not match`),!1}if(i)for(let t=h.contributions.length;t<g.contributions.length;t++)g.contributions[t].name=i;let L=await ep(a,"zkey",1,10);if(p.pos=0,p.pos+=u,p.pos+=u,p.pos+=f,p.pos+=f,c.vk_delta_1=await I(p),c.vk_delta_2=await F(p),await eK(L,c),await p.readUBE32()!=c.nPublic+1)return o&&o.error("Invalid number of points in IC"),await L.discard(),!1;if(p.pos+=u*(c.nPublic+1),await eA(r,s,L,3),await eA(r,s,L,4),await p.readUBE32()!=c.domainSize-1)return o&&o.error("Invalid number of points in H"),await L.discard(),!1;let w=await p.read(u*(c.domainSize-1)),y=await d.G1.batchUtoLEM(w);(n=new Uint8Array(c.domainSize*u)).set(y),d.G1.toRprLEM(n,u*(c.domainSize-1),d.G1.zeroAffine);let A=d.Fr.neg(d.Fr.inv(d.Fr.e(2))),C=d.Fr.inv(d.Fr.w[c.power+1]);if(n=await d.G1.batchApplyKey(n,A,C,"affine","jacobian",o),n=await d.G1.ifft(n,"jacobian","affine",o),await e_(L,9),await L.write(n),await em(L),await p.readUBE32()!=c.nVars-c.nPublic-1)return o&&o.error("Invalid number of points in L"),await L.discard(),!1;if(l=await p.read(u*(c.nVars-c.nPublic-1)),l=await d.G1.batchUtoLEM(l),await e_(L,8),await L.write(l),await em(L),await p.readUBE32()!=c.nVars)return o&&o.error("Invalid number of points in A"),await L.discard(),!1;if(p.pos+=u*c.nVars,await eA(r,s,L,5),await p.readUBE32()!=c.nVars)return o&&o.error("Invalid number of points in B1"),await L.discard(),!1;if(p.pos+=u*c.nVars,await eA(r,s,L,6),await p.readUBE32()!=c.nVars)return o&&o.error("Invalid number of points in B2"),await L.discard(),!1;return p.pos+=f*c.nVars,await eA(r,s,L,7),await e6(L,d,g),await p.close(),await L.close(),await r.close(),!0;async function I(t){let e=await t.read(2*d.G1.F.n8);return d.G1.fromRprUncompressed(e,0)}async function F(t){let e=await t.read(2*d.G2.F.n8);return d.G2.fromRprUncompressed(e,0)}}async function os(t,e,a,i){await eP.ready();let{fd:o,sections:l}=await eg(a,"zkey",2),r=await eJ(o,l,!1);if("groth16"!=r.protocol)throw Error("zkey file is not groth16");let s=await eS(r.q),c=2*s.G1.F.n8,d=await e8(o,s,l),u=eP(64);u.update(d.csHash);let f=s.G1.g;for(let t=0;t<d.contributions.length;t++){let e=d.contributions[t],a=function(t){let e=t.getPartialHash(),a=eP(64);return a.setPartialHash(e),a}(u);if(e7(a,s,e.delta.g1_s),e7(a,s,e.delta.g1_sx),!eU(a.digest(),e.transcript))return console.log(`INVALID(${t}): Inconsistent transcript `),!1;let i=ay(s,e.transcript);if(!0!==await eM(s,e.delta.g1_s,e.delta.g1_sx,i,e.delta.g2_spx))return console.log(`INVALID(${t}): public key G1 and G2 do not have the same ration `),!1;if(!0!==await eM(s,f,e.deltaAfter,i,e.delta.g2_spx))return console.log(`INVALID(${t}): deltaAfter does not fillow the public key `),!1;if(1==e.type){let a=await eD(e.beaconHash,e.numIterationsExp),i=s.Fr.fromRng(a),o=s.G1.toAffine(s.G1.fromRng(a)),n=s.G1.toAffine(s.G1.timesFr(o,i));if(!0!==s.G1.eq(o,e.delta.g1_s))return console.log(`INVALID(${t}): Key of the beacon does not match. g1_s `),!1;if(!0!==s.G1.eq(n,e.delta.g1_sx))return console.log(`INVALID(${t}): Key of the beacon does not match. g1_sx `),!1}e5(u,s,e);let o=eP(64);e5(o,s,e),e.contributionHash=o.digest(),f=e.deltaAfter}let{fd:h,sections:g}=await eg(t,"zkey",2),p=await eJ(h,g,!1);if("groth16"!=p.protocol)throw Error("zkeyinit file is not groth16");if(!n.eq(p.q,r.q)||!n.eq(p.r,r.r)||p.n8q!=r.n8q||p.n8r!=r.n8r)return i&&i.error("INVALID:  Different curves"),!1;if(p.nVars!=r.nVars||p.nPublic!=r.nPublic||p.domainSize!=r.domainSize)return i&&i.error("INVALID:  Different circuit parameters"),!1;if(!s.G1.eq(r.vk_alpha_1,p.vk_alpha_1))return i&&i.error("INVALID:  Invalid alpha1"),!1;if(!s.G1.eq(r.vk_beta_1,p.vk_beta_1))return i&&i.error("INVALID:  Invalid beta1"),!1;if(!s.G2.eq(r.vk_beta_2,p.vk_beta_2))return i&&i.error("INVALID:  Invalid beta2"),!1;if(!s.G2.eq(r.vk_gamma_2,p.vk_gamma_2))return i&&i.error("INVALID:  Invalid gamma2"),!1;if(!s.G1.eq(r.vk_delta_1,f))return i&&i.error("INVALID:  Invalid delta1"),!1;if(!0!==await eM(s,s.G1.g,f,s.G2.g,r.vk_delta_2))return i&&i.error("INVALID:  Invalid delta2"),!1;let _=await e8(h,s,g);if(!eU(d.csHash,_.csHash))return i&&i.error("INVALID:  Circuit does not match"),!1;if(l[8][0].size!=c*(r.nVars-r.nPublic-1))return i&&i.error("INVALID:  Invalid L section size"),!1;if(l[9][0].size!=c*r.domainSize)return i&&i.error("INVALID:  Invalid H section size"),!1;if(!await eI(o,l,h,g,3))return i&&i.error("INVALID:  IC section is not identical"),!1;if(!await eI(o,l,h,g,4))return i&&i.error("Coeffs section is not identical"),!1;if(!await eI(o,l,h,g,5))return i&&i.error("A section is not identical"),!1;if(!await eI(o,l,h,g,6))return i&&i.error("B1 section is not identical"),!1;if(!await eI(o,l,h,g,7))return i&&i.error("B2 section is not identical"),!1;if(!0!==await m("G1",h,g,o,l,8,r.vk_delta_2,p.vk_delta_2,"L section"))return i&&i.error("L section does not match"),!1;if(!0!==await b())return i&&i.error("H section does not match"),!1;i&&i.info(ez(d.csHash,"Circuit Hash: ")),await o.close(),await h.close();for(let t=d.contributions.length-1;t>=0;t--){let e=d.contributions[t];i&&i.info("-------------------------"),i&&i.info(ez(e.contributionHash,`contribution #${t+1} ${e.name?e.name:""}:`)),1==e.type&&(i&&i.info(`Beacon generator: ${ej(e.beaconHash)}`),i&&i.info(`Beacon iterations Exp: ${e.numIterationsExp}`))}return i&&i.info("-------------------------"),i&&i.info("ZKey Ok!"),!0;async function m(t,e,a,o,n,l,r,c,d){let u=s[t],f=2*u.F.n8;await eb(e,a,l),await eb(o,n,l);let h=u.zero,g=u.zero,p=a[l][0].size/f;for(let t=0;t<p;t+=1048576){i&&i.debug(`Same ratio check ${d}:  ${t}/${p}`);let a=Math.min(p-t,1048576),n=await e.read(a*f),l=await o.read(a*f),r=eQ(4*a),s=await u.multiExpAffine(n,r),c=await u.multiExpAffine(l,r);h=u.add(h,s),g=u.add(g,c)}return await eL(e),await eL(o),0==p||!0===await eM(s,h,g,r,c)}async function b(){let t;let a=s.G1,n=s.Fr,c=2*a.F.n8,{fd:d,sections:u}=await eg(e,"ptau",1),f=new tS(r.domainSize*r.n8r),h=Array(8);for(let t=0;t<8;t++)h[t]=eR(eQ(4),0);let g=new td(h);for(let t=0;t<r.domainSize-1;t++){let e=n.fromRng(g);n.toRprLE(f,t*r.n8r,e)}n.toRprLE(f,(r.domainSize-1)*r.n8r,n.zero);let _=a.zero;for(let t=0;t<r.domainSize;t+=1048576){i&&i.debug(`H Verification(tau):  ${t}/${r.domainSize}`);let e=Math.min(r.domainSize-t,1048576),o=await d.read(c*e,u[2][0].p+r.domainSize*c+t*c),n=await d.read(c*e,u[2][0].p+t*c),l=await L(o,n),s=f.slice(t*r.n8r,(t+e)*r.n8r),h=await a.multiExpAffine(l,s);_=a.add(_,h)}if(f=await n.batchToMontgomery(f),r.power<n.s)t=n.neg(n.e(2));else{let e=2**n.s,a=n.exp(n.shift,e);t=n.sub(a,n.one)}let m=r.power<n.s?n.w[r.power+1]:n.shift;f=await n.batchApplyKey(f,t,m),f=await n.fft(f),f=await n.batchFromMontgomery(f),await eb(o,l,9);let b=a.zero;for(let t=0;t<r.domainSize;t+=1048576){i&&i.debug(`H Verification(lagrange):  ${t}/${r.domainSize}`);let e=Math.min(r.domainSize-t,1048576),n=await o.read(c*e),l=f.slice(t*r.n8r,(t+e)*r.n8r),s=await a.multiExpAffine(n,l);b=a.add(b,s)}return await eL(o),!0===await eM(s,_,b,r.vk_delta_2,p.vk_delta_2)}async function L(t,e){let a=2*s.G1.F.n8,i=t.byteLength/a,o=s.tm.concurrency,n=Math.floor(i/o),l=[];for(let a=0;a<o;a++){let r;if(0==(r=a<o-1?n:i-a*n))continue;let s=t.slice(a*n*c,(a*n+r)*c),d=e.slice(a*n*c,(a*n+r)*c);l.push(w(s,d))}let r=await Promise.all(l),d=new Uint8Array(i*a),u=0;for(let t=0;t<r.length;t++)d.set(r[t][0],u),u+=r[t][0].byteLength;return d}async function w(t,e){let a=2*s.G1.F.n8,i=3*s.G1.F.n8,o=t.byteLength/a,n=[];n.push({cmd:"ALLOCSET",var:0,buff:t}),n.push({cmd:"ALLOCSET",var:1,buff:e}),n.push({cmd:"ALLOC",var:2,len:o*i});for(let t=0;t<o;t++)n.push({cmd:"CALL",fnName:"g1m_subAffine",params:[{var:0,offset:t*a},{var:1,offset:t*a},{var:2,offset:t*i}]});return n.push({cmd:"CALL",fnName:"g1m_batchToAffine",params:[{var:2},{val:o},{var:2}]}),n.push({cmd:"GET",out:0,var:2,len:o*a}),await s.tm.queueAction(n)}}async function oc(t,e,a,i){let o={type:"bigMem"};return await on(t,e,o,i),await os(o,e,a,i)}async function od(t,e,a,i,o){await eP.ready();let{fd:n,sections:l}=await eg(t,"zkey",2),r=await eJ(n,l);if("groth16"!=r.protocol)throw Error("zkey file is not groth16");let s=await eS(r.q),c=await e8(n,s,l),d=await ep(e,"zkey",1,10),u=await eN(i),f=eP(64);f.update(c.csHash);for(let t=0;t<c.contributions.length;t++)e5(f,s,c.contributions[t]);let h={};h.delta={},h.delta.prvKey=s.Fr.fromRng(u),h.delta.g1_s=s.G1.toAffine(s.G1.fromRng(u)),h.delta.g1_sx=s.G1.toAffine(s.G1.timesFr(h.delta.g1_s,h.delta.prvKey)),e7(f,s,h.delta.g1_s),e7(f,s,h.delta.g1_sx),h.transcript=f.digest(),h.delta.g2_sp=ay(s,h.transcript),h.delta.g2_spx=s.G2.toAffine(s.G2.timesFr(h.delta.g2_sp,h.delta.prvKey)),r.vk_delta_1=s.G1.timesFr(r.vk_delta_1,h.delta.prvKey),r.vk_delta_2=s.G2.timesFr(r.vk_delta_2,h.delta.prvKey),h.deltaAfter=r.vk_delta_1,h.type=0,a&&(h.name=a),c.contributions.push(h),await eK(d,r),await eA(n,l,d,3),await eA(n,l,d,4),await eA(n,l,d,5),await eA(n,l,d,6),await eA(n,l,d,7);let g=s.Fr.inv(h.delta.prvKey);await aN(n,l,d,8,s,"G1",g,s.Fr.e(1),"L Section",o),await aN(n,l,d,9,s,"G1",g,s.Fr.e(1),"H Section",o),await e6(d,s,c),await n.close(),await d.close();let p=eP(64);e5(p,s,h);let _=p.digest();return o&&o.info(ez(c.csHash,"Circuit Hash: ")),o&&o.info(ez(_,"Contribution Hash: ")),_}async function ou(t,e,a,i,o,n){await eP.ready();let l=e$(i);if(0==l.byteLength||2*l.byteLength!=i.length)return n&&n.error("Invalid Beacon Hash. (It must be a valid hexadecimal sequence)"),!1;if(l.length>=256)return n&&n.error("Maximum length of beacon hash is 255 bytes"),!1;if((o=parseInt(o))<10||o>63)return n&&n.error("Invalid numIterationsExp. (Must be between 10 and 63)"),!1;let{fd:r,sections:s}=await eg(t,"zkey",2),c=await eJ(r,s);if("groth16"!=c.protocol)throw Error("zkey file is not groth16");let d=await eS(c.q),u=await e8(r,d,s),f=await ep(e,"zkey",1,10),h=await eD(l,o),g=eP(64);g.update(u.csHash);for(let t=0;t<u.contributions.length;t++)e5(g,d,u.contributions[t]);let p={};p.delta={},p.delta.prvKey=d.Fr.fromRng(h),p.delta.g1_s=d.G1.toAffine(d.G1.fromRng(h)),p.delta.g1_sx=d.G1.toAffine(d.G1.timesFr(p.delta.g1_s,p.delta.prvKey)),e7(g,d,p.delta.g1_s),e7(g,d,p.delta.g1_sx),p.transcript=g.digest(),p.delta.g2_sp=ay(d,p.transcript),p.delta.g2_spx=d.G2.toAffine(d.G2.timesFr(p.delta.g2_sp,p.delta.prvKey)),c.vk_delta_1=d.G1.timesFr(c.vk_delta_1,p.delta.prvKey),c.vk_delta_2=d.G2.timesFr(c.vk_delta_2,p.delta.prvKey),p.deltaAfter=c.vk_delta_1,p.type=1,p.numIterationsExp=o,p.beaconHash=l,a&&(p.name=a),u.contributions.push(p),await eK(f,c),await eA(r,s,f,3),await eA(r,s,f,4),await eA(r,s,f,5),await eA(r,s,f,6),await eA(r,s,f,7);let _=d.Fr.inv(p.delta.prvKey);await aN(r,s,f,8,d,"G1",_,d.Fr.e(1),"L Section",n),await aN(r,s,f,9,d,"G1",_,d.Fr.e(1),"H Section",n),await e6(f,d,u),await r.close(),await f.close();let m=eP(64);e5(m,d,p);let b=m.digest();return n&&n.info(ez(b,"Contribution Hash: ")),b}async function of(t){let e=await e3(t,!0);return delete e.curve,delete e.F,l.stringifyBigInts(e)}async function oh(t,e,a,i,o){await eP.ready();let n=await eN(i),l=t.Fr.fromRng(n),r=t.Fr.inv(l),s=2*t.G1.F.n8,c=2*t.G2.F.n8,d=await eh(e),u=await ef(a);await v(s),await v(s),await v(c),await v(c);let f=await B(),h=t.G1.timesFr(f,l);await O(h);let g=await S(),p=t.G2.timesFr(g,l);await P(p);let _=await d.readUBE32();await u.writeUBE32(_),await v(_*s);let m=await d.readUBE32();await u.writeUBE32(m),await aD(d,u,null,t,"G1",m,r,t.Fr.e(1),"UNCOMPRESSED","H",o);let b=await d.readUBE32();await u.writeUBE32(b),await aD(d,u,null,t,"G1",b,r,t.Fr.e(1),"UNCOMPRESSED","L",o);let L=await d.readUBE32();await u.writeUBE32(L),await v(L*s);let w=await d.readUBE32();await u.writeUBE32(w),await v(w*s);let y=await d.readUBE32();await u.writeUBE32(y),await v(y*c);let A=eP(64),C={};C.csHash=await d.read(64),A.update(C.csHash);let I=await d.readUBE32();C.contributions=[];for(let e=0;e<I;e++){let e={delta:{}};e.deltaAfter=await B(),e.delta.g1_s=await B(),e.delta.g1_sx=await B(),e.delta.g2_spx=await S(),e.transcript=await d.read(64),C.contributions.push(e),e5(A,t,e)}let F={};F.delta={},F.delta.prvKey=l,F.delta.g1_s=t.G1.toAffine(t.G1.fromRng(n)),F.delta.g1_sx=t.G1.toAffine(t.G1.timesFr(F.delta.g1_s,l)),e7(A,t,F.delta.g1_s),e7(A,t,F.delta.g1_sx),F.transcript=A.digest(),F.delta.g2_sp=ay(t,F.transcript),F.delta.g2_spx=t.G2.toAffine(t.G2.timesFr(F.delta.g2_sp,l)),F.deltaAfter=h,F.type=0,C.contributions.push(F),await u.write(C.csHash),await u.writeUBE32(C.contributions.length);for(let t=0;t<C.contributions.length;t++){let e=C.contributions[t];await O(e.deltaAfter),await O(e.delta.g1_s),await O(e.delta.g1_sx),await P(e.delta.g2_spx),await u.write(e.transcript)}let x=eP(64);e5(x,t,F);let E=x.digest();return o&&o.info(ez(E,"Contribution Hash: ")),await u.close(),await d.close(),E;async function v(t){let e=2*d.pageSize;for(let a=0;a<t;a+=e){let i=Math.min(t-a,e),o=await d.read(i);await u.write(o)}}async function B(){let e=await d.read(2*t.G1.F.n8);return t.G1.fromRprUncompressed(e,0)}async function S(){let e=await d.read(2*t.G2.F.n8);return t.G2.fromRprUncompressed(e,0)}async function O(e){let a=new Uint8Array(s);t.G1.toRprUncompressed(a,0,e),await u.write(a)}async function P(e){let a=new Uint8Array(c);t.G2.toRprUncompressed(a,0,e),await u.write(a)}}let{stringifyBigInts:og}=l;async function op(t,e){let a;e&&e.info("EXPORT VERIFICATION KEY STARTED");let{fd:i,sections:o}=await eg(t,"zkey",2),n=await eJ(i,o);if(e&&e.info("> Detected protocol: "+n.protocol),"groth16"===n.protocol)a=await o_(n,i,o);else if("plonk"===n.protocol)a=await om(n);else if(n.protocolId&&10===n.protocolId)a=await ob(n,e);else throw Error("zkey file protocol unrecognized");return await i.close(),e&&e.info("EXPORT VERIFICATION KEY FINISHED"),a}async function o_(t,e,a){let i=await eS(t.q),o=2*i.G1.F.n8,n=await i.pairing(t.vk_alpha_1,t.vk_beta_2),l={protocol:t.protocol,curve:i.name,nPublic:t.nPublic,vk_alpha_1:i.G1.toObject(t.vk_alpha_1),vk_beta_2:i.G2.toObject(t.vk_beta_2),vk_gamma_2:i.G2.toObject(t.vk_gamma_2),vk_delta_2:i.G2.toObject(t.vk_delta_2),vk_alphabeta_12:i.Gt.toObject(n)};await eb(e,a,3),l.IC=[];for(let a=0;a<=t.nPublic;a++){let t=await e.read(o),a=i.G1.toObject(t);l.IC.push(a)}return await eL(e),l=og(l)}async function om(t){let e=await eS(t.q);return og({protocol:t.protocol,curve:e.name,nPublic:t.nPublic,power:t.power,k1:e.Fr.toObject(t.k1),k2:e.Fr.toObject(t.k2),Qm:e.G1.toObject(t.Qm),Ql:e.G1.toObject(t.Ql),Qr:e.G1.toObject(t.Qr),Qo:e.G1.toObject(t.Qo),Qc:e.G1.toObject(t.Qc),S1:e.G1.toObject(t.S1),S2:e.G1.toObject(t.S2),S3:e.G1.toObject(t.S3),X_2:e.G2.toObject(t.X_2),w:e.Fr.toObject(e.Fr.w[t.power])})}async function ob(t,e){let a=await eS(t.q);return og({protocol:t.protocol,curve:a.name,nPublic:t.nPublic,power:t.power,k1:a.Fr.toObject(t.k1),k2:a.Fr.toObject(t.k2),w:a.Fr.toObject(a.Fr.w[t.power]),w3:a.Fr.toObject(t.w3),w4:a.Fr.toObject(t.w4),w8:a.Fr.toObject(t.w8),wr:a.Fr.toObject(t.wr),X_2:a.G2.toObject(t.X_2),C0:a.G1.toObject(t.C0)})}var oL=a(4752);let{unstringifyBigInts:ow,stringifyBigInts:oy}=l;async function oA(t,e,a){a&&a.info("FFLONK EXPORT SOLIDITY VERIFIER STARTED");let i=await eO(t.curve),o=c(t.w3);t.w3_2=d(i.Fr.square(o));let n=c(t.w4);t.w4_2=d(i.Fr.square(n)),t.w4_3=d(i.Fr.mul(i.Fr.square(n),n));let l=c(t.w8),r=i.Fr.one;for(let e=1;e<8;e++)r=i.Fr.mul(r,l),t["w8_"+e]=d(r);let s=e[t.protocol];return a&&a.info("FFLONK EXPORT SOLIDITY VERIFIER FINISHED"),oL.render(s,t);function c(t){let e=ow(t);return i.Fr.fromObject(e)}function d(t){return oy(i.Fr.toObject(t))}}async function oC(t,e,a){let i=await op(t,a);if("fflonk"===i.protocol)return oA(i,e,a);let o=e[i.protocol];return oL.render(o,i)}async function oI(t,e,a,i){globalThis.gc&&globalThis.gc(),await eP.ready();let{fd:o,sections:l}=await eg(e,"ptau",1,4194304,16777216),{curve:r,power:s}=await ax(o,l),{fd:c,sections:d}=await eg(t,"r1cs",1,4194304,16777216),u=await iX(c,d,{loadConstraints:!0,loadCustomGates:!0}),f=2*r.G1.F.n8,h=r.G1,g=2*r.G2.F.n8,p=r.Fr,_=r.Fr.n8;i&&i.info("Reading r1cs"),await eC(c,d,2);let m=new oo,b=new oo,L=u.nVars,w=u.nOutputs+u.nPubInputs;await S(r.Fr,u,i),globalThis.gc&&globalThis.gc();let y=await ep(a,"zkey",1,14,4194304,16777216);if(u.prime!=r.r)return i&&i.error("r1cs curve does not match powers of tau ceremony curve"),-1;let A=eq(m.length-1)+1;A<3&&(A=3);let C=2**A;if(i&&i.info("Plonk constraints: "+m.length),A>s)return i&&i.error(`circuit too big for this power of tau ceremony. ${m.length} > 2**${s}`),-1;if(!l[12])return i&&i.error("Powers of tau is not prepared."),-1;let I=new tS(C*f),F=l[12][0].p+(2**A-1)*f;await o.readToBuffer(I,0,C*f,F);let[x,E]=function(){let t=p.two;for(;a(t,[],A);)p.add(t,p.one);let e=p.add(t,p.one);for(;a(e,[t],A);)p.add(e,p.one);return[t,e];function a(t,e,a){let i=2**a,o=p.one;for(let n=0;n<i;n++){if(p.eq(t,o))return!0;for(let a=0;a<e.length;a++)if(p.eq(t,p.mul(e[a],o)))return!0;o=p.mul(o,p.w[a])}return!1}}(),v={};await T(3,"Additions"),globalThis.gc&&globalThis.gc(),await O(4,0,"Amap"),globalThis.gc&&globalThis.gc(),await O(5,1,"Bmap"),globalThis.gc&&globalThis.gc(),await O(6,2,"Cmap"),globalThis.gc&&globalThis.gc(),await P(7,3,"Qm"),globalThis.gc&&globalThis.gc(),await P(8,4,"Ql"),globalThis.gc&&globalThis.gc(),await P(9,5,"Qr"),globalThis.gc&&globalThis.gc(),await P(10,6,"Qo"),globalThis.gc&&globalThis.gc(),await P(11,7,"Qc"),globalThis.gc&&globalThis.gc(),await q(12,"sigma"),globalThis.gc&&globalThis.gc(),await z(13,"lagrange polynomials"),globalThis.gc&&globalThis.gc(),await e_(y,14);let B=new tS((C+6)*f);async function S(t,e,a){function i(t){let e=Object.keys(t);for(let a=0;a<e.length;a++)0n==t[e[a]]&&delete t[e[a]]}function o(e,a,o){let n={};for(let i in e)void 0===n[i]?n[i]=t.mul(a,e[i]):n[i]=t.add(n[i],t.mul(a,e[i]));for(let e in o)void 0===n[e]?n[e]=o[e]:n[e]=t.add(n[e],o[e]);return i(n),n}function n(e,a){let i={k:t.zero,s:[],coefs:[]},o=[];for(let a in e)0==a?i.k=t.add(i.k,e[a]):0n!=e[a]&&o.push([Number(a),e[a]]);for(;o.length>a;){let e=o.shift(),a=o.shift(),i=e[0],n=a[0],l=L++,r=t.zero,s=t.neg(e[1]),c=t.neg(a[1]),d=t.one,u=t.zero;m.push([i,n,l,r,s,c,d,u]),b.push([i,n,e[1],a[1]]),o.push([l,t.one])}for(let t=0;t<o.length;t++)i.s[t]=o[t][0],i.coefs[t]=o[t][1];for(;i.coefs.length<a;)i.s.push(0),i.coefs.push(t.zero);return i}function l(e){let a=n(e,3),i=a.s[0],o=a.s[1],l=a.s[2],r=t.zero,s=a.coefs[0],c=a.coefs[1],d=a.coefs[2],u=a.k;m.push([i,o,l,r,s,c,d,u])}function r(e){let a=t.zero,i=0,o=Object.keys(e);for(let n=0;n<o.length;n++)0n==e[o[n]]?delete e[o[n]]:0==o[n]?a=t.add(a,e[o[n]]):i++;return i>0?i.toString():a!=t.zero?"k":"0"}for(let e=1;e<=w;e++){let a=e,i=t.zero,o=t.one,n=t.zero,l=t.zero,r=t.zero;m.push([a,0,0,i,o,n,l,r])}for(let s=0;s<e.constraints.length;s++)a&&s%1e4==0&&a.debug(`processing constraints: ${s}/${e.nConstraints}`),function(e,a,s){let c=r(e),d=r(a);"0"===c||"0"===d?(i(s),l(s)):"k"===c?l(o(a,e[0],s)):"k"===d?l(o(e,a[0],s)):function(e,a,i){let o=n(e,1),l=n(a,1),r=n(i,1),s=o.s[0],c=l.s[0],d=r.s[0],u=t.mul(o.coefs[0],l.coefs[0]),f=t.mul(o.coefs[0],l.k),h=t.mul(o.k,l.coefs[0]),g=t.neg(r.coefs[0]),p=t.sub(t.mul(o.k,l.k),r.k);m.push([s,c,d,u,f,h,g,p])}(e,a,s)}(...e.constraints[s])}async function O(t,e,a){await e_(y,t);for(let t=0;t<m.length;t++)await y.writeULE32(m[t][e]),i&&t%1e6==0&&i.debug(`writing ${a}: ${t}/${m.length}`);await em(y)}async function P(t,e,a){let o=new tS(C*_);for(let t=0;t<m.length;t++)o.set(m[t][e],t*_),i&&t%1e6==0&&i.debug(`writing ${a}: ${t}/${m.length}`);await e_(y,t),await G(o),await em(y),o=await p.batchFromMontgomery(o),v[a]=await r.G1.multiExpAffine(I,o,i,"multiexp "+a)}async function G(t){let e=await p.ifft(t),a=new tS(C*_*4);a.set(e,0);let i=await p.fft(a);await y.write(e),await y.write(i)}async function T(t,e){await e_(y,t);let a=new Uint8Array(8+2*_),o=new DataView(a.buffer);for(let t=0;t<b.length;t++){let n=b[t],l=0;o.setUint32(l,n[0],!0),l+=4,o.setUint32(l,n[1],!0),l+=4,a.set(n[2],l),l+=_,a.set(n[3],l),l+=_,await y.write(a),i&&t%1e6==0&&i.debug(`writing ${e}: ${t}/${b.length}`)}await em(y)}async function q(t,e){let a=new tS(_*C*3),o=new oo(L),n=new oo(L),l=p.one;for(let t=0;t<C;t++)t<m.length?(u(m[t][0],t),u(m[t][1],C+t),u(m[t][2],2*C+t)):(u(0,t),u(0,C+t),u(0,2*C+t)),l=p.mul(l,p.w[A]),i&&t%1e6==0&&i.debug(`writing ${e} phase1: ${t}/${m.length}`);for(let t=0;t<L;t++)void 0!==n[t]?a.set(o[t],n[t]*_):console.log("Variable not used"),i&&t%1e6==0&&i.debug(`writing ${e} phase2: ${t}/${L}`);globalThis.gc&&globalThis.gc(),await e_(y,t);let s=a.slice(0,C*_);await G(s),globalThis.gc&&globalThis.gc();let c=a.slice(C*_,C*_*2);await G(c),globalThis.gc&&globalThis.gc();let d=a.slice(C*_*2,C*_*3);function u(t,e){let i;void 0===o[t]?n[t]=e:a.set(o[t],e*_),i=e<C?l:e<2*C?p.mul(l,x):p.mul(l,E),o[t]=i}await G(d),globalThis.gc&&globalThis.gc(),await em(y),s=await p.batchFromMontgomery(s),c=await p.batchFromMontgomery(c),d=await p.batchFromMontgomery(d),v.S1=await r.G1.multiExpAffine(I,s,i,"multiexp S1"),globalThis.gc&&globalThis.gc(),v.S2=await r.G1.multiExpAffine(I,c,i,"multiexp S2"),globalThis.gc&&globalThis.gc(),v.S3=await r.G1.multiExpAffine(I,d,i,"multiexp S3"),globalThis.gc&&globalThis.gc()}async function z(t,e){await e_(y,t);let a=Math.max(w,1);for(let t=0;t<a;t++){let o=new tS(C*_);o.set(p.one,t*_),await G(o),i&&i.debug(`writing ${e} ${t}/${a}`)}await em(y)}async function U(){let t;await e_(y,1),await y.writeULE32(2),await em(y),await e_(y,2);let e=r.q,a=(Math.floor((n.bitLength(e)-1)/64)+1)*8,i=r.r,s=(Math.floor((n.bitLength(i)-1)/64)+1)*8;await y.writeULE32(a),await ew(y,e,a),await y.writeULE32(s),await ew(y,i,s),await y.writeULE32(L),await y.writeULE32(w),await y.writeULE32(C),await y.writeULE32(b.length),await y.writeULE32(m.length),await y.write(x),await y.write(E),await y.write(h.toAffine(v.Qm)),await y.write(h.toAffine(v.Ql)),await y.write(h.toAffine(v.Qr)),await y.write(h.toAffine(v.Qo)),await y.write(h.toAffine(v.Qc)),await y.write(h.toAffine(v.S1)),await y.write(h.toAffine(v.S2)),await y.write(h.toAffine(v.S3)),t=await o.read(g,l[3][0].p+g),await y.write(t),await em(y)}await o.readToBuffer(B,0,(C+6)*f,l[2][0].p),await y.write(B),await em(y),globalThis.gc&&globalThis.gc(),await U(),await y.close(),await c.close(),await o.close(),i&&i.info("Setup Finished")}class oF{constructor(t,e){this.curve=t,this.logger=e,this.resetProof()}resetProof(){this.polynomials={},this.evaluations={}}addPolynomial(t,e){t in this.polynomials&&this.logger.warn(`proof: polynomial.${t} already exist in proof`),this.polynomials[t]=e}getPolynomial(t){return t in this.polynomials||this.logger.warn(`proof: polynomial ${t} does not exist in proof`),this.polynomials[t]}addEvaluation(t,e){t in this.evaluations&&this.logger.warn(`proof: evaluations.${t} already exist in proof`),this.evaluations[t]=e}getEvaluation(t){return t in this.evaluations||this.logger.warn(`proof: evaluation ${t} does not exist in proof`),this.evaluations[t]}toObjectProof(t=!0){let e=t?{polynomials:{},evaluations:{}}:{};return Object.keys(this.polynomials).forEach(a=>{let i=this.curve.G1.toObject(this.polynomials[a]);t?e.polynomials[a]=i:e[a]=i}),Object.keys(this.evaluations).forEach(a=>{let i=this.curve.Fr.toObject(this.evaluations[a]);t?e.evaluations[a]=i:e[a]=i}),e}fromObjectProof(t){this.resetProof(),Object.keys(t.polynomials).forEach(e=>{this.polynomials[e]=this.curve.G1.fromObject(t.polynomials[e])}),Object.keys(t.evaluations).forEach(e=>{this.evaluations[e]=this.curve.Fr.fromObject(t.evaluations[e])})}}let{keccak256:ox}=a(2648);class oE{constructor(t){this.G1=t.G1,this.Fr=t.Fr,this.reset()}reset(){this.data=[]}addPolCommitment(t){this.data.push({type:0,data:t})}addScalar(t){this.data.push({type:1,data:t})}getChallenge(){if(0===this.data.length)throw Error("Keccak256Transcript: No data to generate a transcript");let t=0,e=0;this.data.forEach(a=>0===a.type?t++:e++);let a=new Uint8Array(e*this.Fr.n8+t*this.G1.F.n8*2),i=0;for(let t=0;t<this.data.length;t++)0===this.data[t].type?(this.G1.toRprUncompressed(a,i,this.data[t].data),i+=2*this.G1.F.n8):(this.Fr.toRprBE(a,i,this.data[t].data),i+=this.Fr.n8);let o=n.fromRprBE(new Uint8Array(ox.arrayBuffer(a)));return this.Fr.e(o)}}class ov{static getZ1(t){return[t.zero,t.add(t.e(-1),t.w[2]),t.e(-2),t.sub(t.e(-1),t.w[2])]}static getZ2(t){return[t.zero,t.add(t.zero,t.mul(t.e(-2),t.w[2])),t.e(4),t.sub(t.zero,t.mul(t.e(-2),t.w[2]))]}static getZ3(t){return[t.zero,t.add(t.e(2),t.mul(t.e(2),t.w[2])),t.e(-8),t.sub(t.e(2),t.mul(t.e(2),t.w[2]))]}static mul2(t,e,a,i,o,n){let l;let r=this.getZ1(n),s=n.mul(t,e),c=n.mul(t,i),d=n.mul(a,e),u=n.mul(a,i);return l=n.add(c,d),o&&(l=n.add(l,n.mul(r[o],u))),[s,l]}static mul3(t,e,a,i,o,n,l,r){let s,c;let d=this.getZ1(r),u=this.getZ2(r),f=r.mul(t,e),h=r.mul(t,o),g=r.mul(i,e),p=r.mul(i,o);s=r.mul(f,a);let _=r.mul(g,a);_=r.add(_,r.mul(h,a)),_=r.add(_,r.mul(f,n));let m=r.mul(p,a);if(m=r.add(m,r.mul(h,n)),m=r.add(m,r.mul(g,n)),c=_,l){let t=r.mul(p,n);c=r.add(c,r.mul(d[l],m)),c=r.add(c,r.mul(u[l],t))}return[s,c]}static mul4(t,e,a,i,o,n,l,r,s,c){let d,u;let f=this.getZ1(c),h=this.getZ2(c),g=this.getZ3(c),p=c.mul(t,e),_=c.mul(t,n),m=c.mul(o,e),b=c.mul(o,n),L=c.mul(a,i),w=c.mul(a,r),y=c.mul(l,i),A=c.mul(l,r);d=c.mul(p,L);let C=c.mul(m,L);C=c.add(C,c.mul(_,L)),C=c.add(C,c.mul(p,y)),C=c.add(C,c.mul(p,w));let I=c.mul(b,L);I=c.add(I,c.mul(m,y)),I=c.add(I,c.mul(m,w)),I=c.add(I,c.mul(_,y)),I=c.add(I,c.mul(_,w)),I=c.add(I,c.mul(p,A));let F=c.mul(_,A);F=c.add(F,c.mul(m,A)),F=c.add(F,c.mul(b,w)),F=c.add(F,c.mul(b,y));let x=c.mul(b,A);return u=C,s&&(u=c.add(u,c.mul(f[s],I)),u=c.add(u,c.mul(h[s],F)),u=c.add(u,c.mul(g[s],x))),[d,u]}}class oB{constructor(t,e,a){this.coef=t,this.curve=e,this.Fr=e.Fr,this.G1=e.G1,this.logger=a}static async fromEvaluations(t,e,a){return new oB(await e.Fr.ifft(t),e,a)}static fromCoefficientsArray(t,e,a){let i=e.Fr,o=t.length>32768?new tS(t.length*i.n8):new Uint8Array(t.length*i.n8);for(let e=0;e<t.length;e++)o.set(t[e],e*i.n8);return new oB(o,e,a)}static fromPolynomial(t,e,a){let i=t.length(),o=e.Fr,n=i>32768?new tS(i*o.n8):new Uint8Array(i*o.n8);return n.set(t.coef.slice(),0),new oB(n,e,a)}isEqual(t){let e=this.degree();if(e!==t.degree())return!1;for(let a=0;a<e+1;a++)if(!this.Fr.eq(this.getCoef(a),t.getCoef(a)))return!1;return!0}blindCoefficients(t){t=t||[];let e=this.length()+t.length>32768?new tS((this.length()+t.length)*this.Fr.n8):new Uint8Array((this.length()+t.length)*this.Fr.n8);e.set(this.coef,0);for(let a=0;a<t.length;a++)e.set(this.Fr.add(e.slice((this.length()+a)*this.Fr.n8,(this.length()+a+1)*this.Fr.n8),t[a]),(this.length()+a)*this.Fr.n8),e.set(this.Fr.sub(e.slice(a*this.Fr.n8,(a+1)*this.Fr.n8),t[a]),a*this.Fr.n8);this.coef=e}getCoef(t){let e=t*this.Fr.n8;return e+this.Fr.n8>this.coef.byteLength?this.Fr.zero:this.coef.slice(e,e+this.Fr.n8)}setCoef(t,e){if(t>this.length()-1)throw Error("Coef index is not available");this.coef.set(e,t*this.Fr.n8)}static async to4T(t,e,a,i){a=a||[];let o=await i.ifft(t),n=4*e>32768?new tS(4*e*i.n8):new Uint8Array(4*e*i.n8);n.set(o,0);let l=await i.fft(n);if(0===a.length)return[o,l];let r=e+a.length>32768?new tS((e+a.length)*i.n8):new Uint8Array((e+a.length)*i.n8);r.set(o,0);for(let t=0;t<a.length;t++)r.set(i.add(r.slice((e+t)*i.n8,(e+t+1)*i.n8),a[t]),(e+t)*i.n8),r.set(i.sub(r.slice(t*i.n8,(t+1)*i.n8),a[t]),t*i.n8);return[r,l]}length(){let t=this.coef.byteLength/this.Fr.n8;if(t!==Math.floor(this.coef.byteLength/this.Fr.n8))throw Error("Polynomial coefficients buffer has incorrect size");return 0===t&&this.logger&&this.logger.warn("Polynomial has length zero"),t}degree(){for(let t=this.length()-1;t>0;t--){let e=t*this.Fr.n8;if(!this.Fr.eq(this.Fr.zero,this.coef.slice(e,e+this.Fr.n8)))return t}return 0}evaluate(t){let e=this.Fr.zero;for(let a=this.degree()+1;a>0;a--){let i=a*this.Fr.n8,o=this.coef.slice(i-this.Fr.n8,i);e=this.Fr.add(o,this.Fr.mul(e,t))}return e}fastEvaluate(t){let e=this.Fr,a=this.degree()+1,i=parseInt(a/3),o=a-3*i,n=[],l=[];l[0]=e.one;for(let a=0;a<3;a++){n[a]=e.zero;let r=2===a?i+o:i;for(let o=r;o>0;o--)n[a]=e.add(this.getCoef(a*i+o-1),e.mul(n[a],t)),0===a&&(l[0]=e.mul(l[0],t))}for(let t=1;t<3;t++)n[0]=e.add(n[0],e.mul(l[t-1],n[t])),l[t]=e.mul(l[t-1],l[0]);return n[0]}add(t,e){let a=!1;t.length()>this.length()&&(a=!0);let i=this.length(),o=t.length();for(let n=0;n<Math.max(i,o);n++){let l=n*this.Fr.n8,r=n<i?this.coef.slice(l,l+this.Fr.n8):this.Fr.zero,s=n<o?t.coef.slice(l,l+this.Fr.n8):this.Fr.zero;void 0!==e&&(s=this.Fr.mul(s,e)),a?t.coef.set(this.Fr.add(r,s),l):this.coef.set(this.Fr.add(r,s),l)}a&&(delete this.coef,this.coef=t.coef)}sub(t,e){let a=!1;t.length()>this.length()&&(a=!0);let i=this.length(),o=t.length();for(let n=0;n<Math.max(i,o);n++){let l=n*this.Fr.n8,r=n<i?this.coef.slice(l,l+this.Fr.n8):this.Fr.zero,s=n<o?t.coef.slice(l,l+this.Fr.n8):this.Fr.zero;void 0!==e&&(s=this.Fr.mul(s,e)),a?t.coef.set(this.Fr.sub(r,s),l):this.coef.set(this.Fr.sub(r,s),l)}a&&(delete this.coef,this.coef=t.coef)}mulScalar(t){for(let e=0;e<this.length();e++){let a=e*this.Fr.n8;this.coef.set(this.Fr.mul(this.coef.slice(a,a+this.Fr.n8),t),a)}}addScalar(t){let e=0===this.length()?this.Fr.zero:this.coef.slice(0,this.Fr.n8);this.coef.set(this.Fr.add(e,t),0)}subScalar(t){let e=0===this.length()?this.Fr.zero:this.coef.slice(0,this.Fr.n8);this.coef.set(this.Fr.sub(e,t),0)}byXSubValue(t){let e=this.Fr,a=e.eq(e.zero,this.getCoef(this.length()-1))?this.length():this.length()+1,i=new oB(a>32768?new tS(a*e.n8):new Uint8Array(a*e.n8),this.curve,this.logger);i.coef.set(this.coef.slice(0,(a-1)*e.n8),32),this.mulScalar(e.neg(t)),i.add(this),this.coef=i.coef}byXNSubValue(t,e){let a=this.Fr,i=this.length()-t-1>=this.degree()?this.length():this.length()+t,o=new oB(i>32768?new tS(i*a.n8):new Uint8Array(i*a.n8),this.curve,this.logger);o.coef.set(this.coef.slice(0,(this.degree()+1)*32),32*t),this.mulScalar(e),o.add(this),this.coef=o.coef}divBy(t){let e=this.Fr,a=this.degree(),i=t.degree(),o=new oB(this.coef,this.curve,this.logger);this.coef=this.length()>32768?new tS(this.length()*e.n8):new Uint8Array(this.length()*e.n8);for(let n=a-i;n>=0;n--){this.setCoef(n,e.div(o.getCoef(n+i),t.getCoef(i)));for(let a=0;a<=i;a++)o.setCoef(n+a,e.sub(o.getCoef(n+a),e.mul(this.getCoef(n),t.getCoef(a))))}return o}divByMonic(t,e){let a=this.Fr,i=this.degree(),o=new oB(this.length()>32768?new tS(this.length()*a.n8):new Uint8Array(this.length()*a.n8),this.curve,this.logger),n=[];for(let e=0;e<t;e++)o.setCoef(i-e-t,this.getCoef(i-e)),n[e]=this.getCoef(i-e);let l=0;for(let r=0;r<t;r++)for(let s=i-2*t-r;s>=0&&!(s<0);s-=t){let i=r;n[i]=a.add(this.getCoef(s+t),a.mul(n[i],e)),o.setCoef(s,n[i]),l=(l+1)%t}this.coef=o.coef}divByVanishing(t,e){if(this.degree()<t)throw Error("divByVanishing polynomial divisor must be of degree lower than the dividend polynomial");let a=this.Fr,i=new oB(this.coef,this.curve,this.logger);this.coef=this.length()>32768?new tS(this.length()*a.n8):new Uint8Array(this.length()*a.n8);for(let o=this.length()-1;o>=t;o--){let n=i.getCoef(o);a.eq(a.zero,n)||(i.setCoef(o,a.zero),i.setCoef(o-t,a.add(i.getCoef(o-t),a.mul(e,n))),this.setCoef(o-t,a.add(this.getCoef(o-t),n)))}return i}divByVanishing2(t,e){if(this.degree()<t)throw Error("divByVanishing polynomial divisor must be of degree lower than the dividend polynomial");let a=this.Fr,i=new oB(this.coef,this.curve,this.logger);this.coef=this.length()>32768?new tS(this.length()*a.n8):new Uint8Array(this.length()*a.n8);let o=this.length()-t,n=Math.floor(o/3),l=o-2*n;console.log(o),console.log(n+"  "+l);for(let o=0;o<3;o++){console.log("> Thread "+o);for(let r=0===o?l:n;r>0;r--){let s=r-1;0!==o&&(s+=(o-1)*n+l);let c=s+t,d=i.getCoef(c);a.eq(a.zero,d)||(i.setCoef(c,a.zero),i.setCoef(s,a.add(i.getCoef(s),a.mul(e,d))),this.setCoef(s,a.add(this.getCoef(s),d)),console.log(s+" <-- "+c))}}return this.print(),i}fastDivByVanishing(t){let e=this.Fr;for(let a=0;a<t.length;a++){let i=t[a][0],o=t[a][1];if(this.degree()<i)throw Error("divByVanishing polynomial divisor must be of degree lower than the dividend polynomial");let n=this.length()-i,l=Math.floor(n/5/i),r=l*i,s=n-5*r,c=new oB(this.length()>32768?new tS(this.length()*e.n8):new Uint8Array(this.length()*e.n8),this.curve,this.logger),d=this.coef;this.coef=c.coef,c.coef=d;for(let t=0;t<5;t++){let a=(t+1)*r+s;for(let t=0;t<i;t++)this.setCoef(a+t-i,c.getCoef(a+t));for(let t=0;t<r-i;t++){let n=a-t-1,l=e.add(c.getCoef(n),e.mul(o,this.getCoef(n)));this.setCoef(n-i,l)}}let u=s;for(let t=0;t<i&&u;t++)this.setCoef(s-t-1,c.getCoef(s+i-t-1)),u--;for(let t=0;t<u;t++){let a=s-t-1,n=e.add(c.getCoef(a),e.mul(o,this.getCoef(a)));this.setCoef(a-i,n)}let f=[],h=e.one;for(let t=0;t<l;t++)h=e.mul(h,o);let g=e.one;for(let t=5;t>0;t--){let a=t-1,o=a*r+s;f[a]=[];for(let n=0;n<i;n++)f[a][n]=this.getCoef(o+n),5!==t&&(f[a][n]=e.add(f[a][n],e.mul(h,f[a+1][n])));g=e.mul(g,h)}for(let t=0;t<5;t++){let a=t*r+s,n=o,l=i-1,c=0===t?s:r;for(let r=0;r<c;r++){let s=a-r-1,c=e.add(this.getCoef(s),e.mul(n,f[t][l]));this.setCoef(s,c),0===l?(l=i-1,n=e.mul(n,o)):l--}}}}divByXSubValue(t){let e=this.length()>32768?new tS(this.length()*this.Fr.n8):new Uint8Array(this.length()*this.Fr.n8);e.set(this.Fr.zero,(this.length()-1)*this.Fr.n8),e.set(this.coef.slice((this.length()-1)*this.Fr.n8,this.length()*this.Fr.n8),(this.length()-2)*this.Fr.n8);for(let a=this.length()-3;a>=0;a--){let i=a*this.Fr.n8;e.set(this.Fr.add(this.coef.slice(i+this.Fr.n8,i+2*this.Fr.n8),this.Fr.mul(t,e.slice(i+this.Fr.n8,i+2*this.Fr.n8))),a*this.Fr.n8)}if(!this.Fr.eq(this.coef.slice(0,this.Fr.n8),this.Fr.mul(this.Fr.neg(t),e.slice(0,this.Fr.n8))))throw Error("Polynomial does not divide");this.coef=e}divZh(t,e=4){for(let e=0;e<t;e++){let t=e*this.Fr.n8;this.coef.set(this.Fr.neg(this.coef.slice(t,t+this.Fr.n8)),t)}let a=this.coef.byteLength/this.Fr.n8;for(let i=t;i<a;i++){let a=i*this.Fr.n8,o=this.Fr.sub(this.coef.slice((i-t)*this.Fr.n8,(i-t)*this.Fr.n8+this.Fr.n8),this.coef.slice(a,a+this.Fr.n8));if(this.coef.set(o,a),i>t*(e-1)-e&&!this.Fr.isZero(o))throw Error("Polynomial is not divisible")}return this}divByZerofier(t,e){let a=this.Fr,i=a.inv(e),o=a.neg(i),n=a.eq(a.one,o),l=a.eq(a.negone,o);if(!n)for(let e=0;e<t;e++){let t;let i=e*this.Fr.n8;t=l?a.neg(this.coef.slice(i,i+this.Fr.n8)):a.mul(o,this.coef.slice(i,i+this.Fr.n8)),this.coef.set(t,i)}n=a.eq(a.one,i),l=a.eq(a.negone,i);for(let e=t;e<this.length();e++){let o=e*this.Fr.n8,r=(e-t)*this.Fr.n8,s=this.Fr.sub(this.coef.slice(r,r+this.Fr.n8),this.coef.slice(o,o+this.Fr.n8));if(n||(s=l?a.neg(s):a.mul(i,s)),this.coef.set(s,o),e>this.length()-t-1&&!this.Fr.isZero(s))throw Error("Polynomial is not divisible")}return this}byX(){let t=this.length()+1>32768?new tS(this.coef.byteLength+this.Fr.n8):new Uint8Array(this.coef.byteLength+this.Fr.n8);t.set(this.Fr.zero,0),t.set(this.coef,this.Fr.n8),this.coef=t}static async expX(t,e,a=!1){let i=t.Fr;if(e<1)throw Error("Compute a new polynomial to a zero or negative number is not allowed");if(1===e)return await oB.fromEvaluations(t.coef,curve,t.logger);let o=a?t.degree():t.length()-1,n=o*e+1>32768?new tS((o*e+1)*i.n8):new Uint8Array((o*e+1)*i.n8);n.set(t.getCoef(0),0);for(let a=1;a<=o;a++){let o=a*i.n8,l=t.getCoef(a);n.set(l,o*e)}return new oB(n,t.curve,t.logger)}split(t,e,a){if(t<1)throw Error(`Polynomials can't be split in ${t} parts`);if(1===t)return[this];if(0!==a.length&&a.length<t-1)throw Error(`Blinding factors length must be ${t-1}`);let i=(e+1)*this.Fr.n8,o=[],n=Math.ceil((this.degree()+1)*this.Fr.n8/i);if(n<t)for(let e=n;e<t;e++)o[e]=new oB(new Uint8Array(this.Fr.n8),this.curve,this.logger);t=Math.min(t,n);for(let e=0;e<t;e++){let n=t-1===e,l=n?this.coef.byteLength-(t-1)*i:i+this.Fr.n8,r=l/this.Fr.n8>32768?new tS(l):new Uint8Array(l);o[e]=new oB(r,this.curve,this.logger);let s=e*i,c=n?this.coef.byteLength:(e+1)*i;if(o[e].coef.set(this.coef.slice(s,c),0),n||o[e].coef.set(a[e],i),0!==e){let t=this.Fr.sub(o[e].coef.slice(0,this.Fr.n8),a[e-1]);o[e].coef.set(t,0)}n&&o[e].truncate()}return o}truncate(){let t=this.degree();if(t+1<this.coef.byteLength/this.Fr.n8){let e=t+1>32768?new tS((t+1)*this.Fr.n8):new Uint8Array((t+1)*this.Fr.n8);e.set(this.coef.slice(0,(t+1)*this.Fr.n8),0),this.coef=e}}static lagrangePolynomialInterpolation(t,e,a){let i=a.Fr,o=n(0);for(let e=1;e<t.length;e++)o.add(n(e));return o;function n(o){let n;for(let e=0;e<t.length;e++)e!==o&&(void 0===n?((n=new oB(t.length>32768?new tS(t.length*i.n8):new Uint8Array(t.length*i.n8),a)).setCoef(0,i.neg(t[e])),n.setCoef(1,i.one)):n.byXSubValue(t[e]));let l=n.evaluate(t[o]);l=i.inv(l);let r=i.mul(e[o],l);return n.mulScalar(r),n}}static zerofierPolynomial(t,e){let a=e.Fr,i=new oB(t.length+1>32768?new tS((t.length+1)*a.n8):new Uint8Array((t.length+1)*a.n8),e);i.setCoef(0,a.neg(t[0])),i.setCoef(1,a.one);for(let e=1;e<t.length;e++)i.byXSubValue(t[e]);return i}print(){let t=this.Fr,e="";for(let a=this.degree();a>=0;a--){let i=this.getCoef(a);!t.eq(t.zero,i)&&(t.isNegative(i)?e+=" - ":a!==this.degree()&&(e+=" + "),e+=t.toString(i),a>0&&(e+=a>1?"x^"+a:"x"))}console.log(e)}async multiExponentiation(t,e){let a=this.coef.byteLength/this.Fr.n8,i=t.slice(0,a*this.G1.F.n8*2),o=await this.Fr.batchFromMontgomery(this.coef),n=await this.G1.multiExpAffine(i,o,this.logger,e);return this.G1.toAffine(n)}}class oS{constructor(t,e,a){this.eval=t,this.curve=e,this.Fr=e.Fr,this.logger=a}static async fromPolynomial(t,e,a,i){let o=new tS(t.length()*e*a.Fr.n8);return o.set(t.coef,0),new oS(await a.Fr.fft(o),a,i)}getEvaluation(t){let e=t*this.Fr.n8;if(e+this.Fr.n8>this.eval.byteLength)throw Error("Evaluations.getEvaluation() out of bounds");return this.eval.slice(e,e+this.Fr.n8)}length(){let t=this.eval.byteLength/this.Fr.n8;if(t!==Math.floor(this.eval.byteLength/this.Fr.n8))throw Error("Polynomial evaluations buffer has incorrect size");return 0===t&&this.logger.warn("Polynomial has length zero"),t}}let{stringifyBigInts:oO}=l;async function oP(t,e,a,i){let{fd:o,sections:l}=await eg(e,"wtns",2,33554432,8388608);a&&a.debug("> Reading witness file");let r=await ae(o,l);a&&a.debug("> Reading zkey file");let{fd:s,sections:c}=await eg(t,"zkey",2,33554432,8388608),d=await eJ(s,c,void 0,i);if("plonk"!=d.protocol)throw Error("zkey file is not plonk");if(!n.eq(d.r,r.q))throw Error("Curve of the witness does not match the curve of the proving key");if(r.nWitness!=d.nVars-d.nAdditions)throw Error(`Invalid witness length. Circuit: ${d.nVars}, witness: ${r.nWitness}, ${d.nAdditions}`);let u=d.curve,f=u.Fr,h=u.Fr.n8,g=d.domainSize*h;a&&(a.debug("----------------------------"),a.debug("  PLONK PROVE SETTINGS"),a.debug(`  Curve:         ${u.name}`),a.debug(`  Circuit power: ${d.power}`),a.debug(`  Domain size:   ${d.domainSize}`),a.debug(`  Vars:          ${d.nVars}`),a.debug(`  Public vars:   ${d.nPublic}`),a.debug(`  Constraints:   ${d.nConstraints}`),a.debug(`  Additions:     ${d.nAdditions}`),a.debug("----------------------------")),a&&a.debug("> Reading witness file data");let p=await eC(o,l,2);p.set(f.zero,0);let _=new tS(h*d.nAdditions),m={},b={},L={},w={},y=new oF(u,a),A=new oE(u);a&&a.debug("> Reading Section 3. Additions"),await x(),a&&a.debug("> Reading Section 12. Sigma1, Sigma2 & Sigma 3"),a&&a.debug("\xb7\xb7\xb7 Reading Sigma polynomials "),b.Sigma1=new oB(new tS(g),u,a),b.Sigma2=new oB(new tS(g),u,a),b.Sigma3=new oB(new tS(g),u,a),await s.readToBuffer(b.Sigma1.coef,0,g,c[12][0].p),await s.readToBuffer(b.Sigma2.coef,0,g,c[12][0].p+5*g),await s.readToBuffer(b.Sigma3.coef,0,g,c[12][0].p+10*g),a&&a.debug("\xb7\xb7\xb7 Reading Sigma evaluations"),L.Sigma1=new oS(new tS(4*g),u,a),L.Sigma2=new oS(new tS(4*g),u,a),L.Sigma3=new oS(new tS(4*g),u,a),await s.readToBuffer(L.Sigma1.eval,0,4*g,c[12][0].p+g),await s.readToBuffer(L.Sigma2.eval,0,4*g,c[12][0].p+6*g),await s.readToBuffer(L.Sigma3.eval,0,4*g,c[12][0].p+11*g),a&&a.debug("> Reading Section 14. Powers of Tau");let C=await eC(s,c,14),I=[];for(let t=1;t<=d.nPublic;t++){let e=p.slice(t*f.n8,t*f.n8+f.n8);I.push(n.fromRprLE(e))}a&&a.debug(""),a&&a.debug("> ROUND 1"),await B(),a&&a.debug("> ROUND 2"),await O(),a&&a.debug("> ROUND 3"),await G(),a&&a.debug("> ROUND 4"),await q(),a&&a.debug("> ROUND 5"),await z(),await s.close(),await o.close();let F=y.toObjectProof(!1);return F.protocol="plonk",F.curve=u.name,a&&a.debug("PLONK PROVER FINISHED"),{proof:oO(F),publicSignals:oO(I)};async function x(){a&&a.debug("\xb7\xb7\xb7 Computing additions");let t=await eC(s,c,3),e=8+2*h;for(let i=0;i<d.nAdditions;i++){a&&0!==i&&i%1e5==0&&a.debug(`    addition ${i}/${d.nAdditions}`);let o=i*e,n=E(t,o),l=E(t,o+=4);o+=4;let r=t.slice(o,o+h);o+=h;let s=t.slice(o,o+h),c=v(n),u=v(l),g=f.add(f.mul(r,c),f.mul(s,u));_.set(g,h*i)}}function E(t,e){let a=t.slice(e,e+4);return new DataView(a.buffer,a.byteOffset,a.byteLength).getUint32(0,!0)}function v(t){return t<d.nVars-d.nAdditions?p.slice(t*h,t*h+h):t<d.nVars?_.slice((t-(d.nVars-d.nAdditions))*h,(t-(d.nVars-d.nAdditions))*h+h):u.Fr.zero}async function B(){w.b=[];for(let t=1;t<=11;t++)w.b[t]=u.Fr.random();a&&a.debug("> Computing A, B, C wire polynomials"),await S(),a&&a.debug("> Computing A, B, C MSM");let t=await b.A.multiExponentiation(C,"A"),e=await b.B.multiExponentiation(C,"B"),i=await b.C.multiExponentiation(C,"C");return y.addPolynomial("A",t),y.addPolynomial("B",e),y.addPolynomial("C",i),0}async function S(){a&&a.debug("\xb7\xb7\xb7 Reading data from zkey file"),m.A=new tS(g),m.B=new tS(g),m.C=new tS(g);let t=await eC(s,c,4),e=await eC(s,c,5),i=await eC(s,c,6);for(let a=0;a<d.nConstraints;a++){let o=a*h,n=4*a,l=E(t,n);m.A.set(v(l),o);let r=E(e,n);m.B.set(v(r),o);let s=E(i,n);m.C.set(v(s),o)}if(m.A=await f.batchToMontgomery(m.A),m.B=await f.batchToMontgomery(m.B),m.C=await f.batchToMontgomery(m.C),a&&a.debug("\xb7\xb7\xb7 Computing A ifft"),b.A=await oB.fromEvaluations(m.A,u,a),a&&a.debug("\xb7\xb7\xb7 Computing B ifft"),b.B=await oB.fromEvaluations(m.B,u,a),a&&a.debug("\xb7\xb7\xb7 Computing C ifft"),b.C=await oB.fromEvaluations(m.C,u,a),a&&a.debug("\xb7\xb7\xb7 Computing A fft"),L.A=await oS.fromPolynomial(b.A,4,u,a),a&&a.debug("\xb7\xb7\xb7 Computing B fft"),L.B=await oS.fromPolynomial(b.B,4,u,a),a&&a.debug("\xb7\xb7\xb7 Computing C fft"),L.C=await oS.fromPolynomial(b.C,4,u,a),b.A.blindCoefficients([w.b[2],w.b[1]]),b.B.blindCoefficients([w.b[4],w.b[3]]),b.C.blindCoefficients([w.b[6],w.b[5]]),b.A.degree()>=d.domainSize+2)throw Error("A Polynomial is not well calculated");if(b.B.degree()>=d.domainSize+2)throw Error("B Polynomial is not well calculated");if(b.C.degree()>=d.domainSize+2)throw Error("C Polynomial is not well calculated")}async function O(){a&&a.debug("> Computing challenges beta and gamma"),A.reset(),A.addPolCommitment(d.Qm),A.addPolCommitment(d.Ql),A.addPolCommitment(d.Qr),A.addPolCommitment(d.Qo),A.addPolCommitment(d.Qc),A.addPolCommitment(d.S1),A.addPolCommitment(d.S2),A.addPolCommitment(d.S3);for(let t=0;t<d.nPublic;t++)A.addScalar(m.A.slice(t*h,t*h+h));A.addPolCommitment(y.getPolynomial("A")),A.addPolCommitment(y.getPolynomial("B")),A.addPolCommitment(y.getPolynomial("C")),w.beta=A.getChallenge(),a&&a.debug("\xb7\xb7\xb7 challenges.beta: "+f.toString(w.beta,16)),A.reset(),A.addScalar(w.beta),w.gamma=A.getChallenge(),a&&a.debug("\xb7\xb7\xb7 challenges.gamma: "+f.toString(w.gamma,16)),a&&a.debug("> Computing Z polynomial"),await P(),a&&a.debug("> Computing Z MSM");let t=await b.Z.multiExponentiation(C,"Z");y.addPolynomial("Z",t)}async function P(){a&&a.debug("\xb7\xb7\xb7 Computing Z evaluations");let t=new tS(g),e=new tS(g);t.set(f.one,0),e.set(f.one,0);let i=f.one;for(let a=0;a<d.domainSize;a++){let o=a*h,n=m.A.slice(o,o+h),l=m.B.slice(o,o+h),r=m.C.slice(o,o+h),s=f.mul(w.beta,i),c=f.add(n,s);c=f.add(c,w.gamma);let u=f.add(l,f.mul(d.k1,s));u=f.add(u,w.gamma);let g=f.add(r,f.mul(d.k2,s));g=f.add(g,w.gamma);let p=f.mul(c,f.mul(u,g)),_=f.add(n,f.mul(L.Sigma1.getEvaluation(4*a),w.beta));_=f.add(_,w.gamma);let b=f.add(l,f.mul(L.Sigma2.getEvaluation(4*a),w.beta));b=f.add(b,w.gamma);let y=f.add(r,f.mul(L.Sigma3.getEvaluation(4*a),w.beta));y=f.add(y,w.gamma);let A=f.mul(_,f.mul(b,y));p=f.mul(t.slice(o,o+h),p),t.set(p,(a+1)%d.domainSize*h),A=f.mul(e.slice(o,o+h),A),e.set(A,(a+1)%d.domainSize*h),i=f.mul(i,f.w[d.power])}e=await f.batchInverse(e);for(let a=0;a<d.domainSize;a++){let i=a*h,o=f.mul(t.slice(i,i+h),e.slice(i,i+h));t.set(o,i)}if(m.Z=t,!f.eq(t.slice(0,h),f.one))throw Error("Copy constraints does not match");if(a&&a.debug("\xb7\xb7\xb7 Computing Z ifft"),b.Z=await oB.fromEvaluations(m.Z,u,a),a&&a.debug("\xb7\xb7\xb7 Computing Z fft"),L.Z=await oS.fromPolynomial(b.Z,4,u,a),b.Z.blindCoefficients([w.b[9],w.b[8],w.b[7]]),b.Z.degree()>=d.domainSize+3)throw Error("Z Polynomial is not well calculated");delete m.Z}async function G(){a&&a.debug("> Computing challenge alpha"),A.reset(),A.addScalar(w.beta),A.addScalar(w.gamma),A.addPolCommitment(y.getPolynomial("Z")),w.alpha=A.getChallenge(),w.alpha2=f.square(w.alpha),a&&a.debug("\xb7\xb7\xb7 challenges.alpha: "+f.toString(w.alpha,16)),a&&a.debug("> Computing T polynomial"),await T(),a&&a.debug("> Computing T MSM");let t=await b.T1.multiExponentiation(C,"T1"),e=await b.T2.multiExponentiation(C,"T2"),i=await b.T3.multiExponentiation(C,"T3");y.addPolynomial("T1",t),y.addPolynomial("T2",e),y.addPolynomial("T3",i)}async function T(){a&&a.debug(`\xb7\xb7\xb7 Reading sections 8, 9, 7, 10, 11. Q selectors`),L.QL=new oS(new tS(4*g),u,a),L.QR=new oS(new tS(4*g),u,a),L.QM=new oS(new tS(4*g),u,a),L.QO=new oS(new tS(4*g),u,a),L.QC=new oS(new tS(4*g),u,a),await s.readToBuffer(L.QL.eval,0,4*g,c[8][0].p+g),await s.readToBuffer(L.QR.eval,0,4*g,c[9][0].p+g),await s.readToBuffer(L.QM.eval,0,4*g,c[7][0].p+g),await s.readToBuffer(L.QO.eval,0,4*g,c[10][0].p+g),await s.readToBuffer(L.QC.eval,0,4*g,c[11][0].p+g),L.Lagrange=new oS(new tS(4*g*d.nPublic),u,a);for(let t=0;t<d.nPublic;t++)await s.readToBuffer(L.Lagrange.eval,t*g*4,4*g,c[13][0].p+5*t*g+g);m.T=new tS(4*g),m.Tz=new tS(4*g),a&&a.debug("\xb7\xb7\xb7 Computing T evaluations");let t=f.one;for(let e=0;e<4*d.domainSize;e++){a&&0!==e&&e%1e5==0&&a.debug(`      T evaluation ${e}/${4*d.domainSize}`);let i=L.A.getEvaluation(e),o=L.B.getEvaluation(e),n=L.C.getEvaluation(e),l=L.Z.getEvaluation(e),r=L.Z.getEvaluation((4*d.domainSize+4+e)%(4*d.domainSize)),s=L.QM.getEvaluation(e),c=L.QL.getEvaluation(e),u=L.QR.getEvaluation(e),g=L.QO.getEvaluation(e),p=L.QC.getEvaluation(e),_=L.Sigma1.getEvaluation(e),b=L.Sigma2.getEvaluation(e),y=L.Sigma3.getEvaluation(e),A=f.add(w.b[2],f.mul(w.b[1],t)),C=f.add(w.b[4],f.mul(w.b[3],t)),I=f.add(w.b[6],f.mul(w.b[5],t)),F=f.square(t),x=f.add(f.add(f.mul(w.b[7],F),f.mul(w.b[8],t)),w.b[9]),E=f.mul(t,f.w[d.power]),v=f.square(E),B=f.add(f.add(f.mul(w.b[7],v),f.mul(w.b[8],E)),w.b[9]),S=f.zero;for(let t=0;t<d.nPublic;t++){let a=4*t*d.domainSize+e,i=L.Lagrange.getEvaluation(a),o=m.A.slice(t*h,(t+1)*h);S=f.sub(S,f.mul(i,o))}let[O,P]=ov.mul2(i,o,A,C,e%4,f);O=f.mul(O,s),P=f.mul(P,s),O=f.add(O,f.mul(i,c)),P=f.add(P,f.mul(A,c)),O=f.add(O,f.mul(o,u)),P=f.add(P,f.mul(C,u)),O=f.add(O,f.mul(n,g)),P=f.add(P,f.mul(I,g)),O=f.add(O,S),O=f.add(O,p);let G=f.mul(w.beta,t),T=i;T=f.add(T,G),T=f.add(T,w.gamma);let q=o;q=f.add(q,f.mul(G,d.k1)),q=f.add(q,w.gamma);let z=n;z=f.add(z,f.mul(G,d.k2)),z=f.add(z,w.gamma);let[U,M]=ov.mul4(T,q,z,l,A,C,I,x,e%4,f);U=f.mul(U,w.alpha),M=f.mul(M,w.alpha);let Q=i;Q=f.add(Q,f.mul(w.beta,_)),Q=f.add(Q,w.gamma);let k=o;k=f.add(k,f.mul(w.beta,b)),k=f.add(k,w.gamma);let R=n;R=f.add(R,f.mul(w.beta,y)),R=f.add(R,w.gamma);let[N,D]=ov.mul4(Q,k,R,r,A,C,I,B,e%4,f);N=f.mul(N,w.alpha),D=f.mul(D,w.alpha);let $=f.sub(l,f.one);$=f.mul($,L.Lagrange.getEvaluation(e)),$=f.mul($,w.alpha2);let j=f.mul(x,L.Lagrange.getEvaluation(e));j=f.mul(j,w.alpha2);let V=f.add(f.sub(f.add(O,U),N),$),K=f.add(f.sub(f.add(P,M),D),j);m.T.set(V,e*h),m.Tz.set(K,e*h),t=f.mul(t,f.w[d.power+2])}if(a&&a.debug("\xb7\xb7\xb7 Computing T ifft"),b.T=await oB.fromEvaluations(m.T,u,a),a&&a.debug("\xb7\xb7\xb7 Computing T / ZH"),b.T.divZh(d.domainSize,4),a&&a.debug("\xb7\xb7\xb7 Computing Tz ifft"),b.Tz=await oB.fromEvaluations(m.Tz,u,a),b.T.add(b.Tz),b.T.degree()>=3*d.domainSize+6)throw Error("T Polynomial is not well calculated");a&&a.debug("\xb7\xb7\xb7 Computing T1, T2, T3 polynomials"),b.T1=new oB(new tS((d.domainSize+1)*h),u,a),b.T2=new oB(new tS((d.domainSize+1)*h),u,a),b.T3=new oB(new tS((d.domainSize+6)*h),u,a),b.T1.coef.set(b.T.coef.slice(0,g),0),b.T2.coef.set(b.T.coef.slice(g,2*g),0),b.T3.coef.set(b.T.coef.slice(2*g,3*g+6*h),0),b.T1.setCoef(d.domainSize,w.b[10]);let e=f.sub(b.T2.getCoef(0),w.b[10]);b.T2.setCoef(0,e),b.T2.setCoef(d.domainSize,w.b[11]);let i=f.sub(b.T3.getCoef(0),w.b[11]);b.T3.setCoef(0,i)}async function q(){a&&a.debug("> Computing challenge xi"),A.reset(),A.addScalar(w.alpha),A.addPolCommitment(y.getPolynomial("T1")),A.addPolCommitment(y.getPolynomial("T2")),A.addPolCommitment(y.getPolynomial("T3")),w.xi=A.getChallenge(),w.xiw=f.mul(w.xi,f.w[d.power]),a&&a.debug("\xb7\xb7\xb7 challenges.xi: "+f.toString(w.xi,16)),y.addEvaluation("eval_a",b.A.evaluate(w.xi)),y.addEvaluation("eval_b",b.B.evaluate(w.xi)),y.addEvaluation("eval_c",b.C.evaluate(w.xi)),y.addEvaluation("eval_s1",b.Sigma1.evaluate(w.xi)),y.addEvaluation("eval_s2",b.Sigma2.evaluate(w.xi)),y.addEvaluation("eval_zw",b.Z.evaluate(w.xiw))}async function z(){a&&a.debug("> Computing challenge v"),A.reset(),A.addScalar(w.xi),A.addScalar(y.getEvaluation("eval_a")),A.addScalar(y.getEvaluation("eval_b")),A.addScalar(y.getEvaluation("eval_c")),A.addScalar(y.getEvaluation("eval_s1")),A.addScalar(y.getEvaluation("eval_s2")),A.addScalar(y.getEvaluation("eval_zw")),w.v=[],w.v[1]=A.getChallenge(),a&&a.debug("\xb7\xb7\xb7 challenges.v: "+f.toString(w.v[1],16));for(let t=2;t<6;t++)w.v[t]=f.mul(w.v[t-1],w.v[1]);a&&a.debug("> Computing linearisation polynomial R(X)"),await U(),a&&a.debug("> Computing opening proof polynomial Wxi(X) polynomial"),b.Wxi=new oB(new tS(g+6*h),u,a),b.Wxi.add(b.R),b.Wxi.add(b.A,w.v[1]),b.Wxi.add(b.B,w.v[2]),b.Wxi.add(b.C,w.v[3]),b.Wxi.add(b.Sigma1,w.v[4]),b.Wxi.add(b.Sigma2,w.v[5]),b.Wxi.subScalar(f.mul(w.v[1],y.evaluations.eval_a)),b.Wxi.subScalar(f.mul(w.v[2],y.evaluations.eval_b)),b.Wxi.subScalar(f.mul(w.v[3],y.evaluations.eval_c)),b.Wxi.subScalar(f.mul(w.v[4],y.evaluations.eval_s1)),b.Wxi.subScalar(f.mul(w.v[5],y.evaluations.eval_s2)),b.Wxi.divByZerofier(1,w.xi),a&&a.debug("> Computing opening proof polynomial Wxiw(X) polynomial"),M(),a&&a.debug("> Computing Wxi, Wxiw MSM");let t=await b.Wxi.multiExponentiation(C,"Wxi"),e=await b.Wxiw.multiExponentiation(C,"Wxiw");y.addPolynomial("Wxi",t),y.addPolynomial("Wxiw",e)}async function U(){let t=u.Fr;b.QL=new oB(new tS(g),u,a),b.QR=new oB(new tS(g),u,a),b.QM=new oB(new tS(g),u,a),b.QO=new oB(new tS(g),u,a),b.QC=new oB(new tS(g),u,a),await s.readToBuffer(b.QL.coef,0,g,c[8][0].p),await s.readToBuffer(b.QR.coef,0,g,c[9][0].p),await s.readToBuffer(b.QM.coef,0,g,c[7][0].p),await s.readToBuffer(b.QO.coef,0,g,c[10][0].p),await s.readToBuffer(b.QC.coef,0,g,c[11][0].p),w.xin=w.xi;for(let e=0;e<d.power;e++)w.xin=t.square(w.xin);w.zh=t.sub(w.xin,t.one);let e=[],i=t.e(d.domainSize),o=t.one;for(let a=1;a<=Math.max(1,d.nPublic);a++)e[a]=t.div(t.mul(o,w.zh),t.mul(i,t.sub(w.xi,o))),o=t.mul(o,t.w[d.power]);let n=t.div(t.sub(w.xin,t.one),t.mul(i,t.sub(w.xi,t.one)));if(a){a.debug("Lagrange Evaluations: ");for(let i=1;i<e.length;i++)a.debug(`L${i}(xi)=`+t.toString(e[i],16))}let l=t.zero;for(let a=0;a<I.length;a++){let i=t.e(I[a]);l=t.sub(l,t.mul(i,e[a+1]))}a&&a.debug("PI: "+t.toString(l,16));let r=t.mul(y.evaluations.eval_a,y.evaluations.eval_b),f=y.evaluations.eval_a,p=t.mul(w.beta,w.xi);f=t.add(f,p),f=t.add(f,w.gamma);let _=y.evaluations.eval_b;_=t.add(_,t.mul(p,d.k1)),_=t.add(_,w.gamma);let m=y.evaluations.eval_c;m=t.add(m,t.mul(p,d.k2)),m=t.add(m,w.gamma);let L=t.mul(t.mul(t.mul(f,_),m),w.alpha),A=y.evaluations.eval_a;A=t.add(A,t.mul(w.beta,y.evaluations.eval_s1)),A=t.add(A,w.gamma);let C=y.evaluations.eval_b;C=t.add(C,t.mul(w.beta,y.evaluations.eval_s2)),C=t.add(C,w.gamma);let F=t.mul(A,C);F=t.mul(F,y.evaluations.eval_zw),F=t.mul(F,w.alpha);let x=t.mul(n,w.alpha2);b.R=new oB(new tS((d.domainSize+6)*h),u,a),b.R.add(b.QM,r),b.R.add(b.QL,y.evaluations.eval_a),b.R.add(b.QR,y.evaluations.eval_b),b.R.add(b.QO,y.evaluations.eval_c),b.R.add(b.QC),b.R.add(b.Z,L),b.R.sub(b.Sigma3,t.mul(F,w.beta)),b.R.add(b.Z,x);let E=oB.fromPolynomial(b.T3,u,a);E.mulScalar(t.square(w.xin)),E.add(b.T2,w.xin),E.add(b.T1),E.mulScalar(w.zh),b.R.sub(E);let v=t.sub(l,t.mul(F,t.add(y.evaluations.eval_c,w.gamma)));v=t.sub(v,x),a&&a.debug("r0: "+t.toString(v,16)),b.R.addScalar(v)}async function M(){b.Wxiw=oB.fromPolynomial(b.Z,u,a),b.Wxiw.subScalar(y.evaluations.eval_zw),b.Wxiw.divByZerofier(1,w.xiw)}}let{unstringifyBigInts:oG}=l;async function oT(t,e,a,i,o,n){let l=oG(t),r={type:"mem"};return await ah(l,e,r,o),await oP(a,r,i,n)}let{unstringifyBigInts:oq}=l;async function oz(t,e,a,i){let o=oq(t);a=oq(a);let n=oq(e),l=await eO(o.curve),r=l.Fr,s=l.G1;i&&i.info("PLONK VERIFIER STARTED");let c=function(t,e){let a=t.G1,i=t.Fr,o={};return o.A=a.fromObject(e.A),o.B=a.fromObject(e.B),o.C=a.fromObject(e.C),o.Z=a.fromObject(e.Z),o.T1=a.fromObject(e.T1),o.T2=a.fromObject(e.T2),o.T3=a.fromObject(e.T3),o.eval_a=i.fromObject(e.eval_a),o.eval_b=i.fromObject(e.eval_b),o.eval_c=i.fromObject(e.eval_c),o.eval_zw=i.fromObject(e.eval_zw),o.eval_s1=i.fromObject(e.eval_s1),o.eval_s2=i.fromObject(e.eval_s2),o.Wxi=a.fromObject(e.Wxi),o.Wxiw=a.fromObject(e.Wxiw),o}(l,a);if(o=function(t,e){let a=t.G1,i=t.G2,o=t.Fr;return e.Qm=a.fromObject(e.Qm),e.Ql=a.fromObject(e.Ql),e.Qr=a.fromObject(e.Qr),e.Qo=a.fromObject(e.Qo),e.Qc=a.fromObject(e.Qc),e.S1=a.fromObject(e.S1),e.S2=a.fromObject(e.S2),e.S3=a.fromObject(e.S3),e.k1=o.fromObject(e.k1),e.k2=o.fromObject(e.k2),e.X_2=i.fromObject(e.X_2),e}(l,o),!function(t,e){let a=t.G1;return!!(a.isValid(e.A)&&a.isValid(e.B)&&a.isValid(e.C)&&a.isValid(e.Z)&&a.isValid(e.T1)&&a.isValid(e.T2)&&a.isValid(e.T3)&&a.isValid(e.Wxi)&&a.isValid(e.Wxiw))}(l,c))return i.error("Proof is not well constructed"),!1;if(n.length!=o.nPublic)return i.error("Invalid number of public inputs"),!1;let d=function(t,e,a,i){let o=t.Fr,n={},l=new oE(t);l.addPolCommitment(i.Qm),l.addPolCommitment(i.Ql),l.addPolCommitment(i.Qr),l.addPolCommitment(i.Qo),l.addPolCommitment(i.Qc),l.addPolCommitment(i.S1),l.addPolCommitment(i.S2),l.addPolCommitment(i.S3);for(let t=0;t<a.length;t++)l.addScalar(o.e(a[t]));l.addPolCommitment(e.A),l.addPolCommitment(e.B),l.addPolCommitment(e.C),n.beta=l.getChallenge(),l.reset(),l.addScalar(n.beta),n.gamma=l.getChallenge(),l.reset(),l.addScalar(n.beta),l.addScalar(n.gamma),l.addPolCommitment(e.Z),n.alpha=l.getChallenge(),l.reset(),l.addScalar(n.alpha),l.addPolCommitment(e.T1),l.addPolCommitment(e.T2),l.addPolCommitment(e.T3),n.xi=l.getChallenge(),l.reset(),l.addScalar(n.xi),l.addScalar(e.eval_a),l.addScalar(e.eval_b),l.addScalar(e.eval_c),l.addScalar(e.eval_s1),l.addScalar(e.eval_s2),l.addScalar(e.eval_zw),n.v=[],n.v[1]=l.getChallenge();for(let t=2;t<6;t++)n.v[t]=o.mul(n.v[t-1],n.v[1]);return l.reset(),l.addPolCommitment(e.Wxi),l.addPolCommitment(e.Wxiw),n.u=l.getChallenge(),n}(l,c,n,o);if(i){i.debug("beta: "+r.toString(d.beta,16)),i.debug("gamma: "+r.toString(d.gamma,16)),i.debug("alpha: "+r.toString(d.alpha,16)),i.debug("xi: "+r.toString(d.xi,16));for(let t=1;t<6;t++)i&&i.debug("v: "+r.toString(d.v[t],16));i.debug("u: "+r.toString(d.u,16))}let u=function(t,e,a){let i=t.Fr,o=e.xi,n=1;for(let t=0;t<a.power;t++)o=i.square(o),n*=2;e.xin=o,e.zh=i.sub(o,i.one);let l=[],r=i.e(n),s=i.one;for(let t=1;t<=Math.max(1,a.nPublic);t++)l[t]=i.div(i.mul(s,e.zh),i.mul(r,i.sub(e.xi,s))),s=i.mul(s,i.w[a.power]);return l}(l,d,o);if(i)for(let t=1;t<u.length;t++)i.debug(`L${t}(xi)=`+r.toString(u[t],16));if(n.length!=o.nPublic)return i.error("Number of public signals does not match with vk"),!1;let f=function(t,e,a){let i=t.Fr,o=i.zero;for(let t=0;t<e.length;t++){let n=i.e(e[t]);o=i.sub(o,i.mul(n,a[t+1]))}return o}(l,n,u);i&&i.debug("PI(xi): "+r.toString(f,16));let h=function(t,e,a,i,o){let n=t.Fr,l=n.mul(o,n.square(a.alpha)),r=n.add(e.eval_a,n.mul(a.beta,e.eval_s1));r=n.add(r,a.gamma);let s=n.add(e.eval_b,n.mul(a.beta,e.eval_s2));s=n.add(s,a.gamma);let c=n.add(e.eval_c,a.gamma),d=n.mul(n.mul(r,s),c);return d=n.mul(d,e.eval_zw),d=n.mul(d,a.alpha),n.sub(n.sub(i,l),d)}(l,c,d,f,u[1]);i&&i.debug("r0: "+r.toString(h,16));let g=function(t,e,a,i,o){let n=t.G1,l=t.Fr,r=n.timesFr(i.Qm,l.mul(e.eval_a,e.eval_b));r=n.add(r,n.timesFr(i.Ql,e.eval_a)),r=n.add(r,n.timesFr(i.Qr,e.eval_b)),r=n.add(r,n.timesFr(i.Qo,e.eval_c)),r=n.add(r,i.Qc);let s=l.mul(a.beta,a.xi),c=l.add(l.add(e.eval_a,s),a.gamma),d=l.add(l.add(e.eval_b,l.mul(s,i.k1)),a.gamma),u=l.add(l.add(e.eval_c,l.mul(s,i.k2)),a.gamma),f=l.mul(l.mul(l.mul(c,d),u),a.alpha),h=l.mul(o,l.square(a.alpha)),g=n.timesFr(e.Z,l.add(l.add(f,h),a.u)),p=l.add(l.add(e.eval_a,l.mul(a.beta,e.eval_s1)),a.gamma),_=l.add(l.add(e.eval_b,l.mul(a.beta,e.eval_s2)),a.gamma),m=l.mul(l.mul(a.alpha,a.beta),e.eval_zw),b=n.timesFr(i.S3,l.mul(l.mul(p,_),m)),L=e.T1,w=n.timesFr(e.T2,a.xin),y=n.timesFr(e.T3,l.square(a.xin)),A=n.add(L,n.add(w,y));return A=n.timesFr(A,a.zh),n.sub(n.sub(n.add(r,g),b),A)}(l,c,d,o,u[1]);i&&i.debug("D: "+s.toString(s.toAffine(g),16));let p=function(t,e,a,i,o){let n=t.G1,l=n.add(o,n.timesFr(e.A,a.v[1]));return l=n.add(l,n.timesFr(e.B,a.v[2])),l=n.add(l,n.timesFr(e.C,a.v[3])),l=n.add(l,n.timesFr(i.S1,a.v[4])),l=n.add(l,n.timesFr(i.S2,a.v[5]))}(l,c,d,o,g);i&&i.debug("F: "+s.toString(s.toAffine(p),16));let _=function(t,e,a,i){let o=t.G1,n=t.Fr,l=n.add(n.neg(i),n.mul(a.v[1],e.eval_a));return l=n.add(l,n.mul(a.v[2],e.eval_b)),l=n.add(l,n.mul(a.v[3],e.eval_c)),l=n.add(l,n.mul(a.v[4],e.eval_s1)),l=n.add(l,n.mul(a.v[5],e.eval_s2)),l=n.add(l,n.mul(a.u,e.eval_zw)),o.timesFr(o.one,l)}(l,c,d,h);i&&i.debug("E: "+s.toString(s.toAffine(_),16));let m=await oU(l,c,d,o,_,p);return i&&(m?i.info("OK!"):i.warn("Invalid Proof")),m}async function oU(t,e,a,i,o,n){let l=t.G1,r=t.Fr,s=e.Wxi;s=l.add(s,l.timesFr(e.Wxiw,a.u));let c=l.timesFr(e.Wxi,a.xi),d=r.mul(r.mul(a.u,a.xi),r.w[i.power]);return c=l.add(c,l.timesFr(e.Wxiw,d)),c=l.add(c,n),c=l.sub(c,o),await t.pairingEq(l.neg(s),i.X_2,c,t.G2.one)}let{unstringifyBigInts:oM}=l;function oQ(t){let e=t.toString(16);for(;e.length<64;)e="0"+e;return`"0x${e}"`}async function ok(t,e){let a=oM(t),i=oM(e),o=await eO(a.curve);o.G1,o.Fr;let n="";for(let t=0;t<i.length;t++)""!=n&&(n+=","),n+=oQ(i[t]);return`[${oQ(a.A[0])}, ${oQ(a.A[1])},${oQ(a.B[0])},${oQ(a.B[1])},${oQ(a.C[0])},${oQ(a.C[1])},${oQ(a.Z[0])},${oQ(a.Z[1])},${oQ(a.T1[0])},${oQ(a.T1[1])},${oQ(a.T2[0])},${oQ(a.T2[1])},${oQ(a.T3[0])},${oQ(a.T3[1])},${oQ(a.Wxi[0])},${oQ(a.Wxi[1])},${oQ(a.Wxiw[0])},${oQ(a.Wxiw[1])},${oQ(a.eval_a)},${oQ(a.eval_b)},${oQ(a.eval_c)},${oQ(a.eval_s1)},${oQ(a.eval_s2)},${oQ(a.eval_zw)}][${n}]`}function oR(t,e){return[t,0,0,e.one,e.zero,e.zero,e.zero,e.zero]}function oN(t,e,a,i,o,n,l,r){return[t,e,a,i,o,n,l,r]}function oD(t,e,a,i,o,n,l,r,s){return[t,e,a,i,o,n,l,r]}class o${constructor(t,e,a,i,o){this.Fr=t,this.logger=o,this.fnGetAdditionConstraint=a,this.fnGetMultiplicationConstraint=i}processR1csConstraint(t,e,a,i){this.normalizeLinearCombination(e),this.normalizeLinearCombination(a),this.normalizeLinearCombination(i);let o=this.getLinearCombinationType(e),n=this.getLinearCombinationType(a);if(0===o||0===n)return this.processR1csAdditionConstraint(t,i);if(1===o){let o=this.joinLinearCombinations(a,i,e[0]);return this.processR1csAdditionConstraint(t,o)}if(1!==n)return this.processR1csMultiplicationConstraint(t,e,a,i);{let o=this.joinLinearCombinations(e,i,a[0]);return this.processR1csAdditionConstraint(t,o)}}getLinearCombinationType(t){let e=this.Fr.zero,a=0,i=Object.keys(t);for(let o=0;o<i.length;o++)0n==t[i[o]]?delete t[i[o]]:0==i[o]?e=this.Fr.add(e,t[i[o]]):a++;return a>0?2:this.Fr.isZero(e)?0:1}normalizeLinearCombination(t){let e=Object.keys(t);for(let a=0;a<e.length;a++)this.Fr.isZero(t[e[a]])&&delete t[e[a]];return t}joinLinearCombinations(t,e,a){let i={};for(let e in t)void 0===i[e]?i[e]=this.Fr.mul(a,t[e]):i[e]=this.Fr.add(i[e],this.Fr.mul(a,t[e]));for(let t in e)void 0===i[t]?i[t]=e[t]:i[t]=this.Fr.add(i[t],e[t]);return this.normalizeLinearCombination(i)}reduceCoefs(t,e,a,i,o){let n={k:this.Fr.zero,signals:[],coefs:[]},l=[];for(let t in i)0==t?n.k=this.Fr.add(n.k,i[t]):0n!=i[t]&&l.push([Number(t),i[t]]);for(;l.length>o;){let i=l.shift(),o=l.shift(),n=t.nVars++,r=this.fnGetAdditionConstraint(i[0],o[0],n,this.Fr.neg(i[1]),this.Fr.neg(o[1]),this.Fr.zero,this.Fr.one,this.Fr.zero);e.push(r),a.push([i[0],o[0],i[1],o[1]]),l.push([n,this.Fr.one])}for(let t=0;t<l.length;t++)n.signals[t]=l[t][0],n.coefs[t]=l[t][1];for(;n.coefs.length<o;)n.signals.push(0),n.coefs.push(this.Fr.zero);return n}processR1csAdditionConstraint(t,e){let a=[],i=[],o=this.reduceCoefs(t,a,i,e,3),n=this.fnGetAdditionConstraint(o.signals[0],o.signals[1],o.signals[2],o.coefs[0],o.coefs[1],this.Fr.zero,o.coefs[2],o.k);return a.push(n),[a,i]}processR1csMultiplicationConstraint(t,e,a,i){let o=[],n=[],l=this.reduceCoefs(t,o,n,e,1),r=this.reduceCoefs(t,o,n,a,1),s=this.reduceCoefs(t,o,n,i,1),c=this.fnGetMultiplicationConstraint(l.signals[0],r.signals[0],s.signals[0],this.Fr.mul(l.coefs[0],r.k),this.Fr.mul(l.k,r.coefs[0]),this.Fr.mul(l.coefs[0],r.coefs[0]),this.Fr.neg(s.coefs[0]),this.Fr.sub(this.Fr.mul(l.k,r.k),s.k));return o.push(c),[o,n]}}class oj{constructor(t,e,a){this.n=t,this.polynomials=Array(t).fill(void 0),this.curve=e,this.Fr=e.Fr,this.G1=e.G1,this.logger=a}addPolynomial(t,e){if(t>this.n-1)throw Error("CPolynomial:addPolynomial, cannot add a polynomial to a position greater than n-1");this.polynomials[t]=e}degree(){return Math.max(...this.polynomials.map((t,e)=>void 0===t?0:t.degree()*this.n+e))}getPolynomial(){let t=this.polynomials.map(t=>void 0===t?0:t.degree()),e=this.degree(),a=2**(eq(e-1)+1),i=this.Fr.n8,o=new oB(new tS(a*i),this.curve,this.logger);for(let a=0;a<e;a++){let e=a*i,n=e*this.n;for(let l=0;l<this.n;l++)void 0!==this.polynomials[l]&&a<=t[l]&&o.coef.set(this.polynomials[l].coef.slice(e,e+i),n+l*i)}return o}async multiExponentiation(t,e){let a=this.getPolynomial(),i=a.coef.byteLength/this.Fr.n8,o=t.slice(0,i*this.G1.F.n8*2),n=await this.Fr.batchFromMontgomery(a.coef),l=await this.G1.multiExpAffine(o,n,this.logger,e);return this.G1.toAffine(l)}}async function oV(t,e,a,i){let o,l,r;i&&i.info("FFLONK SETUP STARTED"),globalThis.gc&&globalThis.gc(),i&&i.info("> Reading PTau file");let{fd:s,sections:c}=await eg(e,"ptau",1,4194304,16777216);if(!c[12])throw Error("Powers of Tau is not well prepared. Section 12 missing.");i&&i.info("> Getting curve from PTau settings");let{curve:d}=await ax(s,c);i&&i.info("> Reading r1cs file");let{fd:u,sections:f}=await eg(t,"r1cs",1,4194304,16777216),h=await iX(u,f,{loadConstraints:!1,loadCustomGates:!0});if(h.prime!==d.r)throw Error("r1cs curve does not match powers of tau ceremony curve");let g=d.Fr,p=d.Fr.n8,_=2*d.G1.F.n8,m=2*d.G2.F.n8,b={},L={},w={nVars:h.nVars,nPublic:h.nOutputs+h.nPubInputs},y=new oo,A=new oo;if(i&&i.info("> Processing FFlonk constraints"),await B(d.Fr,h,i),globalThis.gc&&globalThis.gc(),w.cirPower=Math.max(3,eq(y.length+2-1)+1),w.domainSize=2**w.cirPower,c[2][0].size<(9*w.domainSize+18)*_)throw Error("Powers of Tau is not big enough for this circuit size. Section 2 too small.");if(c[3][0].size<m)throw Error("Powers of Tau is not well prepared. Section 3 too small.");i&&(i.info("----------------------------"),i.info("  FFLONK SETUP SETTINGS"),i.info(`  Curve:         ${d.name}`),i.info(`  Circuit power: ${w.cirPower}`),i.info(`  Domain size:   ${w.domainSize}`),i.info(`  Vars:          ${w.nVars}`),i.info(`  Public vars:   ${w.nPublic}`),i.info(`  Constraints:   ${y.length}`),i.info(`  Additions:     ${A.length}`),i.info("----------------------------")),i&&i.info("> computing k1 and k2");let[C,I]=function(){let t=g.two;for(;a(t,[],w.cirPower);)g.add(t,g.one);let e=g.add(t,g.one);for(;a(e,[t],w.cirPower);)g.add(e,g.one);return[t,e];function a(t,e,a){let i=2**a,o=g.one;for(let n=0;n<i;n++){if(g.eq(t,o))return!0;for(let a=0;a<e.length;a++)if(g.eq(t,g.mul(e[a],o)))return!0;o=g.mul(o,g.w[a])}return!1}}();i&&i.info("> computing w3");let F=(l=g.e(31624),r=n.div(0x810b7bdd032f006f40d60f3c0403964dc08a6b6bef43d6d8b505398a8000000n,n.e(3)),g.exp(l,r));i&&i.info("> computing w4");let x=g.w[2];i&&i.info("> computing w8");let E=g.w[3];i&&i.info("> computing wr");let v=function(t,e){let a=e.e(0x108c3d36f14c2facdf4d615f022a01cfcf001cc24e3db9d89373caf21d767f0n);return e.exp(a,2**(28-t))}(w.cirPower,d.Fr);return await S(),await u.close(),await s.close(),i&&i.info("FFLONK SETUP FINISHED"),0;async function B(t,e,a){for(let e=0;e<w.nPublic;e++)y.push(oR(e+1,t));let i=new o$(t,oR,oN,oD,a),o=await eC(u,f,2),n=0;for(let t=0;t<e.nConstraints;t++){a&&0!==t&&t%5e5==0&&a.info(`    processing r1cs constraints ${t}/${e.nConstraints}`);let[o,n]=i.processR1csConstraint(w,...function(){let t=[];return t[0]=l(),t[1]=l(),t[2]=l(),t}());y.push(...o),A.push(...n)}function l(){let t={},a=o.slice(n,n+4);n+=4;let i=new DataView(a.buffer).getUint32(0,!0),l=o.slice(n,n+(4+e.n8)*i);n+=(4+e.n8)*i;let r=new DataView(l.buffer);for(let a=0;a<i;a++){let i=r.getUint32(a*(4+e.n8),!0),o=e.F.fromRprLE(l,a*(4+e.n8)+4);t[i]=o}return t}return 0}async function S(){i&&i.info("> Writing the zkey file");let t=await ep(a,"zkey",1,17,4194304,16777216);i&&i.info(`\xb7\xb7\xb7 Writing Section 1. Zkey Header`),await O(t),i&&i.info(`\xb7\xb7\xb7 Writing Section 3. Additions`),await P(t),globalThis.gc&&globalThis.gc(),i&&i.info(`\xb7\xb7\xb7 Writing Section 4. A Map`),await G(t,4,0,"A map"),globalThis.gc&&globalThis.gc(),i&&i.info(`\xb7\xb7\xb7 Writing Section 5. B Map`),await G(t,5,1,"B map"),globalThis.gc&&globalThis.gc(),i&&i.info(`\xb7\xb7\xb7 Writing Section 6. C Map`),await G(t,6,2,"C map"),globalThis.gc&&globalThis.gc(),i&&i.info(`\xb7\xb7\xb7 Writing Section 7. QL`),await T(t,7,3,"QL"),globalThis.gc&&globalThis.gc(),i&&i.info(`\xb7\xb7\xb7 Writing Section 8. QR`),await T(t,8,4,"QR"),globalThis.gc&&globalThis.gc(),i&&i.info(`\xb7\xb7\xb7 Writing Section 9. QM`),await T(t,9,5,"QM"),globalThis.gc&&globalThis.gc(),i&&i.info(`\xb7\xb7\xb7 Writing Section 10. QO`),await T(t,10,6,"QO"),globalThis.gc&&globalThis.gc(),i&&i.info(`\xb7\xb7\xb7 Writing Section 11. QC`),await T(t,11,7,"QC"),globalThis.gc&&globalThis.gc(),i&&i.info(`\xb7\xb7\xb7 Writing Sections 12,13,14. Sigma1, Sigma2 & Sigma 3`),await q(t),globalThis.gc&&globalThis.gc(),i&&i.info(`\xb7\xb7\xb7 Writing Section 15. Lagrange Polynomials`),await z(t),globalThis.gc&&globalThis.gc(),i&&i.info(`\xb7\xb7\xb7 Writing Section 16. Powers of Tau`),await U(t),globalThis.gc&&globalThis.gc(),i&&i.info(`\xb7\xb7\xb7 Writing Section 17. C0`),await M(t),globalThis.gc&&globalThis.gc(),i&&i.info(`\xb7\xb7\xb7 Writing Section 2. FFlonk Header`),await Q(t),globalThis.gc&&globalThis.gc(),i&&i.info("> Writing the zkey file finished"),await t.close()}async function O(t){await e_(t,1),await t.writeULE32(10),await em(t)}async function P(t){await e_(t,3);let e=new Uint8Array(8+2*p),a=new DataView(e.buffer);for(let o=0;o<A.length;o++){i&&0!==o&&o%5e5==0&&i.info(`      writing Additions: ${o}/${A.length}`);let n=A[o];a.setUint32(0,n[0],!0),a.setUint32(4,n[1],!0),e.set(n[2],8),e.set(n[3],8+p),await t.write(e)}await em(t)}async function G(t,e,a,o){await e_(t,e);for(let e=0;e<y.length;e++)i&&0!==e&&e%5e5==0&&i.info(`      writing witness ${o}: ${e}/${y.length}`),await t.writeULE32(y[e][a]);await em(t)}async function T(t,e,a,o){let n=new tS(w.domainSize*p);for(let t=0;t<y.length;t++)n.set(y[t][a],t*p),i&&0!==t&&t%5e5==0&&i.info(`      writing ${o}: ${t}/${y.length}`);b[o]=await oB.fromEvaluations(n,d,i),L[o]=await oS.fromPolynomial(b[o],4,d,i),await e_(t,e),await t.write(b[o].coef),await t.write(L[o].eval),await em(t)}async function q(t){let e=new tS(p*w.domainSize*3),a=new oo(w.nVars),o=new oo(w.nVars),n=g.one;for(let t=0;t<w.domainSize;t++)t<y.length?(l(y[t][0],t),l(y[t][1],w.domainSize+t),l(y[t][2],2*w.domainSize+t)):t<w.domainSize-2?(l(0,t),l(0,w.domainSize+t),l(0,2*w.domainSize+t)):(e.set(n,t*p),e.set(g.mul(n,C),(w.domainSize+t)*p),e.set(g.mul(n,I),(2*w.domainSize+t)*p)),n=g.mul(n,g.w[w.cirPower]),i&&0!==t&&t%5e5==0&&i.info(`      writing sigma phase1: ${t}/${y.length}`);for(let t=0;t<w.nVars;t++)void 0!==o[t]?e.set(a[t],o[t]*p):console.log("Variable not used"),i&&0!==t&&t%5e5==0&&i.info(`      writing sigma phase2: ${t}/${w.nVars}`);globalThis.gc&&globalThis.gc();for(let a=0;a<3;a++){let o=0===a?12:1===a?13:14,n="S"+(a+1);b[n]=await oB.fromEvaluations(e.slice(w.domainSize*p*a,w.domainSize*p*(a+1)),d,i),L[n]=await oS.fromPolynomial(b[n],4,d,i),await e_(t,o),await t.write(b[n].coef),await t.write(L[n].eval),await em(t),globalThis.gc&&globalThis.gc()}return 0;function l(t,i){let l;void 0===a[t]?o[t]=i:e.set(a[t],i*p),l=i<w.domainSize?n:i<2*w.domainSize?g.mul(n,C):g.mul(n,I),a[t]=l}}async function z(t){await e_(t,15);let e=Math.max(w.nPublic,1);for(let a=0;a<e;a++){let e=new tS(w.domainSize*p);e.set(g.one,a*p),await k(t,e)}await em(t)}async function U(t){await e_(t,16),o=new tS((9*w.domainSize+18)*_),await s.readToBuffer(o,0,(9*w.domainSize+18)*_,c[2][0].p),await t.write(o),await em(t)}async function M(t){let e=new oj(8,d,i);if(e.addPolynomial(0,b.QL),e.addPolynomial(1,b.QR),e.addPolynomial(2,b.QO),e.addPolynomial(3,b.QM),e.addPolynomial(4,b.QC),e.addPolynomial(5,b.S1),e.addPolynomial(6,b.S2),e.addPolynomial(7,b.S3),b.C0=e.getPolynomial(),b.C0.degree()>=8*w.domainSize)throw Error("C0 Polynomial is not well calculated");await e_(t,17),await t.write(b.C0.coef),await em(t)}async function Q(t){let e;await e_(t,2);let a=d.q,i=(Math.floor((n.bitLength(a)-1)/64)+1)*8;await t.writeULE32(i),await ew(t,a,i);let l=d.r,r=(Math.floor((n.bitLength(l)-1)/64)+1)*8;await t.writeULE32(r),await ew(t,l,r),await t.writeULE32(w.nVars),await t.writeULE32(w.nPublic),await t.writeULE32(w.domainSize),await t.writeULE32(A.length),await t.writeULE32(y.length),await t.write(C),await t.write(I),await t.write(F),await t.write(x),await t.write(E),await t.write(v),e=await s.read(m,c[3][0].p+m),await t.write(e);let u=await b.C0.multiExponentiation(o,"C0");await t.write(u),await em(t)}async function k(t,e){let[a,i]=await oB.to4T(e,w.domainSize,[],g);return await t.write(a),await t.write(i),[a,i]}}let{stringifyBigInts:oK}=l;async function oH(t,e,a,i){a&&a.info("FFLONK PROVER STARTED"),a&&a.info("> Reading witness file");let{fd:o,sections:l}=await eg(e,"wtns",2,33554432,8388608),r=await ae(o,l);a&&a.info("> Reading zkey file");let{fd:s,sections:c}=await eg(t,"zkey",2,33554432,8388608),d=await eJ(s,c,void 0,i);if(10!==d.protocolId)throw Error("zkey file is not fflonk");if(!n.eq(d.r,r.q))throw Error("Curve of the witness does not match the curve of the proving key");if(r.nWitness!==d.nVars-d.nAdditions)throw Error(`Invalid witness length. Circuit: ${d.nVars}, witness: ${r.nWitness}, ${d.nAdditions}`);let u=d.curve,f=u.Fr,h=u.Fr.n8,g=2*u.G1.F.n8,p=d.domainSize*h;a&&(a.info("----------------------------"),a.info("  FFLONK PROVE SETTINGS"),a.info(`  Curve:         ${u.name}`),a.info(`  Circuit power: ${d.power}`),a.info(`  Domain size:   ${d.domainSize}`),a.info(`  Vars:          ${d.nVars}`),a.info(`  Public vars:   ${d.nPublic}`),a.info(`  Constraints:   ${d.nConstraints}`),a.info(`  Additions:     ${d.nAdditions}`),a.info("----------------------------")),a&&a.info("> Reading witness file data");let _=await eC(o,l,2);await o.close(),_.set(f.zero,0);let m=new tS(d.nAdditions*h),b={},L={},w={},y={},A={},C={},I=new oF(u,a);a&&a.info("> Reading Section 3. Additions"),await v(),a&&a.info("> Reading Sections 12,13,14. Sigma1, Sigma2 & Sigma 3"),a&&a.info("\xb7\xb7\xb7 Reading Sigma polynomials "),L.Sigma1=new oB(new tS(p),u,a),L.Sigma2=new oB(new tS(p),u,a),L.Sigma3=new oB(new tS(p),u,a),await s.readToBuffer(L.Sigma1.coef,0,p,c[12][0].p),await s.readToBuffer(L.Sigma2.coef,0,p,c[13][0].p),await s.readToBuffer(L.Sigma3.coef,0,p,c[14][0].p),a&&a.info("\xb7\xb7\xb7 Reading Sigma evaluations"),w.Sigma1=new oS(new tS(4*p),u,a),w.Sigma2=new oS(new tS(4*p),u,a),w.Sigma3=new oS(new tS(4*p),u,a),await s.readToBuffer(w.Sigma1.eval,0,4*p,c[12][0].p+p),await s.readToBuffer(w.Sigma2.eval,0,4*p,c[13][0].p+p),await s.readToBuffer(w.Sigma3.eval,0,4*p,c[14][0].p+p),a&&a.info("> Reading Section 16. Powers of Tau");let F=new tS(16*d.domainSize*g);await s.readToBuffer(F,0,(9*d.domainSize+18)*g,c[16][0].p),globalThis.gc&&globalThis.gc(),a&&a.info(""),a&&a.info("> ROUND 1"),await O(),delete L.T0,delete w.QL,delete w.QR,delete w.QM,delete w.QO,delete w.QC,globalThis.gc&&globalThis.gc(),a&&a.info("> ROUND 2"),await P(),delete b.A,delete b.B,delete b.C,delete w.A,delete w.B,delete w.C,delete w.Sigma1,delete w.Sigma2,delete w.Sigma3,delete w.lagrange1,delete w.Z,globalThis.gc&&globalThis.gc(),a&&a.info("> ROUND 3"),await G(),delete L.A,delete L.B,delete L.C,delete L.Z,delete L.T1,delete L.T2,delete L.Sigma1,delete L.Sigma2,delete L.Sigma3,delete L.QL,delete L.QR,delete L.QM,delete L.QC,delete L.QO,globalThis.gc&&globalThis.gc(),a&&a.info("> ROUND 4"),await T(),globalThis.gc&&globalThis.gc(),a&&a.info("> ROUND 5"),await q(),delete L.C0,delete L.C1,delete L.C2,delete L.R1,delete L.R2,delete L.F,delete L.L,delete L.ZT,delete L.ZTS2,await s.close(),globalThis.gc&&globalThis.gc(),I.addEvaluation("inv",function(){let t=A.xi;for(let e=0;e<d.power;e++)t=f.square(t);y.zh=f.sub(t,f.one),function(t,e,a,i){let o=i.Fr,n=e.length,l=o.mul(o.e(n),o.exp(e[0],n-2));for(let i=0;i<n;i++){let r=e[(n-1)*i%n],s=o.sub(a,e[i]);t[["LiS0_"+(i+1)]]=o.mul(o.mul(l,r),s)}}(y,C.S0.h0w8,A.y,u),function(t,e,a,i){let o=i.Fr,n=e.length,l=o.mul(o.e(n),o.exp(e[0],n-2));for(let i=0;i<n;i++){let r=e[(n-1)*i%n],s=o.sub(a,e[i]);t[["LiS1_"+(i+1)]]=o.mul(o.mul(l,r),s)}}(y,C.S1.h1w4,A.y,u),function(t,e,a,i,o,n,l){let r=l.Fr,s=r.mul(r.e(3),e[0]),c=r.sub(o,n),d=r.mul(s,c);for(let a=0;a<3;a++){let o=e[2*a%3],n=r.sub(i,e[a]);t[["LiS2_"+(a+1)]]=r.mul(d,r.mul(o,n))}let u=r.mul(r.e(3),a[0]),f=r.sub(n,o);d=r.mul(u,f);for(let e=0;e<3;e++){let o=a[2*e%3],n=r.sub(i,a[e]);t[["LiS2_"+(e+1+3)]]=r.mul(d,r.mul(o,n))}}(y,C.S2.h2w3,C.S2.h3w3,A.y,A.xi,A.xiw,u);let e=Math.max(1,d.nPublic),a=f.one;for(let t=0;t<e;t++)y["Li_"+(t+1)]=f.mul(f.e(d.domainSize),f.sub(A.xi,a)),a=f.mul(a,f.w[d.power]);let i=f.one;for(let t of Object.values(y))if(Array.isArray(t))for(let e of t)i=f.mul(i,e);else i=f.mul(i,t);return f.inv(i)}());let x=I.toObjectProof();x.protocol="fflonk",x.curve=u.name;let E=[];for(let t=1;t<=d.nPublic;t++){let e=t*h,a=_.slice(e,e+h);E.push(n.fromRprLE(a))}return a&&a.info("FFLONK PROVER FINISHED"),{proof:oK(x),publicSignals:oK(E)};async function v(){a&&a.info("\xb7\xb7\xb7 Computing additions");let t=await eC(s,c,3),e=8+2*h;for(let i=0;i<d.nAdditions;i++){a&&0!==i&&i%1e5==0&&a.info(`    addition ${i}/${d.nAdditions}`);let o=i*e,n=B(t,o),l=B(t,o+=4);o+=4;let r=t.slice(o,o+h);o+=h;let s=t.slice(o,o+h),c=S(n),u=S(l),g=f.add(f.mul(r,c),f.mul(s,u));m.set(g,h*i)}}function B(t,e){let a=t.slice(e,e+4);return new DataView(a.buffer,a.byteOffset,a.byteLength).getUint32(0,!0)}function S(t){let e=d.nVars-d.nAdditions;if(t<e)return _.slice(t*h,t*h+h);if(t<d.nVars){let a=(t-e)*h;return m.slice(a,a+h)}return f.zero}async function O(){A.b=[];for(let t=1;t<=9;t++)A.b[t]=f.random();a&&a.info("> Computing A, B, C wire polynomials"),await e(),a&&a.info("> Computing T0 polynomial"),await i(),a&&a.info("> Computing C1 polynomial"),await o(),a&&a.info("> Computing C1 multi exponentiation");let t=await L.C1.multiExponentiation(F,"C1");return I.addPolynomial("C1",t),0;async function e(){a&&a.info("\xb7\xb7\xb7 Reading data from zkey file"),b.A=new tS(p),b.B=new tS(p),b.C=new tS(p);let t=await eC(s,c,4),e=await eC(s,c,5),i=await eC(s,c,6);for(let a=0;a<d.nConstraints;a++){let o=a*h,n=4*a,l=B(t,n);b.A.set(S(l),o);let r=B(e,n);b.B.set(S(r),o);let s=B(i,n);b.C.set(S(s),o)}if(b.A.set(A.b[1],p-64),b.A.set(A.b[2],p-32),b.B.set(A.b[3],p-64),b.B.set(A.b[4],p-32),b.C.set(A.b[5],p-64),b.C.set(A.b[6],p-32),b.A=await f.batchToMontgomery(b.A),b.B=await f.batchToMontgomery(b.B),b.C=await f.batchToMontgomery(b.C),a&&a.info("\xb7\xb7\xb7 Computing A ifft"),L.A=await oB.fromEvaluations(b.A,u,a),a&&a.info("\xb7\xb7\xb7 Computing B ifft"),L.B=await oB.fromEvaluations(b.B,u,a),a&&a.info("\xb7\xb7\xb7 Computing C ifft"),L.C=await oB.fromEvaluations(b.C,u,a),a&&a.info("\xb7\xb7\xb7 Computing A fft"),w.A=await oS.fromPolynomial(L.A,4,u,a),a&&a.info("\xb7\xb7\xb7 Computing B fft"),w.B=await oS.fromPolynomial(L.B,4,u,a),a&&a.info("\xb7\xb7\xb7 Computing C fft"),w.C=await oS.fromPolynomial(L.C,4,u,a),L.A.degree()>=d.domainSize)throw Error("A Polynomial is not well calculated");if(L.B.degree()>=d.domainSize)throw Error("B Polynomial is not well calculated");if(L.C.degree()>=d.domainSize)throw Error("C Polynomial is not well calculated")}async function i(){a&&a.info(`\xb7\xb7\xb7 Reading sections 7, 8, 9, 10, 11. Q selectors`),w.QL=new oS(new tS(4*p),u,a),w.QR=new oS(new tS(4*p),u,a),w.QM=new oS(new tS(4*p),u,a),w.QO=new oS(new tS(4*p),u,a),w.QC=new oS(new tS(4*p),u,a),await s.readToBuffer(w.QL.eval,0,4*p,c[7][0].p+p),await s.readToBuffer(w.QR.eval,0,4*p,c[8][0].p+p),await s.readToBuffer(w.QM.eval,0,4*p,c[9][0].p+p),await s.readToBuffer(w.QO.eval,0,4*p,c[10][0].p+p),await s.readToBuffer(w.QC.eval,0,4*p,c[11][0].p+p);let t=await eC(s,c,15);w.lagrange1=new oS(t,u,a),b.T0=new tS(4*p),a&&a.info("\xb7\xb7\xb7 Computing T0 evaluations");for(let t=0;t<4*d.domainSize;t++){a&&0!==t&&t%1e5==0&&a.info(`      T0 evaluation ${t}/${4*d.domainSize}`);let e=w.A.getEvaluation(t),i=w.B.getEvaluation(t),o=w.C.getEvaluation(t),n=w.QL.getEvaluation(t),l=w.QR.getEvaluation(t),r=w.QM.getEvaluation(t),s=w.QO.getEvaluation(t),c=w.QC.getEvaluation(t),u=f.zero;for(let e=0;e<d.nPublic;e++){let a=5*e*d.domainSize+d.domainSize+t,i=w.lagrange1.getEvaluation(a),o=b.A.slice(e*h,(e+1)*h);u=f.sub(u,f.mul(i,o))}let g=f.mul(e,n),p=f.mul(i,l),_=f.mul(f.mul(e,i),r),m=f.mul(o,s),L=f.add(g,f.add(p,f.add(_,f.add(m,f.add(c,u)))));b.T0.set(L,t*h)}if(a&&a.info("buffer T0: "+b.T0.byteLength/h),a&&a.info("\xb7\xb7\xb7 Computing T0 ifft"),L.T0=await oB.fromEvaluations(b.T0,u,a),a&&a.info("T0 length: "+L.T0.length()),a&&a.info("T0 degree: "+L.T0.degree()),a&&a.info("\xb7\xb7\xb7 Computing T0 / ZH"),L.T0.divByZerofier(d.domainSize,f.one),L.T0.degree()>=2*d.domainSize-2)throw Error(`T0 Polynomial is not well calculated (degree is ${L.T0.degree()} and must be less than ${2*d.domainSize+2}`);delete b.T0}async function o(){let t=new oj(4,u,a);if(t.addPolynomial(0,L.A),t.addPolynomial(1,L.B),t.addPolynomial(2,L.C),t.addPolynomial(3,L.T0),L.C1=t.getPolynomial(),L.C1.degree()>=8*d.domainSize-8)throw Error("C1 Polynomial is not well calculated")}}async function P(){a&&a.info("> Computing challenges beta and gamma");let t=new oE(u);t.addPolCommitment(d.C0);for(let e=0;e<d.nPublic;e++)t.addScalar(b.A.slice(e*h,e*h+h));t.addPolCommitment(I.getPolynomial("C1")),A.beta=t.getChallenge(),a&&a.info("\xb7\xb7\xb7 challenges.beta: "+f.toString(A.beta)),t.reset(),t.addScalar(A.beta),A.gamma=t.getChallenge(),a&&a.info("\xb7\xb7\xb7 challenges.gamma: "+f.toString(A.gamma)),a&&a.info("> Computing Z polynomial"),await i(),a&&a.info("> Computing T1 polynomial"),await o(),a&&a.info("> Computing T2 polynomial"),await n(),a&&a.info("> Computing C2 polynomial"),await l(),a&&a.info("> Computing C2 multi exponentiation");let e=await L.C2.multiExponentiation(F,"C2");return I.addPolynomial("C2",e),0;async function i(){a&&a.info("\xb7\xb7\xb7 Computing Z evaluations");let t=new tS(p),e=new tS(p);t.set(f.one,0),e.set(f.one,0);let i=f.one;for(let o=0;o<d.domainSize;o++){a&&0!==o&&o%1e5==0&&a.info(`    Z evaluation ${o}/${d.domainSize}`);let n=o*h,l=f.mul(A.beta,i),r=b.A.slice(n,n+h);r=f.add(r,l),r=f.add(r,A.gamma);let s=b.B.slice(n,n+h);s=f.add(s,f.mul(d.k1,l)),s=f.add(s,A.gamma);let c=b.C.slice(n,n+h);c=f.add(c,f.mul(d.k2,l)),c=f.add(c,A.gamma);let u=f.mul(r,f.mul(s,c)),g=b.A.slice(n,n+h);g=f.add(g,f.mul(A.beta,w.Sigma1.getEvaluation(4*o))),g=f.add(g,A.gamma);let p=b.B.slice(n,n+h);p=f.add(p,f.mul(A.beta,w.Sigma2.getEvaluation(4*o))),p=f.add(p,A.gamma);let _=b.C.slice(n,n+h);_=f.add(_,f.mul(A.beta,w.Sigma3.getEvaluation(4*o))),_=f.add(_,A.gamma);let m=f.mul(g,f.mul(p,_));u=f.mul(t.slice(n,n+h),u),t.set(u,(o+1)%d.domainSize*h),m=f.mul(e.slice(n,n+h),m),e.set(m,(o+1)%d.domainSize*h),i=f.mul(i,f.w[d.power])}e=await f.batchInverse(e);for(let a=0;a<d.domainSize;a++){let i=a*h,o=f.mul(t.slice(i,i+h),e.slice(i,i+h));t.set(o,i)}if(b.Z=t,!f.eq(t.slice(0,h),f.one))throw Error("Copy constraints does not match");if(a&&a.info("\xb7\xb7\xb7 Computing Z ifft"),L.Z=await oB.fromEvaluations(b.Z,u,a),a&&a.info("\xb7\xb7\xb7 Computing Z fft"),w.Z=await oS.fromPolynomial(L.Z,4,u,a),L.Z.blindCoefficients([A.b[9],A.b[8],A.b[7]]),L.Z.degree()>=d.domainSize+3)throw Error("Z Polynomial is not well calculated");delete b.Z}async function o(){a&&a.info("\xb7\xb7\xb7 Computing T1 evaluations"),b.T1=new tS(2*p),b.T1z=new tS(2*p);let t=f.one;for(let e=0;e<2*d.domainSize;e++){a&&0!==e&&e%1e5==0&&a.info(`    T1 evaluation ${e}/${4*d.domainSize}`);let i=f.square(t),o=w.Z.getEvaluation(2*e),n=f.add(f.add(f.mul(A.b[7],i),f.mul(A.b[8],t)),A.b[9]),l=w.lagrange1.getEvaluation(d.domainSize+2*e),r=f.mul(f.sub(o,f.one),l),s=f.mul(n,l);b.T1.set(r,e*h),b.T1z.set(s,e*h),t=f.mul(t,f.w[d.power+1])}if(a&&a.info("\xb7\xb7\xb7 Computing T1 ifft"),L.T1=await oB.fromEvaluations(b.T1,u,a),L.T1.divByZerofier(d.domainSize,f.one),a&&a.info("\xb7\xb7\xb7 Computing T1z ifft"),L.T1z=await oB.fromEvaluations(b.T1z,u,a),L.T1.add(L.T1z),L.T1.degree()>=d.domainSize+2)throw Error("T1 Polynomial is not well calculated");delete b.T1,delete b.T1z,delete L.T1z}async function n(){a&&a.info("\xb7\xb7\xb7 Computing T2 evaluations"),b.T2=new tS(4*p),b.T2z=new tS(4*p);let t=f.one;for(let e=0;e<4*d.domainSize;e++){a&&0!==e&&e%1e5==0&&a.info(`    T2 evaluation ${e}/${4*d.domainSize}`);let i=f.square(t),o=f.mul(t,f.w[d.power]),n=f.square(o),l=w.A.getEvaluation(e),r=w.B.getEvaluation(e),s=w.C.getEvaluation(e),c=w.Z.getEvaluation(e),u=w.Z.getEvaluation((4*d.domainSize+4+e)%(4*d.domainSize)),g=f.add(f.add(f.mul(A.b[7],i),f.mul(A.b[8],t)),A.b[9]),p=f.add(f.add(f.mul(A.b[7],n),f.mul(A.b[8],o)),A.b[9]),_=w.Sigma1.getEvaluation(e),m=w.Sigma2.getEvaluation(e),L=w.Sigma3.getEvaluation(e),y=f.mul(A.beta,t),C=f.add(l,y);C=f.add(C,A.gamma);let I=f.add(r,f.mul(y,d.k1));I=f.add(I,A.gamma);let F=f.add(s,f.mul(y,d.k2));F=f.add(F,A.gamma);let x=f.mul(f.mul(f.mul(C,I),F),c),E=f.mul(f.mul(f.mul(C,I),F),g),v=f.add(l,f.mul(A.beta,_));v=f.add(v,A.gamma);let B=f.add(r,f.mul(A.beta,m));B=f.add(B,A.gamma);let S=f.add(s,f.mul(A.beta,L));S=f.add(S,A.gamma);let O=f.mul(f.mul(f.mul(v,B),S),u),P=f.mul(f.mul(f.mul(v,B),S),p),G=f.sub(x,O),T=f.sub(E,P);b.T2.set(G,e*h),b.T2z.set(T,e*h),t=f.mul(t,f.w[d.power+2])}if(a&&a.info("\xb7\xb7\xb7 Computing T2 ifft"),L.T2=await oB.fromEvaluations(b.T2,u,a),a&&a.info("\xb7\xb7\xb7 Computing T2 / ZH"),L.T2.divByZerofier(d.domainSize,f.one),a&&a.info("\xb7\xb7\xb7 Computing T2z ifft"),L.T2z=await oB.fromEvaluations(b.T2z,u,a),L.T2.add(L.T2z),L.T2.degree()>=3*d.domainSize)throw Error("T2 Polynomial is not well calculated");delete b.T2,delete b.T2z,delete L.T2z}async function l(){let t=new oj(3,u,a);if(t.addPolynomial(0,L.Z),t.addPolynomial(1,L.T1),t.addPolynomial(2,L.T2),L.C2=t.getPolynomial(),L.C2.degree()>=9*d.domainSize)throw Error("C2 Polynomial is not well calculated")}}async function G(){a&&a.info("> Computing challenge xi");let t=new oE(u);t.addScalar(A.gamma),t.addPolCommitment(I.getPolynomial("C2")),A.xiSeed=t.getChallenge();let e=f.square(A.xiSeed);C.w8=[],C.w8[0]=f.one;for(let t=1;t<8;t++)C.w8[t]=f.mul(C.w8[t-1],d.w8);C.w4=[],C.w4[0]=f.one;for(let t=1;t<4;t++)C.w4[t]=f.mul(C.w4[t-1],d.w4);C.w3=[],C.w3[0]=f.one,C.w3[1]=d.w3,C.w3[2]=f.square(d.w3),C.S0={},C.S0.h0w8=[],C.S0.h0w8[0]=f.mul(e,A.xiSeed);for(let t=1;t<8;t++)C.S0.h0w8[t]=f.mul(C.S0.h0w8[0],C.w8[t]);C.S1={},C.S1.h1w4=[],C.S1.h1w4[0]=f.square(C.S0.h0w8[0]);for(let t=1;t<4;t++)C.S1.h1w4[t]=f.mul(C.S1.h1w4[0],C.w4[t]);C.S2={},C.S2.h2w3=[],C.S2.h2w3[0]=f.mul(C.S1.h1w4[0],e),C.S2.h2w3[1]=f.mul(C.S2.h2w3[0],C.w3[1]),C.S2.h2w3[2]=f.mul(C.S2.h2w3[0],C.w3[2]),C.S2.h3w3=[],C.S2.h3w3[0]=f.mul(C.S2.h2w3[0],d.wr),C.S2.h3w3[1]=f.mul(C.S2.h3w3[0],C.w3[1]),C.S2.h3w3[2]=f.mul(C.S2.h3w3[0],C.w3[2]),A.xi=f.mul(f.square(C.S2.h2w3[0]),C.S2.h2w3[0]),a&&a.info("\xb7\xb7\xb7 challenges.xi: "+f.toString(A.xi)),L.QL=new oB(new tS(p),u,a),L.QR=new oB(new tS(p),u,a),L.QM=new oB(new tS(p),u,a),L.QO=new oB(new tS(p),u,a),L.QC=new oB(new tS(p),u,a),await s.readToBuffer(L.QL.coef,0,p,c[7][0].p),await s.readToBuffer(L.QR.coef,0,p,c[8][0].p),await s.readToBuffer(L.QM.coef,0,p,c[9][0].p),await s.readToBuffer(L.QO.coef,0,p,c[10][0].p),await s.readToBuffer(L.QC.coef,0,p,c[11][0].p),a&&a.info("\xb7\xb7\xb7 Computing evaluations"),I.addEvaluation("ql",L.QL.evaluate(A.xi)),I.addEvaluation("qr",L.QR.evaluate(A.xi)),I.addEvaluation("qm",L.QM.evaluate(A.xi)),I.addEvaluation("qo",L.QO.evaluate(A.xi)),I.addEvaluation("qc",L.QC.evaluate(A.xi)),I.addEvaluation("s1",L.Sigma1.evaluate(A.xi)),I.addEvaluation("s2",L.Sigma2.evaluate(A.xi)),I.addEvaluation("s3",L.Sigma3.evaluate(A.xi)),I.addEvaluation("a",L.A.evaluate(A.xi)),I.addEvaluation("b",L.B.evaluate(A.xi)),I.addEvaluation("c",L.C.evaluate(A.xi)),I.addEvaluation("z",L.Z.evaluate(A.xi)),A.xiw=f.mul(A.xi,f.w[d.power]),I.addEvaluation("zw",L.Z.evaluate(A.xiw)),I.addEvaluation("t1w",L.T1.evaluate(A.xiw)),I.addEvaluation("t2w",L.T2.evaluate(A.xiw))}async function T(){a&&a.info("> Computing challenge alpha");let t=new oE(u);t.addScalar(A.xiSeed),t.addScalar(I.getEvaluation("ql")),t.addScalar(I.getEvaluation("qr")),t.addScalar(I.getEvaluation("qm")),t.addScalar(I.getEvaluation("qo")),t.addScalar(I.getEvaluation("qc")),t.addScalar(I.getEvaluation("s1")),t.addScalar(I.getEvaluation("s2")),t.addScalar(I.getEvaluation("s3")),t.addScalar(I.getEvaluation("a")),t.addScalar(I.getEvaluation("b")),t.addScalar(I.getEvaluation("c")),t.addScalar(I.getEvaluation("z")),t.addScalar(I.getEvaluation("zw")),t.addScalar(I.getEvaluation("t1w")),t.addScalar(I.getEvaluation("t2w")),A.alpha=t.getChallenge(),a&&a.info("\xb7\xb7\xb7 challenges.alpha: "+f.toString(A.alpha)),a&&a.info("> Reading C0 polynomial"),L.C0=new oB(new tS(8*p),u,a),await s.readToBuffer(L.C0.coef,0,8*p,c[17][0].p),a&&a.info("> Computing R0 polynomial"),function(){if(L.R0=oB.lagrangePolynomialInterpolation([C.S0.h0w8[0],C.S0.h0w8[1],C.S0.h0w8[2],C.S0.h0w8[3],C.S0.h0w8[4],C.S0.h0w8[5],C.S0.h0w8[6],C.S0.h0w8[7]],[L.C0.evaluate(C.S0.h0w8[0]),L.C0.evaluate(C.S0.h0w8[1]),L.C0.evaluate(C.S0.h0w8[2]),L.C0.evaluate(C.S0.h0w8[3]),L.C0.evaluate(C.S0.h0w8[4]),L.C0.evaluate(C.S0.h0w8[5]),L.C0.evaluate(C.S0.h0w8[6]),L.C0.evaluate(C.S0.h0w8[7])],u),L.R0.degree()>7)throw Error("R0 Polynomial is not well calculated")}(),a&&a.info("> Computing R1 polynomial"),function(){if(L.R1=oB.lagrangePolynomialInterpolation([C.S1.h1w4[0],C.S1.h1w4[1],C.S1.h1w4[2],C.S1.h1w4[3]],[L.C1.evaluate(C.S1.h1w4[0]),L.C1.evaluate(C.S1.h1w4[1]),L.C1.evaluate(C.S1.h1w4[2]),L.C1.evaluate(C.S1.h1w4[3])],u),L.R1.degree()>3)throw Error("R1 Polynomial is not well calculated")}(),a&&a.info("> Computing R2 polynomial"),function(){if(L.R2=oB.lagrangePolynomialInterpolation([C.S2.h2w3[0],C.S2.h2w3[1],C.S2.h2w3[2],C.S2.h3w3[0],C.S2.h3w3[1],C.S2.h3w3[2]],[L.C2.evaluate(C.S2.h2w3[0]),L.C2.evaluate(C.S2.h2w3[1]),L.C2.evaluate(C.S2.h2w3[2]),L.C2.evaluate(C.S2.h3w3[0]),L.C2.evaluate(C.S2.h3w3[1]),L.C2.evaluate(C.S2.h3w3[2])],u),L.R2.degree()>5)throw Error("R2 Polynomial is not well calculated")}(),a&&a.info("> Computing F polynomial"),await i(),a&&a.info("> Computing W1 multi exponentiation");let e=await L.F.multiExponentiation(F,"W1");return I.addPolynomial("W1",e),0;async function i(){a&&a.info("\xb7\xb7\xb7 Computing F polynomial"),L.F=oB.fromPolynomial(L.C0,u,a),L.F.sub(L.R0),L.F.divByZerofier(8,A.xi);let t=oB.fromPolynomial(L.C1,u,a);t.sub(L.R1),t.mulScalar(A.alpha),t.divByZerofier(4,A.xi);let e=oB.fromPolynomial(L.C2,u,a);if(e.sub(L.R2),e.mulScalar(f.square(A.alpha)),e.divByZerofier(3,A.xi),e.divByZerofier(3,A.xiw),L.F.add(t),L.F.add(e),L.F.degree()>=9*d.domainSize-6)throw Error("F Polynomial is not well calculated")}}async function q(){a&&a.info("> Computing challenge y");let t=new oE(u);t.addScalar(A.alpha),t.addPolCommitment(I.getPolynomial("W1")),A.y=t.getChallenge(),a&&a.info("\xb7\xb7\xb7 challenges.y: "+f.toString(A.y)),a&&a.info("> Computing L polynomial"),await l(),a&&a.info("> Computing ZTS2 polynomial"),await s();let e=L.ZTS2.evaluate(A.y);e=f.inv(e),L.L.mulScalar(e);let i=oB.fromCoefficientsArray([f.neg(A.y),f.one],u);a&&a.info("> Computing W' = L / ZTS2 polynomial");let o=L.L.divBy(i);if(o.degree()>0)throw Error(`Degree of L(X)/(ZTS2(y)(X-y)) remainder is ${o.degree()} and should be 0`);if(L.L.degree()>=9*d.domainSize-1)throw Error("Degree of L(X)/(ZTS2(y)(X-y)) is not correct");a&&a.info("> Computing W' multi exponentiation");let n=await L.L.multiExponentiation(F,"W2");return I.addPolynomial("W2",n),0;async function l(){a&&a.info("\xb7\xb7\xb7 Computing L polynomial");let t=L.R0.evaluate(A.y),e=L.R1.evaluate(A.y),i=L.R2.evaluate(A.y),o=f.sub(A.y,C.S0.h0w8[0]);for(let t=1;t<8;t++)o=f.mul(o,f.sub(A.y,C.S0.h0w8[t]));let n=f.sub(A.y,C.S1.h1w4[0]);for(let t=1;t<4;t++)n=f.mul(n,f.sub(A.y,C.S1.h1w4[t]));let l=f.sub(A.y,C.S2.h2w3[0]);for(let t=1;t<3;t++)l=f.mul(l,f.sub(A.y,C.S2.h2w3[t]));for(let t=0;t<3;t++)l=f.mul(l,f.sub(A.y,C.S2.h3w3[t]));let s=f.mul(n,l),c=f.mul(A.alpha,f.mul(o,l)),h=f.mul(f.square(A.alpha),f.mul(o,n));y.denH1=n,y.denH2=l,L.L=oB.fromPolynomial(L.C0,u,a),L.L.subScalar(t),L.L.mulScalar(s);let g=oB.fromPolynomial(L.C1,u,a);g.subScalar(e),g.mulScalar(c);let p=oB.fromPolynomial(L.C2,u,a);p.subScalar(i),p.mulScalar(h),L.L.add(g),L.L.add(p),a&&a.info("> Computing ZT polynomial"),await r();let _=L.ZT.evaluate(A.y);if(L.F.mulScalar(_),L.L.sub(L.F),L.L.degree()>=9*d.domainSize)throw Error("L Polynomial is not well calculated");delete b.L}async function r(){L.ZT=oB.zerofierPolynomial([C.S0.h0w8[0],C.S0.h0w8[1],C.S0.h0w8[2],C.S0.h0w8[3],C.S0.h0w8[4],C.S0.h0w8[5],C.S0.h0w8[6],C.S0.h0w8[7],C.S1.h1w4[0],C.S1.h1w4[1],C.S1.h1w4[2],C.S1.h1w4[3],C.S2.h2w3[0],C.S2.h2w3[1],C.S2.h2w3[2],C.S2.h3w3[0],C.S2.h3w3[1],C.S2.h3w3[2]],u)}async function s(){L.ZTS2=oB.zerofierPolynomial([C.S1.h1w4[0],C.S1.h1w4[1],C.S1.h1w4[2],C.S1.h1w4[3],C.S2.h2w3[0],C.S2.h2w3[1],C.S2.h2w3[2],C.S2.h3w3[0],C.S2.h3w3[1],C.S2.h3w3[2]],u)}}}let{unstringifyBigInts:oZ}=l;async function oW(t,e,a,i,o,n){let l=oZ(t),r={type:"mem"};return await ah(l,e,r,o),await oH(a,r,i,n)}let{unstringifyBigInts:oY}=l;async function oJ(t,e,a,i){var o;i&&i.info("FFLONK VERIFIER STARTED"),t=oY(t),a=oY(a);let l=await eO(t.curve),r=((o=t).k1=l.Fr.fromObject(o.k1),o.k2=l.Fr.fromObject(o.k2),o.w=l.Fr.fromObject(o.w),o.w3=l.Fr.fromObject(o.w3),o.w4=l.Fr.fromObject(o.w4),o.w8=l.Fr.fromObject(o.w8),o.wr=l.Fr.fromObject(o.wr),o.X_2=l.G2.fromObject(o.X_2),o.C0=l.G1.fromObject(o.C0),o),s=new oF(l,i);s.fromObjectProof(a);let c=oY(e);if(c.length!==r.nPublic)return i.error("Number of public signals does not match with vk"),!1;let d=l.Fr;if(i&&(i.info("----------------------------"),i.info("  FFLONK VERIFY SETTINGS"),i.info(`  Curve:         ${l.name}`),i.info(`  Circuit power: ${r.power}`),i.info(`  Domain size:   ${2**r.power}`),i.info(`  Public vars:   ${r.nPublic}`),i.info("----------------------------")),i&&i.info("> Checking commitments belong to G1"),!function(t,e,a){let i=t.G1;return i.isValid(e.polynomials.C1)&&i.isValid(e.polynomials.C2)&&i.isValid(e.polynomials.W1)&&i.isValid(e.polynomials.W2)&&i.isValid(a.C0)}(l,s,r))return i&&i.error("Proof commitments are not valid"),!1;if(i&&i.info("> Checking evaluations belong to F"),!(oX(l,s.evaluations.ql)&&oX(l,s.evaluations.qr)&&oX(l,s.evaluations.qm)&&oX(l,s.evaluations.qo)&&oX(l,s.evaluations.qc)&&oX(l,s.evaluations.s1)&&oX(l,s.evaluations.s2)&&oX(l,s.evaluations.s3)&&oX(l,s.evaluations.a)&&oX(l,s.evaluations.b)&&oX(l,s.evaluations.c)&&oX(l,s.evaluations.z)&&oX(l,s.evaluations.zw)&&oX(l,s.evaluations.t1w)&&oX(l,s.evaluations.t2w)))return i&&i.error("Proof evaluations are not valid."),!1;if(i&&i.info("> Checking public inputs belong to F"),!function(t,e){for(let i=0;i<e.length;i++){var a;if(a=e[i],!n.lt(a,t.r))return!1}return!0}(l,c))return i&&i.error("Public inputs are not valid."),!1;i&&i.info("> Computing challenges");let{challenges:u,roots:f}=function(t,e,a,i,o){let n=t.Fr,l={},r={},s=new oE(t);s.addPolCommitment(a.C0);for(let t=0;t<i.length;t++)s.addScalar(n.e(i[t]));s.addPolCommitment(e.polynomials.C1),l.beta=s.getChallenge(),s.reset(),s.addScalar(l.beta),l.gamma=s.getChallenge(),s.reset(),s.addScalar(l.gamma),s.addPolCommitment(e.polynomials.C2);let c=s.getChallenge(),d=n.square(c),u=[];u[1]=a.w8,u[2]=n.square(a.w8),u[3]=n.mul(u[2],a.w8),u[4]=n.mul(u[3],a.w8),u[5]=n.mul(u[4],a.w8),u[6]=n.mul(u[5],a.w8),u[7]=n.mul(u[6],a.w8);let f=[];f[1]=a.w4,f[2]=n.square(a.w4),f[3]=n.mul(f[2],a.w4);let h=[];h[1]=a.w3,h[2]=n.square(a.w3),r.S0={},r.S0.h0w8=[],r.S0.h0w8[0]=n.mul(d,c);for(let t=1;t<8;t++)r.S0.h0w8[t]=n.mul(r.S0.h0w8[0],u[t]);r.S1={},r.S1.h1w4=[],r.S1.h1w4[0]=n.square(r.S0.h0w8[0]);for(let t=1;t<4;t++)r.S1.h1w4[t]=n.mul(r.S1.h1w4[0],f[t]);r.S2={},r.S2.h2w3=[],r.S2.h2w3[0]=n.mul(r.S1.h1w4[0],d),r.S2.h2w3[1]=n.mul(r.S2.h2w3[0],h[1]),r.S2.h2w3[2]=n.mul(r.S2.h2w3[0],h[2]),r.S2.h3w3=[],r.S2.h3w3[0]=n.mul(r.S2.h2w3[0],a.wr),r.S2.h3w3[1]=n.mul(r.S2.h3w3[0],h[1]),r.S2.h3w3[2]=n.mul(r.S2.h3w3[0],h[2]),l.xi=n.mul(n.square(r.S2.h2w3[0]),r.S2.h2w3[0]),l.xiw=n.mul(l.xi,n.w[a.power]),l.xiN=l.xi,a.domainSize=1;for(let t=0;t<a.power;t++)l.xiN=n.square(l.xiN),a.domainSize*=2;return s.reset(),s.addScalar(c),s.addScalar(e.evaluations.ql),s.addScalar(e.evaluations.qr),s.addScalar(e.evaluations.qm),s.addScalar(e.evaluations.qo),s.addScalar(e.evaluations.qc),s.addScalar(e.evaluations.s1),s.addScalar(e.evaluations.s2),s.addScalar(e.evaluations.s3),s.addScalar(e.evaluations.a),s.addScalar(e.evaluations.b),s.addScalar(e.evaluations.c),s.addScalar(e.evaluations.z),s.addScalar(e.evaluations.zw),s.addScalar(e.evaluations.t1w),s.addScalar(e.evaluations.t2w),l.alpha=s.getChallenge(),s.reset(),s.addScalar(l.alpha),s.addPolCommitment(e.polynomials.W1),l.y=s.getChallenge(),o&&(o.info("\xb7\xb7\xb7 challenges.beta:  "+n.toString(l.beta)),o.info("\xb7\xb7\xb7 challenges.gamma: "+n.toString(l.gamma)),o.info("\xb7\xb7\xb7 challenges.xi:    "+n.toString(l.xi)),o.info("\xb7\xb7\xb7 challenges.alpha: "+n.toString(l.alpha)),o.info("\xb7\xb7\xb7 challenges.y:     "+n.toString(l.y))),{challenges:l,roots:r}}(l,s,r,c,i);i&&i.info("> Computing Zero polynomial evaluation Z_H(xi)"),u.zh=d.sub(u.xiN,d.one),u.invzh=d.inv(u.zh),i&&i.info("> Computing Lagrange evaluations");let h=await o2(l,u,r);i&&i.info("> Computing polynomial identities PI(X)");let g=function(t,e,a){let i=t.Fr,o=i.zero;for(let t=0;t<e.length;t++){let n=i.e(e[t]);o=i.sub(o,i.mul(n,a[t+1]))}return o}(l,c,h);i&&i.info("> Computing r0(y)");let p=function(t,e,a,i,o){let n=i.Fr,l=o3(a.S0.h0w8,e.y,e.xi,i);o&&o.info("\xb7\xb7\xb7 Computing r0(y)");let r=n.zero;for(let e=0;e<8;e++){let i=[];i[1]=a.S0.h0w8[e];for(let t=2;t<8;t++)i[t]=n.mul(i[t-1],a.S0.h0w8[e]);let o=n.add(t.evaluations.ql,n.mul(t.evaluations.qr,i[1]));o=n.add(o,n.mul(t.evaluations.qo,i[2])),o=n.add(o,n.mul(t.evaluations.qm,i[3])),o=n.add(o,n.mul(t.evaluations.qc,i[4])),o=n.add(o,n.mul(t.evaluations.s1,i[5])),o=n.add(o,n.mul(t.evaluations.s2,i[6])),o=n.add(o,n.mul(t.evaluations.s3,i[7])),r=n.add(r,n.mul(o,l[e]))}return r}(s,u,f,l,i);i&&i.info("> Computing r1(y)");let _=function(t,e,a,i,o,n){let l=o.Fr,r=o3(a.S1.h1w4,e.y,e.xi,o);n&&n.info("\xb7\xb7\xb7 Computing T0(xi)");let s=l.mul(t.evaluations.ql,t.evaluations.a);s=l.add(s,l.mul(t.evaluations.qr,t.evaluations.b)),s=l.add(s,l.mul(t.evaluations.qm,l.mul(t.evaluations.a,t.evaluations.b))),s=l.add(s,l.mul(t.evaluations.qo,t.evaluations.c)),s=l.add(s,t.evaluations.qc),s=l.add(s,i),s=l.mul(s,e.invzh),n&&n.info("\xb7\xb7\xb7 Computing C1(h_1_4^i) values");let c=l.zero;for(let e=0;e<4;e++){let i=t.evaluations.a;i=l.add(i,l.mul(a.S1.h1w4[e],t.evaluations.b));let o=l.square(a.S1.h1w4[e]);i=l.add(i,l.mul(o,t.evaluations.c)),i=l.add(i,l.mul(l.mul(o,a.S1.h1w4[e]),s)),c=l.add(c,l.mul(i,r[e]))}return c}(s,u,f,g,l,i);i&&i.info("> Computing r2(y)");let m=function(t,e,a,i,o,n,l){let r=n.Fr,s=function(t,e,a,i,o){let n=o.Fr,l=[],r=t[0].length,s=r*t.length,c=n.exp(e,s),d=n.mul(n.add(a,i),n.exp(e,r)),u=n.mul(a,i),f=n.add(n.sub(c,d),u),h=n.mul(n.mul(n.e(r),t[0][0]),n.sub(a,i));for(let a=0;a<r;a++){let i=t[0][(r-1)*a%r],o=n.sub(e,t[0][a]),s=n.mul(h,n.mul(i,o));l[a]=n.div(f,s)}h=n.mul(n.mul(n.e(r),t[1][0]),n.sub(i,a));for(let a=0;a<r;a++){let i=t[1][(r-1)*a%r],o=n.sub(e,t[1][a]),s=n.mul(h,n.mul(i,o));l[a+r]=n.div(f,s)}return l}([a.S2.h2w3,a.S2.h3w3],e.y,e.xi,e.xiw,n);l&&l.info("\xb7\xb7\xb7 Computing T1(xi)");let c=r.sub(t.evaluations.z,r.one);c=r.mul(c,i),c=r.mul(c,e.invzh),l&&l.info("\xb7\xb7\xb7 Computing T2(xi)");let d=r.mul(e.beta,e.xi),u=r.add(t.evaluations.a,r.add(d,e.gamma)),f=r.add(t.evaluations.b,r.add(r.mul(d,o.k1),e.gamma)),h=r.add(t.evaluations.c,r.add(r.mul(d,o.k2),e.gamma)),g=r.mul(u,r.mul(f,r.mul(h,t.evaluations.z))),p=r.add(t.evaluations.a,r.add(r.mul(e.beta,t.evaluations.s1),e.gamma)),_=r.add(t.evaluations.b,r.add(r.mul(e.beta,t.evaluations.s2),e.gamma)),m=r.add(t.evaluations.c,r.add(r.mul(e.beta,t.evaluations.s3),e.gamma)),b=r.mul(p,r.mul(_,r.mul(m,t.evaluations.zw))),L=r.sub(g,b);L=r.mul(L,e.invzh),l&&l.info("\xb7\xb7\xb7 Computing C2(h_2_3^i) values");let w=r.zero;for(let e=0;e<3;e++){let i=r.add(t.evaluations.z,r.mul(a.S2.h2w3[e],c));i=r.add(i,r.mul(r.square(a.S2.h2w3[e]),L)),w=r.add(w,r.mul(i,s[e]))}l&&l.info("\xb7\xb7\xb7 Computing C2(h_3_3^i) values");for(let e=0;e<3;e++){let i=r.add(t.evaluations.zw,r.mul(a.S2.h3w3[e],t.evaluations.t1w));i=r.add(i,r.mul(r.square(a.S2.h3w3[e]),t.evaluations.t2w)),w=r.add(w,r.mul(i,s[e+3]))}return w}(s,u,f,h[1],r,l,i);i&&i.info("> Computing F");let b=function(t,e,a,i,o){let n=t.G1,l=t.Fr,r=l.sub(i.y,o.S0.h0w8[0]);for(let t=1;t<8;t++)r=l.mul(r,l.sub(i.y,o.S0.h0w8[t]));i.temp=r;let s=l.sub(i.y,o.S1.h1w4[0]);for(let t=1;t<4;t++)s=l.mul(s,l.sub(i.y,o.S1.h1w4[t]));let c=l.sub(i.y,o.S2.h2w3[0]);for(let t=1;t<3;t++)c=l.mul(c,l.sub(i.y,o.S2.h2w3[t]));for(let t=0;t<3;t++)c=l.mul(c,l.sub(i.y,o.S2.h3w3[t]));i.quotient1=l.mul(i.alpha,l.div(r,s)),i.quotient2=l.mul(l.square(i.alpha),l.div(r,c));let d=n.timesFr(e.polynomials.C1,i.quotient1),u=n.timesFr(e.polynomials.C2,i.quotient2);return n.add(a.C0,n.add(d,u))}(l,s,r,u,f);i&&i.info("> Computing E");let L=function(t,e,a,i,o,n,l){let r=t.G1,s=t.Fr,c=s.mul(n,a.quotient1),d=s.mul(l,a.quotient2);return r.timesFr(r.one,s.add(o,s.add(c,d)))}(l,0,u,0,p,_,m);i&&i.info("> Computing J");let w=l.G1.timesFr(s.polynomials.W1,u.temp);i&&i.info("> Validate all evaluations with a pairing");let y=await o1(l,s,u,r,b,L,w);return i&&(y?i.info("PROOF VERIFIED SUCCESSFULLY"):i.warn("Invalid Proof")),i&&i.info("FFLONK VERIFIER FINISHED"),y}function oX(t,e){var a;return a=n.fromRprLE(e),n.lt(a,t.r)}async function o2(t,e,a){let i=t.Fr,o=Math.max(1,a.nPublic),n=new tS(o*i.n8),l=new tS(o*i.n8),r=i.one;for(let t=0;t<o;t++){let o=t*i.n8;n.set(i.mul(r,e.zh),o),l.set(i.mul(i.e(a.domainSize),i.sub(e.xi,r)),o),r=i.mul(r,a.w)}l=await i.batchInverse(l);let s=[];for(let t=0;t<o;t++){let e=t*i.n8;s[t+1]=i.mul(n.slice(e,e+i.n8),l.slice(e,e+i.n8))}return s}async function o1(t,e,a,i,o,n,l){let r=t.G1,s=r.timesFr(e.polynomials.W2,a.y);s=r.add(r.sub(r.sub(o,n),l),s);let c=t.G2.one,d=e.polynomials.W2,u=i.X_2;return await t.pairingEq(r.neg(s),c,d,u)}function o3(t,e,a,i){let o=i.Fr,n=t.length,l=o.sub(o.exp(e,n),a),r=o.mul(o.e(n),o.exp(t[0],n-2)),s=[];for(let a=0;a<n;a++){let i=t[(n-1)*a%n],c=o.sub(e,t[a]);s[a]=o.div(l,o.mul(o.mul(r,i),c))}return s}let{unstringifyBigInts:o0}=l;function o8(t){let e=t.toString(16);for(;e.length<64;)e="0"+e;return`0x${e}`}async function o4(t,e){let a=o0(e),i=o0(t),o=await eO(a.curve);o.G1,o.Fr;let n="";for(let t=0;t<i.length;t++)""!==n&&(n+=","),n+=o8(i[t]);return`[${o8(a.polynomials.C1[0])}, ${o8(a.polynomials.C1[1])},${o8(a.polynomials.C2[0])},${o8(a.polynomials.C2[1])},${o8(a.polynomials.W1[0])},${o8(a.polynomials.W1[1])},${o8(a.polynomials.W2[0])},${o8(a.polynomials.W2[1])},${o8(a.evaluations.ql)},${o8(a.evaluations.qr)},${o8(a.evaluations.qm)},${o8(a.evaluations.qo)},${o8(a.evaluations.qc)},${o8(a.evaluations.s1)},${o8(a.evaluations.s2)},${o8(a.evaluations.s3)},${o8(a.evaluations.a)},${o8(a.evaluations.b)},${o8(a.evaluations.c)},${o8(a.evaluations.z)},${o8(a.evaluations.zw)},${o8(a.evaluations.t1w)},${o8(a.evaluations.t2w)},${o8(a.evaluations.inv)}],[${n}]`}},3316:t=>{"use strict";t.exports={i8:"3.1.10"}}};